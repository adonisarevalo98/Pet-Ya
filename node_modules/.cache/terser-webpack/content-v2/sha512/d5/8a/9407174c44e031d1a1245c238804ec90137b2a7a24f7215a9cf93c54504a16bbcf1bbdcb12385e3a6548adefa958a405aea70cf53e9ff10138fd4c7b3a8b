{"code":"(window.webpackJsonp=window.webpackJsonp||[]).push([[1],{0:function(module,exports,__webpack_require__){module.exports=__webpack_require__(\"zUnb\")},\"6Joi\":function(module,exports,__webpack_require__){\"use strict\";Object.defineProperty(exports,\"__esModule\",{value:!0});var t=__webpack_require__(\"mrSG\"),e=__webpack_require__(\"wj3C\"),n=__webpack_require__(\"q/0M\"),r=__webpack_require__(\"zVF4\"),i=__webpack_require__(\"x7I3\"),o=__webpack_require__(\"S+S0\"),u=function(t){return t&&\"object\"==typeof t&&\"default\"in t?t:{default:t}}(e),a={OK:\"ok\",CANCELLED:\"cancelled\",UNKNOWN:\"unknown\",INVALID_ARGUMENT:\"invalid-argument\",DEADLINE_EXCEEDED:\"deadline-exceeded\",NOT_FOUND:\"not-found\",ALREADY_EXISTS:\"already-exists\",PERMISSION_DENIED:\"permission-denied\",UNAUTHENTICATED:\"unauthenticated\",RESOURCE_EXHAUSTED:\"resource-exhausted\",FAILED_PRECONDITION:\"failed-precondition\",ABORTED:\"aborted\",OUT_OF_RANGE:\"out-of-range\",UNIMPLEMENTED:\"unimplemented\",INTERNAL:\"internal\",UNAVAILABLE:\"unavailable\",DATA_LOSS:\"data-loss\"},c=function(e){function n(t,n){var r=this;return(r=e.call(this,n)||this).code=t,r.message=n,r.name=\"FirebaseError\",r.toString=function(){return r.name+\": [code=\"+r.code+\"]: \"+r.message},r}return t.__extends(n,e),n}(Error),h=new n.Logger(\"@firebase/firestore\");function f(){return h.logLevel}function l(e){for(var r=[],i=1;i<arguments.length;i++)r[i-1]=arguments[i];if(h.logLevel<=n.LogLevel.DEBUG){var o=r.map(v);h.debug.apply(h,t.__spreadArrays([\"Firestore (7.21.1): \"+e],o))}}function p(e){for(var r=[],i=1;i<arguments.length;i++)r[i-1]=arguments[i];if(h.logLevel<=n.LogLevel.ERROR){var o=r.map(v);h.error.apply(h,t.__spreadArrays([\"Firestore (7.21.1): \"+e],o))}}function d(e){for(var r=[],i=1;i<arguments.length;i++)r[i-1]=arguments[i];if(h.logLevel<=n.LogLevel.WARN){var o=r.map(v);h.warn.apply(h,t.__spreadArrays([\"Firestore (7.21.1): \"+e],o))}}function v(t){if(\"string\"==typeof t)return t;try{return JSON.stringify(t)}catch(e){return t}}function y(t){void 0===t&&(t=\"Unexpected state\");var e=\"FIRESTORE (7.21.1) INTERNAL ASSERTION FAILED: \"+t;throw p(e),new Error(e)}function g(t,e){t||y()}function m(t,e){return t}function w(t){var e=0;for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&e++;return e}function _(t,e){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&e(n,t[n])}function b(t){for(var e in t)if(Object.prototype.hasOwnProperty.call(t,e))return!1;return!0}var I=function(){function t(t,e,n){void 0===e?e=0:e>t.length&&y(),void 0===n?n=t.length-e:n>t.length-e&&y(),this.segments=t,this.offset=e,this.t=n}return Object.defineProperty(t.prototype,\"length\",{get:function(){return this.t},enumerable:!1,configurable:!0}),t.prototype.isEqual=function(e){return 0===t.i(this,e)},t.prototype.child=function(e){var n=this.segments.slice(this.offset,this.limit());return e instanceof t?e.forEach((function(t){n.push(t)})):n.push(e),this.o(n)},t.prototype.limit=function(){return this.offset+this.length},t.prototype.u=function(t){return this.o(this.segments,this.offset+(t=void 0===t?1:t),this.length-t)},t.prototype.h=function(){return this.o(this.segments,this.offset,this.length-1)},t.prototype.l=function(){return this.segments[this.offset]},t.prototype._=function(){return this.get(this.length-1)},t.prototype.get=function(t){return this.segments[this.offset+t]},t.prototype.m=function(){return 0===this.length},t.prototype.T=function(t){if(t.length<this.length)return!1;for(var e=0;e<this.length;e++)if(this.get(e)!==t.get(e))return!1;return!0},t.prototype.I=function(t){if(this.length+1!==t.length)return!1;for(var e=0;e<this.length;e++)if(this.get(e)!==t.get(e))return!1;return!0},t.prototype.forEach=function(t){for(var e=this.offset,n=this.limit();e<n;e++)t(this.segments[e])},t.prototype.A=function(){return this.segments.slice(this.offset,this.limit())},t.i=function(t,e){for(var n=Math.min(t.length,e.length),r=0;r<n;r++){var i=t.get(r),o=e.get(r);if(i<o)return-1;if(i>o)return 1}return t.length<e.length?-1:t.length>e.length?1:0},t}(),E=function(e){function n(){return null!==e&&e.apply(this,arguments)||this}return t.__extends(n,e),n.prototype.o=function(t,e,r){return new n(t,e,r)},n.prototype.R=function(){return this.A().join(\"/\")},n.prototype.toString=function(){return this.R()},n.P=function(t){if(t.indexOf(\"//\")>=0)throw new c(a.INVALID_ARGUMENT,\"Invalid path (\"+t+\"). Paths must not contain // in them.\");return new n(t.split(\"/\").filter((function(t){return t.length>0})))},n.g=function(){return new n([])},n}(I),T=/^[_a-zA-Z][_a-zA-Z0-9]*$/,N=function(e){function n(){return null!==e&&e.apply(this,arguments)||this}return t.__extends(n,e),n.prototype.o=function(t,e,r){return new n(t,e,r)},n.V=function(t){return T.test(t)},n.prototype.R=function(){return this.A().map((function(t){return t=t.replace(\"\\\\\",\"\\\\\\\\\").replace(\"`\",\"\\\\`\"),n.V(t)||(t=\"`\"+t+\"`\"),t})).join(\".\")},n.prototype.toString=function(){return this.R()},n.prototype.p=function(){return 1===this.length&&\"__name__\"===this.get(0)},n.v=function(){return new n([\"__name__\"])},n.S=function(t){for(var e=[],r=\"\",i=0,o=function(){if(0===r.length)throw new c(a.INVALID_ARGUMENT,\"Invalid field path (\"+t+\"). Paths must not be empty, begin with '.', end with '.', or contain '..'\");e.push(r),r=\"\"},s=!1;i<t.length;){var u=t[i];if(\"\\\\\"===u){if(i+1===t.length)throw new c(a.INVALID_ARGUMENT,\"Path has trailing escape character: \"+t);var h=t[i+1];if(\"\\\\\"!==h&&\".\"!==h&&\"`\"!==h)throw new c(a.INVALID_ARGUMENT,\"Path has invalid escape sequence: \"+t);r+=h,i+=2}else\"`\"===u?(s=!s,i++):\".\"!==u||s?(r+=u,i++):(o(),i++)}if(o(),s)throw new c(a.INVALID_ARGUMENT,\"Unterminated ` in path: \"+t);return new n(e)},n.g=function(){return new n([])},n}(I),A=function(){function t(t){this.path=t}return t.D=function(e){return new t(E.P(e))},t.C=function(e){return new t(E.P(e).u(5))},t.prototype.N=function(t){return this.path.length>=2&&this.path.get(this.path.length-2)===t},t.prototype.isEqual=function(t){return null!==t&&0===E.i(this.path,t.path)},t.prototype.toString=function(){return this.path.toString()},t.i=function(t,e){return E.i(t.path,e.path)},t.F=function(t){return t.length%2==0},t.$=function(e){return new t(new E(e.slice()))},t}();function S(t,e){if(0!==e.length)throw new c(a.INVALID_ARGUMENT,\"Function \"+t+\"() does not support arguments, but was called with \"+Q(e.length,\"argument\")+\".\")}function D(t,e,n){if(e.length!==n)throw new c(a.INVALID_ARGUMENT,\"Function \"+t+\"() requires \"+Q(n,\"argument\")+\", but was called with \"+Q(e.length,\"argument\")+\".\")}function x(t,e,n){if(e.length<n)throw new c(a.INVALID_ARGUMENT,\"Function \"+t+\"() requires at least \"+Q(n,\"argument\")+\", but was called with \"+Q(e.length,\"argument\")+\".\")}function k(t,e,n,r){if(e.length<n||e.length>r)throw new c(a.INVALID_ARGUMENT,\"Function \"+t+\"() requires between \"+n+\" and \"+r+\" arguments, but was called with \"+Q(e.length,\"argument\")+\".\")}function L(t,e,n,r){V(t,e,z(n)+\" argument\",r)}function O(t,e,n,r){void 0!==r&&L(t,e,n,r)}function R(t,e,n,r){V(t,e,n+\" option\",r)}function U(t,e,n,r){void 0!==r&&R(t,e,n,r)}function C(t,e,n,r,i){void 0!==r&&function(t,e,n,r,i){for(var o=[],s=0,u=i;s<u.length;s++){var h=u[s];if(h===r)return;o.push(F(h))}var f=F(r);throw new c(a.INVALID_ARGUMENT,\"Invalid value \"+f+\" provided to function \"+t+'() for option \"'+n+'\". Acceptable values: '+o.join(\", \"))}(t,0,n,r,i)}function P(t,e,n,r){if(!e.some((function(t){return t===r})))throw new c(a.INVALID_ARGUMENT,\"Invalid value \"+F(r)+\" provided to function \"+t+\"() for its \"+z(n)+\" argument. Acceptable values: \"+e.join(\", \"));return r}function V(t,e,n,r){if(!(\"object\"===e?M(r):\"non-empty string\"===e?\"string\"==typeof r&&\"\"!==r:typeof r===e)){var i=F(r);throw new c(a.INVALID_ARGUMENT,\"Function \"+t+\"() requires its \"+n+\" to be of type \"+e+\", but it was: \"+i)}}function M(t){return\"object\"==typeof t&&null!==t&&(Object.getPrototypeOf(t)===Object.prototype||null===Object.getPrototypeOf(t))}function F(t){if(void 0===t)return\"undefined\";if(null===t)return\"null\";if(\"string\"==typeof t)return t.length>20&&(t=t.substring(0,20)+\"...\"),JSON.stringify(t);if(\"number\"==typeof t||\"boolean\"==typeof t)return\"\"+t;if(\"object\"==typeof t){if(t instanceof Array)return\"an array\";var e=function(t){if(t.constructor){var e=/function\\s+([^\\s(]+)\\s*\\(/.exec(t.constructor.toString());if(e&&e.length>1)return e[1]}return null}(t);return e?\"a custom \"+e+\" object\":\"an object\"}return\"function\"==typeof t?\"a function\":y()}function q(t,e,n){if(void 0===n)throw new c(a.INVALID_ARGUMENT,\"Function \"+t+\"() requires a valid \"+z(e)+\" argument, but it was undefined.\")}function G(t,e,n){_(e,(function(e,r){if(n.indexOf(e)<0)throw new c(a.INVALID_ARGUMENT,\"Unknown option '\"+e+\"' passed to function \"+t+\"(). Available options: \"+n.join(\", \"))}))}function B(t,e,n,r){var i=F(r);return new c(a.INVALID_ARGUMENT,\"Function \"+t+\"() requires its \"+z(n)+\" argument to be a \"+e+\", but it was: \"+i)}function j(t,e,n){if(n<=0)throw new c(a.INVALID_ARGUMENT,\"Function \"+t+\"() requires its \"+z(e)+\" argument to be a positive number, but it was: \"+n+\".\")}function z(t){switch(t){case 1:return\"first\";case 2:return\"second\";case 3:return\"third\";default:return t+\"th\"}}function Q(t,e){return t+\" \"+e+(1===t?\"\":\"s\")}function W(t){var e=\"undefined\"!=typeof self&&(self.crypto||self.msCrypto),n=new Uint8Array(t);if(e&&\"function\"==typeof e.getRandomValues)e.getRandomValues(n);else for(var r=0;r<t;r++)n[r]=Math.floor(256*Math.random());return n}var K=function(){function t(){}return t.k=function(){for(var t=\"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789\",e=Math.floor(256/t.length)*t.length,n=\"\";n.length<20;)for(var r=W(40),i=0;i<r.length;++i)n.length<20&&r[i]<e&&(n+=t.charAt(r[i]%t.length));return n},t}();function Y(t,e){return t<e?-1:t>e?1:0}function H(t,e,n){return t.length===e.length&&t.every((function(t,r){return n(t,e[r])}))}function $(t){return t+\"\\0\"}var X=function(){function t(t){this.M=t}return t.fromBase64String=function(e){return new t(atob(e))},t.fromUint8Array=function(e){return new t(function(t){for(var e=\"\",n=0;n<t.length;++n)e+=String.fromCharCode(t[n]);return e}(e))},t.prototype.toBase64=function(){return btoa(this.M)},t.prototype.toUint8Array=function(){return function(t){for(var e=new Uint8Array(t.length),n=0;n<t.length;n++)e[n]=t.charCodeAt(n);return e}(this.M)},t.prototype.O=function(){return 2*this.M.length},t.prototype.L=function(t){return Y(this.M,t.M)},t.prototype.isEqual=function(t){return this.M===t.M},t}();X.B=new X(\"\");var J=function(){function t(t){this.q=t}return t.fromBase64String=function(e){try{return new t(X.fromBase64String(e))}catch(e){throw new c(a.INVALID_ARGUMENT,\"Failed to construct Bytes from Base64 string: \"+e)}},t.fromUint8Array=function(e){return new t(X.fromUint8Array(e))},t.prototype.toBase64=function(){return this.q.toBase64()},t.prototype.toUint8Array=function(){return this.q.toUint8Array()},t.prototype.toString=function(){return\"Bytes(base64: \"+this.toBase64()+\")\"},t.prototype.isEqual=function(t){return this.q.isEqual(t.q)},t}();function Z(){if(\"undefined\"==typeof Uint8Array)throw new c(a.UNIMPLEMENTED,\"Uint8Arrays are not available in this environment.\")}function tt(){if(\"undefined\"==typeof atob)throw new c(a.UNIMPLEMENTED,\"Blobs are unavailable in Firestore in this environment.\")}var et=function(e){function n(){return null!==e&&e.apply(this,arguments)||this}return t.__extends(n,e),n.fromBase64String=function(t){D(\"Blob.fromBase64String\",arguments,1),L(\"Blob.fromBase64String\",\"string\",1,t),tt();try{return new n(X.fromBase64String(t))}catch(t){throw new c(a.INVALID_ARGUMENT,\"Failed to construct Blob from Base64 string: \"+t)}},n.fromUint8Array=function(t){if(D(\"Blob.fromUint8Array\",arguments,1),Z(),!(t instanceof Uint8Array))throw B(\"Blob.fromUint8Array\",\"Uint8Array\",1,t);return new n(X.fromUint8Array(t))},n.prototype.toBase64=function(){return D(\"Blob.toBase64\",arguments,0),tt(),e.prototype.toBase64.call(this)},n.prototype.toUint8Array=function(){return D(\"Blob.toUint8Array\",arguments,0),Z(),e.prototype.toUint8Array.call(this)},n.prototype.toString=function(){return\"Blob(base64: \"+this.toBase64()+\")\"},n}(J),nt=function(t,e,n,r,i){this.U=t,this.persistenceKey=e,this.host=n,this.ssl=r,this.forceLongPolling=i},rt=function(){function t(t,e){this.projectId=t,this.database=e||\"(default)\"}return Object.defineProperty(t.prototype,\"W\",{get:function(){return\"(default)\"===this.database},enumerable:!1,configurable:!0}),t.prototype.isEqual=function(e){return e instanceof t&&e.projectId===this.projectId&&e.database===this.database},t.prototype.L=function(t){return Y(this.projectId,t.projectId)||Y(this.database,t.database)},t}(),it=function(){function t(t,e){this.j=t,this.K=e,this.G={}}return t.prototype.get=function(t){var e=this.j(t),n=this.G[e];if(void 0!==n)for(var r=0,i=n;r<i.length;r++){var o=i[r],u=o[1];if(this.K(o[0],t))return u}},t.prototype.has=function(t){return void 0!==this.get(t)},t.prototype.set=function(t,e){var n=this.j(t),r=this.G[n];if(void 0!==r){for(var i=0;i<r.length;i++)if(this.K(r[i][0],t))return void(r[i]=[t,e]);r.push([t,e])}else this.G[n]=[[t,e]]},t.prototype.delete=function(t){var e=this.j(t),n=this.G[e];if(void 0===n)return!1;for(var r=0;r<n.length;r++)if(this.K(n[r][0],t))return 1===n.length?delete this.G[e]:n.splice(r,1),!0;return!1},t.prototype.forEach=function(t){_(this.G,(function(e,n){for(var r=0,i=n;r<i.length;r++){var o=i[r];t(o[0],o[1])}}))},t.prototype.m=function(){return b(this.G)},t}(),ot=function(){function t(t,e){if(this.seconds=t,this.nanoseconds=e,e<0)throw new c(a.INVALID_ARGUMENT,\"Timestamp nanoseconds out of range: \"+e);if(e>=1e9)throw new c(a.INVALID_ARGUMENT,\"Timestamp nanoseconds out of range: \"+e);if(t<-62135596800)throw new c(a.INVALID_ARGUMENT,\"Timestamp seconds out of range: \"+t);if(t>=253402300800)throw new c(a.INVALID_ARGUMENT,\"Timestamp seconds out of range: \"+t)}return t.now=function(){return t.fromMillis(Date.now())},t.fromDate=function(e){return t.fromMillis(e.getTime())},t.fromMillis=function(e){var n=Math.floor(e/1e3);return new t(n,1e6*(e-1e3*n))},t.prototype.toDate=function(){return new Date(this.toMillis())},t.prototype.toMillis=function(){return 1e3*this.seconds+this.nanoseconds/1e6},t.prototype.H=function(t){return this.seconds===t.seconds?Y(this.nanoseconds,t.nanoseconds):Y(this.seconds,t.seconds)},t.prototype.isEqual=function(t){return t.seconds===this.seconds&&t.nanoseconds===this.nanoseconds},t.prototype.toString=function(){return\"Timestamp(seconds=\"+this.seconds+\", nanoseconds=\"+this.nanoseconds+\")\"},t.prototype.toJSON=function(){return{seconds:this.seconds,nanoseconds:this.nanoseconds}},t.prototype.valueOf=function(){return String(this.seconds- -62135596800).padStart(12,\"0\")+\".\"+String(this.nanoseconds).padStart(9,\"0\")},t}(),st=function(){function t(t){this.timestamp=t}return t.Y=function(e){return new t(e)},t.min=function(){return new t(new ot(0,0))},t.prototype.L=function(t){return this.timestamp.H(t.timestamp)},t.prototype.isEqual=function(t){return this.timestamp.isEqual(t.timestamp)},t.prototype.J=function(){return 1e6*this.timestamp.seconds+this.timestamp.nanoseconds/1e3},t.prototype.toString=function(){return\"SnapshotVersion(\"+this.timestamp.toString()+\")\"},t.prototype.X=function(){return this.timestamp},t}();function ut(t){return null==t}function at(t){return 0===t&&1/t==-1/0}function ct(t){return\"number\"==typeof t&&Number.isInteger(t)&&!at(t)&&t<=Number.MAX_SAFE_INTEGER&&t>=Number.MIN_SAFE_INTEGER}var ht=function(t,e,n,r,i,o,s){void 0===e&&(e=null),void 0===n&&(n=[]),void 0===r&&(r=[]),void 0===i&&(i=null),void 0===o&&(o=null),void 0===s&&(s=null),this.path=t,this.collectionGroup=e,this.orderBy=n,this.filters=r,this.limit=i,this.startAt=o,this.endAt=s,this.Z=null};function ft(t,e,n,r,i,o,s){return void 0===e&&(e=null),void 0===n&&(n=[]),void 0===r&&(r=[]),void 0===i&&(i=null),void 0===o&&(o=null),void 0===s&&(s=null),new ht(t,e,n,r,i,o,s)}function lt(t){var e=m(t);if(null===e.Z){var n=e.path.R();null!==e.collectionGroup&&(n+=\"|cg:\"+e.collectionGroup),n+=\"|f:\",n+=e.filters.map((function(t){return function(t){return t.field.R()+t.op.toString()+ne(t.value)}(t)})).join(\",\"),n+=\"|ob:\",n+=e.orderBy.map((function(t){return(e=t).field.R()+e.dir;var e})).join(\",\"),ut(e.limit)||(n+=\"|l:\",n+=e.limit),e.startAt&&(n+=\"|lb:\",n+=ir(e.startAt)),e.endAt&&(n+=\"|ub:\",n+=ir(e.endAt)),e.Z=n}return e.Z}function pt(t,e){if(t.limit!==e.limit)return!1;if(t.orderBy.length!==e.orderBy.length)return!1;for(var n=0;n<t.orderBy.length;n++)if(!cr(t.orderBy[n],e.orderBy[n]))return!1;if(t.filters.length!==e.filters.length)return!1;for(var r=0;r<t.filters.length;r++)if((i=t.filters[r]).op!==(o=e.filters[r]).op||!i.field.isEqual(o.field)||!Jt(i.value,o.value))return!1;var i,o;return t.collectionGroup===e.collectionGroup&&!!t.path.isEqual(e.path)&&!!sr(t.startAt,e.startAt)&&sr(t.endAt,e.endAt)}function dt(t){return A.F(t.path)&&null===t.collectionGroup&&0===t.filters.length}var vt,yt,gt=function(){function t(t,e,n,r,i,o,s){void 0===i&&(i=st.min()),void 0===o&&(o=st.min()),void 0===s&&(s=X.B),this.target=t,this.targetId=e,this.tt=n,this.sequenceNumber=r,this.et=i,this.lastLimboFreeSnapshotVersion=o,this.resumeToken=s}return t.prototype.nt=function(e){return new t(this.target,this.targetId,this.tt,e,this.et,this.lastLimboFreeSnapshotVersion,this.resumeToken)},t.prototype.st=function(e,n){return new t(this.target,this.targetId,this.tt,this.sequenceNumber,n,this.lastLimboFreeSnapshotVersion,e)},t.prototype.it=function(e){return new t(this.target,this.targetId,this.tt,this.sequenceNumber,this.et,e,this.resumeToken)},t}(),mt=function(t){this.count=t};function wt(t){switch(t){case a.OK:return y();case a.CANCELLED:case a.UNKNOWN:case a.DEADLINE_EXCEEDED:case a.RESOURCE_EXHAUSTED:case a.INTERNAL:case a.UNAVAILABLE:case a.UNAUTHENTICATED:return!1;case a.INVALID_ARGUMENT:case a.NOT_FOUND:case a.ALREADY_EXISTS:case a.PERMISSION_DENIED:case a.FAILED_PRECONDITION:case a.ABORTED:case a.OUT_OF_RANGE:case a.UNIMPLEMENTED:case a.DATA_LOSS:return!0;default:return y()}}function _t(t){if(void 0===t)return p(\"GRPC error has no .code\"),a.UNKNOWN;switch(t){case vt.OK:return a.OK;case vt.CANCELLED:return a.CANCELLED;case vt.UNKNOWN:return a.UNKNOWN;case vt.DEADLINE_EXCEEDED:return a.DEADLINE_EXCEEDED;case vt.RESOURCE_EXHAUSTED:return a.RESOURCE_EXHAUSTED;case vt.INTERNAL:return a.INTERNAL;case vt.UNAVAILABLE:return a.UNAVAILABLE;case vt.UNAUTHENTICATED:return a.UNAUTHENTICATED;case vt.INVALID_ARGUMENT:return a.INVALID_ARGUMENT;case vt.NOT_FOUND:return a.NOT_FOUND;case vt.ALREADY_EXISTS:return a.ALREADY_EXISTS;case vt.PERMISSION_DENIED:return a.PERMISSION_DENIED;case vt.FAILED_PRECONDITION:return a.FAILED_PRECONDITION;case vt.ABORTED:return a.ABORTED;case vt.OUT_OF_RANGE:return a.OUT_OF_RANGE;case vt.UNIMPLEMENTED:return a.UNIMPLEMENTED;case vt.DATA_LOSS:return a.DATA_LOSS;default:return y()}}(yt=vt||(vt={}))[yt.OK=0]=\"OK\",yt[yt.CANCELLED=1]=\"CANCELLED\",yt[yt.UNKNOWN=2]=\"UNKNOWN\",yt[yt.INVALID_ARGUMENT=3]=\"INVALID_ARGUMENT\",yt[yt.DEADLINE_EXCEEDED=4]=\"DEADLINE_EXCEEDED\",yt[yt.NOT_FOUND=5]=\"NOT_FOUND\",yt[yt.ALREADY_EXISTS=6]=\"ALREADY_EXISTS\",yt[yt.PERMISSION_DENIED=7]=\"PERMISSION_DENIED\",yt[yt.UNAUTHENTICATED=16]=\"UNAUTHENTICATED\",yt[yt.RESOURCE_EXHAUSTED=8]=\"RESOURCE_EXHAUSTED\",yt[yt.FAILED_PRECONDITION=9]=\"FAILED_PRECONDITION\",yt[yt.ABORTED=10]=\"ABORTED\",yt[yt.OUT_OF_RANGE=11]=\"OUT_OF_RANGE\",yt[yt.UNIMPLEMENTED=12]=\"UNIMPLEMENTED\",yt[yt.INTERNAL=13]=\"INTERNAL\",yt[yt.UNAVAILABLE=14]=\"UNAVAILABLE\",yt[yt.DATA_LOSS=15]=\"DATA_LOSS\";var bt=function(){function t(t,e){this.i=t,this.root=e||Et.EMPTY}return t.prototype.rt=function(e,n){return new t(this.i,this.root.rt(e,n,this.i).copy(null,null,Et.ot,null,null))},t.prototype.remove=function(e){return new t(this.i,this.root.remove(e,this.i).copy(null,null,Et.ot,null,null))},t.prototype.get=function(t){for(var e=this.root;!e.m();){var n=this.i(t,e.key);if(0===n)return e.value;n<0?e=e.left:n>0&&(e=e.right)}return null},t.prototype.indexOf=function(t){for(var e=0,n=this.root;!n.m();){var r=this.i(t,n.key);if(0===r)return e+n.left.size;r<0?n=n.left:(e+=n.left.size+1,n=n.right)}return-1},t.prototype.m=function(){return this.root.m()},Object.defineProperty(t.prototype,\"size\",{get:function(){return this.root.size},enumerable:!1,configurable:!0}),t.prototype.at=function(){return this.root.at()},t.prototype.ct=function(){return this.root.ct()},t.prototype.ut=function(t){return this.root.ut(t)},t.prototype.forEach=function(t){this.ut((function(e,n){return t(e,n),!1}))},t.prototype.toString=function(){var t=[];return this.ut((function(e,n){return t.push(e+\":\"+n),!1})),\"{\"+t.join(\", \")+\"}\"},t.prototype.ht=function(t){return this.root.ht(t)},t.prototype.lt=function(){return new It(this.root,null,this.i,!1)},t.prototype._t=function(t){return new It(this.root,t,this.i,!1)},t.prototype.ft=function(){return new It(this.root,null,this.i,!0)},t.prototype.dt=function(t){return new It(this.root,t,this.i,!0)},t}(),It=function(){function t(t,e,n,r){this.wt=r,this.Tt=[];for(var i=1;!t.m();)if(i=e?n(t.key,e):1,r&&(i*=-1),i<0)t=this.wt?t.left:t.right;else{if(0===i){this.Tt.push(t);break}this.Tt.push(t),t=this.wt?t.right:t.left}}return t.prototype.Et=function(){var t=this.Tt.pop(),e={key:t.key,value:t.value};if(this.wt)for(t=t.left;!t.m();)this.Tt.push(t),t=t.right;else for(t=t.right;!t.m();)this.Tt.push(t),t=t.left;return e},t.prototype.It=function(){return this.Tt.length>0},t.prototype.At=function(){if(0===this.Tt.length)return null;var t=this.Tt[this.Tt.length-1];return{key:t.key,value:t.value}},t}(),Et=function(){function t(e,n,r,i,o){this.key=e,this.value=n,this.color=null!=r?r:t.RED,this.left=null!=i?i:t.EMPTY,this.right=null!=o?o:t.EMPTY,this.size=this.left.size+1+this.right.size}return t.prototype.copy=function(e,n,r,i,o){return new t(null!=e?e:this.key,null!=n?n:this.value,null!=r?r:this.color,null!=i?i:this.left,null!=o?o:this.right)},t.prototype.m=function(){return!1},t.prototype.ut=function(t){return this.left.ut(t)||t(this.key,this.value)||this.right.ut(t)},t.prototype.ht=function(t){return this.right.ht(t)||t(this.key,this.value)||this.left.ht(t)},t.prototype.min=function(){return this.left.m()?this:this.left.min()},t.prototype.at=function(){return this.min().key},t.prototype.ct=function(){return this.right.m()?this.key:this.right.ct()},t.prototype.rt=function(t,e,n){var r=this,i=n(t,r.key);return(r=i<0?r.copy(null,null,null,r.left.rt(t,e,n),null):0===i?r.copy(null,e,null,null,null):r.copy(null,null,null,null,r.right.rt(t,e,n))).Rt()},t.prototype.Pt=function(){if(this.left.m())return t.EMPTY;var e=this;return e.left.gt()||e.left.left.gt()||(e=e.yt()),(e=e.copy(null,null,null,e.left.Pt(),null)).Rt()},t.prototype.remove=function(e,n){var r,i=this;if(n(e,i.key)<0)i.left.m()||i.left.gt()||i.left.left.gt()||(i=i.yt()),i=i.copy(null,null,null,i.left.remove(e,n),null);else{if(i.left.gt()&&(i=i.Vt()),i.right.m()||i.right.gt()||i.right.left.gt()||(i=i.bt()),0===n(e,i.key)){if(i.right.m())return t.EMPTY;r=i.right.min(),i=i.copy(r.key,r.value,null,null,i.right.Pt())}i=i.copy(null,null,null,null,i.right.remove(e,n))}return i.Rt()},t.prototype.gt=function(){return this.color},t.prototype.Rt=function(){var t=this;return t.right.gt()&&!t.left.gt()&&(t=t.vt()),t.left.gt()&&t.left.left.gt()&&(t=t.Vt()),t.left.gt()&&t.right.gt()&&(t=t.St()),t},t.prototype.yt=function(){var t=this.St();return t.right.left.gt()&&(t=(t=(t=t.copy(null,null,null,null,t.right.Vt())).vt()).St()),t},t.prototype.bt=function(){var t=this.St();return t.left.left.gt()&&(t=(t=t.Vt()).St()),t},t.prototype.vt=function(){var e=this.copy(null,null,t.RED,null,this.right.left);return this.right.copy(null,null,this.color,e,null)},t.prototype.Vt=function(){var e=this.copy(null,null,t.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,e)},t.prototype.St=function(){var t=this.left.copy(null,null,!this.left.color,null,null),e=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,t,e)},t.prototype.Dt=function(){var t=this.Ct();return Math.pow(2,t)<=this.size+1},t.prototype.Ct=function(){if(this.gt()&&this.left.gt())throw y();if(this.right.gt())throw y();var t=this.left.Ct();if(t!==this.right.Ct())throw y();return t+(this.gt()?0:1)},t}();Et.EMPTY=null,Et.RED=!0,Et.ot=!1,Et.EMPTY=new(function(){function t(){this.size=0}return Object.defineProperty(t.prototype,\"key\",{get:function(){throw y()},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,\"value\",{get:function(){throw y()},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,\"color\",{get:function(){throw y()},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,\"left\",{get:function(){throw y()},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,\"right\",{get:function(){throw y()},enumerable:!1,configurable:!0}),t.prototype.copy=function(t,e,n,r,i){return this},t.prototype.rt=function(t,e,n){return new Et(t,e)},t.prototype.remove=function(t,e){return this},t.prototype.m=function(){return!0},t.prototype.ut=function(t){return!1},t.prototype.ht=function(t){return!1},t.prototype.at=function(){return null},t.prototype.ct=function(){return null},t.prototype.gt=function(){return!1},t.prototype.Dt=function(){return!0},t.prototype.Ct=function(){return 0},t}());var Tt=function(){function t(t){this.i=t,this.data=new bt(this.i)}return t.prototype.has=function(t){return null!==this.data.get(t)},t.prototype.first=function(){return this.data.at()},t.prototype.last=function(){return this.data.ct()},Object.defineProperty(t.prototype,\"size\",{get:function(){return this.data.size},enumerable:!1,configurable:!0}),t.prototype.indexOf=function(t){return this.data.indexOf(t)},t.prototype.forEach=function(t){this.data.ut((function(e,n){return t(e),!1}))},t.prototype.Nt=function(t,e){for(var n=this.data._t(t[0]);n.It();){var r=n.Et();if(this.i(r.key,t[1])>=0)return;e(r.key)}},t.prototype.Ft=function(t,e){var n;for(n=void 0!==e?this.data._t(e):this.data.lt();n.It();)if(!t(n.Et().key))return},t.prototype.xt=function(t){var e=this.data._t(t);return e.It()?e.Et().key:null},t.prototype.lt=function(){return new Nt(this.data.lt())},t.prototype._t=function(t){return new Nt(this.data._t(t))},t.prototype.add=function(t){return this.copy(this.data.remove(t).rt(t,!0))},t.prototype.delete=function(t){return this.has(t)?this.copy(this.data.remove(t)):this},t.prototype.m=function(){return this.data.m()},t.prototype.$t=function(t){var e=this;return e.size<t.size&&(e=t,t=this),t.forEach((function(t){e=e.add(t)})),e},t.prototype.isEqual=function(e){if(!(e instanceof t))return!1;if(this.size!==e.size)return!1;for(var n=this.data.lt(),r=e.data.lt();n.It();){var i=n.Et().key,o=r.Et().key;if(0!==this.i(i,o))return!1}return!0},t.prototype.A=function(){var t=[];return this.forEach((function(e){t.push(e)})),t},t.prototype.toString=function(){var t=[];return this.forEach((function(e){return t.push(e)})),\"SortedSet(\"+t.toString()+\")\"},t.prototype.copy=function(e){var n=new t(this.i);return n.data=e,n},t}(),Nt=function(){function t(t){this.kt=t}return t.prototype.Et=function(){return this.kt.Et().key},t.prototype.It=function(){return this.kt.It()},t}(),At=new bt(A.i);function St(){return At}function Dt(){return St()}var xt=new bt(A.i);function kt(){return xt}var Lt=new bt(A.i),Ot=new Tt(A.i);function Rt(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];for(var n=Ot,r=0,i=t;r<i.length;r++){var o=i[r];n=n.add(o)}return n}var Ut=new Tt(Y);function Ct(){return Ut}var Pt=function(){function t(t){this.i=t?function(e,n){return t(e,n)||A.i(e.key,n.key)}:function(t,e){return A.i(t.key,e.key)},this.Mt=kt(),this.Ot=new bt(this.i)}return t.Lt=function(e){return new t(e.i)},t.prototype.has=function(t){return null!=this.Mt.get(t)},t.prototype.get=function(t){return this.Mt.get(t)},t.prototype.first=function(){return this.Ot.at()},t.prototype.last=function(){return this.Ot.ct()},t.prototype.m=function(){return this.Ot.m()},t.prototype.indexOf=function(t){var e=this.Mt.get(t);return e?this.Ot.indexOf(e):-1},Object.defineProperty(t.prototype,\"size\",{get:function(){return this.Ot.size},enumerable:!1,configurable:!0}),t.prototype.forEach=function(t){this.Ot.ut((function(e,n){return t(e),!1}))},t.prototype.add=function(t){var e=this.delete(t.key);return e.copy(e.Mt.rt(t.key,t),e.Ot.rt(t,null))},t.prototype.delete=function(t){var e=this.get(t);return e?this.copy(this.Mt.remove(t),this.Ot.remove(e)):this},t.prototype.isEqual=function(e){if(!(e instanceof t))return!1;if(this.size!==e.size)return!1;for(var n=this.Ot.lt(),r=e.Ot.lt();n.It();){var i=n.Et().key,o=r.Et().key;if(!i.isEqual(o))return!1}return!0},t.prototype.toString=function(){var t=[];return this.forEach((function(e){t.push(e.toString())})),0===t.length?\"DocumentSet ()\":\"DocumentSet (\\n  \"+t.join(\"  \\n\")+\"\\n)\"},t.prototype.copy=function(e,n){var r=new t;return r.i=this.i,r.Mt=e,r.Ot=n,r},t}(),Vt=function(){function t(){this.Bt=new bt(A.i)}return t.prototype.track=function(t){var e=t.doc.key,n=this.Bt.get(e);n?0!==t.type&&3===n.type?this.Bt=this.Bt.rt(e,t):3===t.type&&1!==n.type?this.Bt=this.Bt.rt(e,{type:n.type,doc:t.doc}):2===t.type&&2===n.type?this.Bt=this.Bt.rt(e,{type:2,doc:t.doc}):2===t.type&&0===n.type?this.Bt=this.Bt.rt(e,{type:0,doc:t.doc}):1===t.type&&0===n.type?this.Bt=this.Bt.remove(e):1===t.type&&2===n.type?this.Bt=this.Bt.rt(e,{type:1,doc:n.doc}):0===t.type&&1===n.type?this.Bt=this.Bt.rt(e,{type:2,doc:t.doc}):y():this.Bt=this.Bt.rt(e,t)},t.prototype.qt=function(){var t=[];return this.Bt.ut((function(e,n){t.push(n)})),t},t}(),Mt=function(){function t(t,e,n,r,i,o,s,u){this.query=t,this.docs=e,this.Ut=n,this.docChanges=r,this.Qt=i,this.fromCache=o,this.Wt=s,this.jt=u}return t.Kt=function(e,n,r,i){var o=[];return n.forEach((function(t){o.push({type:0,doc:t})})),new t(e,n,Pt.Lt(n),o,r,i,!0,!1)},Object.defineProperty(t.prototype,\"hasPendingWrites\",{get:function(){return!this.Qt.m()},enumerable:!1,configurable:!0}),t.prototype.isEqual=function(t){if(!(this.fromCache===t.fromCache&&this.Wt===t.Wt&&this.Qt.isEqual(t.Qt)&&jn(this.query,t.query)&&this.docs.isEqual(t.docs)&&this.Ut.isEqual(t.Ut)))return!1;var e=this.docChanges,n=t.docChanges;if(e.length!==n.length)return!1;for(var r=0;r<e.length;r++)if(e[r].type!==n[r].type||!e[r].doc.isEqual(n[r].doc))return!1;return!0},t}(),Ft=function(){function t(t,e,n,r,i){this.et=t,this.Gt=e,this.zt=n,this.Ht=r,this.Yt=i}return t.Jt=function(e,n){var r=new Map;return r.set(e,qt.Xt(e,n)),new t(st.min(),r,Ct(),St(),Rt())},t}(),qt=function(){function t(t,e,n,r,i){this.resumeToken=t,this.Zt=e,this.te=n,this.ee=r,this.ne=i}return t.Xt=function(e,n){return new t(X.B,n,Rt(),Rt(),Rt())},t}(),Gt=function(t,e,n,r){this.se=t,this.removedTargetIds=e,this.key=n,this.ie=r},Bt=function(t,e){this.targetId=t,this.re=e},jt=function(t,e,n,r){void 0===n&&(n=X.B),void 0===r&&(r=null),this.state=t,this.targetIds=e,this.resumeToken=n,this.cause=r},zt=function(){function t(){this.oe=0,this.ae=Kt(),this.ce=X.B,this.ue=!1,this.he=!0}return Object.defineProperty(t.prototype,\"Zt\",{get:function(){return this.ue},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,\"resumeToken\",{get:function(){return this.ce},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,\"le\",{get:function(){return 0!==this.oe},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,\"_e\",{get:function(){return this.he},enumerable:!1,configurable:!0}),t.prototype.fe=function(t){t.O()>0&&(this.he=!0,this.ce=t)},t.prototype.de=function(){var t=Rt(),e=Rt(),n=Rt();return this.ae.forEach((function(r,i){switch(i){case 0:t=t.add(r);break;case 2:e=e.add(r);break;case 1:n=n.add(r);break;default:y()}})),new qt(this.ce,this.ue,t,e,n)},t.prototype.we=function(){this.he=!1,this.ae=Kt()},t.prototype.me=function(t,e){this.he=!0,this.ae=this.ae.rt(t,e)},t.prototype.Te=function(t){this.he=!0,this.ae=this.ae.remove(t)},t.prototype.Ee=function(){this.oe+=1},t.prototype.Ie=function(){this.oe-=1},t.prototype.Ae=function(){this.he=!0,this.ue=!0},t}(),Qt=function(){function t(t){this.Re=t,this.Pe=new Map,this.ge=St(),this.ye=Wt(),this.Ve=new Tt(Y)}return t.prototype.pe=function(t){for(var e=0,n=t.se;e<n.length;e++){var r=n[e];t.ie instanceof Sn?this.be(r,t.ie):t.ie instanceof Dn&&this.ve(r,t.key,t.ie)}for(var i=0,o=t.removedTargetIds;i<o.length;i++)this.ve(o[i],t.key,t.ie)},t.prototype.Se=function(t){var e=this;this.De(t,(function(n){var r=e.Ce(n);switch(t.state){case 0:e.Ne(n)&&r.fe(t.resumeToken);break;case 1:r.Ie(),r.le||r.we(),r.fe(t.resumeToken);break;case 2:r.Ie(),r.le||e.removeTarget(n);break;case 3:e.Ne(n)&&(r.Ae(),r.fe(t.resumeToken));break;case 4:e.Ne(n)&&(e.Fe(n),r.fe(t.resumeToken));break;default:y()}}))},t.prototype.De=function(t,e){var n=this;t.targetIds.length>0?t.targetIds.forEach(e):this.Pe.forEach((function(t,r){n.Ne(r)&&e(r)}))},t.prototype.xe=function(t){var e=t.targetId,n=t.re.count,r=this.$e(e);if(r){var i=r.target;if(dt(i))if(0===n){var o=new A(i.path);this.ve(e,o,new Dn(o,st.min()))}else g(1===n);else this.ke(e)!==n&&(this.Fe(e),this.Ve=this.Ve.add(e))}},t.prototype.Me=function(t){var e=this,n=new Map;this.Pe.forEach((function(r,i){var o=e.$e(i);if(o){if(r.Zt&&dt(o.target)){var s=new A(o.target.path);null!==e.ge.get(s)||e.Oe(i,s)||e.ve(i,s,new Dn(s,t))}r._e&&(n.set(i,r.de()),r.we())}}));var r=Rt();this.ye.forEach((function(t,n){var i=!0;n.Ft((function(t){var n=e.$e(t);return!n||2===n.tt||(i=!1,!1)})),i&&(r=r.add(t))}));var i=new Ft(t,n,this.Ve,this.ge,r);return this.ge=St(),this.ye=Wt(),this.Ve=new Tt(Y),i},t.prototype.be=function(t,e){if(this.Ne(t)){var n=this.Oe(t,e.key)?2:0;this.Ce(t).me(e.key,n),this.ge=this.ge.rt(e.key,e),this.ye=this.ye.rt(e.key,this.Le(e.key).add(t))}},t.prototype.ve=function(t,e,n){if(this.Ne(t)){var r=this.Ce(t);this.Oe(t,e)?r.me(e,1):r.Te(e),this.ye=this.ye.rt(e,this.Le(e).delete(t)),n&&(this.ge=this.ge.rt(e,n))}},t.prototype.removeTarget=function(t){this.Pe.delete(t)},t.prototype.ke=function(t){var e=this.Ce(t).de();return this.Re.Be(t).size+e.te.size-e.ne.size},t.prototype.Ee=function(t){this.Ce(t).Ee()},t.prototype.Ce=function(t){var e=this.Pe.get(t);return e||(e=new zt,this.Pe.set(t,e)),e},t.prototype.Le=function(t){var e=this.ye.get(t);return e||(e=new Tt(Y),this.ye=this.ye.rt(t,e)),e},t.prototype.Ne=function(t){var e=null!==this.$e(t);return e||l(\"WatchChangeAggregator\",\"Detected inactive target\",t),e},t.prototype.$e=function(t){var e=this.Pe.get(t);return e&&e.le?null:this.Re.qe(t)},t.prototype.Fe=function(t){var e=this;this.Pe.set(t,new zt),this.Re.Be(t).forEach((function(n){e.ve(t,n,null)}))},t.prototype.Oe=function(t,e){return this.Re.Be(t).has(e)},t}();function Wt(){return new bt(A.i)}function Kt(){return new bt(A.i)}function Yt(t){var e,n;return\"server_timestamp\"===(null===(n=((null===(e=null==t?void 0:t.mapValue)||void 0===e?void 0:e.fields)||{}).__type__)||void 0===n?void 0:n.stringValue)}function Ht(t){var e=re(t.mapValue.fields.__local_write_time__.timestampValue);return new ot(e.seconds,e.nanos)}var $t=new RegExp(/^\\d{4}-\\d\\d-\\d\\dT\\d\\d:\\d\\d:\\d\\d(?:\\.(\\d+))?Z$/);function Xt(t){return\"nullValue\"in t?0:\"booleanValue\"in t?1:\"integerValue\"in t||\"doubleValue\"in t?2:\"timestampValue\"in t?3:\"stringValue\"in t?5:\"bytesValue\"in t?6:\"referenceValue\"in t?7:\"geoPointValue\"in t?8:\"arrayValue\"in t?9:\"mapValue\"in t?Yt(t)?4:10:y()}function Jt(t,e){var n=Xt(t);if(n!==Xt(e))return!1;switch(n){case 0:return!0;case 1:return t.booleanValue===e.booleanValue;case 4:return Ht(t).isEqual(Ht(e));case 3:return function(t,e){if(\"string\"==typeof t.timestampValue&&\"string\"==typeof e.timestampValue&&t.timestampValue.length===e.timestampValue.length)return t.timestampValue===e.timestampValue;var n=re(t.timestampValue),r=re(e.timestampValue);return n.seconds===r.seconds&&n.nanos===r.nanos}(t,e);case 5:return t.stringValue===e.stringValue;case 6:return function(t,e){return oe(t.bytesValue).isEqual(oe(e.bytesValue))}(t,e);case 7:return t.referenceValue===e.referenceValue;case 8:return function(t,e){return ie(t.geoPointValue.latitude)===ie(e.geoPointValue.latitude)&&ie(t.geoPointValue.longitude)===ie(e.geoPointValue.longitude)}(t,e);case 2:return function(t,e){if(\"integerValue\"in t&&\"integerValue\"in e)return ie(t.integerValue)===ie(e.integerValue);if(\"doubleValue\"in t&&\"doubleValue\"in e){var n=ie(t.doubleValue),r=ie(e.doubleValue);return n===r?at(n)===at(r):isNaN(n)&&isNaN(r)}return!1}(t,e);case 9:return H(t.arrayValue.values||[],e.arrayValue.values||[],Jt);case 10:return function(t,e){var n=t.mapValue.fields||{},r=e.mapValue.fields||{};if(w(n)!==w(r))return!1;for(var i in n)if(n.hasOwnProperty(i)&&(void 0===r[i]||!Jt(n[i],r[i])))return!1;return!0}(t,e);default:return y()}}function Zt(t,e){return void 0!==(t.values||[]).find((function(t){return Jt(t,e)}))}function te(t,e){var n=Xt(t),r=Xt(e);if(n!==r)return Y(n,r);switch(n){case 0:return 0;case 1:return Y(t.booleanValue,e.booleanValue);case 2:return function(t,e){var n=ie(t.integerValue||t.doubleValue),r=ie(e.integerValue||e.doubleValue);return n<r?-1:n>r?1:n===r?0:isNaN(n)?isNaN(r)?0:-1:1}(t,e);case 3:return ee(t.timestampValue,e.timestampValue);case 4:return ee(Ht(t),Ht(e));case 5:return Y(t.stringValue,e.stringValue);case 6:return function(t,e){var n=oe(t),r=oe(e);return n.L(r)}(t.bytesValue,e.bytesValue);case 7:return function(t,e){for(var n=t.split(\"/\"),r=e.split(\"/\"),i=0;i<n.length&&i<r.length;i++){var o=Y(n[i],r[i]);if(0!==o)return o}return Y(n.length,r.length)}(t.referenceValue,e.referenceValue);case 8:return function(t,e){var n=Y(ie(t.latitude),ie(e.latitude));return 0!==n?n:Y(ie(t.longitude),ie(e.longitude))}(t.geoPointValue,e.geoPointValue);case 9:return function(t,e){for(var n=t.values||[],r=e.values||[],i=0;i<n.length&&i<r.length;++i){var o=te(n[i],r[i]);if(o)return o}return Y(n.length,r.length)}(t.arrayValue,e.arrayValue);case 10:return function(t,e){var n=t.fields||{},r=Object.keys(n),i=e.fields||{},o=Object.keys(i);r.sort(),o.sort();for(var s=0;s<r.length&&s<o.length;++s){var u=Y(r[s],o[s]);if(0!==u)return u;var a=te(n[r[s]],i[o[s]]);if(0!==a)return a}return Y(r.length,o.length)}(t.mapValue,e.mapValue);default:throw y()}}function ee(t,e){if(\"string\"==typeof t&&\"string\"==typeof e&&t.length===e.length)return Y(t,e);var n=re(t),r=re(e),i=Y(n.seconds,r.seconds);return 0!==i?i:Y(n.nanos,r.nanos)}function ne(t){return function t(e){return\"nullValue\"in e?\"null\":\"booleanValue\"in e?\"\"+e.booleanValue:\"integerValue\"in e?\"\"+e.integerValue:\"doubleValue\"in e?\"\"+e.doubleValue:\"timestampValue\"in e?function(t){var e=re(t);return\"time(\"+e.seconds+\",\"+e.nanos+\")\"}(e.timestampValue):\"stringValue\"in e?e.stringValue:\"bytesValue\"in e?oe(e.bytesValue).toBase64():\"referenceValue\"in e?A.C(e.referenceValue).toString():\"geoPointValue\"in e?\"geo(\"+(n=e.geoPointValue).latitude+\",\"+n.longitude+\")\":\"arrayValue\"in e?function(e){for(var n=\"[\",r=!0,i=0,o=e.values||[];i<o.length;i++)r?r=!1:n+=\",\",n+=t(o[i]);return n+\"]\"}(e.arrayValue):\"mapValue\"in e?function(e){for(var n=\"{\",r=!0,i=0,o=Object.keys(e.fields||{}).sort();i<o.length;i++){var s=o[i];r?r=!1:n+=\",\",n+=s+\":\"+t(e.fields[s])}return n+\"}\"}(e.mapValue):y();var n}(t)}function re(t){if(g(!!t),\"string\"==typeof t){var e=0,n=$t.exec(t);if(g(!!n),n[1]){var r=n[1];r=(r+\"000000000\").substr(0,9),e=Number(r)}var i=new Date(t);return{seconds:Math.floor(i.getTime()/1e3),nanos:e}}return{seconds:ie(t.seconds),nanos:ie(t.nanos)}}function ie(t){return\"number\"==typeof t?t:\"string\"==typeof t?Number(t):0}function oe(t){return\"string\"==typeof t?X.fromBase64String(t):X.fromUint8Array(t)}function se(t,e){return{referenceValue:\"projects/\"+t.projectId+\"/databases/\"+t.database+\"/documents/\"+e.path.R()}}function ue(t){return!!t&&\"integerValue\"in t}function ae(t){return!!t&&\"arrayValue\"in t}function ce(t){return!!t&&\"nullValue\"in t}function he(t){return!!t&&\"doubleValue\"in t&&isNaN(Number(t.doubleValue))}function fe(t){return!!t&&\"mapValue\"in t}var le={asc:\"ASCENDING\",desc:\"DESCENDING\"},pe={\"<\":\"LESS_THAN\",\"<=\":\"LESS_THAN_OR_EQUAL\",\">\":\"GREATER_THAN\",\">=\":\"GREATER_THAN_OR_EQUAL\",\"==\":\"EQUAL\",\"!=\":\"NOT_EQUAL\",\"array-contains\":\"ARRAY_CONTAINS\",in:\"IN\",\"not-in\":\"NOT_IN\",\"array-contains-any\":\"ARRAY_CONTAINS_ANY\"},de=function(t,e){this.U=t,this.Ue=e};function ve(t){return{integerValue:\"\"+t}}function ye(t,e){if(t.Ue){if(isNaN(e))return{doubleValue:\"NaN\"};if(e===1/0)return{doubleValue:\"Infinity\"};if(e===-1/0)return{doubleValue:\"-Infinity\"}}return{doubleValue:at(e)?\"-0\":e}}function ge(t,e){return ct(e)?ve(e):ye(t,e)}function me(t,e){return t.Ue?new Date(1e3*e.seconds).toISOString().replace(/\\.\\d*/,\"\").replace(\"Z\",\"\")+\".\"+(\"000000000\"+e.nanoseconds).slice(-9)+\"Z\":{seconds:\"\"+e.seconds,nanos:e.nanoseconds}}function we(t,e){return t.Ue?e.toBase64():e.toUint8Array()}function _e(t,e){return me(t,e.X())}function be(t){return g(!!t),st.Y(function(t){var e=re(t);return new ot(e.seconds,e.nanos)}(t))}function Ie(t,e){return function(t){return new E([\"projects\",t.projectId,\"databases\",t.database])}(t).child(\"documents\").child(e).R()}function Ee(t){var e=E.P(t);return g(ze(e)),e}function Te(t,e){return Ie(t.U,e.path)}function Ne(t,e){var n=Ee(e);return g(n.get(1)===t.U.projectId),g(!n.get(3)&&!t.U.database||n.get(3)===t.U.database),new A(xe(n))}function Ae(t,e){return Ie(t.U,e)}function Se(t){var e=Ee(t);return 4===e.length?E.g():xe(e)}function De(t){return new E([\"projects\",t.U.projectId,\"databases\",t.U.database]).R()}function xe(t){return g(t.length>4&&\"documents\"===t.get(4)),t.u(5)}function ke(t,e,n){return{name:Te(t,e),fields:n.proto.mapValue.fields}}function Le(t,e){var n;if(e instanceof vn)n={update:ke(t,e.key,e.value)};else if(e instanceof bn)n={delete:Te(t,e.key)};else if(e instanceof yn)n={update:ke(t,e.key,e.data),updateMask:je(e.Qe)};else if(e instanceof mn)n={transform:{document:Te(t,e.key),fieldTransforms:e.fieldTransforms.map((function(t){return function(t,e){var n=e.transform;if(n instanceof He)return{fieldPath:e.field.R(),setToServerValue:\"REQUEST_TIME\"};if(n instanceof $e)return{fieldPath:e.field.R(),appendMissingElements:{values:n.elements}};if(n instanceof Je)return{fieldPath:e.field.R(),removeAllFromArray:{values:n.elements}};if(n instanceof tn)return{fieldPath:e.field.R(),increment:n.We};throw y()}(0,t)}))}};else{if(!(e instanceof In))return y();n={verify:Te(t,e.key)}}return e.Ke.je||(n.currentDocument=function(t,e){return void 0!==e.updateTime?{updateTime:_e(t,e.updateTime)}:void 0!==e.exists?{exists:e.exists}:y()}(t,e.Ke)),n}function Oe(t,e){var n=e.currentDocument?function(t){return void 0!==t.updateTime?un.updateTime(be(t.updateTime)):void 0!==t.exists?un.exists(t.exists):un.Ge()}(e.currentDocument):un.Ge();if(e.update){var r=Ne(t,e.update.name),i=new En({mapValue:{fields:e.update.fields}});if(e.updateMask){var o=function(t){return new rn((t.fieldPaths||[]).map((function(t){return N.S(t)})))}(e.updateMask);return new yn(r,i,o,n)}return new vn(r,i,n)}if(e.delete){var s=Ne(t,e.delete);return new bn(s,n)}if(e.transform){var u=Ne(t,e.transform.document),a=e.transform.fieldTransforms.map((function(e){return function(t,e){var n=null;\"setToServerValue\"in e?(g(\"REQUEST_TIME\"===e.setToServerValue),n=new He):\"appendMissingElements\"in e?n=new $e(e.appendMissingElements.values||[]):\"removeAllFromArray\"in e?n=new Je(e.removeAllFromArray.values||[]):\"increment\"in e?n=new tn(t,e.increment):y();var o=N.S(e.fieldPath);return new on(o,n)}(t,e)}));return g(!0===n.exists),new mn(u,a)}if(e.verify){var c=Ne(t,e.verify);return new In(c,n)}return y()}function Re(t,e){return{documents:[Ae(t,e.path)]}}function Ue(t,e){var n={structuredQuery:{}},r=e.path;null!==e.collectionGroup?(n.parent=Ae(t,r),n.structuredQuery.from=[{collectionId:e.collectionGroup,allDescendants:!0}]):(n.parent=Ae(t,r.h()),n.structuredQuery.from=[{collectionId:r._()}]);var i=function(t){if(0!==t.length){var e=t.map((function(t){return function(t){if(\"==\"===t.op){if(he(t.value))return{unaryFilter:{field:Fe(t.field),op:\"IS_NAN\"}};if(ce(t.value))return{unaryFilter:{field:Fe(t.field),op:\"IS_NULL\"}}}else if(\"!=\"===t.op){if(he(t.value))return{unaryFilter:{field:Fe(t.field),op:\"IS_NOT_NAN\"}};if(ce(t.value))return{unaryFilter:{field:Fe(t.field),op:\"IS_NOT_NULL\"}}}return{fieldFilter:{field:Fe(t.field),op:Me(t.op),value:t.value}}}(t)}));return 1===e.length?e[0]:{compositeFilter:{op:\"AND\",filters:e}}}}(e.filters);i&&(n.structuredQuery.where=i);var o=function(t){if(0!==t.length)return t.map((function(t){return function(t){return{field:Fe(t.field),direction:Ve(t.dir)}}(t)}))}(e.orderBy);o&&(n.structuredQuery.orderBy=o);var s=function(t,e){return t.Ue||ut(e)?e:{value:e}}(t,e.limit);return null!==s&&(n.structuredQuery.limit=s),e.startAt&&(n.structuredQuery.startAt=Ce(e.startAt)),e.endAt&&(n.structuredQuery.endAt=Ce(e.endAt)),n}function Ce(t){return{before:t.before,values:t.position}}function Pe(t){return new rr(t.values||[],!!t.before)}function Ve(t){return le[t]}function Me(t){return pe[t]}function Fe(t){return{fieldPath:t.R()}}function qe(t){return N.S(t.fieldPath)}function Ge(t){return Yn.create(qe(t.fieldFilter.field),function(t){switch(t){case\"EQUAL\":return\"==\";case\"NOT_EQUAL\":return\"!=\";case\"GREATER_THAN\":return\">\";case\"GREATER_THAN_OR_EQUAL\":return\">=\";case\"LESS_THAN\":return\"<\";case\"LESS_THAN_OR_EQUAL\":return\"<=\";case\"ARRAY_CONTAINS\":return\"array-contains\";case\"IN\":return\"in\";case\"NOT_IN\":return\"not-in\";case\"ARRAY_CONTAINS_ANY\":return\"array-contains-any\";case\"OPERATOR_UNSPECIFIED\":default:return y()}}(t.fieldFilter.op),t.fieldFilter.value)}function Be(t){switch(t.unaryFilter.op){case\"IS_NAN\":var e=qe(t.unaryFilter.field);return Yn.create(e,\"==\",{doubleValue:NaN});case\"IS_NULL\":var n=qe(t.unaryFilter.field);return Yn.create(n,\"==\",{nullValue:\"NULL_VALUE\"});case\"IS_NOT_NAN\":var r=qe(t.unaryFilter.field);return Yn.create(r,\"!=\",{doubleValue:NaN});case\"IS_NOT_NULL\":var i=qe(t.unaryFilter.field);return Yn.create(i,\"!=\",{nullValue:\"NULL_VALUE\"});case\"OPERATOR_UNSPECIFIED\":default:return y()}}function je(t){var e=[];return t.fields.forEach((function(t){return e.push(t.R())})),{fieldPaths:e}}function ze(t){return t.length>=4&&\"projects\"===t.get(0)&&\"databases\"===t.get(2)}var Qe=function(){this.ze=void 0};function We(t,e,n){return t instanceof He?function(t,e){var n={fields:{__type__:{stringValue:\"server_timestamp\"},__local_write_time__:{timestampValue:{seconds:t.seconds,nanos:t.nanoseconds}}}};return e&&(n.fields.__previous_value__=e),{mapValue:n}}(n,e):t instanceof $e?Xe(t,e):t instanceof Je?Ze(t,e):function(t,e){var n=Ye(t,e),r=en(n)+en(t.We);return ue(n)&&ue(t.We)?ve(r):ye(t.serializer,r)}(t,e)}function Ke(t,e,n){return t instanceof $e?Xe(t,e):t instanceof Je?Ze(t,e):n}function Ye(t,e){return t instanceof tn?ue(n=e)||function(t){return!!t&&\"doubleValue\"in t}(n)?e:{integerValue:0}:null;var n}var He=function(e){function n(){return null!==e&&e.apply(this,arguments)||this}return t.__extends(n,e),n}(Qe),$e=function(e){function n(t){var n=this;return(n=e.call(this)||this).elements=t,n}return t.__extends(n,e),n}(Qe);function Xe(t,e){for(var n=nn(e),r=function(t){n.some((function(e){return Jt(e,t)}))||n.push(t)},i=0,o=t.elements;i<o.length;i++)r(o[i]);return{arrayValue:{values:n}}}var Je=function(e){function n(t){var n=this;return(n=e.call(this)||this).elements=t,n}return t.__extends(n,e),n}(Qe);function Ze(t,e){for(var n=nn(e),r=function(t){n=n.filter((function(e){return!Jt(e,t)}))},i=0,o=t.elements;i<o.length;i++)r(o[i]);return{arrayValue:{values:n}}}var tn=function(e){function n(t,n){var r=this;return(r=e.call(this)||this).serializer=t,r.We=n,r}return t.__extends(n,e),n}(Qe);function en(t){return ie(t.integerValue||t.doubleValue)}function nn(t){return ae(t)&&t.arrayValue.values?t.arrayValue.values.slice():[]}var rn=function(){function t(t){this.fields=t,t.sort(N.i)}return t.prototype.He=function(t){for(var e=0,n=this.fields;e<n.length;e++)if(n[e].T(t))return!0;return!1},t.prototype.isEqual=function(t){return H(this.fields,t.fields,(function(t,e){return t.isEqual(e)}))},t}(),on=function(t,e){this.field=t,this.transform=e},sn=function(t,e){this.version=t,this.transformResults=e},un=function(){function t(t,e){this.updateTime=t,this.exists=e}return t.Ge=function(){return new t},t.exists=function(e){return new t(void 0,e)},t.updateTime=function(e){return new t(e)},Object.defineProperty(t.prototype,\"je\",{get:function(){return void 0===this.updateTime&&void 0===this.exists},enumerable:!1,configurable:!0}),t.prototype.isEqual=function(t){return this.exists===t.exists&&(this.updateTime?!!t.updateTime&&this.updateTime.isEqual(t.updateTime):!t.updateTime)},t}();function an(t,e){return void 0!==t.updateTime?e instanceof Sn&&e.version.isEqual(t.updateTime):void 0===t.exists||t.exists===e instanceof Sn}var cn=function(){};function hn(t,e,n){return t instanceof vn?function(t,e,n){return new Sn(t.key,n.version,t.value,{hasCommittedMutations:!0})}(t,0,n):t instanceof yn?function(t,e,n){if(!an(t.Ke,e))return new xn(t.key,n.version);var r=gn(t,e);return new Sn(t.key,n.version,r,{hasCommittedMutations:!0})}(t,e,n):t instanceof mn?function(t,e,n){if(g(null!=n.transformResults),!an(t.Ke,e))return new xn(t.key,n.version);var r=wn(0,e),i=function(t,e,n){var r=[];g(t.length===n.length);for(var i=0;i<n.length;i++){var o=t[i],s=o.transform,u=null;e instanceof Sn&&(u=e.field(o.field)),r.push(Ke(s,u,n[i]))}return r}(t.fieldTransforms,e,n.transformResults),o=n.version,s=_n(t,r.data(),i);return new Sn(t.key,o,s,{hasCommittedMutations:!0})}(t,e,n):function(t,e,n){return new Dn(t.key,n.version,{hasCommittedMutations:!0})}(t,0,n)}function fn(t,e,n,r){return t instanceof vn?function(t,e){if(!an(t.Ke,e))return e;var n=dn(e);return new Sn(t.key,n,t.value,{Ye:!0})}(t,e):t instanceof yn?function(t,e){if(!an(t.Ke,e))return e;var n=dn(e),r=gn(t,e);return new Sn(t.key,n,r,{Ye:!0})}(t,e):t instanceof mn?function(t,e,n,r){if(!an(t.Ke,e))return e;var i=wn(0,e),o=function(t,e,n,r){for(var i=[],o=0,s=t;o<s.length;o++){var u=s[o],a=u.transform,c=null;n instanceof Sn&&(c=n.field(u.field)),null===c&&r instanceof Sn&&(c=r.field(u.field)),i.push(We(a,c,e))}return i}(t.fieldTransforms,n,e,r),s=_n(t,i.data(),o);return new Sn(t.key,i.version,s,{Ye:!0})}(t,e,r,n):function(t,e){return an(t.Ke,e)?new Dn(t.key,st.min()):e}(t,e)}function ln(t,e){return t instanceof mn?function(t,e){for(var n=null,r=0,i=t.fieldTransforms;r<i.length;r++){var o=i[r],s=e instanceof Sn?e.field(o.field):void 0,u=Ye(o.transform,s||null);null!=u&&(n=null==n?(new Tn).set(o.field,u):n.set(o.field,u))}return n?n.Je():null}(t,e):null}function pn(t,e){return t.type===e.type&&!!t.key.isEqual(e.key)&&!!t.Ke.isEqual(e.Ke)&&(0===t.type?t.value.isEqual(e.value):1===t.type?t.data.isEqual(e.data)&&t.Qe.isEqual(e.Qe):2!==t.type||H(t.fieldTransforms,t.fieldTransforms,(function(t,e){return function(t,e){return t.field.isEqual(e.field)&&function(t,e){return t instanceof $e&&e instanceof $e||t instanceof Je&&e instanceof Je?H(t.elements,e.elements,Jt):t instanceof tn&&e instanceof tn?Jt(t.We,e.We):t instanceof He&&e instanceof He}(t.transform,e.transform)}(t,e)})))}function dn(t){return t instanceof Sn?t.version:st.min()}var vn=function(e){function n(t,n,r){var i=this;return(i=e.call(this)||this).key=t,i.value=n,i.Ke=r,i.type=0,i}return t.__extends(n,e),n}(cn),yn=function(e){function n(t,n,r,i){var o=this;return(o=e.call(this)||this).key=t,o.data=n,o.Qe=r,o.Ke=i,o.type=1,o}return t.__extends(n,e),n}(cn);function gn(t,e){return function(t,e){var n=new Tn(e);return t.Qe.fields.forEach((function(e){if(!e.m()){var r=t.data.field(e);null!==r?n.set(e,r):n.delete(e)}})),n.Je()}(t,e instanceof Sn?e.data():En.empty())}var mn=function(e){function n(t,n){var r=this;return(r=e.call(this)||this).key=t,r.fieldTransforms=n,r.type=2,r.Ke=un.exists(!0),r}return t.__extends(n,e),n}(cn);function wn(t,e){return e}function _n(t,e,n){for(var r=new Tn(e),i=0;i<t.fieldTransforms.length;i++)r.set(t.fieldTransforms[i].field,n[i]);return r.Je()}var bn=function(e){function n(t,n){var r=this;return(r=e.call(this)||this).key=t,r.Ke=n,r.type=3,r}return t.__extends(n,e),n}(cn),In=function(e){function n(t,n){var r=this;return(r=e.call(this)||this).key=t,r.Ke=n,r.type=4,r}return t.__extends(n,e),n}(cn),En=function(){function t(t){this.proto=t}return t.empty=function(){return new t({mapValue:{}})},t.prototype.field=function(t){if(t.m())return this.proto;for(var e=this.proto,n=0;n<t.length-1;++n){if(!e.mapValue.fields)return null;if(!fe(e=e.mapValue.fields[t.get(n)]))return null}return(e=(e.mapValue.fields||{})[t._()])||null},t.prototype.isEqual=function(t){return Jt(this.proto,t.proto)},t}(),Tn=function(){function t(t){void 0===t&&(t=En.empty()),this.Xe=t,this.Ze=new Map}return t.prototype.set=function(t,e){return this.tn(t,e),this},t.prototype.delete=function(t){return this.tn(t,null),this},t.prototype.tn=function(t,e){for(var n=this.Ze,r=0;r<t.length-1;++r){var i=t.get(r),o=n.get(i);o instanceof Map?n=o:o&&10===Xt(o)?(o=new Map(Object.entries(o.mapValue.fields||{})),n.set(i,o),n=o):(o=new Map,n.set(i,o),n=o)}n.set(t._(),e)},t.prototype.Je=function(){var t=this.en(N.g(),this.Ze);return null!=t?new En(t):this.Xe},t.prototype.en=function(t,e){var n=this,r=!1,i=this.Xe.field(t),o=fe(i)?Object.assign({},i.mapValue.fields):{};return e.forEach((function(e,i){if(e instanceof Map){var s=n.en(t.child(i),e);null!=s&&(o[i]=s,r=!0)}else null!==e?(o[i]=e,r=!0):o.hasOwnProperty(i)&&(delete o[i],r=!0)})),r?{mapValue:{fields:o}}:null},t}();function Nn(t){var e=[];return _(t.fields||{},(function(t,n){var r=new N([t]);if(fe(n)){var i=Nn(n.mapValue).fields;if(0===i.length)e.push(r);else for(var o=0,s=i;o<s.length;o++)e.push(r.child(s[o]))}else e.push(r)})),new rn(e)}var An=function(t,e){this.key=t,this.version=e},Sn=function(e){function n(t,n,r,i){var o=this;return(o=e.call(this,t,n)||this).nn=r,o.Ye=!!i.Ye,o.hasCommittedMutations=!!i.hasCommittedMutations,o}return t.__extends(n,e),n.prototype.field=function(t){return this.nn.field(t)},n.prototype.data=function(){return this.nn},n.prototype.sn=function(){return this.nn.proto},n.prototype.isEqual=function(t){return t instanceof n&&this.key.isEqual(t.key)&&this.version.isEqual(t.version)&&this.Ye===t.Ye&&this.hasCommittedMutations===t.hasCommittedMutations&&this.nn.isEqual(t.nn)},n.prototype.toString=function(){return\"Document(\"+this.key+\", \"+this.version+\", \"+this.nn.toString()+\", {hasLocalMutations: \"+this.Ye+\"}), {hasCommittedMutations: \"+this.hasCommittedMutations+\"})\"},Object.defineProperty(n.prototype,\"hasPendingWrites\",{get:function(){return this.Ye||this.hasCommittedMutations},enumerable:!1,configurable:!0}),n}(An),Dn=function(e){function n(t,n,r){var i=this;return(i=e.call(this,t,n)||this).hasCommittedMutations=!(!r||!r.hasCommittedMutations),i}return t.__extends(n,e),n.prototype.toString=function(){return\"NoDocument(\"+this.key+\", \"+this.version+\")\"},Object.defineProperty(n.prototype,\"hasPendingWrites\",{get:function(){return this.hasCommittedMutations},enumerable:!1,configurable:!0}),n.prototype.isEqual=function(t){return t instanceof n&&t.hasCommittedMutations===this.hasCommittedMutations&&t.version.isEqual(this.version)&&t.key.isEqual(this.key)},n}(An),xn=function(e){function n(){return null!==e&&e.apply(this,arguments)||this}return t.__extends(n,e),n.prototype.toString=function(){return\"UnknownDocument(\"+this.key+\", \"+this.version+\")\"},Object.defineProperty(n.prototype,\"hasPendingWrites\",{get:function(){return!0},enumerable:!1,configurable:!0}),n.prototype.isEqual=function(t){return t instanceof n&&t.version.isEqual(this.version)&&t.key.isEqual(this.key)},n}(An),kn=function(t,e,n,r,i,o,s,u){void 0===e&&(e=null),void 0===n&&(n=[]),void 0===r&&(r=[]),void 0===i&&(i=null),void 0===o&&(o=\"F\"),void 0===s&&(s=null),void 0===u&&(u=null),this.path=t,this.collectionGroup=e,this.rn=n,this.filters=r,this.limit=i,this.on=o,this.startAt=s,this.endAt=u,this.an=null,this.cn=null};function Ln(t,e,n,r,i,o,s,u){return new kn(t,e,n,r,i,o,s,u)}function On(t){return new kn(t)}function Rn(t){return!ut(t.limit)&&\"F\"===t.on}function Un(t){return!ut(t.limit)&&\"L\"===t.on}function Cn(t){return t.rn.length>0?t.rn[0].field:null}function Pn(t){for(var e=0,n=t.filters;e<n.length;e++){var r=n[e];if(r.un())return r.field}return null}function Vn(t){return null!==t.collectionGroup}function Mn(t){var e=m(t);if(null===e.an){e.an=[];var n=Pn(e),r=Cn(e);if(null!==n&&null===r)n.p()||e.an.push(new ur(n)),e.an.push(new ur(N.v(),\"asc\"));else{for(var i=!1,o=0,s=e.rn;o<s.length;o++){var u=s[o];e.an.push(u),u.field.p()&&(i=!0)}if(!i){var a=e.rn.length>0?e.rn[e.rn.length-1].dir:\"asc\";e.an.push(new ur(N.v(),a))}}}return e.an}function Fn(t){var e=m(t);if(!e.cn)if(\"F\"===e.on)e.cn=ft(e.path,e.collectionGroup,Mn(e),e.filters,e.limit,e.startAt,e.endAt);else{for(var n=[],r=0,i=Mn(e);r<i.length;r++){var o=i[r];n.push(new ur(o.field,\"desc\"===o.dir?\"asc\":\"desc\"))}var u=e.endAt?new rr(e.endAt.position,!e.endAt.before):null,a=e.startAt?new rr(e.startAt.position,!e.startAt.before):null;e.cn=ft(e.path,e.collectionGroup,n,e.filters,e.limit,u,a)}return e.cn}function qn(t,e,n){return new kn(t.path,t.collectionGroup,t.rn.slice(),t.filters.slice(),e,n,t.startAt,t.endAt)}function Gn(t,e){return new kn(t.path,t.collectionGroup,t.rn.slice(),t.filters.slice(),t.limit,t.on,e,t.endAt)}function Bn(t,e){return new kn(t.path,t.collectionGroup,t.rn.slice(),t.filters.slice(),t.limit,t.on,t.startAt,e)}function jn(t,e){return pt(Fn(t),Fn(e))&&t.on===e.on}function zn(t){return lt(Fn(t))+\"|lt:\"+t.on}function Qn(t){return\"Query(target=\"+function(t){var e=t.path.R();return null!==t.collectionGroup&&(e+=\" collectionGroup=\"+t.collectionGroup),t.filters.length>0&&(e+=\", filters: [\"+t.filters.map((function(t){return(e=t).field.R()+\" \"+e.op+\" \"+ne(e.value);var e})).join(\", \")+\"]\"),ut(t.limit)||(e+=\", limit: \"+t.limit),t.orderBy.length>0&&(e+=\", orderBy: [\"+t.orderBy.map((function(t){return(e=t).field.R()+\" (\"+e.dir+\")\";var e})).join(\", \")+\"]\"),t.startAt&&(e+=\", startAt: \"+ir(t.startAt)),t.endAt&&(e+=\", endAt: \"+ir(t.endAt)),\"Target(\"+e+\")\"}(Fn(t))+\"; limitType=\"+t.on+\")\"}function Wn(t,e){return function(t,e){var n=e.key.path;return null!==t.collectionGroup?e.key.N(t.collectionGroup)&&t.path.T(n):A.F(t.path)?t.path.isEqual(n):t.path.I(n)}(t,e)&&function(t,e){for(var n=0,r=t.rn;n<r.length;n++){var i=r[n];if(!i.field.p()&&null===e.field(i.field))return!1}return!0}(t,e)&&function(t,e){for(var n=0,r=t.filters;n<r.length;n++)if(!r[n].matches(e))return!1;return!0}(t,e)&&function(t,e){return!(t.startAt&&!or(t.startAt,Mn(t),e)||t.endAt&&or(t.endAt,Mn(t),e))}(t,e)}function Kn(t){return function(e,n){for(var r=!1,i=0,o=Mn(t);i<o.length;i++){var s=o[i],u=ar(s,e,n);if(0!==u)return u;r=r||s.field.p()}return 0}}var Yn=function(e){function n(t,n,r){var i=this;return(i=e.call(this)||this).field=t,i.op=n,i.value=r,i}return t.__extends(n,e),n.create=function(t,e,r){if(t.p())return\"in\"===e||\"not-in\"===e?this.hn(t,e,r):new Hn(t,e,r);if(ce(r)){if(\"==\"!==e&&\"!=\"!==e)throw new c(a.INVALID_ARGUMENT,\"Invalid query. Null only supports '==' and '!=' comparisons.\");return new n(t,e,r)}if(he(r)){if(\"==\"!==e&&\"!=\"!==e)throw new c(a.INVALID_ARGUMENT,\"Invalid query. NaN only supports '==' and '!=' comparisons.\");return new n(t,e,r)}return\"array-contains\"===e?new Zn(t,r):\"in\"===e?new tr(t,r):\"not-in\"===e?new er(t,r):\"array-contains-any\"===e?new nr(t,r):new n(t,e,r)},n.hn=function(t,e,n){return\"in\"===e?new $n(t,n):new Xn(t,n)},n.prototype.matches=function(t){var e=t.field(this.field);return\"!=\"===this.op?null!==e&&this.ln(te(e,this.value)):null!==e&&Xt(this.value)===Xt(e)&&this.ln(te(e,this.value))},n.prototype.ln=function(t){switch(this.op){case\"<\":return t<0;case\"<=\":return t<=0;case\"==\":return 0===t;case\"!=\":return 0!==t;case\">\":return t>0;case\">=\":return t>=0;default:return y()}},n.prototype.un=function(){return[\"<\",\"<=\",\">\",\">=\",\"!=\",\"not-in\"].indexOf(this.op)>=0},n}((function(){})),Hn=function(e){function n(t,n,r){var i=this;return(i=e.call(this,t,n,r)||this).key=A.C(r.referenceValue),i}return t.__extends(n,e),n.prototype.matches=function(t){var e=A.i(t.key,this.key);return this.ln(e)},n}(Yn),$n=function(e){function n(t,n){var r=this;return(r=e.call(this,t,\"in\",n)||this).keys=Jn(0,n),r}return t.__extends(n,e),n.prototype.matches=function(t){return this.keys.some((function(e){return e.isEqual(t.key)}))},n}(Yn),Xn=function(e){function n(t,n){var r=this;return(r=e.call(this,t,\"not-in\",n)||this).keys=Jn(0,n),r}return t.__extends(n,e),n.prototype.matches=function(t){return!this.keys.some((function(e){return e.isEqual(t.key)}))},n}(Yn);function Jn(t,e){var n;return((null===(n=e.arrayValue)||void 0===n?void 0:n.values)||[]).map((function(t){return A.C(t.referenceValue)}))}var Zn=function(e){function n(t,n){return e.call(this,t,\"array-contains\",n)||this}return t.__extends(n,e),n.prototype.matches=function(t){var e=t.field(this.field);return ae(e)&&Zt(e.arrayValue,this.value)},n}(Yn),tr=function(e){function n(t,n){return e.call(this,t,\"in\",n)||this}return t.__extends(n,e),n.prototype.matches=function(t){var e=t.field(this.field);return null!==e&&Zt(this.value.arrayValue,e)},n}(Yn),er=function(e){function n(t,n){return e.call(this,t,\"not-in\",n)||this}return t.__extends(n,e),n.prototype.matches=function(t){if(Zt(this.value.arrayValue,{nullValue:\"NULL_VALUE\"}))return!1;var e=t.field(this.field);return null!==e&&!Zt(this.value.arrayValue,e)},n}(Yn),nr=function(e){function n(t,n){return e.call(this,t,\"array-contains-any\",n)||this}return t.__extends(n,e),n.prototype.matches=function(t){var e=this,n=t.field(this.field);return!(!ae(n)||!n.arrayValue.values)&&n.arrayValue.values.some((function(t){return Zt(e.value.arrayValue,t)}))},n}(Yn),rr=function(t,e){this.position=t,this.before=e};function ir(t){return(t.before?\"b\":\"a\")+\":\"+t.position.map((function(t){return ne(t)})).join(\",\")}function or(t,e,n){for(var r=0,i=0;i<t.position.length;i++){var o=e[i],s=t.position[i];if(r=o.field.p()?A.i(A.C(s.referenceValue),n.key):te(s,n.field(o.field)),\"desc\"===o.dir&&(r*=-1),0!==r)break}return t.before?r<=0:r<0}function sr(t,e){if(null===t)return null===e;if(null===e)return!1;if(t.before!==e.before||t.position.length!==e.position.length)return!1;for(var n=0;n<t.position.length;n++)if(!Jt(t.position[n],e.position[n]))return!1;return!0}var ur=function(t,e){void 0===e&&(e=\"asc\"),this.field=t,this.dir=e};function ar(t,e,n){var r=t.field.p()?A.i(e.key,n.key):function(t,e,n){var r=e.field(t),i=n.field(t);return null!==r&&null!==i?te(r,i):y()}(t.field,e,n);switch(t.dir){case\"asc\":return r;case\"desc\":return-1*r;default:return y()}}function cr(t,e){return t.dir===e.dir&&t.field.isEqual(e.field)}var hr=function(){var t=this;this.promise=new Promise((function(e,n){t.resolve=e,t.reject=n}))},fr=function(){function t(t,e,n,r,i){void 0===n&&(n=1e3),void 0===r&&(r=1.5),void 0===i&&(i=6e4),this._n=t,this.fn=e,this.dn=n,this.wn=r,this.mn=i,this.Tn=0,this.En=null,this.In=Date.now(),this.reset()}return t.prototype.reset=function(){this.Tn=0},t.prototype.An=function(){this.Tn=this.mn},t.prototype.Rn=function(t){var e=this;this.cancel();var n=Math.floor(this.Tn+this.Pn()),r=Math.max(0,Date.now()-this.In),i=Math.max(0,n-r);i>0&&l(\"ExponentialBackoff\",\"Backing off for \"+i+\" ms (base delay: \"+this.Tn+\" ms, delay with jitter: \"+n+\" ms, last attempt: \"+r+\" ms ago)\"),this.En=this._n.gn(this.fn,i,(function(){return e.In=Date.now(),t()})),this.Tn*=this.wn,this.Tn<this.dn&&(this.Tn=this.dn),this.Tn>this.mn&&(this.Tn=this.mn)},t.prototype.yn=function(){null!==this.En&&(this.En.Vn(),this.En=null)},t.prototype.cancel=function(){null!==this.En&&(this.En.cancel(),this.En=null)},t.prototype.Pn=function(){return(Math.random()-.5)*this.Tn},t}(),lr=function(){function t(t){var e=this;this.pn=null,this.bn=null,this.result=void 0,this.error=void 0,this.vn=!1,this.Sn=!1,t((function(t){e.vn=!0,e.result=t,e.pn&&e.pn(t)}),(function(t){e.vn=!0,e.error=t,e.bn&&e.bn(t)}))}return t.prototype.catch=function(t){return this.next(void 0,t)},t.prototype.next=function(e,n){var r=this;return this.Sn&&y(),this.Sn=!0,this.vn?this.error?this.Dn(n,this.error):this.Cn(e,this.result):new t((function(t,i){r.pn=function(n){r.Cn(e,n).next(t,i)},r.bn=function(e){r.Dn(n,e).next(t,i)}}))},t.prototype.Nn=function(){var t=this;return new Promise((function(e,n){t.next(e,n)}))},t.prototype.Fn=function(e){try{var n=e();return n instanceof t?n:t.resolve(n)}catch(e){return t.reject(e)}},t.prototype.Cn=function(e,n){return e?this.Fn((function(){return e(n)})):t.resolve(n)},t.prototype.Dn=function(e,n){return e?this.Fn((function(){return e(n)})):t.reject(n)},t.resolve=function(e){return new t((function(t,n){t(e)}))},t.reject=function(e){return new t((function(t,n){n(e)}))},t.xn=function(e){return new t((function(t,n){var r=0,i=0,o=!1;e.forEach((function(e){++r,e.next((function(){++i,o&&i===r&&t()}),(function(t){return n(t)}))})),o=!0,i===r&&t()}))},t.$n=function(e){for(var n=t.resolve(!1),r=function(e){n=n.next((function(n){return n?t.resolve(n):e()}))},i=0,o=e;i<o.length;i++)r(o[i]);return n},t.forEach=function(t,e){var n=this,r=[];return t.forEach((function(t,i){r.push(e.call(n,t,i))})),this.xn(r)},t}(),pr=function(){function e(t,n,i){this.name=t,this.version=n,this.kn=i,12.2===e.Mn(r.getUA())&&p(\"Firestore persistence suffers from a bug in iOS 12.2 Safari that may cause your app to stop working. See https://stackoverflow.com/q/56496296/110915 for details and a potential workaround.\")}return e.delete=function(t){return l(\"SimpleDb\",\"Removing database:\",t),wr(window.indexedDB.deleteDatabase(t)).Nn()},e.On=function(){if(\"undefined\"==typeof indexedDB)return!1;if(e.Ln())return!0;var t=r.getUA(),n=e.Mn(t),i=0<n&&n<10,o=e.Bn(t),s=0<o&&o<4.5;return!(t.indexOf(\"MSIE \")>0||t.indexOf(\"Trident/\")>0||t.indexOf(\"Edge/\")>0||i||s)},e.Ln=function(){var t;return\"undefined\"!=typeof process&&\"YES\"===(null===(t=process.env)||void 0===t?void 0:t.qn)},e.Un=function(t,e){return t.store(e)},e.Mn=function(t){var e=t.match(/i(?:phone|pad|pod) os ([\\d_]+)/i),n=e?e[1].split(\"_\").slice(0,2).join(\".\"):\"-1\";return Number(n)},e.Bn=function(t){var e=t.match(/Android ([\\d.]+)/i),n=e?e[1].split(\".\").slice(0,2).join(\".\"):\"-1\";return Number(n)},e.prototype.Qn=function(){return t.__awaiter(this,void 0,void 0,(function(){var e,n=this;return t.__generator(this,(function(t){switch(t.label){case 0:return this.db?[3,2]:(l(\"SimpleDb\",\"Opening database:\",this.name),e=this,[4,new Promise((function(t,e){var r=indexedDB.open(n.name,n.version);r.onsuccess=function(e){t(e.target.result)},r.onblocked=function(){e(new vr(\"Cannot upgrade IndexedDB schema while another tab is open. Close all tabs that access Firestore and reload this page to proceed.\"))},r.onerror=function(t){var n=t.target.error;e(\"VersionError\"===n.name?new c(a.FAILED_PRECONDITION,\"A newer version of the Firestore SDK was previously used and so the persisted data is not compatible with the version of the SDK you are now using. The SDK will operate with persistence disabled. If you need persistence, please re-upgrade to a newer version of the SDK or else clear the persisted IndexedDB data for your app to start fresh.\"):new vr(n))},r.onupgradeneeded=function(t){l(\"SimpleDb\",'Database \"'+n.name+'\" requires upgrade from version:',t.oldVersion),n.kn.createOrUpgrade(t.target.result,r.transaction,t.oldVersion,n.version).next((function(){l(\"SimpleDb\",\"Database upgrade to version \"+n.version+\" complete\")}))}}))]);case 1:e.db=t.sent(),t.label=2;case 2:return[2,(this.Wn&&(this.db.onversionchange=function(t){return n.Wn(t)}),this.db)]}}))}))},e.prototype.jn=function(t){this.Wn=t,this.db&&(this.db.onversionchange=function(e){return t(e)})},e.prototype.runTransaction=function(e,n,r){return t.__awaiter(this,void 0,void 0,(function(){var i,o,s,u,a;return t.__generator(this,(function(c){switch(c.label){case 0:i=\"readonly\"===e,o=0,s=function(){var e,s,a,c,h;return t.__generator(this,(function(t){switch(t.label){case 0:++o,t.label=1;case 1:return t.trys.push([1,4,,5]),[4,u.Qn()];case 2:return u.db=t.sent(),e=gr.open(u.db,i?\"readonly\":\"readwrite\",n),s=r(e).catch((function(t){return e.abort(t),lr.reject(t)})).Nn(),a={},s.catch((function(){})),[4,e.Kn];case 3:return[2,(a.value=(t.sent(),s),a)];case 4:return l(\"SimpleDb\",\"Transaction failed with error:\",(c=t.sent()).message,\"Retrying:\",h=\"FirebaseError\"!==c.name&&o<3),u.close(),h?[3,5]:[2,{value:Promise.reject(c)}];case 5:return[2]}}))},u=this,c.label=1;case 1:return[5,s()];case 2:if(\"object\"==typeof(a=c.sent()))return[2,a.value];c.label=3;case 3:return[3,1];case 4:return[2]}}))}))},e.prototype.close=function(){this.db&&this.db.close(),this.db=void 0},e}(),dr=function(){function t(t){this.Gn=t,this.zn=!1,this.Hn=null}return Object.defineProperty(t.prototype,\"vn\",{get:function(){return this.zn},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,\"Yn\",{get:function(){return this.Hn},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,\"cursor\",{set:function(t){this.Gn=t},enumerable:!1,configurable:!0}),t.prototype.done=function(){this.zn=!0},t.prototype.Jn=function(t){this.Hn=t},t.prototype.delete=function(){return wr(this.Gn.delete())},t}(),vr=function(e){function n(t){var n=this;return(n=e.call(this,a.UNAVAILABLE,\"IndexedDB transaction failed: \"+t)||this).name=\"IndexedDbTransactionError\",n}return t.__extends(n,e),n}(c);function yr(t){return\"IndexedDbTransactionError\"===t.name}var gr=function(){function t(t){var e=this;this.transaction=t,this.aborted=!1,this.Xn=new hr,this.transaction.oncomplete=function(){e.Xn.resolve()},this.transaction.onabort=function(){t.error?e.Xn.reject(new vr(t.error)):e.Xn.resolve()},this.transaction.onerror=function(t){var n=br(t.target.error);e.Xn.reject(new vr(n))}}return t.open=function(e,n,r){try{return new t(e.transaction(r,n))}catch(e){throw new vr(e)}},Object.defineProperty(t.prototype,\"Kn\",{get:function(){return this.Xn.promise},enumerable:!1,configurable:!0}),t.prototype.abort=function(t){t&&this.Xn.reject(t),this.aborted||(l(\"SimpleDb\",\"Aborting transaction:\",t?t.message:\"Client-initiated abort\"),this.aborted=!0,this.transaction.abort())},t.prototype.store=function(t){var e=this.transaction.objectStore(t);return new mr(e)},t}(),mr=function(){function t(t){this.store=t}return t.prototype.put=function(t,e){var n;return void 0!==e?(l(\"SimpleDb\",\"PUT\",this.store.name,t,e),n=this.store.put(e,t)):(l(\"SimpleDb\",\"PUT\",this.store.name,\"<auto-key>\",t),n=this.store.put(t)),wr(n)},t.prototype.add=function(t){return l(\"SimpleDb\",\"ADD\",this.store.name,t,t),wr(this.store.add(t))},t.prototype.get=function(t){var e=this;return wr(this.store.get(t)).next((function(n){return void 0===n&&(n=null),l(\"SimpleDb\",\"GET\",e.store.name,t,n),n}))},t.prototype.delete=function(t){return l(\"SimpleDb\",\"DELETE\",this.store.name,t),wr(this.store.delete(t))},t.prototype.count=function(){return l(\"SimpleDb\",\"COUNT\",this.store.name),wr(this.store.count())},t.prototype.Zn=function(t,e){var n=this.cursor(this.options(t,e)),r=[];return this.ts(n,(function(t,e){r.push(e)})).next((function(){return r}))},t.prototype.es=function(t,e){l(\"SimpleDb\",\"DELETE ALL\",this.store.name);var n=this.options(t,e);n.ns=!1;var r=this.cursor(n);return this.ts(r,(function(t,e,n){return n.delete()}))},t.prototype.ss=function(t,e){var n;e?n=t:(n={},e=t);var r=this.cursor(n);return this.ts(r,e)},t.prototype.rs=function(t){var e=this.cursor({});return new lr((function(n,r){e.onerror=function(t){var e=br(t.target.error);r(e)},e.onsuccess=function(e){var r=e.target.result;r?t(r.primaryKey,r.value).next((function(t){t?r.continue():n()})):n()}}))},t.prototype.ts=function(t,e){var n=[];return new lr((function(r,i){t.onerror=function(t){i(t.target.error)},t.onsuccess=function(t){var i=t.target.result;if(i){var o=new dr(i),s=e(i.primaryKey,i.value,o);if(s instanceof lr){var u=s.catch((function(t){return o.done(),lr.reject(t)}));n.push(u)}o.vn?r():null===o.Yn?i.continue():i.continue(o.Yn)}else r()}})).next((function(){return lr.xn(n)}))},t.prototype.options=function(t,e){var n=void 0;return void 0!==t&&(\"string\"==typeof t?n=t:e=t),{index:n,range:e}},t.prototype.cursor=function(t){var e=\"next\";if(t.reverse&&(e=\"prev\"),t.index){var n=this.store.index(t.index);return t.ns?n.openKeyCursor(t.range,e):n.openCursor(t.range,e)}return this.store.openCursor(t.range,e)},t}();function wr(t){return new lr((function(e,n){t.onsuccess=function(t){e(t.target.result)},t.onerror=function(t){var e=br(t.target.error);n(e)}}))}var _r=!1;function br(t){var e=pr.Mn(r.getUA());if(e>=12.2&&e<13){var n=\"An internal error was encountered in the Indexed Database server\";if(t.message.indexOf(n)>=0){var i=new c(\"internal\",\"IOS_INDEXEDDB_BUG1: IndexedDb has thrown '\"+n+\"'. This is likely due to an unavoidable bug in iOS. See https://stackoverflow.com/q/56496296/110915 for details and a potential workaround.\");return _r||(_r=!0,setTimeout((function(){throw i}),0)),i}}return t}function Ir(){return\"undefined\"!=typeof window?window:null}function Er(){return\"undefined\"!=typeof document?document:null}var Tr=function(){function t(t,e,n,r,i){this.os=t,this.fn=e,this.cs=n,this.op=r,this.us=i,this.hs=new hr,this.then=this.hs.promise.then.bind(this.hs.promise),this.hs.promise.catch((function(t){}))}return t.ls=function(e,n,r,i,o){var s=new t(e,n,Date.now()+r,i,o);return s.start(r),s},t.prototype.start=function(t){var e=this;this._s=setTimeout((function(){return e.fs()}),t)},t.prototype.Vn=function(){return this.fs()},t.prototype.cancel=function(t){null!==this._s&&(this.clearTimeout(),this.hs.reject(new c(a.CANCELLED,\"Operation cancelled\"+(t?\": \"+t:\"\"))))},t.prototype.fs=function(){var t=this;this.os.ds((function(){return null!==t._s?(t.clearTimeout(),t.op().then((function(e){return t.hs.resolve(e)}))):Promise.resolve()}))},t.prototype.clearTimeout=function(){null!==this._s&&(this.us(this),clearTimeout(this._s),this._s=null)},t}(),Nr=function(){function e(){var t=this;this.ws=Promise.resolve(),this.Ts=[],this.Es=!1,this.Is=[],this.As=null,this.Rs=!1,this.Ps=[],this.gs=new fr(this,\"async_queue_retry\"),this.ys=function(){var e=Er();e&&l(\"AsyncQueue\",\"Visibility state changed to  \",e.visibilityState),t.gs.yn()};var e=Er();e&&\"function\"==typeof e.addEventListener&&e.addEventListener(\"visibilitychange\",this.ys)}return Object.defineProperty(e.prototype,\"Vs\",{get:function(){return this.Es},enumerable:!1,configurable:!0}),e.prototype.ds=function(t){this.enqueue(t)},e.prototype.ps=function(t){this.bs(),this.vs(t)},e.prototype.Ss=function(){if(!this.Es){this.Es=!0;var t=Er();t&&\"function\"==typeof t.removeEventListener&&t.removeEventListener(\"visibilitychange\",this.ys)}},e.prototype.enqueue=function(t){return this.bs(),this.Es?new Promise((function(t){})):this.vs(t)},e.prototype.Ds=function(t){var e=this;this.Ts.push(t),this.ds((function(){return e.Cs()}))},e.prototype.Cs=function(){return t.__awaiter(this,void 0,void 0,(function(){var e,n=this;return t.__generator(this,(function(t){switch(t.label){case 0:if(0===this.Ts.length)return[3,5];t.label=1;case 1:return t.trys.push([1,3,,4]),[4,this.Ts[0]()];case 2:return t.sent(),this.Ts.shift(),this.gs.reset(),[3,4];case 3:if(!yr(e=t.sent()))throw e;return l(\"AsyncQueue\",\"Operation failed with retryable error: \"+e),[3,4];case 4:this.Ts.length>0&&this.gs.Rn((function(){return n.Cs()})),t.label=5;case 5:return[2]}}))}))},e.prototype.vs=function(t){var e=this,n=this.ws.then((function(){return e.Rs=!0,t().catch((function(t){throw e.As=t,e.Rs=!1,p(\"INTERNAL UNHANDLED ERROR: \",function(t){var e=t.message||\"\";return t.stack&&(e=t.stack.includes(t.message)?t.stack:t.message+\"\\n\"+t.stack),e}(t)),t})).then((function(t){return e.Rs=!1,t}))}));return this.ws=n,n},e.prototype.gn=function(t,e,n){var r=this;this.bs(),this.Ps.indexOf(t)>-1&&(e=0);var i=Tr.ls(this,t,e,n,(function(t){return r.Ns(t)}));return this.Is.push(i),i},e.prototype.bs=function(){this.As&&y()},e.prototype.Fs=function(){},e.prototype.xs=function(){return t.__awaiter(this,void 0,void 0,(function(){var e;return t.__generator(this,(function(t){switch(t.label){case 0:return[4,e=this.ws];case 1:t.sent(),t.label=2;case 2:if(e!==this.ws)return[3,0];t.label=3;case 3:return[2]}}))}))},e.prototype.$s=function(t){for(var e=0,n=this.Is;e<n.length;e++)if(n[e].fn===t)return!0;return!1},e.prototype.ks=function(t){var e=this;return this.xs().then((function(){e.Is.sort((function(t,e){return t.cs-e.cs}));for(var n=0,r=e.Is;n<r.length;n++){var i=r[n];if(i.Vn(),\"all\"!==t&&i.fn===t)break}return e.xs()}))},e.prototype.Ms=function(t){this.Ps.push(t)},e.prototype.Ns=function(t){var e=this.Is.indexOf(t);this.Is.splice(e,1)},e}();function Ar(t,e){if(p(\"AsyncQueue\",e+\": \"+t),yr(t))return new c(a.UNAVAILABLE,e+\": \"+t);throw t}var Sr=function(){this.Os=void 0,this.listeners=[]},Dr=function(){this.Ls=new it((function(t){return zn(t)}),jn),this.onlineState=\"Unknown\",this.Bs=new Set};function xr(e,n){return t.__awaiter(this,void 0,void 0,(function(){var r,i,o,s,u,a,c;return t.__generator(this,(function(t){switch(t.label){case 0:if(r=m(e),o=!1,(s=r.Ls.get(i=n.query))||(o=!0,s=new Sr),!o)return[3,4];t.label=1;case 1:return t.trys.push([1,3,,4]),u=s,[4,r.qs(i)];case 2:return u.Os=t.sent(),[3,4];case 3:return a=t.sent(),c=Ar(a,\"Initialization of query '\"+Qn(n.query)+\"' failed\"),[2,void n.onError(c)];case 4:return r.Ls.set(i,s),s.listeners.push(n),n.Us(r.onlineState),s.Os&&n.Qs(s.Os)&&Rr(r),[2]}}))}))}function kr(e,n){return t.__awaiter(this,void 0,void 0,(function(){var r,i,o,s,u;return t.__generator(this,(function(t){return r=m(e),o=!1,(s=r.Ls.get(i=n.query))&&(u=s.listeners.indexOf(n))>=0&&(s.listeners.splice(u,1),o=0===s.listeners.length),o?[2,(r.Ls.delete(i),r.Ws(i))]:[2]}))}))}function Lr(t,e){for(var n=m(t),r=!1,i=0,o=e;i<o.length;i++){var s=o[i],a=n.Ls.get(s.query);if(a){for(var c=0,h=a.listeners;c<h.length;c++)h[c].Qs(s)&&(r=!0);a.Os=s}}r&&Rr(n)}function Or(t,e,n){var r=m(t),i=r.Ls.get(e);if(i)for(var o=0,s=i.listeners;o<s.length;o++)s[o].onError(n);r.Ls.delete(e)}function Rr(t){t.Bs.forEach((function(t){t.next()}))}var Ur=function(){function t(t,e,n){this.query=t,this.js=e,this.Ks=!1,this.Gs=null,this.onlineState=\"Unknown\",this.options=n||{}}return t.prototype.Qs=function(t){if(!this.options.includeMetadataChanges){for(var e=[],n=0,r=t.docChanges;n<r.length;n++){var i=r[n];3!==i.type&&e.push(i)}t=new Mt(t.query,t.docs,t.Ut,e,t.Qt,t.fromCache,t.Wt,!0)}var o=!1;return this.Ks?this.zs(t)&&(this.js.next(t),o=!0):this.Hs(t,this.onlineState)&&(this.Ys(t),o=!0),this.Gs=t,o},t.prototype.onError=function(t){this.js.error(t)},t.prototype.Us=function(t){this.onlineState=t;var e=!1;return this.Gs&&!this.Ks&&this.Hs(this.Gs,t)&&(this.Ys(this.Gs),e=!0),e},t.prototype.Hs=function(t,e){return!t.fromCache||!(this.options.Js&&\"Offline\"!==e||t.docs.m()&&\"Offline\"!==e)},t.prototype.zs=function(t){return t.docChanges.length>0||!!(t.Wt||this.Gs&&this.Gs.hasPendingWrites!==t.hasPendingWrites)&&!0===this.options.includeMetadataChanges},t.prototype.Ys=function(t){t=Mt.Kt(t.query,t.docs,t.Qt,t.fromCache),this.Ks=!0,this.js.next(t)},t}(),Cr=function(){function t(t){this.uid=t}return t.prototype.Xs=function(){return null!=this.uid},t.prototype.Zs=function(){return this.Xs()?\"uid:\"+this.uid:\"anonymous-user\"},t.prototype.isEqual=function(t){return t.uid===this.uid},t}();Cr.UNAUTHENTICATED=new Cr(null),Cr.ti=new Cr(\"google-credentials-uid\"),Cr.ei=new Cr(\"first-party-uid\");var Pr=function(){function t(t,e){var n=this;this.previousValue=t,e&&(e.ni=function(t){return n.si(t)},this.ii=function(t){return e.ri(t)})}return t.prototype.si=function(t){return this.previousValue=Math.max(t,this.previousValue),this.previousValue},t.prototype.next=function(){var t=++this.previousValue;return this.ii&&this.ii(t),t},t}();function Vr(t,e){return\"firestore_clients_\"+t+\"_\"+e}function Mr(t,e,n){var r=\"firestore_mutations_\"+t+\"_\"+n;return e.Xs()&&(r+=\"_\"+e.uid),r}function Fr(t,e){return\"firestore_targets_\"+t+\"_\"+e}Pr.oi=-1;var qr=function(){function t(t,e,n,r){this.user=t,this.batchId=e,this.state=n,this.error=r}return t.ai=function(e,n,r){var i=JSON.parse(r),o=\"object\"==typeof i&&-1!==[\"pending\",\"acknowledged\",\"rejected\"].indexOf(i.state)&&(void 0===i.error||\"object\"==typeof i.error),s=void 0;return o&&i.error&&(o=\"string\"==typeof i.error.message&&\"string\"==typeof i.error.code)&&(s=new c(i.error.code,i.error.message)),o?new t(e,n,i.state,s):(p(\"SharedClientState\",\"Failed to parse mutation state for ID '\"+n+\"': \"+r),null)},t.prototype.ci=function(){var t={state:this.state,updateTimeMs:Date.now()};return this.error&&(t.error={code:this.error.code,message:this.error.message}),JSON.stringify(t)},t}(),Gr=function(){function t(t,e,n){this.targetId=t,this.state=e,this.error=n}return t.ai=function(e,n){var r=JSON.parse(n),i=\"object\"==typeof r&&-1!==[\"not-current\",\"current\",\"rejected\"].indexOf(r.state)&&(void 0===r.error||\"object\"==typeof r.error),o=void 0;return i&&r.error&&(i=\"string\"==typeof r.error.message&&\"string\"==typeof r.error.code)&&(o=new c(r.error.code,r.error.message)),i?new t(e,r.state,o):(p(\"SharedClientState\",\"Failed to parse target state for ID '\"+e+\"': \"+n),null)},t.prototype.ci=function(){var t={state:this.state,updateTimeMs:Date.now()};return this.error&&(t.error={code:this.error.code,message:this.error.message}),JSON.stringify(t)},t}(),Br=function(){function t(t,e){this.clientId=t,this.activeTargetIds=e}return t.ai=function(e,n){for(var r=JSON.parse(n),i=\"object\"==typeof r&&r.activeTargetIds instanceof Array,o=Ct(),s=0;i&&s<r.activeTargetIds.length;++s)i=ct(r.activeTargetIds[s]),o=o.add(r.activeTargetIds[s]);return i?new t(e,o):(p(\"SharedClientState\",\"Failed to parse client data for instance '\"+e+\"': \"+n),null)},t}(),jr=function(){function t(t,e){this.clientId=t,this.onlineState=e}return t.ai=function(e){var n=JSON.parse(e);return\"object\"==typeof n&&-1!==[\"Unknown\",\"Online\",\"Offline\"].indexOf(n.onlineState)&&\"string\"==typeof n.clientId?new t(n.clientId,n.onlineState):(p(\"SharedClientState\",\"Failed to parse online state: \"+e),null)},t}(),zr=function(){function t(){this.activeTargetIds=Ct()}return t.prototype.ui=function(t){this.activeTargetIds=this.activeTargetIds.add(t)},t.prototype.hi=function(t){this.activeTargetIds=this.activeTargetIds.delete(t)},t.prototype.ci=function(){var t={activeTargetIds:this.activeTargetIds.A(),updateTimeMs:Date.now()};return JSON.stringify(t)},t}(),Qr=function(){function e(t,e,n,r,i){this.window=t,this._n=e,this.persistenceKey=n,this.li=r,this._i=null,this.fi=null,this.ni=null,this.di=this.wi.bind(this),this.mi=new bt(Y),this.Ti=!1,this.Ei=[];var o=n.replace(/[.*+?^${}()|[\\]\\\\]/g,\"\\\\$&\");this.storage=this.window.localStorage,this.currentUser=i,this.Ii=Vr(this.persistenceKey,this.li),this.Ai=function(t){return\"firestore_sequence_number_\"+t}(this.persistenceKey),this.mi=this.mi.rt(this.li,new zr),this.Ri=new RegExp(\"^firestore_clients_\"+o+\"_([^_]*)$\"),this.Pi=new RegExp(\"^firestore_mutations_\"+o+\"_(\\\\d+)(?:_(.*))?$\"),this.gi=new RegExp(\"^firestore_targets_\"+o+\"_(\\\\d+)$\"),this.yi=function(t){return\"firestore_online_state_\"+t}(this.persistenceKey),this.window.addEventListener(\"storage\",this.di)}return e.On=function(t){return!(!t||!t.localStorage)},e.prototype.start=function(){return t.__awaiter(this,void 0,void 0,(function(){var e,n,r,i,o,s,u,a,c,h,l=this;return t.__generator(this,(function(t){switch(t.label){case 0:return[4,this._i.Vi()];case 1:for(e=t.sent(),n=0,r=e;n<r.length;n++)(i=r[n])!==this.li&&(o=this.getItem(Vr(this.persistenceKey,i)))&&(s=Br.ai(i,o))&&(this.mi=this.mi.rt(s.clientId,s));for(this.pi(),(u=this.storage.getItem(this.yi))&&(a=this.bi(u))&&this.vi(a),c=0,h=this.Ei;c<h.length;c++)this.wi(h[c]);return this.Ei=[],this.window.addEventListener(\"unload\",(function(){return l.Si()})),this.Ti=!0,[2]}}))}))},e.prototype.ri=function(t){this.setItem(this.Ai,JSON.stringify(t))},e.prototype.Di=function(){return this.Ci(this.mi)},e.prototype.Ni=function(t){var e=!1;return this.mi.forEach((function(n,r){r.activeTargetIds.has(t)&&(e=!0)})),e},e.prototype.Fi=function(t){this.xi(t,\"pending\")},e.prototype.$i=function(t,e,n){this.xi(t,e,n),this.ki(t)},e.prototype.Mi=function(t){var e=\"not-current\";if(this.Ni(t)){var n=this.storage.getItem(Fr(this.persistenceKey,t));if(n){var r=Gr.ai(t,n);r&&(e=r.state)}}return this.Oi.ui(t),this.pi(),e},e.prototype.Li=function(t){this.Oi.hi(t),this.pi()},e.prototype.Bi=function(t){return this.Oi.activeTargetIds.has(t)},e.prototype.qi=function(t){this.removeItem(Fr(this.persistenceKey,t))},e.prototype.Ui=function(t,e,n){this.Qi(t,e,n)},e.prototype.Wi=function(t,e,n){var r=this;e.forEach((function(t){r.ki(t)})),this.currentUser=t,n.forEach((function(t){r.Fi(t)}))},e.prototype.ji=function(t){this.Ki(t)},e.prototype.Si=function(){this.Ti&&(this.window.removeEventListener(\"storage\",this.di),this.removeItem(this.Ii),this.Ti=!1)},e.prototype.getItem=function(t){var e=this.storage.getItem(t);return l(\"SharedClientState\",\"READ\",t,e),e},e.prototype.setItem=function(t,e){l(\"SharedClientState\",\"SET\",t,e),this.storage.setItem(t,e)},e.prototype.removeItem=function(t){l(\"SharedClientState\",\"REMOVE\",t),this.storage.removeItem(t)},e.prototype.wi=function(e){var n=this,r=e;if(r.storageArea===this.storage){if(l(\"SharedClientState\",\"EVENT\",r.key,r.newValue),r.key===this.Ii)return void p(\"Received WebStorage notification for local change. Another client might have garbage-collected our state\");this._n.Ds((function(){return t.__awaiter(n,void 0,void 0,(function(){var e,n,i,o,s,u;return t.__generator(this,(function(t){if(this.Ti){if(null!==r.key)if(this.Ri.test(r.key)){if(null==r.newValue)return e=this.Gi(r.key),[2,this.zi(e,null)];if(n=this.Hi(r.key,r.newValue))return[2,this.zi(n.clientId,n)]}else if(this.Pi.test(r.key)){if(null!==r.newValue&&(i=this.Yi(r.key,r.newValue)))return[2,this.Ji(i)]}else if(this.gi.test(r.key)){if(null!==r.newValue&&(o=this.Xi(r.key,r.newValue)))return[2,this.Zi(o)]}else if(r.key===this.yi){if(null!==r.newValue&&(s=this.bi(r.newValue)))return[2,this.vi(s)]}else r.key===this.Ai&&(u=function(t){var e=Pr.oi;if(null!=t)try{var n=JSON.parse(t);g(\"number\"==typeof n),e=n}catch(t){p(\"SharedClientState\",\"Failed to read sequence number from WebStorage\",t)}return e}(r.newValue))!==Pr.oi&&this.ni(u)}else this.Ei.push(r);return[2]}))}))}))}},Object.defineProperty(e.prototype,\"Oi\",{get:function(){return this.mi.get(this.li)},enumerable:!1,configurable:!0}),e.prototype.pi=function(){this.setItem(this.Ii,this.Oi.ci())},e.prototype.xi=function(t,e,n){var r=new qr(this.currentUser,t,e,n),i=Mr(this.persistenceKey,this.currentUser,t);this.setItem(i,r.ci())},e.prototype.ki=function(t){var e=Mr(this.persistenceKey,this.currentUser,t);this.removeItem(e)},e.prototype.Ki=function(t){this.storage.setItem(this.yi,JSON.stringify({clientId:this.li,onlineState:t}))},e.prototype.Qi=function(t,e,n){var r=Fr(this.persistenceKey,t),i=new Gr(t,e,n);this.setItem(r,i.ci())},e.prototype.Gi=function(t){var e=this.Ri.exec(t);return e?e[1]:null},e.prototype.Hi=function(t,e){var n=this.Gi(t);return Br.ai(n,e)},e.prototype.Yi=function(t,e){var n=this.Pi.exec(t),r=Number(n[1]);return qr.ai(new Cr(void 0!==n[2]?n[2]:null),r,e)},e.prototype.Xi=function(t,e){var n=this.gi.exec(t),r=Number(n[1]);return Gr.ai(r,e)},e.prototype.bi=function(t){return jr.ai(t)},e.prototype.Ji=function(e){return t.__awaiter(this,void 0,void 0,(function(){return t.__generator(this,(function(t){return e.user.uid===this.currentUser.uid?[2,this._i.tr(e.batchId,e.state,e.error)]:(l(\"SharedClientState\",\"Ignoring mutation for non-active user \"+e.user.uid),[2])}))}))},e.prototype.Zi=function(t){return this._i.er(t.targetId,t.state,t.error)},e.prototype.zi=function(t,e){var n=this,r=e?this.mi.rt(t,e):this.mi.remove(t),i=this.Ci(this.mi),o=this.Ci(r),s=[],u=[];return o.forEach((function(t){i.has(t)||s.push(t)})),i.forEach((function(t){o.has(t)||u.push(t)})),this._i.nr(s,u).then((function(){n.mi=r}))},e.prototype.vi=function(t){this.mi.get(t.clientId)&&this.fi(t.onlineState)},e.prototype.Ci=function(t){var e=Ct();return t.forEach((function(t,n){e=e.$t(n.activeTargetIds)})),e},e}(),Wr=function(){function t(){this.sr=new zr,this.ir={},this.fi=null,this.ni=null}return t.prototype.Fi=function(t){},t.prototype.$i=function(t,e,n){},t.prototype.Mi=function(t){return this.sr.ui(t),this.ir[t]||\"not-current\"},t.prototype.Ui=function(t,e,n){this.ir[t]=e},t.prototype.Li=function(t){this.sr.hi(t)},t.prototype.Bi=function(t){return this.sr.activeTargetIds.has(t)},t.prototype.qi=function(t){delete this.ir[t]},t.prototype.Di=function(){return this.sr.activeTargetIds},t.prototype.Ni=function(t){return this.sr.activeTargetIds.has(t)},t.prototype.start=function(){return this.sr=new zr,Promise.resolve()},t.prototype.Wi=function(t,e,n){},t.prototype.ji=function(t){},t.prototype.Si=function(){},t.prototype.ri=function(t){},t}(),Kr=function(){function t(t,e,n,r){this.batchId=t,this.rr=e,this.baseMutations=n,this.mutations=r}return t.prototype.ar=function(t,e,n){for(var r=n.cr,i=0;i<this.mutations.length;i++){var o=this.mutations[i];o.key.isEqual(t)&&(e=hn(o,e,r[i]))}return e},t.prototype.ur=function(t,e){for(var n=0,r=this.baseMutations;n<r.length;n++){var i=r[n];i.key.isEqual(t)&&(e=fn(i,e,e,this.rr))}for(var o=e,s=0,u=this.mutations;s<u.length;s++){var a=u[s];a.key.isEqual(t)&&(e=fn(a,e,o,this.rr))}return e},t.prototype.hr=function(t){var e=this,n=t;return this.mutations.forEach((function(r){var i=e.ur(r.key,t.get(r.key));i&&(n=n.rt(r.key,i))})),n},t.prototype.keys=function(){return this.mutations.reduce((function(t,e){return t.add(e.key)}),Rt())},t.prototype.isEqual=function(t){return this.batchId===t.batchId&&H(this.mutations,t.mutations,(function(t,e){return pn(t,e)}))&&H(this.baseMutations,t.baseMutations,(function(t,e){return pn(t,e)}))},t}(),Yr=function(){function t(t,e,n,r){this.batch=t,this.lr=e,this.cr=n,this._r=r}return t.from=function(e,n,r){g(e.mutations.length===r.length);for(var i=Lt,o=e.mutations,s=0;s<o.length;s++)i=i.rt(o[s].key,r[s].version);return new t(e,n,r,i)},t}(),Hr=function(){function t(){this.dr=new it((function(t){return t.toString()}),(function(t,e){return t.isEqual(e)})),this.wr=!1}return Object.defineProperty(t.prototype,\"readTime\",{get:function(){return this.mr},set:function(t){this.mr=t},enumerable:!1,configurable:!0}),t.prototype.Tr=function(t,e){this.Er(),this.readTime=e,this.dr.set(t.key,t)},t.prototype.Ir=function(t,e){this.Er(),e&&(this.readTime=e),this.dr.set(t,null)},t.prototype.Ar=function(t,e){this.Er();var n=this.dr.get(e);return void 0!==n?lr.resolve(n):this.Rr(t,e)},t.prototype.getEntries=function(t,e){return this.Pr(t,e)},t.prototype.apply=function(t){return this.Er(),this.wr=!0,this.gr(t)},t.prototype.Er=function(){},t}(),$r=\"The current tab is not in the required state to perform this operation. It might be necessary to refresh the browser tab.\",Xr=function(){function t(){this.yr=[]}return t.prototype.Vr=function(t){this.yr.push(t)},t.prototype.pr=function(){this.yr.forEach((function(t){return t()}))},t}(),Jr=function(){function t(t,e,n){this.br=t,this.vr=e,this.Sr=n}return t.prototype.Dr=function(t,e){var n=this;return this.vr.Cr(t,e).next((function(r){return n.Nr(t,e,r)}))},t.prototype.Nr=function(t,e,n){return this.br.Ar(t,e).next((function(t){for(var r=0,i=n;r<i.length;r++)t=i[r].ur(e,t);return t}))},t.prototype.Fr=function(t,e,n){var r=Dt();return e.forEach((function(t,e){for(var i=0,o=n;i<o.length;i++)e=o[i].ur(t,e);r=r.rt(t,e)})),r},t.prototype.$r=function(t,e){var n=this;return this.br.getEntries(t,e).next((function(e){return n.kr(t,e)}))},t.prototype.kr=function(t,e){var n=this;return this.vr.Mr(t,e).next((function(r){var i=n.Fr(t,e,r),o=St();return i.forEach((function(t,e){e||(e=new Dn(t,st.min())),o=o.rt(t,e)})),o}))},t.prototype.Or=function(t,e,n){return function(t){return A.F(t.path)&&null===t.collectionGroup&&0===t.filters.length}(e)?this.Lr(t,e.path):Vn(e)?this.Br(t,e,n):this.qr(t,e,n)},t.prototype.Lr=function(t,e){return this.Dr(t,new A(e)).next((function(t){var e=kt();return t instanceof Sn&&(e=e.rt(t.key,t)),e}))},t.prototype.Br=function(t,e,n){var r=this,i=e.collectionGroup,o=kt();return this.Sr.Ur(t,i).next((function(s){return lr.forEach(s,(function(s){var u=function(t,e){return new kn(e,null,t.rn.slice(),t.filters.slice(),t.limit,t.on,t.startAt,t.endAt)}(e,s.child(i));return r.qr(t,u,n).next((function(t){t.forEach((function(t,e){o=o.rt(t,e)}))}))})).next((function(){return o}))}))},t.prototype.qr=function(t,e,n){var r,i,o=this;return this.br.Or(t,e,n).next((function(n){return r=n,o.vr.Qr(t,e)})).next((function(e){return o.Wr(t,i=e,r).next((function(t){r=t;for(var e=0,n=i;e<n.length;e++)for(var o=n[e],s=0,u=o.mutations;s<u.length;s++){var a=u[s],c=a.key,h=r.get(c),f=fn(a,h,h,o.rr);r=f instanceof Sn?r.rt(c,f):r.remove(c)}}))})).next((function(){return r.forEach((function(t,n){Wn(e,n)||(r=r.remove(t))})),r}))},t.prototype.Wr=function(t,e,n){for(var r=Rt(),i=0,o=e;i<o.length;i++)for(var s=0,u=o[i].mutations;s<u.length;s++){var a=u[s];a instanceof yn&&null===n.get(a.key)&&(r=r.add(a.key))}var c=n;return this.br.getEntries(t,r).next((function(t){return t.forEach((function(t,e){null!==e&&e instanceof Sn&&(c=c.rt(t,e))})),c}))},t}(),Zr=function(){function t(t,e,n,r){this.targetId=t,this.fromCache=e,this.jr=n,this.Kr=r}return t.Gr=function(e,n){for(var r=Rt(),i=Rt(),o=0,s=n.docChanges;o<s.length;o++){var u=s[o];switch(u.type){case 0:r=r.add(u.doc.key);break;case 1:i=i.add(u.doc.key)}}return new t(e,n.fromCache,r,i)},t}();function ti(t,e){var r=t[1],o=e[1],s=Y(t[0],e[0]);return 0===s?Y(r,o):s}var ei=function(){function t(t){this.zr=t,this.buffer=new Tt(ti),this.Hr=0}return t.prototype.Yr=function(){return++this.Hr},t.prototype.Jr=function(t){var e=[t,this.Yr()];if(this.buffer.size<this.zr)this.buffer=this.buffer.add(e);else{var n=this.buffer.last();ti(e,n)<0&&(this.buffer=this.buffer.delete(n).add(e))}},Object.defineProperty(t.prototype,\"maxValue\",{get:function(){return this.buffer.last()[0]},enumerable:!1,configurable:!0}),t}(),ni={Xr:!1,Zr:0,eo:0,no:0},ri=function(){function t(t,e,n){this.so=t,this.io=e,this.ro=n}return t.oo=function(e){return new t(e,t.ao,t.co)},t}();ri.uo=-1,ri.ho=1048576,ri.lo=41943040,ri.ao=10,ri.co=1e3,ri._o=new ri(ri.lo,ri.ao,ri.co),ri.fo=new ri(ri.uo,0,0);var ii=function(){function e(t,e){this.do=t,this.os=e,this.wo=!1,this.mo=null}return e.prototype.start=function(t){this.do.params.so!==ri.uo&&this.To(t)},e.prototype.stop=function(){this.mo&&(this.mo.cancel(),this.mo=null)},Object.defineProperty(e.prototype,\"Ti\",{get:function(){return null!==this.mo},enumerable:!1,configurable:!0}),e.prototype.To=function(e){var n=this,r=this.wo?3e5:6e4;l(\"LruGarbageCollector\",\"Garbage collection scheduled in \"+r+\"ms\"),this.mo=this.os.gn(\"lru_garbage_collection\",r,(function(){return t.__awaiter(n,void 0,void 0,(function(){var n;return t.__generator(this,(function(t){switch(t.label){case 0:this.mo=null,this.wo=!0,t.label=1;case 1:return t.trys.push([1,3,,7]),[4,e.Eo(this.do)];case 2:return t.sent(),[3,7];case 3:return yr(n=t.sent())?(l(\"LruGarbageCollector\",\"Ignoring IndexedDB error during garbage collection: \",n),[3,6]):[3,4];case 4:return[4,bo(n)];case 5:t.sent(),t.label=6;case 6:return[3,7];case 7:return[4,this.To(e)];case 8:return t.sent(),[2]}}))}))}))},e}(),oi=function(){function t(t,e){this.Io=t,this.params=e}return t.prototype.Ao=function(t,e){return this.Io.Ro(t).next((function(t){return Math.floor(e/100*t)}))},t.prototype.Po=function(t,e){var n=this;if(0===e)return lr.resolve(Pr.oi);var r=new ei(e);return this.Io.De(t,(function(t){return r.Jr(t.sequenceNumber)})).next((function(){return n.Io.yo(t,(function(t){return r.Jr(t)}))})).next((function(){return r.maxValue}))},t.prototype.Vo=function(t,e,n){return this.Io.Vo(t,e,n)},t.prototype.po=function(t,e){return this.Io.po(t,e)},t.prototype.bo=function(t,e){var n=this;return this.params.so===ri.uo?(l(\"LruGarbageCollector\",\"Garbage collection skipped; disabled\"),lr.resolve(ni)):this.vo(t).next((function(r){return r<n.params.so?(l(\"LruGarbageCollector\",\"Garbage collection skipped; Cache size \"+r+\" is lower than threshold \"+n.params.so),ni):n.So(t,e)}))},t.prototype.vo=function(t){return this.Io.vo(t)},t.prototype.So=function(t,e){var r,i,o,s,u,a,c,h=this,p=Date.now();return this.Ao(t,this.params.io).next((function(e){return e>h.params.ro?(l(\"LruGarbageCollector\",\"Capping sequence numbers to collect down to the maximum of \"+h.params.ro+\" from \"+e),i=h.params.ro):i=e,s=Date.now(),h.Po(t,i)})).next((function(n){return r=n,u=Date.now(),h.Vo(t,r,e)})).next((function(e){return o=e,a=Date.now(),h.po(t,r)})).next((function(t){return c=Date.now(),f()<=n.LogLevel.DEBUG&&l(\"LruGarbageCollector\",\"LRU Garbage Collection\\n\\tCounted targets in \"+(s-p)+\"ms\\n\\tDetermined least recently used \"+i+\" in \"+(u-s)+\"ms\\n\\tRemoved \"+o+\" targets in \"+(a-u)+\"ms\\n\\tRemoved \"+t+\" documents in \"+(c-a)+\"ms\\nTotal Duration: \"+(c-p)+\"ms\"),lr.resolve({Xr:!0,Zr:i,eo:o,no:t})}))},t}();function si(t){for(var e=\"\",n=0;n<t.length;n++)e.length>0&&(e=ai(e)),e=ui(t.get(n),e);return ai(e)}function ui(t,e){for(var n=e,r=t.length,i=0;i<r;i++){var o=t.charAt(i);switch(o){case\"\\0\":n+=\"\u0001\u0010\";break;case\"\u0001\":n+=\"\u0001\u0011\";break;default:n+=o}}return n}function ai(t){return t+\"\u0001\u0001\"}function ci(t){var e=t.length;if(g(e>=2),2===e)return g(\"\u0001\"===t.charAt(0)&&\"\u0001\"===t.charAt(1)),E.g();for(var n=e-2,r=[],i=\"\",o=0;o<e;){var s=t.indexOf(\"\u0001\",o);switch((s<0||s>n)&&y(),t.charAt(s+1)){case\"\u0001\":var u=t.substring(o,s),a=void 0;0===i.length?a=u:(a=i+=u,i=\"\"),r.push(a);break;case\"\u0010\":i+=t.substring(o,s),i+=\"\\0\";break;case\"\u0011\":i+=t.substring(o,s+1);break;default:y()}o=s+2}return new E(r)}var hi=function(t){this.Do=t};function fi(t,e){if(e.document)return function(t,e,n){var r=Ne(t,e.name),i=be(e.updateTime),o=new En({mapValue:{fields:e.fields}});return new Sn(r,i,o,{hasCommittedMutations:!!n})}(t.Do,e.document,!!e.hasCommittedMutations);if(e.noDocument){var n=A.$(e.noDocument.path),r=yi(e.noDocument.readTime);return new Dn(n,r,{hasCommittedMutations:!!e.hasCommittedMutations})}if(e.unknownDocument){var i=A.$(e.unknownDocument.path),o=yi(e.unknownDocument.version);return new xn(i,o)}return y()}function li(t,e,n){var r=pi(n),i=e.key.path.h().A();if(e instanceof Sn){var o=function(t,e){return{name:Te(t,e.key),fields:e.sn().mapValue.fields,updateTime:me(t,e.version.X())}}(t.Do,e);return new Gi(null,null,o,e.hasCommittedMutations,r,i)}if(e instanceof Dn){var u=e.key.path.A(),a=vi(e.version),c=e.hasCommittedMutations;return new Gi(null,new Fi(u,a),null,c,r,i)}if(e instanceof xn){var h=e.key.path.A(),f=vi(e.version);return new Gi(new qi(h,f),null,null,!0,r,i)}return y()}function pi(t){var e=t.X();return[e.seconds,e.nanoseconds]}function di(t){var e=new ot(t[0],t[1]);return st.Y(e)}function vi(t){var e=t.X();return new Ui(e.seconds,e.nanoseconds)}function yi(t){var e=new ot(t.seconds,t.nanoseconds);return st.Y(e)}function gi(t,e){var n=(e.baseMutations||[]).map((function(e){return Oe(t.Do,e)})),r=e.mutations.map((function(e){return Oe(t.Do,e)})),i=ot.fromMillis(e.localWriteTimeMs);return new Kr(e.batchId,i,n,r)}function mi(t){var e,n,r=yi(t.readTime),i=void 0!==t.lastLimboFreeSnapshotVersion?yi(t.lastLimboFreeSnapshotVersion):st.min();return void 0!==t.query.documents?(g(1===(n=t.query).documents.length),e=Fn(On(Se(n.documents[0])))):e=function(t){var e=Se(t.parent),n=t.structuredQuery,r=n.from?n.from.length:0,i=null;if(r>0){g(1===r);var o=n.from[0];o.allDescendants?i=o.collectionId:e=e.child(o.collectionId)}var s=[];n.where&&(s=function t(e){return e?void 0!==e.unaryFilter?[Be(e)]:void 0!==e.fieldFilter?[Ge(e)]:void 0!==e.compositeFilter?e.compositeFilter.filters.map((function(e){return t(e)})).reduce((function(t,e){return t.concat(e)})):y():[]}(n.where));var u=[];n.orderBy&&(u=n.orderBy.map((function(t){return function(t){return new ur(qe(t.field),function(t){switch(t){case\"ASCENDING\":return\"asc\";case\"DESCENDING\":return\"desc\";default:return}}(t.direction))}(t)})));var a=null;n.limit&&(a=function(t){var e;return ut(e=\"object\"==typeof t?t.value:t)?null:e}(n.limit));var c=null;n.startAt&&(c=Pe(n.startAt));var h=null;return n.endAt&&(h=Pe(n.endAt)),Fn(Ln(e,i,u,s,a,\"F\",c,h))}(t.query),new gt(e,t.targetId,0,t.lastListenSequenceNumber,r,i,X.fromBase64String(t.resumeToken))}function wi(t,e){var n,r=vi(e.et),i=vi(e.lastLimboFreeSnapshotVersion);n=dt(e.target)?Re(t.Do,e.target):Ue(t.Do,e.target);var o=e.resumeToken.toBase64();return new ji(e.targetId,lt(e.target),r,o,e.sequenceNumber,i,n)}var _i=function(){function t(t,e,n,r){this.userId=t,this.serializer=e,this.Sr=n,this.Co=r,this.No={}}return t.Fo=function(e,n,r,i){return g(\"\"!==e.uid),new t(e.Xs()?e.uid:\"\",n,r,i)},t.prototype.xo=function(t){var e=!0,n=IDBKeyRange.bound([this.userId,Number.NEGATIVE_INFINITY],[this.userId,Number.POSITIVE_INFINITY]);return Ei(t).ss({index:Vi.userMutationsIndex,range:n},(function(t,n,r){e=!1,r.done()})).next((function(){return e}))},t.prototype.$o=function(t,e,n,r){var i=this,o=Ti(t),s=Ei(t);return s.add({}).next((function(u){g(\"number\"==typeof u);for(var a=new Kr(u,e,n,r),c=function(t,e,n){var r=n.baseMutations.map((function(e){return Le(t.Do,e)})),i=n.mutations.map((function(e){return Le(t.Do,e)}));return new Vi(e,n.batchId,n.rr.toMillis(),r,i)}(i.serializer,i.userId,a),h=[],f=new Tt((function(t,e){return Y(t.R(),e.R())})),l=0,p=r;l<p.length;l++){var d=p[l],v=Mi.key(i.userId,d.key.path,u);f=f.add(d.key.path.h()),h.push(s.put(c)),h.push(o.put(v,Mi.PLACEHOLDER))}return f.forEach((function(e){h.push(i.Sr.ko(t,e))})),t.Vr((function(){i.No[u]=a.keys()})),lr.xn(h).next((function(){return a}))}))},t.prototype.Mo=function(t,e){var n=this;return Ei(t).get(e).next((function(t){return t?(g(t.userId===n.userId),gi(n.serializer,t)):null}))},t.prototype.Oo=function(t,e){var n=this;return this.No[e]?lr.resolve(this.No[e]):this.Mo(t,e).next((function(t){if(t){var r=t.keys();return n.No[e]=r,r}return null}))},t.prototype.Lo=function(t,e){var n=this,r=e+1,i=IDBKeyRange.lowerBound([this.userId,r]),o=null;return Ei(t).ss({index:Vi.userMutationsIndex,range:i},(function(t,e,i){e.userId===n.userId&&(g(e.batchId>=r),o=gi(n.serializer,e)),i.done()})).next((function(){return o}))},t.prototype.Bo=function(t){var e=IDBKeyRange.upperBound([this.userId,Number.POSITIVE_INFINITY]),n=-1;return Ei(t).ss({index:Vi.userMutationsIndex,range:e,reverse:!0},(function(t,e,r){n=e.batchId,r.done()})).next((function(){return n}))},t.prototype.qo=function(t){var e=this,n=IDBKeyRange.bound([this.userId,-1],[this.userId,Number.POSITIVE_INFINITY]);return Ei(t).Zn(Vi.userMutationsIndex,n).next((function(t){return t.map((function(t){return gi(e.serializer,t)}))}))},t.prototype.Cr=function(t,e){var n=this,r=Mi.prefixForPath(this.userId,e.path),i=IDBKeyRange.lowerBound(r),o=[];return Ti(t).ss({range:i},(function(r,i,s){var u=r[0],c=r[2],h=ci(r[1]);if(u===n.userId&&e.path.isEqual(h))return Ei(t).get(c).next((function(t){if(!t)throw y();g(t.userId===n.userId),o.push(gi(n.serializer,t))}));s.done()})).next((function(){return o}))},t.prototype.Mr=function(t,e){var n=this,r=new Tt(Y),i=[];return e.forEach((function(e){var o=Mi.prefixForPath(n.userId,e.path),s=IDBKeyRange.lowerBound(o),u=Ti(t).ss({range:s},(function(t,i,o){var s=t[0],a=t[2],c=ci(t[1]);s===n.userId&&e.path.isEqual(c)?r=r.add(a):o.done()}));i.push(u)})),lr.xn(i).next((function(){return n.Uo(t,r)}))},t.prototype.Qr=function(t,e){var n=this,r=e.path,i=r.length+1,o=Mi.prefixForPath(this.userId,r),s=IDBKeyRange.lowerBound(o),u=new Tt(Y);return Ti(t).ss({range:s},(function(t,e,o){var s=t[0],c=t[2],h=ci(t[1]);s===n.userId&&r.T(h)?h.length===i&&(u=u.add(c)):o.done()})).next((function(){return n.Uo(t,u)}))},t.prototype.Uo=function(t,e){var n=this,r=[],i=[];return e.forEach((function(e){i.push(Ei(t).get(e).next((function(t){if(null===t)throw y();g(t.userId===n.userId),r.push(gi(n.serializer,t))})))})),lr.xn(i).next((function(){return r}))},t.prototype.Qo=function(t,e){var n=this;return Ii(t.Wo,this.userId,e).next((function(r){return t.Vr((function(){n.jo(e.batchId)})),lr.forEach(r,(function(e){return n.Co.Ko(t,e)}))}))},t.prototype.jo=function(t){delete this.No[t]},t.prototype.Go=function(t){var e=this;return this.xo(t).next((function(n){if(!n)return lr.resolve();var r=IDBKeyRange.lowerBound(Mi.prefixForUser(e.userId)),i=[];return Ti(t).ss({range:r},(function(t,n,r){if(t[0]===e.userId){var o=ci(t[1]);i.push(o)}else r.done()})).next((function(){g(0===i.length)}))}))},t.prototype.zo=function(t,e){return bi(t,this.userId,e)},t.prototype.Ho=function(t){var e=this;return Ni(t).get(this.userId).next((function(t){return t||new Pi(e.userId,-1,\"\")}))},t}();function bi(t,e,n){var r=Mi.prefixForPath(e,n.path),i=r[1],o=IDBKeyRange.lowerBound(r),s=!1;return Ti(t).ss({range:o,ns:!0},(function(t,n,r){t[0]===e&&t[1]===i&&(s=!0),r.done()})).next((function(){return s}))}function Ii(t,e,n){var r=t.store(Vi.store),i=t.store(Mi.store),o=[],s=IDBKeyRange.only(n.batchId),u=0,a=r.ss({range:s},(function(t,e,n){return u++,n.delete()}));o.push(a.next((function(){g(1===u)})));for(var c=[],h=0,f=n.mutations;h<f.length;h++){var l=f[h],p=Mi.key(e,l.key.path,n.batchId);o.push(i.delete(p)),c.push(l.key)}return lr.xn(o).next((function(){return c}))}function Ei(t){return oo.Un(t,Vi.store)}function Ti(t){return oo.Un(t,Mi.store)}function Ni(t){return oo.Un(t,Pi.store)}var Ai=function(){function t(t,e){this.serializer=t,this.Sr=e}return t.prototype.Tr=function(t,e,n){return Di(t).put(xi(e),n)},t.prototype.Ir=function(t,e){var n=Di(t),r=xi(e);return n.delete(r)},t.prototype.updateMetadata=function(t,e){var n=this;return this.getMetadata(t).next((function(r){return r.byteSize+=e,n.Yo(t,r)}))},t.prototype.Ar=function(t,e){var n=this;return Di(t).get(xi(e)).next((function(t){return n.Jo(t)}))},t.prototype.Xo=function(t,e){var n=this;return Di(t).get(xi(e)).next((function(t){var e=n.Jo(t);return e?{Zo:e,size:ki(t)}:null}))},t.prototype.getEntries=function(t,e){var n=this,r=Dt();return this.ta(t,e,(function(t,e){var i=n.Jo(e);r=r.rt(t,i)})).next((function(){return r}))},t.prototype.ea=function(t,e){var n=this,r=Dt(),i=new bt(A.i);return this.ta(t,e,(function(t,e){var o=n.Jo(e);o?(r=r.rt(t,o),i=i.rt(t,ki(e))):(r=r.rt(t,null),i=i.rt(t,0))})).next((function(){return{na:r,sa:i}}))},t.prototype.ta=function(t,e,n){if(e.m())return lr.resolve();var r=IDBKeyRange.bound(e.first().path.A(),e.last().path.A()),i=e.lt(),o=i.Et();return Di(t).ss({range:r},(function(t,e,r){for(var s=A.$(t);o&&A.i(o,s)<0;)n(o,null),o=i.Et();o&&o.isEqual(s)&&(n(o,e),o=i.It()?i.Et():null),o?r.Jn(o.path.A()):r.done()})).next((function(){for(;o;)n(o,null),o=i.It()?i.Et():null}))},t.prototype.Or=function(t,e,n){var r=this,i=kt(),o=e.path.length+1,s={};if(n.isEqual(st.min())){var u=e.path.A();s.range=IDBKeyRange.lowerBound(u)}else{var a=e.path.A(),c=pi(n);s.range=IDBKeyRange.lowerBound([a,c],!0),s.index=Gi.collectionReadTimeIndex}return Di(t).ss(s,(function(t,n,s){if(t.length===o){var u=fi(r.serializer,n);e.path.T(u.key.path)?u instanceof Sn&&Wn(e,u)&&(i=i.rt(u.key,u)):s.done()}})).next((function(){return i}))},t.prototype.ia=function(t,e){var n=this,r=St(),i=pi(e),o=Di(t),s=IDBKeyRange.lowerBound(i,!0);return o.ss({index:Gi.readTimeIndex,range:s},(function(t,e){var o=fi(n.serializer,e);r=r.rt(o.key,o),i=e.readTime})).next((function(){return{ra:r,readTime:di(i)}}))},t.prototype.oa=function(t){var e=Di(t),n=st.min();return e.ss({index:Gi.readTimeIndex,reverse:!0},(function(t,e,r){e.readTime&&(n=di(e.readTime)),r.done()})).next((function(){return n}))},t.prototype.aa=function(e){return new t.ca(this,!!e&&e.ua)},t.prototype.ha=function(t){return this.getMetadata(t).next((function(t){return t.byteSize}))},t.prototype.getMetadata=function(t){return Si(t).get(Bi.key).next((function(t){return g(!!t),t}))},t.prototype.Yo=function(t,e){return Si(t).put(Bi.key,e)},t.prototype.Jo=function(t){if(t){var e=fi(this.serializer,t);return e instanceof Dn&&e.version.isEqual(st.min())?null:e}return null},t}();function Si(t){return oo.Un(t,Bi.store)}function Di(t){return oo.Un(t,Gi.store)}function xi(t){return t.path.A()}function ki(t){var e;if(t.document)e=t.document;else if(t.unknownDocument)e=t.unknownDocument;else{if(!t.noDocument)throw y();e=t.noDocument}return JSON.stringify(e).length}Ai.ca=function(e){function n(t,n){var r=this;return(r=e.call(this)||this).la=t,r.ua=n,r._a=new it((function(t){return t.toString()}),(function(t,e){return t.isEqual(e)})),r}return t.__extends(n,e),n.prototype.gr=function(t){var e=this,n=[],r=0,i=new Tt((function(t,e){return Y(t.R(),e.R())}));return this.dr.forEach((function(o,s){var u=e._a.get(o);if(s){var a=li(e.la.serializer,s,e.readTime);i=i.add(o.path.h());var c=ki(a);r+=c-u,n.push(e.la.Tr(t,o,a))}else if(r-=u,e.ua){var h=li(e.la.serializer,new Dn(o,st.min()),e.readTime);n.push(e.la.Tr(t,o,h))}else n.push(e.la.Ir(t,o))})),i.forEach((function(r){n.push(e.la.Sr.ko(t,r))})),n.push(this.la.updateMetadata(t,r)),lr.xn(n)},n.prototype.Rr=function(t,e){var n=this;return this.la.Xo(t,e).next((function(t){return null===t?(n._a.set(e,0),null):(n._a.set(e,t.size),t.Zo)}))},n.prototype.Pr=function(t,e){var n=this;return this.la.ea(t,e).next((function(t){var e=t.na;return t.sa.forEach((function(t,e){n._a.set(t,e)})),e}))},n}(Hr);var Li=function(){function t(){this.fa=new Oi}return t.prototype.ko=function(t,e){return this.fa.add(e),lr.resolve()},t.prototype.Ur=function(t,e){return lr.resolve(this.fa.getEntries(e))},t}(),Oi=function(){function t(){this.index={}}return t.prototype.add=function(t){var e=t._(),n=t.h(),r=this.index[e]||new Tt(E.i),i=!r.has(n);return this.index[e]=r.add(n),i},t.prototype.has=function(t){var e=t._(),n=t.h(),r=this.index[e];return r&&r.has(n)},t.prototype.getEntries=function(t){return(this.index[t]||new Tt(E.i)).A()},t}(),Ri=function(){function t(t){this.serializer=t}return t.prototype.createOrUpgrade=function(t,e,n,r){var i=this;g(n<r&&n>=0&&r<=10);var o=new gr(e);n<1&&r>=1&&(function(t){t.createObjectStore(Ci.store)}(t),function(t){t.createObjectStore(Pi.store,{keyPath:Pi.keyPath}),t.createObjectStore(Vi.store,{keyPath:Vi.keyPath,autoIncrement:!0}).createIndex(Vi.userMutationsIndex,Vi.userMutationsKeyPath,{unique:!0}),t.createObjectStore(Mi.store)}(t),Ki(t),function(t){t.createObjectStore(Gi.store)}(t));var s=lr.resolve();return n<3&&r>=3&&(0!==n&&(function(t){t.deleteObjectStore(zi.store),t.deleteObjectStore(ji.store),t.deleteObjectStore(Qi.store)}(t),Ki(t)),s=s.next((function(){return function(t){var e=t.store(Qi.store),n=new Qi(0,0,st.min().X(),0);return e.put(Qi.key,n)}(o)}))),n<4&&r>=4&&(0!==n&&(s=s.next((function(){return function(t,e){return e.store(Vi.store).Zn().next((function(n){t.deleteObjectStore(Vi.store),t.createObjectStore(Vi.store,{keyPath:Vi.keyPath,autoIncrement:!0}).createIndex(Vi.userMutationsIndex,Vi.userMutationsKeyPath,{unique:!0});var r=e.store(Vi.store),i=n.map((function(t){return r.put(t)}));return lr.xn(i)}))}(t,o)}))),s=s.next((function(){!function(t){t.createObjectStore(Yi.store,{keyPath:Yi.keyPath})}(t)}))),n<5&&r>=5&&(s=s.next((function(){return i.removeAcknowledgedMutations(o)}))),n<6&&r>=6&&(s=s.next((function(){return function(t){t.createObjectStore(Bi.store)}(t),i.addDocumentGlobal(o)}))),n<7&&r>=7&&(s=s.next((function(){return i.ensureSequenceNumbers(o)}))),n<8&&r>=8&&(s=s.next((function(){return i.createCollectionParentIndex(t,o)}))),n<9&&r>=9&&(s=s.next((function(){!function(t){t.objectStoreNames.contains(\"remoteDocumentChanges\")&&t.deleteObjectStore(\"remoteDocumentChanges\")}(t),function(t){var e=t.objectStore(Gi.store);e.createIndex(Gi.readTimeIndex,Gi.readTimeIndexPath,{unique:!1}),e.createIndex(Gi.collectionReadTimeIndex,Gi.collectionReadTimeIndexPath,{unique:!1})}(e)}))),n<10&&r>=10&&(s=s.next((function(){return i.rewriteCanonicalIds(o)}))),s},t.prototype.addDocumentGlobal=function(t){var e=0;return t.store(Gi.store).ss((function(t,n){e+=ki(n)})).next((function(){var n=new Bi(e);return t.store(Bi.store).put(Bi.key,n)}))},t.prototype.removeAcknowledgedMutations=function(t){var e=this,n=t.store(Pi.store),r=t.store(Vi.store);return n.Zn().next((function(n){return lr.forEach(n,(function(n){var i=IDBKeyRange.bound([n.userId,-1],[n.userId,n.lastAcknowledgedBatchId]);return r.Zn(Vi.userMutationsIndex,i).next((function(r){return lr.forEach(r,(function(r){g(r.userId===n.userId);var i=gi(e.serializer,r);return Ii(t,n.userId,i).next((function(){}))}))}))}))}))},t.prototype.ensureSequenceNumbers=function(t){var e=t.store(zi.store),n=t.store(Gi.store);return t.store(Qi.store).get(Qi.key).next((function(t){var r=[];return n.ss((function(n,i){var o=new E(n),s=function(t){return[0,si(t)]}(o);r.push(e.get(s).next((function(n){return n?lr.resolve():function(n){return e.put(new zi(0,si(n),t.highestListenSequenceNumber))}(o)})))})).next((function(){return lr.xn(r)}))}))},t.prototype.createCollectionParentIndex=function(t,e){t.createObjectStore(Wi.store,{keyPath:Wi.keyPath});var n=e.store(Wi.store),r=new Oi,i=function(t){if(r.add(t)){var e=t._(),i=t.h();return n.put({collectionId:e,parent:si(i)})}};return e.store(Gi.store).ss({ns:!0},(function(t,e){var n=new E(t);return i(n.h())})).next((function(){return e.store(Mi.store).ss({ns:!0},(function(t,e){var r=ci(t[1]);return i(r.h())}))}))},t.prototype.rewriteCanonicalIds=function(t){var e=this,n=t.store(ji.store);return n.ss((function(t,r){var i=mi(r),o=wi(e.serializer,i);return n.put(o)}))},t}(),Ui=function(t,e){this.seconds=t,this.nanoseconds=e},Ci=function(t,e,n){this.ownerId=t,this.allowTabSynchronization=e,this.leaseTimestampMs=n};Ci.store=\"owner\",Ci.key=\"owner\";var Pi=function(t,e,n){this.userId=t,this.lastAcknowledgedBatchId=e,this.lastStreamToken=n};Pi.store=\"mutationQueues\",Pi.keyPath=\"userId\";var Vi=function(t,e,n,r,i){this.userId=t,this.batchId=e,this.localWriteTimeMs=n,this.baseMutations=r,this.mutations=i};Vi.store=\"mutations\",Vi.keyPath=\"batchId\",Vi.userMutationsIndex=\"userMutationsIndex\",Vi.userMutationsKeyPath=[\"userId\",\"batchId\"];var Mi=function(){function t(){}return t.prefixForUser=function(t){return[t]},t.prefixForPath=function(t,e){return[t,si(e)]},t.key=function(t,e,n){return[t,si(e),n]},t}();Mi.store=\"documentMutations\",Mi.PLACEHOLDER=new Mi;var Fi=function(t,e){this.path=t,this.readTime=e},qi=function(t,e){this.path=t,this.version=e},Gi=function(t,e,n,r,i,o){this.unknownDocument=t,this.noDocument=e,this.document=n,this.hasCommittedMutations=r,this.readTime=i,this.parentPath=o};Gi.store=\"remoteDocuments\",Gi.readTimeIndex=\"readTimeIndex\",Gi.readTimeIndexPath=\"readTime\",Gi.collectionReadTimeIndex=\"collectionReadTimeIndex\",Gi.collectionReadTimeIndexPath=[\"parentPath\",\"readTime\"];var Bi=function(t){this.byteSize=t};Bi.store=\"remoteDocumentGlobal\",Bi.key=\"remoteDocumentGlobalKey\";var ji=function(t,e,n,r,i,o,s){this.targetId=t,this.canonicalId=e,this.readTime=n,this.resumeToken=r,this.lastListenSequenceNumber=i,this.lastLimboFreeSnapshotVersion=o,this.query=s};ji.store=\"targets\",ji.keyPath=\"targetId\",ji.queryTargetsIndexName=\"queryTargetsIndex\",ji.queryTargetsKeyPath=[\"canonicalId\",\"targetId\"];var zi=function(t,e,n){this.targetId=t,this.path=e,this.sequenceNumber=n};zi.store=\"targetDocuments\",zi.keyPath=[\"targetId\",\"path\"],zi.documentTargetsIndex=\"documentTargetsIndex\",zi.documentTargetsKeyPath=[\"path\",\"targetId\"];var Qi=function(t,e,n,r){this.highestTargetId=t,this.highestListenSequenceNumber=e,this.lastRemoteSnapshotVersion=n,this.targetCount=r};Qi.key=\"targetGlobalKey\",Qi.store=\"targetGlobal\";var Wi=function(t,e){this.collectionId=t,this.parent=e};function Ki(t){t.createObjectStore(zi.store,{keyPath:zi.keyPath}).createIndex(zi.documentTargetsIndex,zi.documentTargetsKeyPath,{unique:!0}),t.createObjectStore(ji.store,{keyPath:ji.keyPath}).createIndex(ji.queryTargetsIndexName,ji.queryTargetsKeyPath,{unique:!0}),t.createObjectStore(Qi.store)}Wi.store=\"collectionParents\",Wi.keyPath=[\"collectionId\",\"parent\"];var Yi=function(t,e,n,r){this.clientId=t,this.updateTimeMs=e,this.networkEnabled=n,this.inForeground=r};Yi.store=\"clientMetadata\",Yi.keyPath=\"clientId\";var Hi=t.__spreadArrays(t.__spreadArrays(t.__spreadArrays([Pi.store,Vi.store,Mi.store,Gi.store,ji.store,Ci.store,Qi.store,zi.store],[Yi.store]),[Bi.store]),[Wi.store]),$i=function(){function t(){this.da=new Oi}return t.prototype.ko=function(t,e){var n=this;if(!this.da.has(e)){var r=e._(),i=e.h();t.Vr((function(){n.da.add(e)}));var o={collectionId:r,parent:si(i)};return Xi(t).put(o)}return lr.resolve()},t.prototype.Ur=function(t,e){var n=[],r=IDBKeyRange.bound([e,\"\"],[$(e),\"\"],!1,!0);return Xi(t).Zn(r).next((function(t){for(var r=0,i=t;r<i.length;r++){var o=i[r];if(o.collectionId!==e)break;n.push(ci(o.parent))}return n}))},t}();function Xi(t){return oo.Un(t,Wi.store)}var Ji=function(){function t(t){this.wa=t}return t.prototype.next=function(){return this.wa+=2,this.wa},t.ma=function(){return new t(0)},t.Ta=function(){return new t(-1)},t}(),Zi=function(){function t(t,e){this.Co=t,this.serializer=e}return t.prototype.Ea=function(t){var e=this;return this.Ia(t).next((function(n){var r=new Ji(n.highestTargetId);return n.highestTargetId=r.next(),e.Aa(t,n).next((function(){return n.highestTargetId}))}))},t.prototype.Ra=function(t){return this.Ia(t).next((function(t){return st.Y(new ot(t.lastRemoteSnapshotVersion.seconds,t.lastRemoteSnapshotVersion.nanoseconds))}))},t.prototype.Pa=function(t){return this.Ia(t).next((function(t){return t.highestListenSequenceNumber}))},t.prototype.ga=function(t,e,n){var r=this;return this.Ia(t).next((function(i){return i.highestListenSequenceNumber=e,n&&(i.lastRemoteSnapshotVersion=n.X()),e>i.highestListenSequenceNumber&&(i.highestListenSequenceNumber=e),r.Aa(t,i)}))},t.prototype.ya=function(t,e){var n=this;return this.Va(t,e).next((function(){return n.Ia(t).next((function(r){return r.targetCount+=1,n.pa(e,r),n.Aa(t,r)}))}))},t.prototype.ba=function(t,e){return this.Va(t,e)},t.prototype.va=function(t,e){var n=this;return this.Sa(t,e.targetId).next((function(){return to(t).delete(e.targetId)})).next((function(){return n.Ia(t)})).next((function(e){return g(e.targetCount>0),e.targetCount-=1,n.Aa(t,e)}))},t.prototype.Vo=function(t,e,n){var r=this,i=0,o=[];return to(t).ss((function(s,u){var a=mi(u);a.sequenceNumber<=e&&null===n.get(a.targetId)&&(i++,o.push(r.va(t,a)))})).next((function(){return lr.xn(o)})).next((function(){return i}))},t.prototype.De=function(t,e){return to(t).ss((function(t,n){var r=mi(n);e(r)}))},t.prototype.Ia=function(t){return eo(t).get(Qi.key).next((function(t){return g(null!==t),t}))},t.prototype.Aa=function(t,e){return eo(t).put(Qi.key,e)},t.prototype.Va=function(t,e){return to(t).put(wi(this.serializer,e))},t.prototype.pa=function(t,e){var n=!1;return t.targetId>e.highestTargetId&&(e.highestTargetId=t.targetId,n=!0),t.sequenceNumber>e.highestListenSequenceNumber&&(e.highestListenSequenceNumber=t.sequenceNumber,n=!0),n},t.prototype.Da=function(t){return this.Ia(t).next((function(t){return t.targetCount}))},t.prototype.Ca=function(t,e){var n=lt(e),r=IDBKeyRange.bound([n,Number.NEGATIVE_INFINITY],[n,Number.POSITIVE_INFINITY]),i=null;return to(t).ss({range:r,index:ji.queryTargetsIndexName},(function(t,n,r){var o=mi(n);pt(e,o.target)&&(i=o,r.done())})).next((function(){return i}))},t.prototype.Na=function(t,e,n){var r=this,i=[],o=no(t);return e.forEach((function(e){var s=si(e.path);i.push(o.put(new zi(n,s))),i.push(r.Co.Fa(t,n,e))})),lr.xn(i)},t.prototype.xa=function(t,e,n){var r=this,i=no(t);return lr.forEach(e,(function(e){var o=si(e.path);return lr.xn([i.delete([n,o]),r.Co.$a(t,n,e)])}))},t.prototype.Sa=function(t,e){var n=no(t),r=IDBKeyRange.bound([e],[e+1],!1,!0);return n.delete(r)},t.prototype.ka=function(t,e){var n=IDBKeyRange.bound([e],[e+1],!1,!0),r=no(t),i=Rt();return r.ss({range:n,ns:!0},(function(t,e,n){var r=ci(t[1]),o=new A(r);i=i.add(o)})).next((function(){return i}))},t.prototype.zo=function(t,e){var n=si(e.path),r=IDBKeyRange.bound([n],[$(n)],!1,!0),i=0;return no(t).ss({index:zi.documentTargetsIndex,ns:!0,range:r},(function(t,e,n){0!==t[0]&&(i++,n.done())})).next((function(){return i>0}))},t.prototype.qe=function(t,e){return to(t).get(e).next((function(t){return t?mi(t):null}))},t}();function to(t){return oo.Un(t,ji.store)}function eo(t){return oo.Un(t,Qi.store)}function no(t){return oo.Un(t,zi.store)}var ro=\"Failed to obtain exclusive access to the persistence layer. To allow shared access, make sure to invoke `enablePersistence()` with `synchronizeTabs:true` in all tabs. If you are using `experimentalForceOwningTab:true`, make sure that only one tab has persistence enabled at any given time.\",io=function(e){function n(t,n){var r=this;return(r=e.call(this)||this).Wo=t,r.Ma=n,r}return t.__extends(n,e),n}(Xr),oo=function(){function e(t,n,r,i,o,s,u,h,f,l){if(this.allowTabSynchronization=t,this.persistenceKey=n,this.clientId=r,this._n=o,this.window=s,this.document=u,this.Oa=f,this.La=l,this.Ba=null,this.qa=!1,this.isPrimary=!1,this.networkEnabled=!0,this.Ua=null,this.inForeground=!1,this.Qa=null,this.Wa=null,this.ja=Number.NEGATIVE_INFINITY,this.Ka=function(t){return Promise.resolve()},!e.On())throw new c(a.UNIMPLEMENTED,\"This platform is either missing IndexedDB or is known to have an incomplete implementation. Offline persistence has been disabled.\");this.Co=new ao(this,i),this.Ga=n+\"main\",this.serializer=new hi(h),this.za=new pr(this.Ga,10,new Ri(this.serializer)),this.Ha=new Zi(this.Co,this.serializer),this.Sr=new $i,this.br=new Ai(this.serializer,this.Sr),this.window&&this.window.localStorage?this.Ya=this.window.localStorage:(this.Ya=null,!1===l&&p(\"IndexedDbPersistence\",\"LocalStorage is unavailable. As a result, persistence may not work reliably. In particular enablePersistence() could fail immediately after refreshing the page.\"))}return e.Un=function(t,e){if(t instanceof io)return pr.Un(t.Wo,e);throw y()},e.prototype.start=function(){var t=this;return this.Ja().then((function(){if(!t.isPrimary&&!t.allowTabSynchronization)throw new c(a.FAILED_PRECONDITION,ro);return t.Xa(),t.Za(),t.tc(),t.runTransaction(\"getHighestListenSequenceNumber\",\"readonly\",(function(e){return t.Ha.Pa(e)}))})).then((function(e){t.Ba=new Pr(e,t.Oa)})).then((function(){t.qa=!0})).catch((function(e){return t.za&&t.za.close(),Promise.reject(e)}))},e.prototype.ec=function(e){var n=this;return this.Ka=function(r){return t.__awaiter(n,void 0,void 0,(function(){return t.__generator(this,(function(t){return this.Ti?[2,e(r)]:[2]}))}))},e(this.isPrimary)},e.prototype.nc=function(e){var n=this;this.za.jn((function(r){return t.__awaiter(n,void 0,void 0,(function(){return t.__generator(this,(function(t){switch(t.label){case 0:return null===r.newVersion?[4,e()]:[3,2];case 1:t.sent(),t.label=2;case 2:return[2]}}))}))}))},e.prototype.sc=function(e){var n=this;this.networkEnabled!==e&&(this.networkEnabled=e,this._n.ds((function(){return t.__awaiter(n,void 0,void 0,(function(){return t.__generator(this,(function(t){switch(t.label){case 0:return this.Ti?[4,this.Ja()]:[3,2];case 1:t.sent(),t.label=2;case 2:return[2]}}))}))})))},e.prototype.Ja=function(){var t=this;return this.runTransaction(\"updateClientMetadataAndTryBecomePrimary\",\"readwrite\",(function(e){return uo(e).put(new Yi(t.clientId,Date.now(),t.networkEnabled,t.inForeground)).next((function(){if(t.isPrimary)return t.ic(e).next((function(e){e||(t.isPrimary=!1,t._n.Ds((function(){return t.Ka(!1)})))}))})).next((function(){return t.rc(e)})).next((function(n){return t.isPrimary&&!n?t.oc(e).next((function(){return!1})):!!n&&t.ac(e).next((function(){return!0}))}))})).catch((function(e){if(yr(e))return l(\"IndexedDbPersistence\",\"Failed to extend owner lease: \",e),t.isPrimary;if(!t.allowTabSynchronization)throw e;return l(\"IndexedDbPersistence\",\"Releasing owner lease after error during lease refresh\",e),!1})).then((function(e){t.isPrimary!==e&&t._n.Ds((function(){return t.Ka(e)})),t.isPrimary=e}))},e.prototype.ic=function(t){var e=this;return so(t).get(Ci.key).next((function(t){return lr.resolve(e.cc(t))}))},e.prototype.uc=function(t){return uo(t).delete(this.clientId)},e.prototype.hc=function(){return t.__awaiter(this,void 0,void 0,(function(){var n,r,i,s=this;return t.__generator(this,(function(t){switch(t.label){case 0:return!this.isPrimary||this.lc(this.ja,18e5)?[3,2]:(this.ja=Date.now(),[4,this.runTransaction(\"maybeGarbageCollectMultiClientState\",\"readwrite-primary\",(function(t){var n=e.Un(t,Yi.store);return n.Zn().next((function(t){var e=s._c(t,18e5),r=t.filter((function(t){return-1===e.indexOf(t)}));return lr.forEach(r,(function(t){return n.delete(t.clientId)})).next((function(){return r}))}))})).catch((function(){return[]}))]);case 1:if(n=t.sent(),this.Ya)for(r=0,i=n;r<i.length;r++)this.Ya.removeItem(this.fc(i[r].clientId));t.label=2;case 2:return[2]}}))}))},e.prototype.tc=function(){var t=this;this.Wa=this._n.gn(\"client_metadata_refresh\",4e3,(function(){return t.Ja().then((function(){return t.hc()})).then((function(){return t.tc()}))}))},e.prototype.cc=function(t){return!!t&&t.ownerId===this.clientId},e.prototype.rc=function(t){var e=this;return this.La?lr.resolve(!0):so(t).get(Ci.key).next((function(n){if(null!==n&&e.lc(n.leaseTimestampMs,5e3)&&!e.dc(n.ownerId)){if(e.cc(n)&&e.networkEnabled)return!0;if(!e.cc(n)){if(!n.allowTabSynchronization)throw new c(a.FAILED_PRECONDITION,ro);return!1}}return!(!e.networkEnabled||!e.inForeground)||uo(t).Zn().next((function(t){return void 0===e._c(t,5e3).find((function(t){return!(e.clientId===t.clientId||!(!e.networkEnabled&&t.networkEnabled||!e.inForeground&&t.inForeground&&e.networkEnabled===t.networkEnabled))}))}))})).next((function(t){return e.isPrimary!==t&&l(\"IndexedDbPersistence\",\"Client \"+(t?\"is\":\"is not\")+\" eligible for a primary lease.\"),t}))},e.prototype.Si=function(){return t.__awaiter(this,void 0,void 0,(function(){var e=this;return t.__generator(this,(function(t){switch(t.label){case 0:return this.qa=!1,this.wc(),this.Wa&&(this.Wa.cancel(),this.Wa=null),this.mc(),this.Tc(),[4,this.za.runTransaction(\"readwrite\",[Ci.store,Yi.store],(function(t){var n=new io(t,Pr.oi);return e.oc(n).next((function(){return e.uc(n)}))}))];case 1:return t.sent(),this.za.close(),this.Ec(),[2]}}))}))},e.prototype._c=function(t,e){var n=this;return t.filter((function(t){return n.lc(t.updateTimeMs,e)&&!n.dc(t.clientId)}))},e.prototype.Vi=function(){var t=this;return this.runTransaction(\"getActiveClients\",\"readonly\",(function(e){return uo(e).Zn().next((function(e){return t._c(e,18e5).map((function(t){return t.clientId}))}))}))},Object.defineProperty(e.prototype,\"Ti\",{get:function(){return this.qa},enumerable:!1,configurable:!0}),e.prototype.Ic=function(t){return _i.Fo(t,this.serializer,this.Sr,this.Co)},e.prototype.Ac=function(){return this.Ha},e.prototype.Rc=function(){return this.br},e.prototype.Pc=function(){return this.Sr},e.prototype.runTransaction=function(t,e,n){var i,r=this;return l(\"IndexedDbPersistence\",\"Starting transaction:\",t),this.za.runTransaction(\"readonly\"===e?\"readonly\":\"readwrite\",Hi,(function(o){return i=new io(o,r.Ba?r.Ba.next():Pr.oi),\"readwrite-primary\"===e?r.ic(i).next((function(t){return!!t||r.rc(i)})).next((function(e){if(!e)throw p(\"Failed to obtain primary lease for action '\"+t+\"'.\"),r.isPrimary=!1,r._n.Ds((function(){return r.Ka(!1)})),new c(a.FAILED_PRECONDITION,$r);return n(i)})).next((function(t){return r.ac(i).next((function(){return t}))})):r.gc(i).next((function(){return n(i)}))})).then((function(t){return i.pr(),t}))},e.prototype.gc=function(t){var e=this;return so(t).get(Ci.key).next((function(t){if(null!==t&&e.lc(t.leaseTimestampMs,5e3)&&!e.dc(t.ownerId)&&!e.cc(t)&&!(e.La||e.allowTabSynchronization&&t.allowTabSynchronization))throw new c(a.FAILED_PRECONDITION,ro)}))},e.prototype.ac=function(t){var e=new Ci(this.clientId,this.allowTabSynchronization,Date.now());return so(t).put(Ci.key,e)},e.On=function(){return pr.On()},e.prototype.oc=function(t){var e=this,n=so(t);return n.get(Ci.key).next((function(t){return e.cc(t)?(l(\"IndexedDbPersistence\",\"Releasing primary lease.\"),n.delete(Ci.key)):lr.resolve()}))},e.prototype.lc=function(t,e){var n=Date.now();return!(t<n-e||t>n&&(p(\"Detected an update time that is in the future: \"+t+\" > \"+n),1))},e.prototype.Xa=function(){var t=this;null!==this.document&&\"function\"==typeof this.document.addEventListener&&(this.Qa=function(){t._n.ds((function(){return t.inForeground=\"visible\"===t.document.visibilityState,t.Ja()}))},this.document.addEventListener(\"visibilitychange\",this.Qa),this.inForeground=\"visible\"===this.document.visibilityState)},e.prototype.mc=function(){this.Qa&&(this.document.removeEventListener(\"visibilitychange\",this.Qa),this.Qa=null)},e.prototype.Za=function(){var t,e=this;\"function\"==typeof(null===(t=this.window)||void 0===t?void 0:t.addEventListener)&&(this.Ua=function(){e.wc(),e._n.ds((function(){return e.Si()}))},this.window.addEventListener(\"unload\",this.Ua))},e.prototype.Tc=function(){this.Ua&&(this.window.removeEventListener(\"unload\",this.Ua),this.Ua=null)},e.prototype.dc=function(t){var e;try{var n=null!==(null===(e=this.Ya)||void 0===e?void 0:e.getItem(this.fc(t)));return l(\"IndexedDbPersistence\",\"Client '\"+t+\"' \"+(n?\"is\":\"is not\")+\" zombied in LocalStorage\"),n}catch(t){return p(\"IndexedDbPersistence\",\"Failed to get zombied client id.\",t),!1}},e.prototype.wc=function(){if(this.Ya)try{this.Ya.setItem(this.fc(this.clientId),String(Date.now()))}catch(t){p(\"Failed to set zombie client id.\",t)}},e.prototype.Ec=function(){if(this.Ya)try{this.Ya.removeItem(this.fc(this.clientId))}catch(t){}},e.prototype.fc=function(t){return\"firestore_zombie_\"+this.persistenceKey+\"_\"+t},e}();function so(t){return oo.Un(t,Ci.store)}function uo(t){return oo.Un(t,Yi.store)}var ao=function(){function t(t,e){this.db=t,this.do=new oi(this,e)}return t.prototype.Ro=function(t){var e=this.yc(t);return this.db.Ac().Da(t).next((function(t){return e.next((function(e){return t+e}))}))},t.prototype.yc=function(t){var e=0;return this.yo(t,(function(t){e++})).next((function(){return e}))},t.prototype.De=function(t,e){return this.db.Ac().De(t,e)},t.prototype.yo=function(t,e){return this.Vc(t,(function(t,n){return e(n)}))},t.prototype.Fa=function(t,e,n){return co(t,n)},t.prototype.$a=function(t,e,n){return co(t,n)},t.prototype.Vo=function(t,e,n){return this.db.Ac().Vo(t,e,n)},t.prototype.Ko=function(t,e){return co(t,e)},t.prototype.bc=function(t,e){return function(t,e){var n=!1;return Ni(t).rs((function(r){return bi(t,r,e).next((function(t){return t&&(n=!0),lr.resolve(!t)}))})).next((function(){return n}))}(t,e)},t.prototype.po=function(t,e){var n=this,r=this.db.Rc().aa(),i=[],o=0;return this.Vc(t,(function(s,u){if(u<=e){var a=n.bc(t,s).next((function(e){if(!e)return o++,r.Ar(t,s).next((function(){return r.Ir(s),no(t).delete([0,si(s.path)])}))}));i.push(a)}})).next((function(){return lr.xn(i)})).next((function(){return r.apply(t)})).next((function(){return o}))},t.prototype.removeTarget=function(t,e){var n=e.nt(t.Ma);return this.db.Ac().ba(t,n)},t.prototype.vc=function(t,e){return co(t,e)},t.prototype.Vc=function(t,e){var n,r=no(t),i=Pr.oi;return r.ss({index:zi.documentTargetsIndex},(function(t,r){var s=r.path,u=r.sequenceNumber;0===t[0]?(i!==Pr.oi&&e(new A(ci(n)),i),i=u,n=s):i=Pr.oi})).next((function(){i!==Pr.oi&&e(new A(ci(n)),i)}))},t.prototype.vo=function(t){return this.db.Rc().ha(t)},t}();function co(t,e){return no(t).put(function(t,e){return new zi(0,si(t.path),e)}(e,t.Ma))}function ho(t,e){var n=t.projectId;return t.W||(n+=\".\"+t.database),\"firestore/\"+e+\"/\"+n+\"/\"}var fo=function(){function t(t,e,n){this.persistence=t,this.Sc=e,this.Dc=new bt(Y),this.Cc=new it((function(t){return lt(t)}),pt),this.Nc=st.min(),this.vr=t.Ic(n),this.Fc=t.Rc(),this.Ha=t.Ac(),this.xc=new Jr(this.Fc,this.vr,this.persistence.Pc()),this.Sc.$c(this.xc)}return t.prototype.Eo=function(t){var e=this;return this.persistence.runTransaction(\"Collect garbage\",\"readwrite-primary\",(function(n){return t.bo(n,e.Dc)}))},t}();function lo(t,e){var n=m(t);return n.persistence.runTransaction(\"Acknowledge batch\",\"readwrite-primary\",(function(t){var r=e.batch.keys(),i=n.Fc.aa({ua:!0});return function(t,e,n,r){var i=n.batch,o=i.keys(),s=lr.resolve();return o.forEach((function(t){s=s.next((function(){return r.Ar(e,t)})).next((function(e){var o=e,s=n._r.get(t);g(null!==s),(!o||o.version.L(s)<0)&&(o=i.ar(t,o,n))&&r.Tr(o,n.lr)}))})),s.next((function(){return t.vr.Qo(e,i)}))}(n,t,e,i).next((function(){return i.apply(t)})).next((function(){return n.vr.Go(t)})).next((function(){return n.xc.$r(t,r)}))}))}function po(t){var e=m(t);return e.persistence.runTransaction(\"Get last remote snapshot version\",\"readonly\",(function(t){return e.Ha.Ra(t)}))}function vo(t,e){var n=m(t),r=e.et,i=n.Dc;return n.persistence.runTransaction(\"Apply remote event\",\"readwrite-primary\",(function(t){var o=n.Fc.aa({ua:!0});i=n.Dc;var s=[];e.Gt.forEach((function(e,o){var u=i.get(o);if(u){s.push(n.Ha.xa(t,e.ne,o).next((function(){return n.Ha.Na(t,e.te,o)})));var a=e.resumeToken;if(a.O()>0){var c=u.st(a,r).nt(t.Ma);i=i.rt(o,c),function(t,e,n){return g(e.resumeToken.O()>0),0===t.resumeToken.O()||e.et.J()-t.et.J()>=3e8||n.te.size+n.ee.size+n.ne.size>0}(u,c,e)&&s.push(n.Ha.ba(t,c))}}}));var u=St(),a=Rt();if(e.Ht.forEach((function(t,e){a=a.add(t)})),s.push(o.getEntries(t,a).next((function(i){e.Ht.forEach((function(a,c){var h=i.get(a);c instanceof Dn&&c.version.isEqual(st.min())?(o.Ir(a,r),u=u.rt(a,c)):null==h||c.version.L(h.version)>0||0===c.version.L(h.version)&&h.hasPendingWrites?(o.Tr(c,r),u=u.rt(a,c)):l(\"LocalStore\",\"Ignoring outdated watch update for \",a,\". Current version:\",h.version,\" Watch version:\",c.version),e.Yt.has(a)&&s.push(n.persistence.Co.vc(t,a))}))}))),!r.isEqual(st.min())){var c=n.Ha.Ra(t).next((function(e){return n.Ha.ga(t,t.Ma,r)}));s.push(c)}return lr.xn(s).next((function(){return o.apply(t)})).next((function(){return n.xc.kr(t,u)}))})).then((function(t){return n.Dc=i,t}))}function yo(t,e){var n=m(t);return n.persistence.runTransaction(\"Get next mutation batch\",\"readonly\",(function(t){return void 0===e&&(e=-1),n.vr.Lo(t,e)}))}function go(t,e){var n=m(t);return n.persistence.runTransaction(\"Allocate target\",\"readwrite\",(function(t){var r;return n.Ha.Ca(t,e).next((function(i){return i?lr.resolve(r=i):n.Ha.Ea(t).next((function(i){return r=new gt(e,i,0,t.Ma),n.Ha.ya(t,r).next((function(){return r}))}))}))})).then((function(t){var r=n.Dc.get(t.targetId);return(null===r||t.et.L(r.et)>0)&&(n.Dc=n.Dc.rt(t.targetId,t),n.Cc.set(e,t.targetId)),t}))}function mo(e,n,r){return t.__awaiter(this,void 0,void 0,(function(){var i,o,s,u;return t.__generator(this,(function(t){switch(t.label){case 0:i=m(e),o=i.Dc.get(n),s=r?\"readwrite\":\"readwrite-primary\",t.label=1;case 1:return t.trys.push([1,4,,5]),r?[3,3]:[4,i.persistence.runTransaction(\"Release target\",s,(function(t){return i.persistence.Co.removeTarget(t,o)}))];case 2:t.sent(),t.label=3;case 3:return[3,5];case 4:if(!yr(u=t.sent()))throw u;return l(\"LocalStore\",\"Failed to update sequence numbers for target \"+n+\": \"+u),[3,5];case 5:return i.Dc=i.Dc.remove(n),i.Cc.delete(o.target),[2]}}))}))}function wo(t,e,n){var r=m(t),i=st.min(),o=Rt();return r.persistence.runTransaction(\"Execute query\",\"readonly\",(function(t){return function(t,e,n){var r=m(t),i=r.Cc.get(n);return void 0!==i?lr.resolve(r.Dc.get(i)):r.Ha.Ca(e,n)}(r,t,Fn(e)).next((function(e){if(e)return i=e.lastLimboFreeSnapshotVersion,r.Ha.ka(t,e.targetId).next((function(t){o=t}))})).next((function(){return r.Sc.Or(t,e,n?i:st.min(),n?o:Rt())})).next((function(t){return{documents:t,kc:o}}))}))}function _o(t,e){var n=m(t),r=m(n.Ha),i=n.Dc.get(e);return i?Promise.resolve(i.target):n.persistence.runTransaction(\"Get target data\",\"readonly\",(function(t){return r.qe(t,e).next((function(t){return t?t.target:null}))}))}function bo(e){return t.__awaiter(this,void 0,void 0,(function(){return t.__generator(this,(function(t){if(e.code!==a.FAILED_PRECONDITION||e.message!==$r)throw e;return l(\"LocalStore\",\"Unexpectedly lost primary lease\"),[2]}))}))}var Io=function(){function t(){this.Mc=new Tt(Eo.Oc),this.Lc=new Tt(Eo.Bc)}return t.prototype.m=function(){return this.Mc.m()},t.prototype.Fa=function(t,e){var n=new Eo(t,e);this.Mc=this.Mc.add(n),this.Lc=this.Lc.add(n)},t.prototype.qc=function(t,e){var n=this;t.forEach((function(t){return n.Fa(t,e)}))},t.prototype.$a=function(t,e){this.Uc(new Eo(t,e))},t.prototype.Qc=function(t,e){var n=this;t.forEach((function(t){return n.$a(t,e)}))},t.prototype.Wc=function(t){var e=this,n=new A(new E([])),r=new Eo(n,t),i=new Eo(n,t+1),o=[];return this.Lc.Nt([r,i],(function(t){e.Uc(t),o.push(t.key)})),o},t.prototype.jc=function(){var t=this;this.Mc.forEach((function(e){return t.Uc(e)}))},t.prototype.Uc=function(t){this.Mc=this.Mc.delete(t),this.Lc=this.Lc.delete(t)},t.prototype.Kc=function(t){var e=new A(new E([])),n=new Eo(e,t),r=new Eo(e,t+1),i=Rt();return this.Lc.Nt([n,r],(function(t){i=i.add(t.key)})),i},t.prototype.zo=function(t){var e=new Eo(t,0),n=this.Mc.xt(e);return null!==n&&t.isEqual(n.key)},t}(),Eo=function(){function t(t,e){this.key=t,this.Gc=e}return t.Oc=function(t,e){return A.i(t.key,e.key)||Y(t.Gc,e.Gc)},t.Bc=function(t,e){return Y(t.Gc,e.Gc)||A.i(t.key,e.key)},t}(),To=function(t,e){this.user=e,this.type=\"OAuth\",this.zc={},this.zc.Authorization=\"Bearer \"+t},No=function(){function t(){this.Hc=null}return t.prototype.getToken=function(){return Promise.resolve(null)},t.prototype.Yc=function(){},t.prototype.Jc=function(t){this.Hc=t,t(Cr.UNAUTHENTICATED)},t.prototype.Xc=function(){this.Hc=null},t}(),Ao=function(){function t(t){var e=this;this.Zc=null,this.currentUser=Cr.UNAUTHENTICATED,this.tu=!1,this.eu=0,this.Hc=null,this.forceRefresh=!1,this.Zc=function(){e.eu++,e.currentUser=e.nu(),e.tu=!0,e.Hc&&e.Hc(e.currentUser)},this.eu=0,this.auth=t.getImmediate({optional:!0}),this.auth?this.auth.addAuthTokenListener(this.Zc):(this.Zc(null),t.get().then((function(t){e.auth=t,e.Zc&&e.auth.addAuthTokenListener(e.Zc)}),(function(){})))}return t.prototype.getToken=function(){var t=this,e=this.eu,n=this.forceRefresh;return this.forceRefresh=!1,this.auth?this.auth.getToken(n).then((function(n){return t.eu!==e?(l(\"FirebaseCredentialsProvider\",\"getToken aborted due to token change.\"),t.getToken()):n?(g(\"string\"==typeof n.accessToken),new To(n.accessToken,t.currentUser)):null})):Promise.resolve(null)},t.prototype.Yc=function(){this.forceRefresh=!0},t.prototype.Jc=function(t){this.Hc=t,this.tu&&t(this.currentUser)},t.prototype.Xc=function(){this.auth&&this.auth.removeAuthTokenListener(this.Zc),this.Zc=null,this.Hc=null},t.prototype.nu=function(){var t=this.auth&&this.auth.getUid();return g(null===t||\"string\"==typeof t),new Cr(t)},t}(),So=function(){function t(t,e){this.su=t,this.iu=e,this.type=\"FirstParty\",this.user=Cr.ei}return Object.defineProperty(t.prototype,\"zc\",{get:function(){var t={\"X-Goog-AuthUser\":this.iu},e=this.su.auth.getAuthHeaderValueForFirstParty([]);return e&&(t.Authorization=e),t},enumerable:!1,configurable:!0}),t}(),Do=function(){function t(t,e){this.su=t,this.iu=e}return t.prototype.getToken=function(){return Promise.resolve(new So(this.su,this.iu))},t.prototype.Jc=function(t){t(Cr.ei)},t.prototype.Xc=function(){},t.prototype.Yc=function(){},t}(),xo=function(){function e(t,e,n,r,i,o){this._n=t,this.ru=n,this.ou=r,this.au=i,this.listener=o,this.state=0,this.cu=0,this.uu=null,this.stream=null,this.gs=new fr(t,e)}return e.prototype.hu=function(){return 1===this.state||2===this.state||4===this.state},e.prototype.lu=function(){return 2===this.state},e.prototype.start=function(){3!==this.state?this.auth():this._u()},e.prototype.stop=function(){return t.__awaiter(this,void 0,void 0,(function(){return t.__generator(this,(function(t){switch(t.label){case 0:return this.hu()?[4,this.close(0)]:[3,2];case 1:t.sent(),t.label=2;case 2:return[2]}}))}))},e.prototype.fu=function(){this.state=0,this.gs.reset()},e.prototype.du=function(){var t=this;this.lu()&&null===this.uu&&(this.uu=this._n.gn(this.ru,6e4,(function(){return t.wu()})))},e.prototype.mu=function(t){this.Tu(),this.stream.send(t)},e.prototype.wu=function(){return t.__awaiter(this,void 0,void 0,(function(){return t.__generator(this,(function(t){return this.lu()?[2,this.close(0)]:[2]}))}))},e.prototype.Tu=function(){this.uu&&(this.uu.cancel(),this.uu=null)},e.prototype.close=function(e,n){return t.__awaiter(this,void 0,void 0,(function(){return t.__generator(this,(function(t){switch(t.label){case 0:return this.Tu(),this.gs.cancel(),this.cu++,3!==e?this.gs.reset():n&&n.code===a.RESOURCE_EXHAUSTED?(p(n.toString()),p(\"Using maximum backoff delay to prevent overloading the backend.\"),this.gs.An()):n&&n.code===a.UNAUTHENTICATED&&this.au.Yc(),null!==this.stream&&(this.Eu(),this.stream.close(),this.stream=null),this.state=e,[4,this.listener.Iu(n)];case 1:return t.sent(),[2]}}))}))},e.prototype.Eu=function(){},e.prototype.auth=function(){var t=this;this.state=1;var e=this.Au(this.cu),n=this.cu;this.au.getToken().then((function(e){t.cu===n&&t.Ru(e)}),(function(n){e((function(){var e=new c(a.UNKNOWN,\"Fetching auth token failed: \"+n.message);return t.Pu(e)}))}))},e.prototype.Ru=function(t){var e=this,n=this.Au(this.cu);this.stream=this.gu(t),this.stream.yu((function(){n((function(){return e.state=2,e.listener.yu()}))})),this.stream.Iu((function(t){n((function(){return e.Pu(t)}))})),this.stream.onMessage((function(t){n((function(){return e.onMessage(t)}))}))},e.prototype._u=function(){var e=this;this.state=4,this.gs.Rn((function(){return t.__awaiter(e,void 0,void 0,(function(){return t.__generator(this,(function(t){return this.state=0,this.start(),[2]}))}))}))},e.prototype.Pu=function(t){return l(\"PersistentStream\",\"close with error: \"+t),this.stream=null,this.close(3,t)},e.prototype.Au=function(t){var e=this;return function(n){e._n.ds((function(){return e.cu===t?n():(l(\"PersistentStream\",\"stream callback skipped by getCloseGuardedDispatcher.\"),Promise.resolve())}))}},e}(),ko=function(e){function n(t,n,r,i,o){var s=this;return(s=e.call(this,t,\"listen_stream_connection_backoff\",\"listen_stream_idle\",n,r,o)||this).serializer=i,s}return t.__extends(n,e),n.prototype.gu=function(t){return this.ou.Vu(\"Listen\",t)},n.prototype.onMessage=function(t){this.gs.reset();var e=function(t,e){var n;if(\"targetChange\"in e){var r=function(t){return\"NO_CHANGE\"===t?0:\"ADD\"===t?1:\"REMOVE\"===t?2:\"CURRENT\"===t?3:\"RESET\"===t?4:y()}(e.targetChange.targetChangeType||\"NO_CHANGE\"),i=e.targetChange.targetIds||[],o=function(t,e){return t.Ue?(g(void 0===e||\"string\"==typeof e),X.fromBase64String(e||\"\")):(g(void 0===e||e instanceof Uint8Array),X.fromUint8Array(e||new Uint8Array))}(t,e.targetChange.resumeToken),s=e.targetChange.cause,u=s&&function(t){var e=void 0===t.code?a.UNKNOWN:_t(t.code);return new c(e,t.message||\"\")}(s);n=new jt(r,i,o,u||null)}else if(\"documentChange\"in e){var h=e.documentChange,f=Ne(t,h.document.name),l=be(h.document.updateTime),p=new En({mapValue:{fields:h.document.fields}}),d=new Sn(f,l,p,{});n=new Gt(h.targetIds||[],h.removedTargetIds||[],d.key,d)}else if(\"documentDelete\"in e){var w=e.documentDelete,_=Ne(t,w.document),b=w.readTime?be(w.readTime):st.min(),I=new Dn(_,b);n=new Gt([],w.removedTargetIds||[],I.key,I)}else if(\"documentRemove\"in e){var T=e.documentRemove,N=Ne(t,T.document);n=new Gt([],T.removedTargetIds||[],N,null)}else{if(!(\"filter\"in e))return y();var S=e.filter,x=new mt(S.count||0);n=new Bt(S.targetId,x)}return n}(this.serializer,t),n=function(t){if(!(\"targetChange\"in t))return st.min();var e=t.targetChange;return e.targetIds&&e.targetIds.length?st.min():e.readTime?be(e.readTime):st.min()}(t);return this.listener.pu(e,n)},n.prototype.bu=function(t){var e={};e.database=De(this.serializer),e.addTarget=function(t,e){var n,r=e.target;return(n=dt(r)?{documents:Re(t,r)}:{query:Ue(t,r)}).targetId=e.targetId,e.resumeToken.O()>0&&(n.resumeToken=we(t,e.resumeToken)),n}(this.serializer,t);var n=function(t,e){var n=function(t,e){switch(e){case 0:return null;case 1:return\"existence-filter-mismatch\";case 2:return\"limbo-document\";default:return y()}}(0,e.tt);return null==n?null:{\"goog-listen-tags\":n}}(0,t);n&&(e.labels=n),this.mu(e)},n.prototype.vu=function(t){var e={};e.database=De(this.serializer),e.removeTarget=t,this.mu(e)},n}(xo),Lo=function(e){function n(t,n,r,i,o){var s=this;return(s=e.call(this,t,\"write_stream_connection_backoff\",\"write_stream_idle\",n,r,o)||this).serializer=i,s.Su=!1,s}return t.__extends(n,e),Object.defineProperty(n.prototype,\"Du\",{get:function(){return this.Su},enumerable:!1,configurable:!0}),n.prototype.start=function(){this.Su=!1,this.lastStreamToken=void 0,e.prototype.start.call(this)},n.prototype.Eu=function(){this.Su&&this.Cu([])},n.prototype.gu=function(t){return this.ou.Vu(\"Write\",t)},n.prototype.onMessage=function(t){if(g(!!t.streamToken),this.lastStreamToken=t.streamToken,this.Su){this.gs.reset();var e=function(t,e){return t&&t.length>0?(g(void 0!==e),t.map((function(t){return function(t,e){var n=be(t.updateTime?t.updateTime:e);n.isEqual(st.min())&&(n=be(e));var r=null;return t.transformResults&&t.transformResults.length>0&&(r=t.transformResults),new sn(n,r)}(t,e)}))):[]}(t.writeResults,t.commitTime),n=be(t.commitTime);return this.listener.Nu(n,e)}return g(!t.writeResults||0===t.writeResults.length),this.Su=!0,this.listener.Fu()},n.prototype.xu=function(){var t={};t.database=De(this.serializer),this.mu(t)},n.prototype.Cu=function(t){var e=this,n={streamToken:this.lastStreamToken,writes:t.map((function(t){return Le(e.serializer,t)}))};this.mu(n)},n}(xo),Oo=function(e){function n(t,n,r){var i=this;return(i=e.call(this)||this).credentials=t,i.ou=n,i.serializer=r,i.$u=!1,i}return t.__extends(n,e),n.prototype.ku=function(){if(this.$u)throw new c(a.FAILED_PRECONDITION,\"The client has already been terminated.\")},n.prototype.Mu=function(t,e,n){var r=this;return this.ku(),this.credentials.getToken().then((function(i){return r.ou.Mu(t,e,n,i)})).catch((function(t){throw t.code===a.UNAUTHENTICATED&&r.credentials.Yc(),t}))},n.prototype.Ou=function(t,e,n){var r=this;return this.ku(),this.credentials.getToken().then((function(i){return r.ou.Ou(t,e,n,i)})).catch((function(t){throw t.code===a.UNAUTHENTICATED&&r.credentials.Yc(),t}))},n.prototype.terminate=function(){this.$u=!1},n}((function(){})),Ro=function(){function t(t,e){this.os=t,this.fi=e,this.state=\"Unknown\",this.Lu=0,this.Bu=null,this.qu=!0}return t.prototype.Uu=function(){var t=this;0===this.Lu&&(this.Qu(\"Unknown\"),this.Bu=this.os.gn(\"online_state_timeout\",1e4,(function(){return t.Bu=null,t.Wu(\"Backend didn't respond within 10 seconds.\"),t.Qu(\"Offline\"),Promise.resolve()})))},t.prototype.ju=function(t){\"Online\"===this.state?this.Qu(\"Unknown\"):(this.Lu++,this.Lu>=1&&(this.Ku(),this.Wu(\"Connection failed 1 times. Most recent error: \"+t.toString()),this.Qu(\"Offline\")))},t.prototype.set=function(t){this.Ku(),this.Lu=0,\"Online\"===t&&(this.qu=!1),this.Qu(t)},t.prototype.Qu=function(t){t!==this.state&&(this.state=t,this.fi(t))},t.prototype.Wu=function(t){var e=\"Could not reach Cloud Firestore backend. \"+t+\"\\nThis typically indicates that your device does not have a healthy Internet connection at the moment. The client will operate in offline mode until it is able to successfully connect to the backend.\";this.qu?(p(e),this.qu=!1):l(\"OnlineStateTracker\",e)},t.prototype.Ku=function(){null!==this.Bu&&(this.Bu.cancel(),this.Bu=null)},t}(),Uo=function(e,n,r,i,o){var s=this;this.Gu=e,this.zu=n,this.os=r,this.Hu={},this.Yu=[],this.Ju=new Map,this.Xu=new Set,this.Zu=[],this.th=o,this.th.eh((function(e){r.ds((function(){return t.__awaiter(s,void 0,void 0,(function(){return t.__generator(this,(function(e){switch(e.label){case 0:return zo(this)?(l(\"RemoteStore\",\"Restarting streams for network reachability change.\"),[4,function(e){return t.__awaiter(this,void 0,void 0,(function(){var n;return t.__generator(this,(function(t){switch(t.label){case 0:return(n=m(e)).Xu.add(4),[4,Po(n)];case 1:return t.sent(),n.nh.set(\"Unknown\"),n.Xu.delete(4),[4,Co(n)];case 2:return t.sent(),[2]}}))}))}(this)]):[3,2];case 1:e.sent(),e.label=2;case 2:return[2]}}))}))}))})),this.nh=new Ro(r,i)};function Co(e){return t.__awaiter(this,void 0,void 0,(function(){var n,r;return t.__generator(this,(function(t){switch(t.label){case 0:if(!zo(e))return[3,4];n=0,r=e.Zu,t.label=1;case 1:return n<r.length?[4,(0,r[n])(!0)]:[3,4];case 2:t.sent(),t.label=3;case 3:return n++,[3,1];case 4:return[2]}}))}))}function Po(e){return t.__awaiter(this,void 0,void 0,(function(){var n,r;return t.__generator(this,(function(t){switch(t.label){case 0:n=0,r=e.Zu,t.label=1;case 1:return n<r.length?[4,(0,r[n])(!1)]:[3,4];case 2:t.sent(),t.label=3;case 3:return n++,[3,1];case 4:return[2]}}))}))}function Vo(e){return t.__awaiter(this,void 0,void 0,(function(){var n;return t.__generator(this,(function(t){switch(t.label){case 0:return n=m(e),l(\"RemoteStore\",\"RemoteStore shutting down.\"),n.Xu.add(5),[4,Po(n)];case 1:return t.sent(),n.th.Si(),n.nh.set(\"Unknown\"),[2]}}))}))}function Mo(t,e){var n=m(t);n.Ju.has(e.targetId)||(n.Ju.set(e.targetId,e),jo(n)?Bo(n):os(n).lu()&&qo(n,e))}function Fo(t,e){var n=m(t),r=os(n);n.Ju.delete(e),r.lu()&&Go(n,e),0===n.Ju.size&&(r.lu()?r.du():zo(n)&&n.nh.set(\"Unknown\"))}function qo(t,e){t.sh.Ee(e.targetId),os(t).bu(e)}function Go(t,e){t.sh.Ee(e),os(t).vu(e)}function Bo(t){t.sh=new Qt({Be:function(e){return t.Hu.Be(e)},qe:function(e){return t.Ju.get(e)||null}}),os(t).start(),t.nh.Uu()}function jo(t){return zo(t)&&!os(t).hu()&&t.Ju.size>0}function zo(t){return 0===m(t).Xu.size}function Qo(t){t.sh=void 0}function Wo(e){return t.__awaiter(this,void 0,void 0,(function(){return t.__generator(this,(function(t){return e.Ju.forEach((function(t,n){qo(e,t)})),[2]}))}))}function Ko(e,n){return t.__awaiter(this,void 0,void 0,(function(){return t.__generator(this,(function(t){return Qo(e),jo(e)?(e.nh.ju(n),Bo(e)):e.nh.set(\"Unknown\"),[2]}))}))}function Yo(e,n,r){return t.__awaiter(this,void 0,void 0,(function(){var i,o,s;return t.__generator(this,(function(u){switch(u.label){case 0:if(e.nh.set(\"Online\"),!(n instanceof jt&&2===n.state&&n.cause))return[3,6];u.label=1;case 1:return u.trys.push([1,3,,5]),[4,function(e,n){return t.__awaiter(this,void 0,void 0,(function(){var r,i,o,s;return t.__generator(this,(function(t){switch(t.label){case 0:r=n.cause,i=0,o=n.targetIds,t.label=1;case 1:return i<o.length?e.Ju.has(s=o[i])?[4,e.Hu.ih(s,r)]:[3,3]:[3,5];case 2:t.sent(),e.Ju.delete(s),e.sh.removeTarget(s),t.label=3;case 3:t.label=4;case 4:return i++,[3,1];case 5:return[2]}}))}))}(e,n)];case 2:return u.sent(),[3,5];case 3:return i=u.sent(),l(\"RemoteStore\",\"Failed to remove targets %s: %s \",n.targetIds.join(\",\"),i),[4,Ho(e,i)];case 4:return u.sent(),[3,5];case 5:return[3,13];case 6:if(n instanceof Gt?e.sh.pe(n):n instanceof Bt?e.sh.xe(n):e.sh.Se(n),r.isEqual(st.min()))return[3,13];u.label=7;case 7:return u.trys.push([7,11,,13]),[4,po(e.Gu)];case 8:return o=u.sent(),r.L(o)>=0?[4,function(t,e){var n=t.sh.Me(e);return n.Gt.forEach((function(n,r){if(n.resumeToken.O()>0){var i=t.Ju.get(r);i&&t.Ju.set(r,i.st(n.resumeToken,e))}})),n.zt.forEach((function(e){var n=t.Ju.get(e);if(n){t.Ju.set(e,n.st(X.B,n.et)),Go(t,e);var r=new gt(n.target,e,1,n.sequenceNumber);qo(t,r)}})),t.Hu.rh(n)}(e,r)]:[3,10];case 9:u.sent(),u.label=10;case 10:return[3,13];case 11:return l(\"RemoteStore\",\"Failed to raise snapshot:\",s=u.sent()),[4,Ho(e,s)];case 12:return u.sent(),[3,13];case 13:return[2]}}))}))}function Ho(e,n,r){return t.__awaiter(this,void 0,void 0,(function(){var i=this;return t.__generator(this,(function(o){switch(o.label){case 0:if(!yr(n))throw n;return e.Xu.add(1),[4,Po(e)];case 1:return o.sent(),e.nh.set(\"Offline\"),r||(r=function(){return po(e.Gu)}),e.os.Ds((function(){return t.__awaiter(i,void 0,void 0,(function(){return t.__generator(this,(function(t){switch(t.label){case 0:return l(\"RemoteStore\",\"Retrying IndexedDB access\"),[4,r()];case 1:return t.sent(),e.Xu.delete(1),[4,Co(e)];case 2:return t.sent(),[2]}}))}))})),[2]}}))}))}function $o(t,e){return e().catch((function(n){return Ho(t,n,e)}))}function Xo(e){return t.__awaiter(this,void 0,void 0,(function(){var n,r,i,o,s;return t.__generator(this,(function(t){switch(t.label){case 0:n=m(e),r=ss(n),i=n.Yu.length>0?n.Yu[n.Yu.length-1].batchId:-1,t.label=1;case 1:if(!function(t){return zo(t)&&t.Yu.length<10}(n))return[3,7];t.label=2;case 2:return t.trys.push([2,4,,6]),[4,yo(n.Gu,i)];case 3:return null===(o=t.sent())?(0===n.Yu.length&&r.du(),[3,7]):(i=o.batchId,function(t,e){t.Yu.push(e);var n=ss(t);n.lu()&&n.Du&&n.Cu(e.mutations)}(n,o),[3,6]);case 4:return s=t.sent(),[4,Ho(n,s)];case 5:return t.sent(),[3,6];case 6:return[3,1];case 7:return Jo(n)&&Zo(n),[2]}}))}))}function Jo(t){return zo(t)&&!ss(t).hu()&&t.Yu.length>0}function Zo(t){ss(t).start()}function ts(e){return t.__awaiter(this,void 0,void 0,(function(){return t.__generator(this,(function(t){return ss(e).xu(),[2]}))}))}function es(e){return t.__awaiter(this,void 0,void 0,(function(){var n,r,i;return t.__generator(this,(function(t){for(n=ss(e),r=0,i=e.Yu;r<i.length;r++)n.Cu(i[r].mutations);return[2]}))}))}function ns(e,n,r){return t.__awaiter(this,void 0,void 0,(function(){var i,o;return t.__generator(this,(function(t){switch(t.label){case 0:return i=e.Yu.shift(),o=Yr.from(i,n,r),[4,$o(e,(function(){return e.Hu.oh(o)}))];case 1:return t.sent(),[4,Xo(e)];case 2:return t.sent(),[2]}}))}))}function rs(e,n){return t.__awaiter(this,void 0,void 0,(function(){return t.__generator(this,(function(r){switch(r.label){case 0:return n&&ss(e).Du?[4,function(e,n){return t.__awaiter(this,void 0,void 0,(function(){var r,i;return t.__generator(this,(function(t){switch(t.label){case 0:return wt(i=n.code)&&i!==a.ABORTED?(r=e.Yu.shift(),ss(e).fu(),[4,$o(e,(function(){return e.Hu.ah(r.batchId,n)}))]):[3,3];case 1:return t.sent(),[4,Xo(e)];case 2:t.sent(),t.label=3;case 3:return[2]}}))}))}(e,n)]:[3,2];case 1:r.sent(),r.label=2;case 2:return Jo(e)&&Zo(e),[2]}}))}))}function is(e,n){return t.__awaiter(this,void 0,void 0,(function(){var r;return t.__generator(this,(function(t){switch(t.label){case 0:return r=m(e),n?(r.Xu.delete(2),[4,Co(r)]):[3,2];case 1:return t.sent(),[3,5];case 2:return n?[3,4]:(r.Xu.add(2),[4,Po(r)]);case 3:t.sent(),r.nh.set(\"Unknown\"),t.label=4;case 4:t.label=5;case 5:return[2]}}))}))}function os(e){var n=this;return e.uh||(e.uh=function(t,e,n){var r=m(t);return r.ku(),new ko(e,r.ou,r.credentials,r.serializer,n)}(e.zu,e.os,{yu:Wo.bind(null,e),Iu:Ko.bind(null,e),pu:Yo.bind(null,e)}),e.Zu.push((function(r){return t.__awaiter(n,void 0,void 0,(function(){return t.__generator(this,(function(t){switch(t.label){case 0:return r?(e.uh.fu(),jo(e)?Bo(e):e.nh.set(\"Unknown\"),[3,3]):[3,1];case 1:return[4,e.uh.stop()];case 2:t.sent(),Qo(e),t.label=3;case 3:return[2]}}))}))}))),e.uh}function ss(e){var n=this;return e.hh||(e.hh=function(t,e,n){var r=m(t);return r.ku(),new Lo(e,r.ou,r.credentials,r.serializer,n)}(e.zu,e.os,{yu:ts.bind(null,e),Iu:rs.bind(null,e),Fu:es.bind(null,e),Nu:ns.bind(null,e)}),e.Zu.push((function(r){return t.__awaiter(n,void 0,void 0,(function(){return t.__generator(this,(function(t){switch(t.label){case 0:return r?(e.hh.fu(),[4,Xo(e)]):[3,2];case 1:return t.sent(),[3,4];case 2:return[4,e.hh.stop()];case 3:t.sent(),e.Yu.length>0&&(l(\"RemoteStore\",\"Stopping write stream with \"+e.Yu.length+\" pending writes\"),e.Yu=[]),t.label=4;case 4:return[2]}}))}))}))),e.hh}var us=function(t){this.key=t},as=function(t){this.key=t},cs=function(){function t(t,e){this.query=t,this.lh=e,this._h=null,this.Zt=!1,this.fh=Rt(),this.Qt=Rt(),this.dh=Kn(t),this.wh=new Pt(this.dh)}return Object.defineProperty(t.prototype,\"mh\",{get:function(){return this.lh},enumerable:!1,configurable:!0}),t.prototype.Th=function(t,e){var n=this,r=e?e.Eh:new Vt,i=e?e.wh:this.wh,o=e?e.Qt:this.Qt,s=i,u=!1,a=Rn(this.query)&&i.size===this.query.limit?i.last():null,c=Un(this.query)&&i.size===this.query.limit?i.first():null;if(t.ut((function(t,e){var h=i.get(t),f=e instanceof Sn?e:null;f&&(f=Wn(n.query,f)?f:null);var l=!!h&&n.Qt.has(h.key),p=!!f&&(f.Ye||n.Qt.has(f.key)&&f.hasCommittedMutations),d=!1;h&&f?h.data().isEqual(f.data())?l!==p&&(r.track({type:3,doc:f}),d=!0):n.Ih(h,f)||(r.track({type:2,doc:f}),d=!0,(a&&n.dh(f,a)>0||c&&n.dh(f,c)<0)&&(u=!0)):!h&&f?(r.track({type:0,doc:f}),d=!0):h&&!f&&(r.track({type:1,doc:h}),d=!0,(a||c)&&(u=!0)),d&&(f?(s=s.add(f),o=p?o.add(t):o.delete(t)):(s=s.delete(t),o=o.delete(t)))})),Rn(this.query)||Un(this.query))for(;s.size>this.query.limit;){var h=Rn(this.query)?s.last():s.first();s=s.delete(h.key),o=o.delete(h.key),r.track({type:1,doc:h})}return{wh:s,Eh:r,Ah:u,Qt:o}},t.prototype.Ih=function(t,e){return t.Ye&&e.hasCommittedMutations&&!e.Ye},t.prototype.gr=function(t,e,n){var r=this,i=this.wh;this.wh=t.wh,this.Qt=t.Qt;var o=t.Eh.qt();o.sort((function(t,e){return function(t,e){var n=function(t){switch(t){case 0:return 1;case 2:case 3:return 2;case 1:return 0;default:return y()}};return n(t)-n(e)}(t.type,e.type)||r.dh(t.doc,e.doc)})),this.Rh(n);var s=e?this.Ph():[],u=0===this.fh.size&&this.Zt?1:0,a=u!==this._h;return this._h=u,0!==o.length||a?{snapshot:new Mt(this.query,t.wh,i,o,t.Qt,0===u,a,!1),gh:s}:{gh:s}},t.prototype.Us=function(t){return this.Zt&&\"Offline\"===t?(this.Zt=!1,this.gr({wh:this.wh,Eh:new Vt,Qt:this.Qt,Ah:!1},!1)):{gh:[]}},t.prototype.yh=function(t){return!this.lh.has(t)&&!!this.wh.has(t)&&!this.wh.get(t).Ye},t.prototype.Rh=function(t){var e=this;t&&(t.te.forEach((function(t){return e.lh=e.lh.add(t)})),t.ee.forEach((function(t){})),t.ne.forEach((function(t){return e.lh=e.lh.delete(t)})),this.Zt=t.Zt)},t.prototype.Ph=function(){var t=this;if(!this.Zt)return[];var e=this.fh;this.fh=Rt(),this.wh.forEach((function(e){t.yh(e.key)&&(t.fh=t.fh.add(e.key))}));var n=[];return e.forEach((function(e){t.fh.has(e)||n.push(new as(e))})),this.fh.forEach((function(t){e.has(t)||n.push(new us(t))})),n},t.prototype.Vh=function(t){this.lh=t.kc,this.fh=Rt();var e=this.Th(t.documents);return this.gr(e,!0)},t.prototype.ph=function(){return Mt.Kt(this.query,this.wh,this.Qt,0===this._h)},t}(),hs=function(t,e,n){this.query=t,this.targetId=e,this.view=n},fs=function(t){this.key=t,this.bh=!1},ls=function(){function t(t,e,n,r,i,o){this.Gu=t,this.Sh=e,this.Dh=n,this.Ch=r,this.currentUser=i,this.Nh=o,this.Fh={},this.xh=new it((function(t){return zn(t)}),jn),this.$h=new Map,this.kh=[],this.Mh=new bt(A.i),this.Oh=new Map,this.Lh=new Io,this.Bh={},this.qh=new Map,this.Uh=Ji.Ta(),this.onlineState=\"Unknown\",this.Qh=void 0}return Object.defineProperty(t.prototype,\"Wh\",{get:function(){return!0===this.Qh},enumerable:!1,configurable:!0}),t}();function ps(e,n){return t.__awaiter(this,void 0,void 0,(function(){var r,o,s,u,a;return t.__generator(this,(function(t){switch(t.label){case 0:return r=Fs(e),(s=r.xh.get(n))?(r.Ch.Mi(s.targetId),o=s.view.ph(),[3,4]):[3,1];case 1:return[4,go(r.Gu,Fn(n))];case 2:return u=t.sent(),a=r.Ch.Mi(u.targetId),[4,ds(r,n,u.targetId,\"current\"===a)];case 3:o=t.sent(),r.Wh&&Mo(r.Sh,u),t.label=4;case 4:return[2,o]}}))}))}function ds(e,n,r,i){return t.__awaiter(this,void 0,void 0,(function(){var o,s,u,a,c,h;return t.__generator(this,(function(f){switch(f.label){case 0:return e.jh=function(n,r,i){return function(e,n,r,i){return t.__awaiter(this,void 0,void 0,(function(){var o,s,u;return t.__generator(this,(function(t){switch(t.label){case 0:return(o=n.view.Th(r)).Ah?[4,wo(e.Gu,n.query,!1).then((function(t){return n.view.Th(t.documents,o)}))]:[3,2];case 1:o=t.sent(),t.label=2;case 2:return s=i&&i.Gt.get(n.targetId),u=n.view.gr(o,e.Wh,s),[2,(Ns(e,n.targetId,u.gh),u.snapshot)]}}))}))}(e,n,r,i)},[4,wo(e.Gu,n,!0)];case 1:return o=f.sent(),s=new cs(n,o.kc),u=s.Th(o.documents),a=qt.Xt(r,i&&\"Offline\"!==e.onlineState),c=s.gr(u,e.Wh,a),Ns(e,r,c.gh),h=new hs(n,r,s),[2,(e.xh.set(n,h),e.$h.has(r)?e.$h.get(r).push(n):e.$h.set(r,[n]),c.snapshot)]}}))}))}function vs(e,n){return t.__awaiter(this,void 0,void 0,(function(){var r,i,o;return t.__generator(this,(function(t){switch(t.label){case 0:return r=m(e),i=r.xh.get(n),(o=r.$h.get(i.targetId)).length>1?[2,(r.$h.set(i.targetId,o.filter((function(t){return!jn(t,n)}))),void r.xh.delete(n))]:r.Wh?(r.Ch.Li(i.targetId),r.Ch.Ni(i.targetId)?[3,2]:[4,mo(r.Gu,i.targetId,!1).then((function(){r.Ch.qi(i.targetId),Fo(r.Sh,i.targetId),Es(r,i.targetId)})).catch(bo)]):[3,3];case 1:t.sent(),t.label=2;case 2:return[3,5];case 3:return Es(r,i.targetId),[4,mo(r.Gu,i.targetId,!0)];case 4:t.sent(),t.label=5;case 5:return[2]}}))}))}function ys(e,n){return t.__awaiter(this,void 0,void 0,(function(){var r,i;return t.__generator(this,(function(t){switch(t.label){case 0:r=m(e),t.label=1;case 1:return t.trys.push([1,4,,6]),[4,vo(r.Gu,n)];case 2:return i=t.sent(),n.Gt.forEach((function(t,e){var n=r.Oh.get(e);n&&(g(t.te.size+t.ee.size+t.ne.size<=1),t.te.size>0?n.bh=!0:t.ee.size>0?g(n.bh):t.ne.size>0&&(g(n.bh),n.bh=!1))})),[4,Ds(r,i,n)];case 3:return t.sent(),[3,6];case 4:return[4,bo(t.sent())];case 5:return t.sent(),[3,6];case 6:return[2]}}))}))}function gs(t,e,n){var r=m(t);if(r.Wh&&0===n||!r.Wh&&1===n){var i=[];r.xh.forEach((function(t,n){var r=n.view.Us(e);r.snapshot&&i.push(r.snapshot)})),function(t,e){var n=m(t);n.onlineState=e;var r=!1;n.Ls.forEach((function(t,n){for(var i=0,o=n.listeners;i<o.length;i++)o[i].Us(e)&&(r=!0)})),r&&Rr(n)}(r.Dh,e),i.length&&r.Fh.pu(i),r.onlineState=e,r.Wh&&r.Ch.ji(e)}}function ms(e,n,r){return t.__awaiter(this,void 0,void 0,(function(){var i,o,s,u,a,c;return t.__generator(this,(function(t){switch(t.label){case 0:return(i=m(e)).Ch.Ui(n,\"rejected\",r),o=i.Oh.get(n),(s=o&&o.key)?(u=(u=new bt(A.i)).rt(s,new Dn(s,st.min())),a=Rt().add(s),c=new Ft(st.min(),new Map,new Tt(Y),u,a),[4,ys(i,c)]):[3,2];case 1:return t.sent(),i.Mh=i.Mh.remove(s),i.Oh.delete(n),Ss(i),[3,4];case 2:return[4,mo(i.Gu,n,!1).then((function(){return Es(i,n,r)})).catch(bo)];case 3:t.sent(),t.label=4;case 4:return[2]}}))}))}function ws(e,n){return t.__awaiter(this,void 0,void 0,(function(){var r,i,o;return t.__generator(this,(function(t){switch(t.label){case 0:r=m(e),i=n.batch.batchId,t.label=1;case 1:return t.trys.push([1,4,,6]),[4,lo(r.Gu,n)];case 2:return o=t.sent(),Is(r,i,null),bs(r,i),r.Ch.$i(i,\"acknowledged\"),[4,Ds(r,o)];case 3:return t.sent(),[3,6];case 4:return[4,bo(t.sent())];case 5:return t.sent(),[3,6];case 6:return[2]}}))}))}function _s(e,n,r){return t.__awaiter(this,void 0,void 0,(function(){var i,o;return t.__generator(this,(function(t){switch(t.label){case 0:i=m(e),t.label=1;case 1:return t.trys.push([1,4,,6]),[4,function(t,e){var n=m(t);return n.persistence.runTransaction(\"Reject batch\",\"readwrite-primary\",(function(t){var r;return n.vr.Mo(t,e).next((function(e){return g(null!==e),r=e.keys(),n.vr.Qo(t,e)})).next((function(){return n.vr.Go(t)})).next((function(){return n.xc.$r(t,r)}))}))}(i.Gu,n)];case 2:return o=t.sent(),Is(i,n,r),bs(i,n),i.Ch.$i(n,\"rejected\",r),[4,Ds(i,o)];case 3:return t.sent(),[3,6];case 4:return[4,bo(t.sent())];case 5:return t.sent(),[3,6];case 6:return[2]}}))}))}function bs(t,e){(t.qh.get(e)||[]).forEach((function(t){t.resolve()})),t.qh.delete(e)}function Is(t,e,n){var r=m(t),i=r.Bh[r.currentUser.Zs()];if(i){var o=i.get(e);o&&(n?o.reject(n):o.resolve(),i=i.remove(e)),r.Bh[r.currentUser.Zs()]=i}}function Es(t,e,n){void 0===n&&(n=null),t.Ch.Li(e);for(var r=0,i=t.$h.get(e);r<i.length;r++){var o=i[r];t.xh.delete(o),n&&t.Fh.Kh(o,n)}t.$h.delete(e),t.Wh&&t.Lh.Wc(e).forEach((function(e){t.Lh.zo(e)||Ts(t,e)}))}function Ts(t,e){var n=t.Mh.get(e);null!==n&&(Fo(t.Sh,n),t.Mh=t.Mh.remove(e),t.Oh.delete(n),Ss(t))}function Ns(t,e,n){for(var r=0,i=n;r<i.length;r++){var o=i[r];o instanceof us?(t.Lh.Fa(o.key,e),As(t,o)):o instanceof as?(l(\"SyncEngine\",\"Document no longer in limbo: \"+o.key),t.Lh.$a(o.key,e),t.Lh.zo(o.key)||Ts(t,o.key)):y()}}function As(t,e){var n=e.key;t.Mh.get(n)||(l(\"SyncEngine\",\"New document in limbo: \"+n),t.kh.push(n),Ss(t))}function Ss(t){for(;t.kh.length>0&&t.Mh.size<t.Nh;){var e=t.kh.shift(),n=t.Uh.next();t.Oh.set(n,new fs(e)),t.Mh=t.Mh.rt(e,n),Mo(t.Sh,new gt(Fn(On(e.path)),n,2,Pr.oi))}}function Ds(e,n,r){return t.__awaiter(this,void 0,void 0,(function(){var i,o,s,u;return t.__generator(this,(function(a){switch(a.label){case 0:return i=m(e),o=[],s=[],u=[],i.xh.m()?[3,3]:(i.xh.forEach((function(t,e){u.push(i.jh(e,n,r).then((function(t){if(t){i.Wh&&i.Ch.Ui(e.targetId,t.fromCache?\"not-current\":\"current\"),o.push(t);var n=Zr.Gr(e.targetId,t);s.push(n)}})))})),[4,Promise.all(u)]);case 1:return a.sent(),i.Fh.pu(o),[4,function(e,n){return t.__awaiter(this,void 0,void 0,(function(){var r,i,o,s,u,a,c,f;return t.__generator(this,(function(t){switch(t.label){case 0:r=m(e),t.label=1;case 1:return t.trys.push([1,3,,4]),[4,r.persistence.runTransaction(\"notifyLocalViewChanges\",\"readwrite\",(function(t){return lr.forEach(n,(function(e){return lr.forEach(e.jr,(function(n){return r.persistence.Co.Fa(t,e.targetId,n)})).next((function(){return lr.forEach(e.Kr,(function(n){return r.persistence.Co.$a(t,e.targetId,n)}))}))}))}))];case 2:return t.sent(),[3,4];case 3:if(!yr(i=t.sent()))throw i;return l(\"LocalStore\",\"Failed to update sequence numbers: \"+i),[3,4];case 4:for(o=0,s=n;o<s.length;o++)a=(u=s[o]).targetId,u.fromCache||(c=r.Dc.get(a),f=c.it(c.et),r.Dc=r.Dc.rt(a,f));return[2]}}))}))}(i.Gu,s)];case 2:a.sent(),a.label=3;case 3:return[2]}}))}))}function xs(e,n){return t.__awaiter(this,void 0,void 0,(function(){var r,i;return t.__generator(this,(function(o){switch(o.label){case 0:return(r=m(e)).currentUser.isEqual(n)?[3,3]:(l(\"SyncEngine\",\"User change. New user:\",n.Zs()),[4,function(e,n){return t.__awaiter(this,void 0,void 0,(function(){var r,i,o,s;return t.__generator(this,(function(t){switch(t.label){case 0:return r=m(e),i=r.vr,o=r.xc,[4,r.persistence.runTransaction(\"Handle user change\",\"readonly\",(function(t){var e;return r.vr.qo(t).next((function(s){return e=s,i=r.persistence.Ic(n),o=new Jr(r.Fc,i,r.persistence.Pc()),i.qo(t)})).next((function(n){for(var r=[],i=[],s=Rt(),u=0,a=e;u<a.length;u++){var c=a[u];r.push(c.batchId);for(var h=0,f=c.mutations;h<f.length;h++)s=s.add(f[h].key)}for(var p=0,d=n;p<d.length;p++){var v=d[p];i.push(v.batchId);for(var y=0,g=v.mutations;y<g.length;y++)s=s.add(g[y].key)}return o.$r(t,s).next((function(t){return{Gh:t,zh:r,Hh:i}}))}))}))];case 1:return s=t.sent(),[2,(r.vr=i,r.xc=o,r.Sc.$c(r.xc),s)]}}))}))}(r.Gu,n)]);case 1:return i=o.sent(),r.currentUser=n,function(t,e){t.qh.forEach((function(t){t.forEach((function(t){t.reject(new c(a.CANCELLED,\"'waitForPendingWrites' promise is rejected due to a user change.\"))}))})),t.qh.clear()}(r),r.Ch.Wi(n,i.zh,i.Hh),[4,Ds(r,i.Gh)];case 2:o.sent(),o.label=3;case 3:return[2]}}))}))}function ks(t,e){var n=m(t),r=n.Oh.get(e);if(r&&r.bh)return Rt().add(r.key);var i=Rt(),o=n.$h.get(e);if(!o)return i;for(var s=0,u=o;s<u.length;s++){var c=n.xh.get(u[s]);i=i.$t(c.view.mh)}return i}function Ls(e,n){return t.__awaiter(this,void 0,void 0,(function(){var r,i,o;return t.__generator(this,(function(t){switch(t.label){case 0:return[4,wo((r=m(e)).Gu,n.query,!0)];case 1:return i=t.sent(),o=n.view.Vh(i),[2,(r.Wh&&Ns(r,n.targetId,o.gh),o)]}}))}))}function Os(e,n,r,i){return t.__awaiter(this,void 0,void 0,(function(){var o,s;return t.__generator(this,(function(t){switch(t.label){case 0:return[4,function(t,e){var n=m(t),r=m(n.vr);return n.persistence.runTransaction(\"Lookup mutation documents\",\"readonly\",(function(t){return r.Oo(t,e).next((function(e){return e?n.xc.$r(t,e):lr.resolve(null)}))}))}((o=m(e)).Gu,n)];case 1:return null===(s=t.sent())?[3,6]:\"pending\"!==r?[3,3]:[4,Xo(o.Sh)];case 2:return t.sent(),[3,4];case 3:\"acknowledged\"===r||\"rejected\"===r?(Is(o,n,i||null),bs(o,n),function(t,e){m(m(t).vr).jo(e)}(o.Gu,n)):y(),t.label=4;case 4:return[4,Ds(o,s)];case 5:return t.sent(),[3,7];case 6:l(\"SyncEngine\",\"Cannot apply mutation batch with id: \"+n),t.label=7;case 7:return[2]}}))}))}function Rs(e,n){return t.__awaiter(this,void 0,void 0,(function(){var r,i,o,s,u,c,h;return t.__generator(this,(function(t){switch(t.label){case 0:return Fs(r=m(e)),qs(r),!0!==n||!0===r.Qh?[3,3]:(i=r.Ch.Di(),[4,Us(r,i.A())]);case 1:return o=t.sent(),r.Qh=!0,[4,is(r.Sh,!0)];case 2:for(t.sent(),s=0,u=o;s<u.length;s++)Mo(r.Sh,u[s]);return[3,7];case 3:return!1!==n||!1===r.Qh?[3,7]:(c=[],h=Promise.resolve(),r.$h.forEach((function(t,e){r.Ch.Bi(e)?c.push(e):h=h.then((function(){return Es(r,e),mo(r.Gu,e,!0)})),Fo(r.Sh,e)})),[4,h]);case 4:return t.sent(),[4,Us(r,c)];case 5:return t.sent(),function(t){var e=m(t);e.Oh.forEach((function(t,n){Fo(e.Sh,n)})),e.Lh.jc(),e.Oh=new Map,e.Mh=new bt(A.i)}(r),r.Qh=!1,[4,is(r.Sh,!1)];case 6:t.sent(),t.label=7;case 7:return[2]}}))}))}function Us(e,n,r){return t.__awaiter(this,void 0,void 0,(function(){var r,i,o,s,u,a,c,h,f,l,d,v,y;return t.__generator(this,(function(t){switch(t.label){case 0:r=m(e),i=[],o=[],s=0,u=n,t.label=1;case 1:return s<u.length?(c=void 0,(h=r.$h.get(a=u[s]))&&0!==h.length?[4,go(r.Gu,Fn(h[0]))]:[3,7]):[3,13];case 2:c=t.sent(),f=0,l=h,t.label=3;case 3:return f<l.length?(d=r.xh.get(l[f]),[4,Ls(r,d)]):[3,6];case 4:(v=t.sent()).snapshot&&o.push(v.snapshot),t.label=5;case 5:return f++,[3,3];case 6:return[3,11];case 7:return[4,_o(r.Gu,a)];case 8:return y=t.sent(),[4,go(r.Gu,y)];case 9:return c=t.sent(),[4,ds(r,Cs(y),a,!1)];case 10:t.sent(),t.label=11;case 11:i.push(c),t.label=12;case 12:return s++,[3,1];case 13:return[2,(r.Fh.pu(o),i)]}}))}))}function Cs(t){return Ln(t.path,t.collectionGroup,t.orderBy,t.filters,t.limit,\"F\",t.startAt,t.endAt)}function Ps(t){var e=m(t);return m(m(e.Gu).persistence).Vi()}function Vs(e,n,r,i){return t.__awaiter(this,void 0,void 0,(function(){var o,s,u;return t.__generator(this,(function(t){switch(t.label){case 0:return(o=m(e)).Qh?(l(\"SyncEngine\",\"Ignoring unexpected query state notification.\"),[3,8]):[3,1];case 1:if(!o.$h.has(n))return[3,8];switch(r){case\"current\":case\"not-current\":return[3,2];case\"rejected\":return[3,5]}return[3,7];case 2:return[4,function(t){var e=m(t),n=m(e.Fc);return e.persistence.runTransaction(\"Get new document changes\",\"readonly\",(function(t){return n.ia(t,e.Nc)})).then((function(t){var n=t.ra;return e.Nc=t.readTime,n}))}(o.Gu)];case 3:return s=t.sent(),u=Ft.Jt(n,\"current\"===r),[4,Ds(o,s,u)];case 4:return t.sent(),[3,8];case 5:return[4,mo(o.Gu,n,!0)];case 6:return t.sent(),Es(o,n,i),[3,8];case 7:y(),t.label=8;case 8:return[2]}}))}))}function Ms(e,n,r){return t.__awaiter(this,void 0,void 0,(function(){var i,o,s,u,a,c,h,f,p;return t.__generator(this,(function(v){switch(v.label){case 0:if(!(i=Fs(e)).Qh)return[3,10];o=0,s=n,v.label=1;case 1:return o<s.length?i.$h.has(u=s[o])?(l(\"SyncEngine\",\"Adding an already active target \"+u),[3,5]):[4,_o(i.Gu,u)]:[3,6];case 2:return a=v.sent(),[4,go(i.Gu,a)];case 3:return c=v.sent(),[4,ds(i,Cs(a),c.targetId,!1)];case 4:v.sent(),Mo(i.Sh,c),v.label=5;case 5:return o++,[3,1];case 6:h=function(e){return t.__generator(this,(function(t){switch(t.label){case 0:return i.$h.has(e)?[4,mo(i.Gu,e,!1).then((function(){Fo(i.Sh,e),Es(i,e)})).catch(bo)]:[3,2];case 1:t.sent(),t.label=2;case 2:return[2]}}))},f=0,p=r,v.label=7;case 7:return f<p.length?[5,h(p[f])]:[3,10];case 8:v.sent(),v.label=9;case 9:return f++,[3,7];case 10:return[2]}}))}))}function Fs(t){var e=m(t);return e.Sh.Hu.rh=ys.bind(null,e),e.Sh.Hu.Be=ks.bind(null,e),e.Sh.Hu.ih=ms.bind(null,e),e.Fh.pu=Lr.bind(null,e.Dh),e.Fh.Kh=Or.bind(null,e.Dh),e}function qs(t){var e=m(t);return e.Sh.Hu.oh=ws.bind(null,e),e.Sh.Hu.ah=_s.bind(null,e),e}var Gs=function(){function t(){}return t.prototype.$c=function(t){this.Yh=t},t.prototype.Or=function(t,e,r,i){var o=this;return function(t){return 0===t.filters.length&&null===t.limit&&null==t.startAt&&null==t.endAt&&(0===t.rn.length||1===t.rn.length&&t.rn[0].field.p())}(e)||r.isEqual(st.min())?this.Jh(t,e):this.Yh.$r(t,i).next((function(s){var u=o.Xh(e,s);return(Rn(e)||Un(e))&&o.Ah(e.on,u,i,r)?o.Jh(t,e):(f()<=n.LogLevel.DEBUG&&l(\"IndexFreeQueryEngine\",\"Re-using previous result from %s to execute query: %s\",r.toString(),Qn(e)),o.Yh.Or(t,e,r).next((function(t){return u.forEach((function(e){t=t.rt(e.key,e)})),t})))}))},t.prototype.Xh=function(t,e){var n=new Tt(Kn(t));return e.forEach((function(e,r){r instanceof Sn&&Wn(t,r)&&(n=n.add(r))})),n},t.prototype.Ah=function(t,e,n,r){if(n.size!==e.size)return!0;var i=\"F\"===t?e.last():e.first();return!!i&&(i.hasPendingWrites||i.version.L(r)>0)},t.prototype.Jh=function(t,e){return f()<=n.LogLevel.DEBUG&&l(\"IndexFreeQueryEngine\",\"Using full collection scan to execute query:\",Qn(e)),this.Yh.Or(t,e,st.min())},t}(),Bs=function(){function t(t,e){this.Sr=t,this.Co=e,this.vr=[],this.Zh=1,this.tl=new Tt(Eo.Oc)}return t.prototype.xo=function(t){return lr.resolve(0===this.vr.length)},t.prototype.$o=function(t,e,n,r){var i=this.Zh;this.Zh++;var o=new Kr(i,e,n,r);this.vr.push(o);for(var s=0,u=r;s<u.length;s++){var a=u[s];this.tl=this.tl.add(new Eo(a.key,i)),this.Sr.ko(t,a.key.path.h())}return lr.resolve(o)},t.prototype.Mo=function(t,e){return lr.resolve(this.el(e))},t.prototype.Lo=function(t,e){var r=this.nl(e+1),i=r<0?0:r;return lr.resolve(this.vr.length>i?this.vr[i]:null)},t.prototype.Bo=function(){return lr.resolve(0===this.vr.length?-1:this.Zh-1)},t.prototype.qo=function(t){return lr.resolve(this.vr.slice())},t.prototype.Cr=function(t,e){var n=this,r=new Eo(e,0),i=new Eo(e,Number.POSITIVE_INFINITY),o=[];return this.tl.Nt([r,i],(function(t){var e=n.el(t.Gc);o.push(e)})),lr.resolve(o)},t.prototype.Mr=function(t,e){var n=this,r=new Tt(Y);return e.forEach((function(t){var e=new Eo(t,0),i=new Eo(t,Number.POSITIVE_INFINITY);n.tl.Nt([e,i],(function(t){r=r.add(t.Gc)}))})),lr.resolve(this.sl(r))},t.prototype.Qr=function(t,e){var n=e.path,r=n.length+1,i=n;A.F(i)||(i=i.child(\"\"));var o=new Eo(new A(i),0),s=new Tt(Y);return this.tl.Ft((function(t){var e=t.key.path;return!!n.T(e)&&(e.length===r&&(s=s.add(t.Gc)),!0)}),o),lr.resolve(this.sl(s))},t.prototype.sl=function(t){var e=this,n=[];return t.forEach((function(t){var r=e.el(t);null!==r&&n.push(r)})),n},t.prototype.Qo=function(t,e){var n=this;g(0===this.il(e.batchId,\"removed\")),this.vr.shift();var r=this.tl;return lr.forEach(e.mutations,(function(i){var o=new Eo(i.key,e.batchId);return r=r.delete(o),n.Co.Ko(t,i.key)})).next((function(){n.tl=r}))},t.prototype.jo=function(t){},t.prototype.zo=function(t,e){var n=new Eo(e,0),r=this.tl.xt(n);return lr.resolve(e.isEqual(r&&r.key))},t.prototype.Go=function(t){return lr.resolve()},t.prototype.il=function(t,e){return this.nl(t)},t.prototype.nl=function(t){return 0===this.vr.length?0:t-this.vr[0].batchId},t.prototype.el=function(t){var e=this.nl(t);return e<0||e>=this.vr.length?null:this.vr[e]},t}(),js=function(){function t(t,e){this.Sr=t,this.rl=e,this.docs=new bt(A.i),this.size=0}return t.prototype.Tr=function(t,e,n){var r=e.key,i=this.docs.get(r),o=i?i.size:0,s=this.rl(e);return this.docs=this.docs.rt(r,{Zo:e,size:s,readTime:n}),this.size+=s-o,this.Sr.ko(t,r.path.h())},t.prototype.Ir=function(t){var e=this.docs.get(t);e&&(this.docs=this.docs.remove(t),this.size-=e.size)},t.prototype.Ar=function(t,e){var n=this.docs.get(e);return lr.resolve(n?n.Zo:null)},t.prototype.getEntries=function(t,e){var n=this,r=Dt();return e.forEach((function(t){var e=n.docs.get(t);r=r.rt(t,e?e.Zo:null)})),lr.resolve(r)},t.prototype.Or=function(t,e,n){for(var r=kt(),i=new A(e.path.child(\"\")),o=this.docs._t(i);o.It();){var s=o.Et(),a=s.value,c=a.Zo,h=a.readTime;if(!e.path.T(s.key.path))break;h.L(n)<=0||c instanceof Sn&&Wn(e,c)&&(r=r.rt(c.key,c))}return lr.resolve(r)},t.prototype.ol=function(t,e){return lr.forEach(this.docs,(function(t){return e(t)}))},t.prototype.aa=function(e){return new t.ca(this)},t.prototype.ha=function(t){return lr.resolve(this.size)},t}();js.ca=function(e){function n(t){var n=this;return(n=e.call(this)||this).la=t,n}return t.__extends(n,e),n.prototype.gr=function(t){var e=this,n=[];return this.dr.forEach((function(r,i){i?n.push(e.la.Tr(t,i,e.readTime)):e.la.Ir(r)})),lr.xn(n)},n.prototype.Rr=function(t,e){return this.la.Ar(t,e)},n.prototype.Pr=function(t,e){return this.la.getEntries(t,e)},n}(Hr);var zs=function(){function t(t){this.persistence=t,this.al=new it((function(t){return lt(t)}),pt),this.lastRemoteSnapshotVersion=st.min(),this.highestTargetId=0,this.cl=0,this.ul=new Io,this.targetCount=0,this.hl=Ji.ma()}return t.prototype.De=function(t,e){return this.al.forEach((function(t,n){return e(n)})),lr.resolve()},t.prototype.Ra=function(t){return lr.resolve(this.lastRemoteSnapshotVersion)},t.prototype.Pa=function(t){return lr.resolve(this.cl)},t.prototype.Ea=function(t){return this.highestTargetId=this.hl.next(),lr.resolve(this.highestTargetId)},t.prototype.ga=function(t,e,n){return n&&(this.lastRemoteSnapshotVersion=n),e>this.cl&&(this.cl=e),lr.resolve()},t.prototype.Va=function(t){this.al.set(t.target,t);var e=t.targetId;e>this.highestTargetId&&(this.hl=new Ji(e),this.highestTargetId=e),t.sequenceNumber>this.cl&&(this.cl=t.sequenceNumber)},t.prototype.ya=function(t,e){return this.Va(e),this.targetCount+=1,lr.resolve()},t.prototype.ba=function(t,e){return this.Va(e),lr.resolve()},t.prototype.va=function(t,e){return this.al.delete(e.target),this.ul.Wc(e.targetId),this.targetCount-=1,lr.resolve()},t.prototype.Vo=function(t,e,n){var r=this,i=0,o=[];return this.al.forEach((function(s,u){u.sequenceNumber<=e&&null===n.get(u.targetId)&&(r.al.delete(s),o.push(r.Sa(t,u.targetId)),i++)})),lr.xn(o).next((function(){return i}))},t.prototype.Da=function(t){return lr.resolve(this.targetCount)},t.prototype.Ca=function(t,e){var n=this.al.get(e)||null;return lr.resolve(n)},t.prototype.Na=function(t,e,n){return this.ul.qc(e,n),lr.resolve()},t.prototype.xa=function(t,e,n){this.ul.Qc(e,n);var r=this.persistence.Co,i=[];return r&&e.forEach((function(e){i.push(r.Ko(t,e))})),lr.xn(i)},t.prototype.Sa=function(t,e){return this.ul.Wc(e),lr.resolve()},t.prototype.ka=function(t,e){var n=this.ul.Kc(e);return lr.resolve(n)},t.prototype.zo=function(t,e){return lr.resolve(this.ul.zo(e))},t}(),Qs=function(){function t(t){var e=this;this.ll={},this.Ba=new Pr(0),this.qa=!1,this.qa=!0,this.Co=t(this),this.Ha=new zs(this),this.Sr=new Li,this.br=new js(this.Sr,(function(t){return e.Co._l(t)}))}return t.prototype.start=function(){return Promise.resolve()},t.prototype.Si=function(){return this.qa=!1,Promise.resolve()},Object.defineProperty(t.prototype,\"Ti\",{get:function(){return this.qa},enumerable:!1,configurable:!0}),t.prototype.nc=function(){},t.prototype.sc=function(){},t.prototype.Pc=function(){return this.Sr},t.prototype.Ic=function(t){var e=this.ll[t.Zs()];return e||(e=new Bs(this.Sr,this.Co),this.ll[t.Zs()]=e),e},t.prototype.Ac=function(){return this.Ha},t.prototype.Rc=function(){return this.br},t.prototype.runTransaction=function(t,e,n){var r=this;l(\"MemoryPersistence\",\"Starting transaction:\",t);var i=new Ws(this.Ba.next());return this.Co.fl(),n(i).next((function(t){return r.Co.dl(i).next((function(){return t}))})).Nn().then((function(t){return i.pr(),t}))},t.prototype.wl=function(t,e){return lr.$n(Object.values(this.ll).map((function(n){return function(){return n.zo(t,e)}})))},t}(),Ws=function(e){function n(t){var n=this;return(n=e.call(this)||this).Ma=t,n}return t.__extends(n,e),n}(Xr),Ks=function(){function t(t){this.persistence=t,this.ml=new Io,this.Tl=null}return t.El=function(e){return new t(e)},Object.defineProperty(t.prototype,\"Il\",{get:function(){if(this.Tl)return this.Tl;throw y()},enumerable:!1,configurable:!0}),t.prototype.Fa=function(t,e,n){return this.ml.Fa(n,e),this.Il.delete(n.toString()),lr.resolve()},t.prototype.$a=function(t,e,n){return this.ml.$a(n,e),this.Il.add(n.toString()),lr.resolve()},t.prototype.Ko=function(t,e){return this.Il.add(e.toString()),lr.resolve()},t.prototype.removeTarget=function(t,e){var n=this;this.ml.Wc(e.targetId).forEach((function(t){return n.Il.add(t.toString())}));var r=this.persistence.Ac();return r.ka(t,e.targetId).next((function(t){t.forEach((function(t){return n.Il.add(t.toString())}))})).next((function(){return r.va(t,e)}))},t.prototype.fl=function(){this.Tl=new Set},t.prototype.dl=function(t){var e=this,n=this.persistence.Rc().aa();return lr.forEach(this.Il,(function(r){var i=A.D(r);return e.Al(t,i).next((function(t){t||n.Ir(i)}))})).next((function(){return e.Tl=null,n.apply(t)}))},t.prototype.vc=function(t,e){var n=this;return this.Al(t,e).next((function(t){t?n.Il.delete(e.toString()):n.Il.add(e.toString())}))},t.prototype._l=function(t){return 0},t.prototype.Al=function(t,e){var n=this;return lr.$n([function(){return lr.resolve(n.ml.zo(e))},function(){return n.persistence.Ac().zo(t,e)},function(){return n.persistence.wl(t,e)}])},t}(),Ys=function(){function t(t){this.Rl=t.Rl,this.Pl=t.Pl}return t.prototype.yu=function(t){this.gl=t},t.prototype.Iu=function(t){this.yl=t},t.prototype.onMessage=function(t){this.Vl=t},t.prototype.close=function(){this.Pl()},t.prototype.send=function(t){this.Rl(t)},t.prototype.pl=function(){this.gl()},t.prototype.bl=function(t){this.yl(t)},t.prototype.vl=function(t){this.Vl(t)},t}(),Hs={BatchGetDocuments:\"batchGet\",Commit:\"commit\",RunQuery:\"runQuery\"},$s=function(e){function n(t){var n=this;return(n=e.call(this,t)||this).forceLongPolling=t.forceLongPolling,n}return t.__extends(n,e),n.prototype.xl=function(t,e,n,r){return new Promise((function(o,s){var u=new i.XhrIo;u.listenOnce(i.EventType.COMPLETE,(function(){try{switch(u.getLastErrorCode()){case i.ErrorCode.NO_ERROR:var e=u.getResponseJson();l(\"Connection\",\"XHR received:\",JSON.stringify(e)),o(e);break;case i.ErrorCode.TIMEOUT:l(\"Connection\",'RPC \"'+t+'\" timed out'),s(new c(a.DEADLINE_EXCEEDED,\"Request time out\"));break;case i.ErrorCode.HTTP_ERROR:var n=u.getStatus();if(l(\"Connection\",'RPC \"'+t+'\" failed with status:',n,\"response text:\",u.getResponseText()),n>0){var r=u.getResponseJson().error;if(r&&r.status&&r.message){var h=function(t){var e=t.toLowerCase().replace(\"_\",\"-\");return Object.values(a).indexOf(e)>=0?e:a.UNKNOWN}(r.status);s(new c(h,r.message))}else s(new c(a.UNKNOWN,\"Server responded with status \"+u.getStatus()))}else s(new c(a.UNAVAILABLE,\"Connection failed.\"));break;default:y()}}finally{l(\"Connection\",'RPC \"'+t+'\" completed.')}}));var h=JSON.stringify(r);u.send(e,\"POST\",h,n,15)}))},n.prototype.Vu=function(t,e){var n=[this.Dl,\"/\",\"google.firestore.v1.Firestore\",\"/\",t,\"/channel\"],o=i.createWebChannelTransport(),s={httpSessionIdParam:\"gsessionid\",initMessageHeaders:{},messageUrlParams:{database:\"projects/\"+this.U.projectId+\"/databases/\"+this.U.database},sendRawJson:!0,supportsCrossDomainXhr:!0,internalChannelParams:{forwardChannelRequestTimeoutMs:6e5},forceLongPolling:this.forceLongPolling};this.Fl(s.initMessageHeaders,e),r.isMobileCordova()||r.isReactNative()||r.isElectron()||r.isIE()||r.isUWP()||r.isBrowserExtension()||(s.httpHeadersOverwriteParam=\"$httpHeaders\");var u=n.join(\"\");l(\"Connection\",\"Creating WebChannel: \"+u,s);var h=o.createWebChannel(u,s),f=!1,p=!1,v=new Ys({Rl:function(t){p?l(\"Connection\",\"Not sending because WebChannel is closed:\",t):(f||(l(\"Connection\",\"Opening WebChannel transport.\"),h.open(),f=!0),l(\"Connection\",\"WebChannel sending:\",t),h.send(t))},Pl:function(){return h.close()}}),y=function(t,e){h.listen(t,(function(t){try{e(t)}catch(t){setTimeout((function(){throw t}),0)}}))};return y(i.WebChannel.EventType.OPEN,(function(){p||l(\"Connection\",\"WebChannel transport opened.\")})),y(i.WebChannel.EventType.CLOSE,(function(){p||(p=!0,l(\"Connection\",\"WebChannel transport closed\"),v.bl())})),y(i.WebChannel.EventType.ERROR,(function(t){p||(p=!0,d(\"Connection\",\"WebChannel transport errored:\",t),v.bl(new c(a.UNAVAILABLE,\"The operation could not be completed\")))})),y(i.WebChannel.EventType.MESSAGE,(function(t){var e;if(!p){var n=t.data[0];g(!!n);var i=n.error||(null===(e=n[0])||void 0===e?void 0:e.error);if(i){l(\"Connection\",\"WebChannel received error:\",i);var o=i.status,s=function(t){var e=vt[t];if(void 0!==e)return _t(e)}(o),u=i.message;void 0===s&&(s=a.INTERNAL,u=\"Unknown error status: \"+o+\" with message \"+i.message),p=!0,v.bl(new c(s,u)),h.close()}else l(\"Connection\",\"WebChannel received:\",n),v.vl(n)}})),setTimeout((function(){v.pl()}),0),v},n}(function(){function t(t){this.Sl=t,this.U=t.U,this.Dl=(t.ssl?\"https\":\"http\")+\"://\"+t.host,this.Cl=\"projects/\"+this.U.projectId+\"/databases/\"+this.U.database+\"/documents\"}return t.prototype.Mu=function(t,e,n,r){var i=this.Nl(t,e);l(\"RestConnection\",\"Sending: \",i,n);var o={};return this.Fl(o,r),this.xl(t,i,o,n).then((function(t){return l(\"RestConnection\",\"Received: \",t),t}),(function(e){throw d(\"RestConnection\",t+\" failed with error: \",e,\"url: \",i,\"request:\",n),e}))},t.prototype.Ou=function(t,e,n,r){return this.Mu(t,e,n,r)},t.prototype.Fl=function(t,e){if(t[\"X-Goog-Api-Client\"]=\"gl-js/ fire/7.21.1\",t[\"Content-Type\"]=\"text/plain\",e)for(var n in e.zc)e.zc.hasOwnProperty(n)&&(t[n]=e.zc[n])},t.prototype.Nl=function(t,e){return this.Dl+\"/v1/\"+e+\":\"+Hs[t]},t}()),Xs=function(){function t(){var t=this;this.$l=function(){return t.kl()},this.Ml=function(){return t.Ol()},this.Ll=[],this.Bl()}return t.prototype.eh=function(t){this.Ll.push(t)},t.prototype.Si=function(){window.removeEventListener(\"online\",this.$l),window.removeEventListener(\"offline\",this.Ml)},t.prototype.Bl=function(){window.addEventListener(\"online\",this.$l),window.addEventListener(\"offline\",this.Ml)},t.prototype.kl=function(){l(\"ConnectivityMonitor\",\"Network connectivity changed: AVAILABLE\");for(var t=0,e=this.Ll;t<e.length;t++)(0,e[t])(0)},t.prototype.Ol=function(){l(\"ConnectivityMonitor\",\"Network connectivity changed: UNAVAILABLE\");for(var t=0,e=this.Ll;t<e.length;t++)(0,e[t])(1)},t.On=function(){return\"undefined\"!=typeof window&&void 0!==window.addEventListener&&void 0!==window.removeEventListener},t}(),Js=function(){function t(){}return t.prototype.eh=function(t){},t.prototype.Si=function(){},t}();function Zs(t){return new de(t,!0)}var tu=\"You are using the memory-only build of Firestore. Persistence support is only available via the @firebase/firestore bundle or the firebase-firestore.js build.\",eu=function(){function e(){}return e.prototype.initialize=function(e){return t.__awaiter(this,void 0,void 0,(function(){return t.__generator(this,(function(t){switch(t.label){case 0:return this.Ch=this.ql(e),this.persistence=this.Ul(e),[4,this.persistence.start()];case 1:return t.sent(),this.Ql=this.Wl(e),this.Gu=this.jl(e),[2]}}))}))},e.prototype.Wl=function(t){return null},e.prototype.jl=function(t){return e=this.persistence,n=new Gs,new fo(e,n,t.Kl);var e,n},e.prototype.Ul=function(t){if(t.persistenceSettings.Gl)throw new c(a.FAILED_PRECONDITION,tu);return new Qs(Ks.El)},e.prototype.ql=function(t){return new Wr},e.prototype.terminate=function(){return t.__awaiter(this,void 0,void 0,(function(){return t.__generator(this,(function(t){switch(t.label){case 0:return this.Ql&&this.Ql.stop(),[4,this.Ch.Si()];case 1:return t.sent(),[4,this.persistence.Si()];case 2:return t.sent(),[2]}}))}))},e.prototype.clearPersistence=function(t,e){throw new c(a.FAILED_PRECONDITION,tu)},e}(),nu=function(e){function n(){return null!==e&&e.apply(this,arguments)||this}return t.__extends(n,e),n.prototype.initialize=function(n){return t.__awaiter(this,void 0,void 0,(function(){var r,i=this;return t.__generator(this,(function(o){switch(o.label){case 0:return[4,e.prototype.initialize.call(this,n)];case 1:return o.sent(),r=this.zl._i,this.Ch instanceof Qr?(this.Ch._i={tr:Os.bind(null,r),er:Vs.bind(null,r),nr:Ms.bind(null,r),Vi:Ps.bind(null,r)},[4,this.Ch.start()]):[3,3];case 2:o.sent(),o.label=3;case 3:return[4,this.persistence.ec((function(e){return t.__awaiter(i,void 0,void 0,(function(){return t.__generator(this,(function(t){switch(t.label){case 0:return[4,Rs(this.zl._i,e)];case 1:return t.sent(),this.Ql&&(e&&!this.Ql.Ti?this.Ql.start(this.Gu):e||this.Ql.stop()),[2]}}))}))}))];case 4:return o.sent(),[2]}}))}))},n.prototype.ql=function(t){if(t.persistenceSettings.Gl&&t.persistenceSettings.synchronizeTabs){var e=Ir();if(!Qr.On(e))throw new c(a.UNIMPLEMENTED,\"IndexedDB persistence is only available on platforms that support LocalStorage.\");var n=ho(t.Sl.U,t.Sl.persistenceKey);return new Qr(e,t.os,n,t.clientId,t.Kl)}return new Wr},n}(function(e){function n(t){var n=this;return(n=e.call(this)||this).zl=t,n}return t.__extends(n,e),n.prototype.initialize=function(n){return t.__awaiter(this,void 0,void 0,(function(){return t.__generator(this,(function(r){switch(r.label){case 0:return[4,e.prototype.initialize.call(this,n)];case 1:return r.sent(),[4,function(e){return t.__awaiter(this,void 0,void 0,(function(){var n,r;return t.__generator(this,(function(t){return n=m(e),r=m(n.Fc),[2,n.persistence.runTransaction(\"Synchronize last document change read time\",\"readonly\",(function(t){return r.oa(t)})).then((function(t){n.Nc=t}))]}))}))}(this.Gu)];case 2:return r.sent(),[4,this.zl.initialize(this,n)];case 3:return r.sent(),[4,qs(this.zl._i)];case 4:return r.sent(),[4,Xo(this.zl.Sh)];case 5:return r.sent(),[2]}}))}))},n.prototype.Wl=function(t){return new ii(this.persistence.Co.do,t.os)},n.prototype.Ul=function(t){var e=ho(t.Sl.U,t.Sl.persistenceKey),n=Zs(t.Sl.U);return new oo(t.persistenceSettings.synchronizeTabs,e,t.clientId,ri.oo(t.persistenceSettings.cacheSizeBytes),t.os,Ir(),Er(),n,this.Ch,t.persistenceSettings.La)},n.prototype.ql=function(t){return new Wr},n.prototype.clearPersistence=function(e,n){return function(e){return t.__awaiter(this,void 0,void 0,(function(){return t.__generator(this,(function(t){switch(t.label){case 0:return pr.On()?[4,pr.delete(e+\"main\")]:[2,Promise.resolve()];case 1:return t.sent(),[2]}}))}))}(ho(e,n))},n}(eu)),ru=function(){function e(){}return e.prototype.initialize=function(e,n){return t.__awaiter(this,void 0,void 0,(function(){var r=this;return t.__generator(this,(function(t){switch(t.label){case 0:return this.Gu?[3,2]:(this.Gu=e.Gu,this.Ch=e.Ch,this.zu=this.Hl(n),this.Sh=this.Yl(n),this.Dh=this.Jl(n),this._i=this.Xl(n),this.Ch.fi=function(t){return gs(r._i,t,1)},this.Sh.Hu.Zl=xs.bind(null,this._i),[4,is(this.Sh,this._i.Wh)]);case 1:t.sent(),t.label=2;case 2:return[2]}}))}))},e.prototype.Jl=function(t){return new Dr},e.prototype.Hl=function(t){var n=Zs(t.Sl.U),r=new $s(t.Sl);return function(t,e,n){return new Oo(t,e,n)}(t.credentials,r,n)},e.prototype.Yl=function(t){var e,n,r,i,o,s=this;return e=this.Gu,n=this.zu,r=t.os,i=function(t){return gs(s._i,t,0)},o=Xs.On()?new Xs:new Js,new Uo(e,n,r,i,o)},e.prototype.Xl=function(t){return function(t,e,n,r,i,o,s){var u=new ls(t,e,n,r,i,o);return s&&(u.Qh=!0),u}(this.Gu,this.Sh,this.Dh,this.Ch,t.Kl,t.Nh,!t.persistenceSettings.Gl||!t.persistenceSettings.synchronizeTabs)},e.prototype.terminate=function(){return Vo(this.Sh)},e}(),iu=function(){function t(t){this.observer=t,this.muted=!1}return t.prototype.next=function(t){this.observer.next&&this.t_(this.observer.next,t)},t.prototype.error=function(t){this.observer.error?this.t_(this.observer.error,t):console.error(\"Uncaught Error in snapshot listener:\",t)},t.prototype.e_=function(){this.muted=!0},t.prototype.t_=function(t,e){var n=this;this.muted||setTimeout((function(){n.muted||t(e)}),0)},t}(),ou=function(t){!function(t,e,n,r){if(!(e instanceof Array)||e.length<1)throw new c(a.INVALID_ARGUMENT,\"Function FieldPath() requires its fieldNames argument to be an array with at least \"+Q(1,\"element\")+\".\")}(0,t);for(var e=0;e<t.length;++e)if(L(\"FieldPath\",\"string\",e,t[e]),0===t[e].length)throw new c(a.INVALID_ARGUMENT,\"Invalid field name at argument $(i + 1). Field names must not be empty.\");this.n_=new N(t)},su=function(e){function n(){for(var t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];return e.call(this,t)||this}return t.__extends(n,e),n.documentId=function(){return new n(N.v().R())},n.prototype.isEqual=function(t){if(!(t instanceof n))throw B(\"isEqual\",\"FieldPath\",1,t);return this.n_.isEqual(t.n_)},n}(ou),uu=new RegExp(\"[~\\\\*/\\\\[\\\\]]\"),au=function(){this.s_=this},cu=function(e){function n(t){var n=this;return(n=e.call(this)||this).i_=t,n}return t.__extends(n,e),n.prototype.r_=function(t){if(2!==t.o_)throw t.a_(1===t.o_?this.i_+\"() can only appear at the top level of your update data\":this.i_+\"() cannot be used with set() unless you pass {merge:true}\");return t.Qe.push(t.path),null},n.prototype.isEqual=function(t){return t instanceof n},n}(au);function hu(t,e,n){return new Eu({o_:3,c_:e.settings.c_,methodName:t.i_,u_:n},e.U,e.serializer,e.ignoreUndefinedProperties)}var fu=function(e){function n(t){var n=this;return(n=e.call(this)||this).i_=t,n}return t.__extends(n,e),n.prototype.r_=function(t){return new on(t.path,new He)},n.prototype.isEqual=function(t){return t instanceof n},n}(au),lu=function(e){function n(t,n){var r=this;return(r=e.call(this)||this).i_=t,r.h_=n,r}return t.__extends(n,e),n.prototype.r_=function(t){var e=hu(this,t,!0),n=this.h_.map((function(t){return xu(t,e)})),r=new $e(n);return new on(t.path,r)},n.prototype.isEqual=function(t){return this===t},n}(au),pu=function(e){function n(t,n){var r=this;return(r=e.call(this)||this).i_=t,r.h_=n,r}return t.__extends(n,e),n.prototype.r_=function(t){var e=hu(this,t,!0),n=this.h_.map((function(t){return xu(t,e)})),r=new Je(n);return new on(t.path,r)},n.prototype.isEqual=function(t){return this===t},n}(au),du=function(e){function n(t,n){var r=this;return(r=e.call(this)||this).i_=t,r.l_=n,r}return t.__extends(n,e),n.prototype.r_=function(t){var e=new tn(t.serializer,ge(t.serializer,this.l_));return new on(t.path,e)},n.prototype.isEqual=function(t){return this===t},n}(au),vu=function(e){function n(){return e.call(this)||this}return t.__extends(n,e),n.delete=function(){return S(\"FieldValue.delete\",arguments),new yu(new cu(\"FieldValue.delete\"))},n.serverTimestamp=function(){return S(\"FieldValue.serverTimestamp\",arguments),new yu(new fu(\"FieldValue.serverTimestamp\"))},n.arrayUnion=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return x(\"FieldValue.arrayUnion\",arguments,1),new yu(new lu(\"FieldValue.arrayUnion\",t))},n.arrayRemove=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return x(\"FieldValue.arrayRemove\",arguments,1),new yu(new pu(\"FieldValue.arrayRemove\",t))},n.increment=function(t){return L(\"FieldValue.increment\",\"number\",1,t),D(\"FieldValue.increment\",arguments,1),new yu(new du(\"FieldValue.increment\",t))},n}(au),yu=function(e){function n(t){var n=this;return(n=e.call(this)||this).s_=t,n.i_=t.i_,n}return t.__extends(n,e),n.prototype.r_=function(t){return this.s_.r_(t)},n.prototype.isEqual=function(t){return t instanceof n&&this.s_.isEqual(t.s_)},n}(vu),gu=function(){function t(t,e){if(D(\"GeoPoint\",arguments,2),L(\"GeoPoint\",\"number\",1,t),L(\"GeoPoint\",\"number\",2,e),!isFinite(t)||t<-90||t>90)throw new c(a.INVALID_ARGUMENT,\"Latitude must be a number between -90 and 90, but was: \"+t);if(!isFinite(e)||e<-180||e>180)throw new c(a.INVALID_ARGUMENT,\"Longitude must be a number between -180 and 180, but was: \"+e);this.__=t,this.f_=e}return Object.defineProperty(t.prototype,\"latitude\",{get:function(){return this.__},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,\"longitude\",{get:function(){return this.f_},enumerable:!1,configurable:!0}),t.prototype.isEqual=function(t){return this.__===t.__&&this.f_===t.f_},t.prototype.toJSON=function(){return{latitude:this.__,longitude:this.f_}},t.prototype.H=function(t){return Y(this.__,t.__)||Y(this.f_,t.f_)},t}(),mu=/^__.*__$/,wu=function(t,e,n){this.d_=t,this.w_=e,this.m_=n},_u=function(){function t(t,e,n){this.data=t,this.Qe=e,this.fieldTransforms=n}return t.prototype.T_=function(t,e){var n=[];return n.push(null!==this.Qe?new yn(t,this.data,this.Qe,e):new vn(t,this.data,e)),this.fieldTransforms.length>0&&n.push(new mn(t,this.fieldTransforms)),n},t}(),bu=function(){function t(t,e,n){this.data=t,this.Qe=e,this.fieldTransforms=n}return t.prototype.T_=function(t,e){var n=[new yn(t,this.data,this.Qe,e)];return this.fieldTransforms.length>0&&n.push(new mn(t,this.fieldTransforms)),n},t}();function Iu(t){switch(t){case 0:case 2:case 1:return!0;case 3:case 4:return!1;default:throw y()}}var Eu=function(){function t(t,e,n,r,i,o){this.settings=t,this.U=e,this.serializer=n,this.ignoreUndefinedProperties=r,void 0===i&&this.E_(),this.fieldTransforms=i||[],this.Qe=o||[]}return Object.defineProperty(t.prototype,\"path\",{get:function(){return this.settings.path},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,\"o_\",{get:function(){return this.settings.o_},enumerable:!1,configurable:!0}),t.prototype.I_=function(e){return new t(Object.assign(Object.assign({},this.settings),e),this.U,this.serializer,this.ignoreUndefinedProperties,this.fieldTransforms,this.Qe)},t.prototype.A_=function(t){var e,n=null===(e=this.path)||void 0===e?void 0:e.child(t),r=this.I_({path:n,u_:!1});return r.R_(t),r},t.prototype.P_=function(t){var e,n=null===(e=this.path)||void 0===e?void 0:e.child(t),r=this.I_({path:n,u_:!1});return r.E_(),r},t.prototype.g_=function(t){return this.I_({path:void 0,u_:!0})},t.prototype.a_=function(t){return Cu(t,this.settings.methodName,this.settings.y_||!1,this.path,this.settings.c_)},t.prototype.contains=function(t){return void 0!==this.Qe.find((function(e){return t.T(e)}))||void 0!==this.fieldTransforms.find((function(e){return t.T(e.field)}))},t.prototype.E_=function(){if(this.path)for(var t=0;t<this.path.length;t++)this.R_(this.path.get(t))},t.prototype.R_=function(t){if(0===t.length)throw this.a_(\"Document fields must not be empty\");if(Iu(this.o_)&&mu.test(t))throw this.a_('Document fields cannot begin and end with \"__\"')},t}(),Tu=function(){function t(t,e,n){this.U=t,this.ignoreUndefinedProperties=e,this.serializer=n||Zs(t)}return t.prototype.V_=function(t,e,n,r){return void 0===r&&(r=!1),new Eu({o_:t,methodName:e,c_:n,path:N.g(),u_:!1,y_:r},this.U,this.serializer,this.ignoreUndefinedProperties)},t}();function Nu(t,e,n,r,i,o){void 0===o&&(o={});var s=t.V_(o.merge||o.mergeFields?2:0,e,n,i);Ou(\"Data must be an object, but it was:\",s,r);var u,h,f=ku(r,s);if(o.merge)u=new rn(s.Qe),h=s.fieldTransforms;else if(o.mergeFields){for(var l=[],p=0,d=o.mergeFields;p<d.length;p++){var v=d[p],g=void 0;if(v instanceof ou)g=v.n_;else{if(\"string\"!=typeof v)throw y();g=Uu(e,v,n)}if(!s.contains(g))throw new c(a.INVALID_ARGUMENT,\"Field '\"+g+\"' is specified in your field mask but missing from your input data.\");Pu(l,g)||l.push(g)}u=new rn(l),h=s.fieldTransforms.filter((function(t){return u.He(t.field)}))}else u=null,h=s.fieldTransforms;return new _u(new En(f),u,h)}function Au(t,e,n,r){var i=t.V_(1,e,n);Ou(\"Data must be an object, but it was:\",i,r);var o=[],s=new Tn;_(r,(function(t,r){var u=Uu(e,t,n),a=i.P_(u);if(r instanceof au&&r.s_ instanceof cu)o.push(u);else{var c=xu(r,a);null!=c&&(o.push(u),s.set(u,c))}}));var u=new rn(o);return new bu(s.Je(),u,i.fieldTransforms)}function Su(t,e,n,r,i,o){var s=t.V_(1,e,n),u=[Ru(e,r,n)],h=[i];if(o.length%2!=0)throw new c(a.INVALID_ARGUMENT,\"Function \"+e+\"() needs to be called with an even number of arguments that alternate between field names and values.\");for(var f=0;f<o.length;f+=2)u.push(Ru(e,o[f])),h.push(o[f+1]);for(var l=[],p=new Tn,d=u.length-1;d>=0;--d)if(!Pu(l,u[d])){var v=u[d],y=h[d],g=s.P_(v);if(y instanceof au&&y.s_ instanceof cu)l.push(v);else{var m=xu(y,g);null!=m&&(l.push(v),p.set(v,m))}}var w=new rn(l);return new bu(p.Je(),w,s.fieldTransforms)}function Du(t,e,n,r){return void 0===r&&(r=!1),xu(n,t.V_(r?4:3,e))}function xu(t,e){if(Lu(t))return Ou(\"Unsupported field value:\",e,t),ku(t,e);if(t instanceof au)return function(t,e){if(!Iu(e.o_))throw e.a_(t.i_+\"() can only be used with update() and set()\");if(!e.path)throw e.a_(t.i_+\"() is not currently supported inside arrays\");var n=t.r_(e);n&&e.fieldTransforms.push(n)}(t,e),null;if(e.path&&e.Qe.push(e.path),t instanceof Array){if(e.settings.u_&&4!==e.o_)throw e.a_(\"Nested arrays are not supported\");return function(t,e){for(var n=[],r=0,i=0,o=t;i<o.length;i++){var s=xu(o[i],e.g_(r));null==s&&(s={nullValue:\"NULL_VALUE\"}),n.push(s),r++}return{arrayValue:{values:n}}}(t,e)}return function(t,e){if(null===t)return{nullValue:\"NULL_VALUE\"};if(\"number\"==typeof t)return ge(e.serializer,t);if(\"boolean\"==typeof t)return{booleanValue:t};if(\"string\"==typeof t)return{stringValue:t};if(t instanceof Date){var n=ot.fromDate(t);return{timestampValue:me(e.serializer,n)}}if(t instanceof ot){var r=new ot(t.seconds,1e3*Math.floor(t.nanoseconds/1e3));return{timestampValue:me(e.serializer,r)}}if(t instanceof gu)return{geoPointValue:{latitude:t.latitude,longitude:t.longitude}};if(t instanceof J)return{bytesValue:we(e.serializer,t.q)};if(t instanceof wu){var i=e.U,o=t.d_;if(!o.isEqual(i))throw e.a_(\"Document reference is for database \"+o.projectId+\"/\"+o.database+\" but should be for database \"+i.projectId+\"/\"+i.database);return{referenceValue:Ie(t.d_||e.U,t.w_.path)}}if(void 0===t&&e.ignoreUndefinedProperties)return null;throw e.a_(\"Unsupported field value: \"+F(t))}(t,e)}function ku(t,e){var n={};return b(t)?e.path&&e.path.length>0&&e.Qe.push(e.path):_(t,(function(t,r){var i=xu(r,e.A_(t));null!=i&&(n[t]=i)})),{mapValue:{fields:n}}}function Lu(t){return!(\"object\"!=typeof t||null===t||t instanceof Array||t instanceof Date||t instanceof ot||t instanceof gu||t instanceof J||t instanceof wu||t instanceof au)}function Ou(t,e,n){if(!Lu(n)||!M(n)){var r=F(n);throw e.a_(\"an object\"===r?t+\" a custom object\":t+\" \"+r)}}function Ru(t,e,n){if(e instanceof ou)return e.n_;if(\"string\"==typeof e)return Uu(t,e);throw Cu(\"Field path arguments must be of type string or FieldPath.\",t,!1,void 0,n)}function Uu(e,n,r){try{return function(e){if(e.search(uu)>=0)throw new c(a.INVALID_ARGUMENT,\"Invalid field path (\"+e+\"). Paths must not contain '~', '*', '/', '[', or ']'\");try{return new(su.bind.apply(su,t.__spreadArrays([void 0],e.split(\".\"))))}catch(t){throw new c(a.INVALID_ARGUMENT,\"Invalid field path (\"+e+\"). Paths must not be empty, begin with '.', end with '.', or contain '..'\")}}(n).n_}catch(n){throw Cu((i=n)instanceof Error?i.message:i.toString(),e,!1,void 0,r)}var i}function Cu(t,e,n,r,i){var o=r&&!r.m(),s=void 0!==i,u=\"Function \"+e+\"() called with invalid data\";n&&(u+=\" (via `toFirestore()`)\");var h=\"\";return(o||s)&&(h+=\" (found\",o&&(h+=\" in field \"+r),s&&(h+=\" in document \"+i),h+=\")\"),new c(a.INVALID_ARGUMENT,(u+=\". \")+t+h)}function Pu(t,e){return t.some((function(t){return t.isEqual(e)}))}var Vu=function(){function e(t){this.zu=t,this.p_=new Map,this.mutations=[],this.b_=!1,this.v_=null,this.S_=new Set}return e.prototype.D_=function(e){return t.__awaiter(this,void 0,void 0,(function(){var n,r=this;return t.__generator(this,(function(i){switch(i.label){case 0:if(this.C_(),this.mutations.length>0)throw new c(a.INVALID_ARGUMENT,\"Firestore transactions require all reads to be executed before all writes.\");return[4,function(e,n){return t.__awaiter(this,void 0,void 0,(function(){var r,i,o,s,u,a;return t.__generator(this,(function(t){switch(t.label){case 0:return r=m(e),i=De(r.serializer)+\"/documents\",o={documents:n.map((function(t){return Te(r.serializer,t)}))},[4,r.Ou(\"BatchGetDocuments\",i,o)];case 1:return s=t.sent(),u=new Map,s.forEach((function(t){var e=function(t,e){return\"found\"in e?function(t,e){g(!!e.found);var n=Ne(t,e.found.name),r=be(e.found.updateTime),i=new En({mapValue:{fields:e.found.fields}});return new Sn(n,r,i,{})}(t,e):\"missing\"in e?function(t,e){g(!!e.missing),g(!!e.readTime);var n=Ne(t,e.missing),r=be(e.readTime);return new Dn(n,r)}(t,e):y()}(r.serializer,t);u.set(e.key.toString(),e)})),a=[],[2,(n.forEach((function(t){var e=u.get(t.toString());g(!!e),a.push(e)})),a)]}}))}))}(this.zu,e)];case 1:return[2,((n=i.sent()).forEach((function(t){t instanceof Dn||t instanceof Sn?r.N_(t):y()})),n)]}}))}))},e.prototype.set=function(t,e){this.write(e.T_(t,this.Ke(t))),this.S_.add(t.toString())},e.prototype.update=function(t,e){try{this.write(e.T_(t,this.F_(t)))}catch(t){this.v_=t}this.S_.add(t.toString())},e.prototype.delete=function(t){this.write([new bn(t,this.Ke(t))]),this.S_.add(t.toString())},e.prototype.commit=function(){return t.__awaiter(this,void 0,void 0,(function(){var e,n=this;return t.__generator(this,(function(r){switch(r.label){case 0:if(this.C_(),this.v_)throw this.v_;return e=this.p_,this.mutations.forEach((function(t){e.delete(t.key.toString())})),e.forEach((function(t,e){var r=A.D(e);n.mutations.push(new In(r,n.Ke(r)))})),[4,function(e,n){return t.__awaiter(this,void 0,void 0,(function(){var r,i,o;return t.__generator(this,(function(t){switch(t.label){case 0:return r=m(e),i=De(r.serializer)+\"/documents\",o={writes:n.map((function(t){return Le(r.serializer,t)}))},[4,r.Mu(\"Commit\",i,o)];case 1:return t.sent(),[2]}}))}))}(this.zu,this.mutations)];case 1:return r.sent(),this.b_=!0,[2]}}))}))},e.prototype.N_=function(t){var e;if(t instanceof Sn)e=t.version;else{if(!(t instanceof Dn))throw y();e=st.min()}var n=this.p_.get(t.key.toString());if(n){if(!e.isEqual(n))throw new c(a.ABORTED,\"Document version changed between two reads.\")}else this.p_.set(t.key.toString(),e)},e.prototype.Ke=function(t){var e=this.p_.get(t.toString());return!this.S_.has(t.toString())&&e?un.updateTime(e):un.Ge()},e.prototype.F_=function(t){var e=this.p_.get(t.toString());if(!this.S_.has(t.toString())&&e){if(e.isEqual(st.min()))throw new c(a.INVALID_ARGUMENT,\"Can't update a document that doesn't exist.\");return un.updateTime(e)}return un.exists(!0)},e.prototype.write=function(t){this.C_(),this.mutations=this.mutations.concat(t)},e.prototype.C_=function(){},e}(),Mu=function(){function e(t,e,n,r){this.os=t,this.zu=e,this.updateFunction=n,this.hs=r,this.x_=5,this.gs=new fr(this.os,\"transaction_retry\")}return e.prototype.run=function(){this.k_()},e.prototype.k_=function(){var e=this;this.gs.Rn((function(){return t.__awaiter(e,void 0,void 0,(function(){var e,n,r=this;return t.__generator(this,(function(t){return e=new Vu(this.zu),(n=this.M_(e))&&n.then((function(t){r.os.ds((function(){return e.commit().then((function(){r.hs.resolve(t)})).catch((function(t){r.O_(t)}))}))})).catch((function(t){r.O_(t)})),[2]}))}))}))},e.prototype.M_=function(t){try{var e=this.updateFunction(t);return!ut(e)&&e.catch&&e.then?e:(this.hs.reject(Error(\"Transaction callback must return a Promise\")),null)}catch(t){return this.hs.reject(t),null}},e.prototype.O_=function(t){var e=this;this.x_>0&&this.L_(t)?(this.x_-=1,this.os.ds((function(){return e.k_(),Promise.resolve()}))):this.hs.reject(t)},e.prototype.L_=function(t){if(\"FirebaseError\"===t.name){var e=t.code;return\"aborted\"===e||\"failed-precondition\"===e||!wt(e)}return!1},e}(),Fu=function(){function e(t,e){this.credentials=t,this.os=e,this.clientId=K.k(),this.B_=new hr}return e.prototype.start=function(e,n,r,i){var o=this;this.q_(),this.Sl=e;var s=new hr,u=!1;return this.credentials.Jc((function(e){if(!u)return u=!0,l(\"FirestoreClient\",\"Initializing. user=\",e.uid),o.U_(n,r,i,e,s).then(o.B_.resolve,o.B_.reject);o.os.Ds((function(){return function(e,n){return t.__awaiter(this,void 0,void 0,(function(){var r,i;return t.__generator(this,(function(t){switch(t.label){case 0:return(r=m(e)).os.Fs(),l(\"RemoteStore\",\"RemoteStore received new credentials\"),i=zo(r),r.Xu.add(3),[4,Po(r)];case 1:return t.sent(),i&&r.nh.set(\"Unknown\"),[4,r.Hu.Zl(n)];case 2:return t.sent(),r.Xu.delete(3),[4,Co(r)];case 3:return t.sent(),[2]}}))}))}(o.Sh,e)}))})),this.os.ds((function(){return o.B_.promise})),s.promise},e.prototype.enableNetwork=function(){var t=this;return this.q_(),this.os.enqueue((function(){return t.persistence.sc(!0),function(t){var e=m(t);return e.Xu.delete(0),Co(e)}(t.Sh)}))},e.prototype.U_=function(e,n,r,i,o){return t.__awaiter(this,void 0,void 0,(function(){var s,u,a=this;return t.__generator(this,(function(c){switch(c.label){case 0:return c.trys.push([0,3,,4]),[4,e.initialize(s={os:this.os,Sl:this.Sl,clientId:this.clientId,credentials:this.credentials,Kl:i,Nh:100,persistenceSettings:r})];case 1:return c.sent(),[4,n.initialize(e,s)];case 2:return c.sent(),this.persistence=e.persistence,this.Ch=e.Ch,this.Gu=e.Gu,this.Ql=e.Ql,this.zu=n.zu,this.Sh=n.Sh,this._i=n._i,this.Q_=n.Dh,this.Q_.qs=ps.bind(null,this._i),this.Q_.Ws=vs.bind(null,this._i),this.persistence.nc((function(){return t.__awaiter(a,void 0,void 0,(function(){return t.__generator(this,(function(t){switch(t.label){case 0:return[4,this.terminate()];case 1:return t.sent(),[2]}}))}))})),o.resolve(),[3,4];case 3:if(u=c.sent(),o.reject(u),!this.W_(u))throw u;return[2,(console.warn(\"Error enabling offline persistence. Falling back to persistence disabled: \"+u),this.U_(new eu,new ru,{Gl:!1},i,o))];case 4:return[2]}}))}))},e.prototype.W_=function(t){return\"FirebaseError\"===t.name?t.code===a.FAILED_PRECONDITION||t.code===a.UNIMPLEMENTED:!(\"undefined\"!=typeof DOMException&&t instanceof DOMException)||22===t.code||20===t.code||11===t.code},e.prototype.q_=function(){if(this.os.Vs)throw new c(a.FAILED_PRECONDITION,\"The client has already been terminated.\")},e.prototype.disableNetwork=function(){var e=this;return this.q_(),this.os.enqueue((function(){return e.persistence.sc(!1),function(e){return t.__awaiter(this,void 0,void 0,(function(){var n;return t.__generator(this,(function(t){switch(t.label){case 0:return(n=m(e)).Xu.add(0),[4,Po(n)];case 1:return t.sent(),n.nh.set(\"Offline\"),[2]}}))}))}(e.Sh)}))},e.prototype.terminate=function(){var e=this;this.os.Ss();var n=new hr;return this.os.ps((function(){return t.__awaiter(e,void 0,void 0,(function(){var e,r;return t.__generator(this,(function(t){switch(t.label){case 0:return t.trys.push([0,4,,5]),this.Ql&&this.Ql.stop(),[4,Vo(this.Sh)];case 1:return t.sent(),[4,this.Ch.Si()];case 2:return t.sent(),[4,this.persistence.Si()];case 3:return t.sent(),this.credentials.Xc(),n.resolve(),[3,5];case 4:return e=t.sent(),r=Ar(e,\"Failed to shutdown persistence\"),n.reject(r),[3,5];case 5:return[2]}}))}))})),n.promise},e.prototype.waitForPendingWrites=function(){var e=this;this.q_();var n=new hr;return this.os.ds((function(){return function(e,n){return t.__awaiter(this,void 0,void 0,(function(){var r,i,o,s,u;return t.__generator(this,(function(t){switch(t.label){case 0:zo((r=m(e)).Sh)||l(\"SyncEngine\",\"The network is disabled. The task returned by 'awaitPendingWrites()' will not complete until the network is enabled.\"),t.label=1;case 1:return t.trys.push([1,3,,4]),[4,function(t){var e=m(t);return e.persistence.runTransaction(\"Get highest unacknowledged batch id\",\"readonly\",(function(t){return e.vr.Bo(t)}))}(r.Gu)];case 2:return-1===(i=t.sent())?[2,void n.resolve()]:((o=r.qh.get(i)||[]).push(n),r.qh.set(i,o),[3,4]);case 3:return s=t.sent(),u=Ar(s,\"Initialization of waitForPendingWrites() operation failed\"),n.reject(u),[3,4];case 4:return[2]}}))}))}(e._i,n)})),n.promise},e.prototype.listen=function(t,e,n){var r=this;this.q_();var i=new iu(n),o=new Ur(t,i,e);return this.os.ds((function(){return xr(r.Q_,o)})),function(){i.e_(),r.os.ds((function(){return kr(r.Q_,o)}))}},e.prototype.j_=function(e){return t.__awaiter(this,void 0,void 0,(function(){var n,r=this;return t.__generator(this,(function(i){switch(i.label){case 0:return this.q_(),[4,this.B_.promise];case 1:return i.sent(),n=new hr,[2,(this.os.ds((function(){return function(e,n,r){return t.__awaiter(this,void 0,void 0,(function(){var i,o,s;return t.__generator(this,(function(t){switch(t.label){case 0:return t.trys.push([0,2,,3]),[4,function(t,e){var n=m(t);return n.persistence.runTransaction(\"read document\",\"readonly\",(function(t){return n.xc.Dr(t,e)}))}(e,n)];case 1:return(i=t.sent())instanceof Sn?r.resolve(i):i instanceof Dn?r.resolve(null):r.reject(new c(a.UNAVAILABLE,\"Failed to get document from cache. (However, this document may exist on the server. Run again without setting 'source' in the GetOptions to attempt to retrieve the document from the server.)\")),[3,3];case 2:return o=t.sent(),s=Ar(o,\"Failed to get document '\"+n+\" from cache\"),r.reject(s),[3,3];case 3:return[2]}}))}))}(r.Gu,e,n)})),n.promise)]}}))}))},e.prototype.K_=function(e,n){return void 0===n&&(n={}),t.__awaiter(this,void 0,void 0,(function(){var r,i=this;return t.__generator(this,(function(t){switch(t.label){case 0:return this.q_(),[4,this.B_.promise];case 1:return t.sent(),r=new hr,[2,(this.os.ds((function(){return function(t,e,n,r,i){var o=new iu({next:function(o){e.ds((function(){return kr(t,s)}));var u=o.docs.has(n);!u&&o.fromCache?i.reject(new c(a.UNAVAILABLE,\"Failed to get document because the client is offline.\")):u&&o.fromCache&&r&&\"server\"===r.source?i.reject(new c(a.UNAVAILABLE,'Failed to get document from server. (However, this document does exist in the local cache. Run again without setting source to \"server\" to retrieve the cached document.)')):i.resolve(o)},error:function(t){return i.reject(t)}}),s=new Ur(On(n.path),o,{includeMetadataChanges:!0,Js:!0});return xr(t,s)}(i.Q_,i.os,e,n,r)})),r.promise)]}}))}))},e.prototype.G_=function(e){return t.__awaiter(this,void 0,void 0,(function(){var n,r=this;return t.__generator(this,(function(i){switch(i.label){case 0:return this.q_(),[4,this.B_.promise];case 1:return i.sent(),n=new hr,[2,(this.os.ds((function(){return function(e,n,r){return t.__awaiter(this,void 0,void 0,(function(){var i,o,s,u,a,c;return t.__generator(this,(function(t){switch(t.label){case 0:return t.trys.push([0,2,,3]),[4,wo(e,n,!0)];case 1:return i=t.sent(),o=new cs(n,i.kc),s=o.Th(i.documents),u=o.gr(s,!1),r.resolve(u.snapshot),[3,3];case 2:return a=t.sent(),c=Ar(a,\"Failed to execute query '\"+n+\" against cache\"),r.reject(c),[3,3];case 3:return[2]}}))}))}(r.Gu,e,n)})),n.promise)]}}))}))},e.prototype.z_=function(e,n){return void 0===n&&(n={}),t.__awaiter(this,void 0,void 0,(function(){var r,i=this;return t.__generator(this,(function(t){switch(t.label){case 0:return this.q_(),[4,this.B_.promise];case 1:return t.sent(),r=new hr,[2,(this.os.ds((function(){return function(t,e,n,r,i){var o=new iu({next:function(n){e.ds((function(){return kr(t,s)})),n.fromCache&&\"server\"===r.source?i.reject(new c(a.UNAVAILABLE,'Failed to get documents from server. (However, these documents may exist in the local cache. Run again without setting source to \"server\" to retrieve the cached documents.)')):i.resolve(n)},error:function(t){return i.reject(t)}}),s=new Ur(n,o,{includeMetadataChanges:!0,Js:!0});return xr(t,s)}(i.Q_,i.os,e,n,r)})),r.promise)]}}))}))},e.prototype.write=function(e){var n=this;this.q_();var r=new hr;return this.os.ds((function(){return function(e,n,r){return t.__awaiter(this,void 0,void 0,(function(){var i,o,s,u;return t.__generator(this,(function(t){switch(t.label){case 0:i=qs(e),t.label=1;case 1:return t.trys.push([1,5,,6]),[4,function(t,e){var n,r=m(t),i=ot.now(),o=e.reduce((function(t,e){return t.add(e.key)}),Rt());return r.persistence.runTransaction(\"Locally write mutations\",\"readwrite\",(function(t){return r.xc.$r(t,o).next((function(o){n=o;for(var s=[],u=0,a=e;u<a.length;u++){var c=a[u],h=ln(c,n.get(c.key));null!=h&&s.push(new yn(c.key,h,Nn(h.proto.mapValue),un.exists(!0)))}return r.vr.$o(t,i,s,e)}))})).then((function(t){var e=t.hr(n);return{batchId:t.batchId,dr:e}}))}(i.Gu,n)];case 2:return o=t.sent(),i.Ch.Fi(o.batchId),function(t,e,n){var r=t.Bh[t.currentUser.Zs()];r||(r=new bt(Y)),r=r.rt(e,n),t.Bh[t.currentUser.Zs()]=r}(i,o.batchId,r),[4,Ds(i,o.dr)];case 3:return t.sent(),[4,Xo(i.Sh)];case 4:return t.sent(),[3,6];case 5:return s=t.sent(),u=Ar(s,\"Failed to persist write\"),r.reject(u),[3,6];case 6:return[2]}}))}))}(n._i,e,r)})),r.promise},e.prototype.U=function(){return this.Sl.U},e.prototype.H_=function(e){var n=this;this.q_();var r=new iu(e);return this.os.ds((function(){return t.__awaiter(n,void 0,void 0,(function(){return t.__generator(this,(function(t){return[2,function(t,e){m(t).Bs.add(e),e.next()}(this.Q_,r)]}))}))})),function(){r.e_(),n.os.ds((function(){return t.__awaiter(n,void 0,void 0,(function(){return t.__generator(this,(function(t){return[2,function(t,e){m(t).Bs.delete(e)}(this.Q_,r)]}))}))}))}},Object.defineProperty(e.prototype,\"Y_\",{get:function(){return this.os.Vs},enumerable:!1,configurable:!0}),e.prototype.transaction=function(t){var e=this;this.q_();var n=new hr;return this.os.ds((function(){return new Mu(e.os,e.zu,t,n).run(),Promise.resolve()})),n.promise},e}();function qu(t){return function(t,e){if(\"object\"!=typeof t||null===t)return!1;for(var n=t,r=0,i=[\"next\",\"error\",\"complete\"];r<i.length;r++){var o=i[r];if(o in n&&\"function\"==typeof n[o])return!0}return!1}(t)}var Gu=function(){function t(t,e,n,r,i){this.U=t,this.timestampsInSnapshots=e,this.J_=n,this.X_=r,this.Z_=i}return t.prototype.tf=function(t){switch(Xt(t)){case 0:return null;case 1:return t.booleanValue;case 2:return ie(t.integerValue||t.doubleValue);case 3:return this.ef(t.timestampValue);case 4:return this.nf(t);case 5:return t.stringValue;case 6:return this.Z_(oe(t.bytesValue));case 7:return this.sf(t.referenceValue);case 8:return this.if(t.geoPointValue);case 9:return this.rf(t.arrayValue);case 10:return this.af(t.mapValue);default:throw y()}},t.prototype.af=function(t){var e=this,n={};return _(t.fields||{},(function(t,r){n[t]=e.tf(r)})),n},t.prototype.if=function(t){return new gu(ie(t.latitude),ie(t.longitude))},t.prototype.rf=function(t){var e=this;return(t.values||[]).map((function(t){return e.tf(t)}))},t.prototype.nf=function(t){switch(this.J_){case\"previous\":var e=function t(e){var n=e.mapValue.fields.__previous_value__;return Yt(n)?t(n):n}(t);return null==e?null:this.tf(e);case\"estimate\":return this.ef(Ht(t));default:return null}},t.prototype.ef=function(t){var e=re(t),n=new ot(e.seconds,e.nanos);return this.timestampsInSnapshots?n:n.toDate()},t.prototype.sf=function(t){var e=E.P(t);g(ze(e));var n=new rt(e.get(1),e.get(3)),r=new A(e.u(5));return n.isEqual(this.U)||p(\"Document \"+r+\" contains a document reference within a different database (\"+n.projectId+\"/\"+n.database+\") which is not supported. It will be treated as a reference in the current database (\"+this.U.projectId+\"/\"+this.U.database+\") instead.\"),this.X_(r)},t}(),Bu=ri.uo,ju=function(){function t(t){var e,n,r,i;if(void 0===t.host){if(void 0!==t.ssl)throw new c(a.INVALID_ARGUMENT,\"Can't provide ssl option if host option is not set\");this.host=\"firestore.googleapis.com\",this.ssl=!0}else R(\"settings\",\"non-empty string\",\"host\",t.host),this.host=t.host,U(\"settings\",\"boolean\",\"ssl\",t.ssl),this.ssl=null===(e=t.ssl)||void 0===e||e;if(G(\"settings\",t,[\"host\",\"ssl\",\"credentials\",\"timestampsInSnapshots\",\"cacheSizeBytes\",\"experimentalForceLongPolling\",\"ignoreUndefinedProperties\"]),U(\"settings\",\"object\",\"credentials\",t.credentials),this.credentials=t.credentials,U(\"settings\",\"boolean\",\"timestampsInSnapshots\",t.timestampsInSnapshots),U(\"settings\",\"boolean\",\"ignoreUndefinedProperties\",t.ignoreUndefinedProperties),!0===t.timestampsInSnapshots?p(\"The setting 'timestampsInSnapshots: true' is no longer required and should be removed.\"):!1===t.timestampsInSnapshots&&p(\"Support for 'timestampsInSnapshots: false' will be removed soon. You must update your code to handle Timestamp objects.\"),this.timestampsInSnapshots=null===(n=t.timestampsInSnapshots)||void 0===n||n,this.ignoreUndefinedProperties=null!==(r=t.ignoreUndefinedProperties)&&void 0!==r&&r,U(\"settings\",\"number\",\"cacheSizeBytes\",t.cacheSizeBytes),void 0===t.cacheSizeBytes)this.cacheSizeBytes=ri.lo;else{if(t.cacheSizeBytes!==Bu&&t.cacheSizeBytes<ri.ho)throw new c(a.INVALID_ARGUMENT,\"cacheSizeBytes must be at least \"+ri.ho);this.cacheSizeBytes=t.cacheSizeBytes}U(\"settings\",\"boolean\",\"experimentalForceLongPolling\",t.experimentalForceLongPolling),this.experimentalForceLongPolling=null!==(i=t.experimentalForceLongPolling)&&void 0!==i&&i}return t.prototype.isEqual=function(t){return this.host===t.host&&this.ssl===t.ssl&&this.timestampsInSnapshots===t.timestampsInSnapshots&&this.credentials===t.credentials&&this.cacheSizeBytes===t.cacheSizeBytes&&this.experimentalForceLongPolling===t.experimentalForceLongPolling&&this.ignoreUndefinedProperties===t.ignoreUndefinedProperties},t}(),zu=function(){function e(n,r,i,o){var s=this;if(void 0===i&&(i=new eu),void 0===o&&(o=new ru),this.cf=i,this.uf=o,this.hf=null,this.lf=new Nr,this.INTERNAL={delete:function(){return t.__awaiter(s,void 0,void 0,(function(){return t.__generator(this,(function(t){switch(t.label){case 0:return this._f(),[4,this.ff.terminate()];case 1:return t.sent(),[2]}}))}))}},\"object\"==typeof n.options){var u=n;this.hf=u,this.d_=e.df(u),this.wf=u.name,this.mf=new Ao(r)}else{var h=n;if(!h.projectId)throw new c(a.INVALID_ARGUMENT,\"Must provide projectId\");this.d_=new rt(h.projectId,h.database),this.wf=\"[DEFAULT]\",this.mf=new No}this.Tf=new ju({})}return Object.defineProperty(e.prototype,\"Ef\",{get:function(){return this.If||(this.If=new Tu(this.d_,this.Tf.ignoreUndefinedProperties)),this.If},enumerable:!1,configurable:!0}),e.prototype.settings=function(t){D(\"Firestore.settings\",arguments,1),L(\"Firestore.settings\",\"object\",1,t),t.merge&&delete(t=Object.assign(Object.assign({},this.Tf),t)).merge;var e=new ju(t);if(this.ff&&!this.Tf.isEqual(e))throw new c(a.FAILED_PRECONDITION,\"Firestore has already been started and its settings can no longer be changed. You can only call settings() before calling any other methods on a Firestore object.\");this.Tf=e,void 0!==e.credentials&&(this.mf=function(t){if(!t)return new No;switch(t.type){case\"gapi\":var e=t.client;return g(!(\"object\"!=typeof e||null===e||!e.auth||!e.auth.getAuthHeaderValueForFirstParty)),new Do(e,t.sessionIndex||\"0\");case\"provider\":return t.client;default:throw new c(a.INVALID_ARGUMENT,\"makeCredentialsProvider failed due to invalid credential type\")}}(e.credentials))},e.prototype.enableNetwork=function(){return this._f(),this.ff.enableNetwork()},e.prototype.disableNetwork=function(){return this._f(),this.ff.disableNetwork()},e.prototype.enablePersistence=function(t){var e,n;if(this.ff)throw new c(a.FAILED_PRECONDITION,\"Firestore has already been started and persistence can no longer be enabled. You can only call enablePersistence() before calling any other methods on a Firestore object.\");var r=!1,i=!1;if(t&&(void 0!==t.experimentalTabSynchronization&&p(\"The 'experimentalTabSynchronization' setting will be removed. Use 'synchronizeTabs' instead.\"),r=null!==(n=null!==(e=t.synchronizeTabs)&&void 0!==e?e:t.experimentalTabSynchronization)&&void 0!==n&&n,i=!!t.experimentalForceOwningTab&&t.experimentalForceOwningTab,r&&i))throw new c(a.INVALID_ARGUMENT,\"The 'experimentalForceOwningTab' setting cannot be used with 'synchronizeTabs'.\");return this.Af(this.cf,this.uf,{Gl:!0,cacheSizeBytes:this.Tf.cacheSizeBytes,synchronizeTabs:r,La:i})},e.prototype.clearPersistence=function(){return t.__awaiter(this,void 0,void 0,(function(){var e,n=this;return t.__generator(this,(function(r){if(void 0!==this.ff&&!this.ff.Y_)throw new c(a.FAILED_PRECONDITION,\"Persistence can only be cleared before a Firestore instance is initialized or after it is terminated.\");return e=new hr,[2,(this.lf.ps((function(){return t.__awaiter(n,void 0,void 0,(function(){var n;return t.__generator(this,(function(t){switch(t.label){case 0:return t.trys.push([0,2,,3]),[4,this.cf.clearPersistence(this.d_,this.wf)];case 1:return t.sent(),e.resolve(),[3,3];case 2:return n=t.sent(),e.reject(n),[3,3];case 3:return[2]}}))}))})),e.promise)]}))}))},e.prototype.terminate=function(){return this.app._removeServiceInstance(\"firestore\"),this.INTERNAL.delete()},Object.defineProperty(e.prototype,\"Rf\",{get:function(){return this._f(),this.ff.Y_},enumerable:!1,configurable:!0}),e.prototype.waitForPendingWrites=function(){return this._f(),this.ff.waitForPendingWrites()},e.prototype.onSnapshotsInSync=function(t){return this._f(),qu(t)?this.ff.H_(t):(L(\"Firestore.onSnapshotsInSync\",\"function\",1,t),this.ff.H_({next:t}))},e.prototype._f=function(){return this.ff||this.Af(new eu,new ru,{Gl:!1}),this.ff},e.prototype.Pf=function(){return new nt(this.d_,this.wf,this.Tf.host,this.Tf.ssl,this.Tf.experimentalForceLongPolling)},e.prototype.Af=function(t,e,n){var r=this.Pf();return this.ff=new Fu(this.mf,this.lf),this.ff.start(r,t,e,n)},e.df=function(t){if(!Object.prototype.hasOwnProperty.call(t.options,\"projectId\"))throw new c(a.INVALID_ARGUMENT,'\"projectId\" not provided in firebase.initializeApp.');var n=t.options.projectId;if(!n||\"string\"!=typeof n)throw new c(a.INVALID_ARGUMENT,\"projectId must be a string in FirebaseApp.options\");return new rt(n)},Object.defineProperty(e.prototype,\"app\",{get:function(){if(!this.hf)throw new c(a.FAILED_PRECONDITION,\"Firestore was not initialized using the Firebase SDK. 'app' is not available\");return this.hf},enumerable:!1,configurable:!0}),e.prototype.collection=function(t){return D(\"Firestore.collection\",arguments,1),L(\"Firestore.collection\",\"non-empty string\",1,t),this._f(),new oa(E.P(t),this,null)},e.prototype.doc=function(t){return D(\"Firestore.doc\",arguments,1),L(\"Firestore.doc\",\"non-empty string\",1,t),this._f(),Ku.gf(E.P(t),this,null)},e.prototype.collectionGroup=function(t){if(D(\"Firestore.collectionGroup\",arguments,1),L(\"Firestore.collectionGroup\",\"non-empty string\",1,t),t.indexOf(\"/\")>=0)throw new c(a.INVALID_ARGUMENT,\"Invalid collection ID '\"+t+\"' passed to function Firestore.collectionGroup(). Collection IDs must not contain '/'.\");return this._f(),new ra(function(t){return new kn(E.g(),t)}(t),this,null)},e.prototype.runTransaction=function(t){var e=this;return D(\"Firestore.runTransaction\",arguments,1),L(\"Firestore.runTransaction\",\"function\",1,t),this._f().transaction((function(n){return t(new Qu(e,n))}))},e.prototype.batch=function(){return this._f(),new Wu(this)},Object.defineProperty(e,\"logLevel\",{get:function(){switch(f()){case n.LogLevel.DEBUG:return\"debug\";case n.LogLevel.ERROR:return\"error\";case n.LogLevel.SILENT:return\"silent\";case n.LogLevel.WARN:return\"warn\";case n.LogLevel.INFO:return\"info\";case n.LogLevel.VERBOSE:return\"verbose\";default:return\"error\"}},enumerable:!1,configurable:!0}),e.setLogLevel=function(t){D(\"Firestore.setLogLevel\",arguments,1),P(\"setLogLevel\",[\"debug\",\"error\",\"silent\",\"warn\",\"info\",\"verbose\"],1,t),h.setLogLevel(t)},e.prototype.yf=function(){return this.Tf.timestampsInSnapshots},e.prototype.Vf=function(){return this.Tf},e}(),Qu=function(){function t(t,e){this.pf=t,this.bf=e}return t.prototype.get=function(t){var e=this;D(\"Transaction.get\",arguments,1);var n=ca(\"Transaction.get\",t,this.pf);return this.bf.D_([n.w_]).then((function(t){if(!t||1!==t.length)return y();var r=t[0];if(r instanceof Dn)return new Hu(e.pf,n.w_,null,!1,!1,n.m_);if(r instanceof Sn)return new Hu(e.pf,n.w_,r,!1,!1,n.m_);throw y()}))},t.prototype.set=function(t,e,n){k(\"Transaction.set\",arguments,2,3);var r=ca(\"Transaction.set\",t,this.pf);n=sa(\"Transaction.set\",n);var i=fa(r.m_,e,n),o=Nu(this.pf.Ef,\"Transaction.set\",r.w_,i,null!==r.m_,n);return this.bf.set(r.w_,o),this},t.prototype.update=function(t,e,n){for(var r,i,o=[],s=3;s<arguments.length;s++)o[s-3]=arguments[s];return\"string\"==typeof e||e instanceof su?(x(\"Transaction.update\",arguments,3),r=ca(\"Transaction.update\",t,this.pf),i=Su(this.pf.Ef,\"Transaction.update\",r.w_,e,n,o)):(D(\"Transaction.update\",arguments,2),r=ca(\"Transaction.update\",t,this.pf),i=Au(this.pf.Ef,\"Transaction.update\",r.w_,e)),this.bf.update(r.w_,i),this},t.prototype.delete=function(t){D(\"Transaction.delete\",arguments,1);var e=ca(\"Transaction.delete\",t,this.pf);return this.bf.delete(e.w_),this},t}(),Wu=function(){function t(t){this.pf=t,this.vf=[],this.Sf=!1}return t.prototype.set=function(t,e,n){k(\"WriteBatch.set\",arguments,2,3),this.Df();var r=ca(\"WriteBatch.set\",t,this.pf);n=sa(\"WriteBatch.set\",n);var i=fa(r.m_,e,n),o=Nu(this.pf.Ef,\"WriteBatch.set\",r.w_,i,null!==r.m_,n);return this.vf=this.vf.concat(o.T_(r.w_,un.Ge())),this},t.prototype.update=function(t,e,n){for(var r,i,o=[],s=3;s<arguments.length;s++)o[s-3]=arguments[s];return this.Df(),\"string\"==typeof e||e instanceof su?(x(\"WriteBatch.update\",arguments,3),r=ca(\"WriteBatch.update\",t,this.pf),i=Su(this.pf.Ef,\"WriteBatch.update\",r.w_,e,n,o)):(D(\"WriteBatch.update\",arguments,2),r=ca(\"WriteBatch.update\",t,this.pf),i=Au(this.pf.Ef,\"WriteBatch.update\",r.w_,e)),this.vf=this.vf.concat(i.T_(r.w_,un.exists(!0))),this},t.prototype.delete=function(t){D(\"WriteBatch.delete\",arguments,1),this.Df();var e=ca(\"WriteBatch.delete\",t,this.pf);return this.vf=this.vf.concat(new bn(e.w_,un.Ge())),this},t.prototype.commit=function(){return this.Df(),this.Sf=!0,this.vf.length>0?this.pf._f().write(this.vf):Promise.resolve()},t.prototype.Df=function(){if(this.Sf)throw new c(a.FAILED_PRECONDITION,\"A write batch can no longer be used after commit() has been called.\")},t}(),Ku=function(e){function n(t,n,r){var i=this;return(i=e.call(this,n.d_,t,r)||this).w_=t,i.firestore=n,i.m_=r,i.ff=i.firestore._f(),i}return t.__extends(n,e),n.gf=function(t,e,r){if(t.length%2!=0)throw new c(a.INVALID_ARGUMENT,\"Invalid document reference. Document references must have an even number of segments, but \"+t.R()+\" has \"+t.length);return new n(new A(t),e,r)},Object.defineProperty(n.prototype,\"id\",{get:function(){return this.w_.path._()},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,\"parent\",{get:function(){return new oa(this.w_.path.h(),this.firestore,this.m_)},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,\"path\",{get:function(){return this.w_.path.R()},enumerable:!1,configurable:!0}),n.prototype.collection=function(t){if(D(\"DocumentReference.collection\",arguments,1),L(\"DocumentReference.collection\",\"non-empty string\",1,t),!t)throw new c(a.INVALID_ARGUMENT,\"Must provide a non-empty collection name to collection()\");var e=E.P(t);return new oa(this.w_.path.child(e),this.firestore,null)},n.prototype.isEqual=function(t){if(!(t instanceof n))throw B(\"isEqual\",\"DocumentReference\",1,t);return this.firestore===t.firestore&&this.w_.isEqual(t.w_)&&this.m_===t.m_},n.prototype.set=function(t,e){k(\"DocumentReference.set\",arguments,1,2),e=sa(\"DocumentReference.set\",e);var n=fa(this.m_,t,e),r=Nu(this.firestore.Ef,\"DocumentReference.set\",this.w_,n,null!==this.m_,e);return this.ff.write(r.T_(this.w_,un.Ge()))},n.prototype.update=function(t,e){for(var n,r=[],i=2;i<arguments.length;i++)r[i-2]=arguments[i];return\"string\"==typeof t||t instanceof su?(x(\"DocumentReference.update\",arguments,2),n=Su(this.firestore.Ef,\"DocumentReference.update\",this.w_,t,e,r)):(D(\"DocumentReference.update\",arguments,1),n=Au(this.firestore.Ef,\"DocumentReference.update\",this.w_,t)),this.ff.write(n.T_(this.w_,un.exists(!0)))},n.prototype.delete=function(){return D(\"DocumentReference.delete\",arguments,0),this.ff.write([new bn(this.w_,un.Ge())])},n.prototype.onSnapshot=function(){for(var t,e,n,r=this,i=[],o=0;o<arguments.length;o++)i[o]=arguments[o];k(\"DocumentReference.onSnapshot\",arguments,1,4);var s={includeMetadataChanges:!1},u=0;\"object\"!=typeof i[u]||qu(i[u])||(G(\"DocumentReference.onSnapshot\",s=i[u],[\"includeMetadataChanges\"]),U(\"DocumentReference.onSnapshot\",\"boolean\",\"includeMetadataChanges\",s.includeMetadataChanges),u++);var a={includeMetadataChanges:s.includeMetadataChanges};if(qu(i[u])){var c=i[u];i[u]=null===(t=c.next)||void 0===t?void 0:t.bind(c),i[u+1]=null===(e=c.error)||void 0===e?void 0:e.bind(c),i[u+2]=null===(n=c.complete)||void 0===n?void 0:n.bind(c)}else L(\"DocumentReference.onSnapshot\",\"function\",u,i[u]),O(\"DocumentReference.onSnapshot\",\"function\",u+1,i[u+1]),O(\"DocumentReference.onSnapshot\",\"function\",u+2,i[u+2]);var h={next:function(t){i[u]&&i[u](r.Cf(t))},error:i[u+1],complete:i[u+2]};return this.ff.listen(On(this.w_.path),a,h)},n.prototype.get=function(t){var e=this;k(\"DocumentReference.get\",arguments,0,1),aa(\"DocumentReference.get\",t);var n=this.firestore._f();return t&&\"cache\"===t.source?n.j_(this.w_).then((function(t){return new Hu(e.firestore,e.w_,t,!0,t instanceof Sn&&t.Ye,e.m_)})):n.K_(this.w_,t).then((function(t){return e.Cf(t)}))},n.prototype.withConverter=function(t){return new n(this.w_,this.firestore,t)},n.prototype.Cf=function(t){var e=t.docs.get(this.w_);return new Hu(this.firestore,this.w_,e,t.fromCache,t.hasPendingWrites,this.m_)},n}(wu),Yu=function(){function t(t,e){this.hasPendingWrites=t,this.fromCache=e}return t.prototype.isEqual=function(t){return this.hasPendingWrites===t.hasPendingWrites&&this.fromCache===t.fromCache},t}(),Hu=function(){function t(t,e,n,r,i,o){this.pf=t,this.w_=e,this.Nf=n,this.Ff=r,this.xf=i,this.m_=o}return t.prototype.data=function(t){var e=this;if(k(\"DocumentSnapshot.data\",arguments,0,1),t=ua(\"DocumentSnapshot.data\",t),this.Nf){if(this.m_){var n=new $u(this.pf,this.w_,this.Nf,this.Ff,this.xf,null);return this.m_.fromFirestore(n,t)}return new Gu(this.pf.d_,this.pf.yf(),t.serverTimestamps||\"none\",(function(t){return new Ku(t,e.pf,null)}),(function(t){return new et(t)})).tf(this.Nf.sn())}},t.prototype.get=function(t,e){var n=this;if(k(\"DocumentSnapshot.get\",arguments,1,2),e=ua(\"DocumentSnapshot.get\",e),this.Nf){var r=this.Nf.data().field(Ru(\"DocumentSnapshot.get\",t,this.w_));if(null!==r)return new Gu(this.pf.d_,this.pf.yf(),e.serverTimestamps||\"none\",(function(t){return new Ku(t,n.pf,n.m_)}),(function(t){return new et(t)})).tf(r)}},Object.defineProperty(t.prototype,\"id\",{get:function(){return this.w_.path._()},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,\"ref\",{get:function(){return new Ku(this.w_,this.pf,this.m_)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,\"exists\",{get:function(){return null!==this.Nf},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,\"metadata\",{get:function(){return new Yu(this.xf,this.Ff)},enumerable:!1,configurable:!0}),t.prototype.isEqual=function(e){if(!(e instanceof t))throw B(\"isEqual\",\"DocumentSnapshot\",1,e);return this.pf===e.pf&&this.Ff===e.Ff&&this.w_.isEqual(e.w_)&&(null===this.Nf?null===e.Nf:this.Nf.isEqual(e.Nf))&&this.m_===e.m_},t}(),$u=function(e){function n(){return null!==e&&e.apply(this,arguments)||this}return t.__extends(n,e),n.prototype.data=function(t){return e.prototype.data.call(this,t)},n}(Hu);function Xu(t,e,n,r,i,o,s){var u;if(i.p()){if(\"array-contains\"===o||\"array-contains-any\"===o)throw new c(a.INVALID_ARGUMENT,\"Invalid Query. You can't perform '\"+o+\"' queries on FieldPath.documentId().\");if(\"in\"===o||\"not-in\"===o){ta(s,o);for(var h=[],f=0,l=s;f<l.length;f++)h.push(Zu(r,t,l[f]));u={arrayValue:{values:h}}}else u=Zu(r,t,s)}else\"in\"!==o&&\"not-in\"!==o&&\"array-contains-any\"!==o||ta(s,o),u=Du(n,e,s,\"in\"===o||\"not-in\"===o);var d=Yn.create(i,o,u);return function(t,e){if(e.un()){var n=Pn(t);if(null!==n&&!n.isEqual(e.field))throw new c(a.INVALID_ARGUMENT,\"Invalid query. All where filters with an inequality (<, <=, >, or >=) must be on the same field. But you have inequality filters on '\"+n.toString()+\"' and '\"+e.field.toString()+\"'\");var r=Cn(t);null!==r&&ea(0,e.field,r)}var i=function(t,e){for(var n=0,r=t.filters;n<r.length;n++){var i=r[n];if(e.indexOf(i.op)>=0)return i.op}return null}(t,function(t){switch(t){case\"!=\":return[\"!=\",\"not-in\"];case\"array-contains\":return[\"array-contains\",\"array-contains-any\",\"not-in\"];case\"in\":return[\"array-contains-any\",\"in\",\"not-in\"];case\"array-contains-any\":return[\"array-contains\",\"array-contains-any\",\"in\",\"not-in\"];case\"not-in\":return[\"array-contains\",\"array-contains-any\",\"in\",\"not-in\",\"!=\"];default:return[]}}(e.op));if(null!==i)throw new c(a.INVALID_ARGUMENT,i===e.op?\"Invalid query. You cannot use more than one '\"+e.op.toString()+\"' filter.\":\"Invalid query. You cannot use '\"+e.op.toString()+\"' filters with '\"+i.toString()+\"' filters.\")}(t,d),d}function Ju(t,e,n){if(null!==t.startAt)throw new c(a.INVALID_ARGUMENT,\"Invalid query. You must not call startAt() or startAfter() before calling orderBy().\");if(null!==t.endAt)throw new c(a.INVALID_ARGUMENT,\"Invalid query. You must not call endAt() or endBefore() before calling orderBy().\");var r=new ur(e,n);return function(t,e){if(null===Cn(t)){var n=Pn(t);null!==n&&ea(0,n,e.field)}}(t,r),r}function Zu(t,e,n){if(\"string\"==typeof n){if(\"\"===n)throw new c(a.INVALID_ARGUMENT,\"Invalid query. When querying with FieldPath.documentId(), you must provide a valid document ID, but it was an empty string.\");if(!Vn(e)&&-1!==n.indexOf(\"/\"))throw new c(a.INVALID_ARGUMENT,\"Invalid query. When querying a collection by FieldPath.documentId(), you must provide a plain document ID, but '\"+n+\"' contains a '/' character.\");var r=e.path.child(E.P(n));if(!A.F(r))throw new c(a.INVALID_ARGUMENT,\"Invalid query. When querying a collection group by FieldPath.documentId(), the value provided must result in a valid document path, but '\"+r+\"' is not because it has an odd number of segments (\"+r.length+\").\");return se(t,new A(r))}if(n instanceof wu)return se(t,n.w_);throw new c(a.INVALID_ARGUMENT,\"Invalid query. When querying with FieldPath.documentId(), you must provide a valid string or a DocumentReference, but it was: \"+F(n)+\".\")}function ta(t,e){if(!Array.isArray(t)||0===t.length)throw new c(a.INVALID_ARGUMENT,\"Invalid Query. A non-empty array is required for '\"+e.toString()+\"' filters.\");if(t.length>10)throw new c(a.INVALID_ARGUMENT,\"Invalid Query. '\"+e.toString()+\"' filters support a maximum of 10 elements in the value array.\");if(\"in\"===e||\"array-contains-any\"===e){if(t.indexOf(null)>=0)throw new c(a.INVALID_ARGUMENT,\"Invalid Query. '\"+e.toString()+\"' filters cannot contain 'null' in the value array.\");if(t.filter((function(t){return Number.isNaN(t)})).length>0)throw new c(a.INVALID_ARGUMENT,\"Invalid Query. '\"+e.toString()+\"' filters cannot contain 'NaN' in the value array.\")}}function ea(t,e,n){if(!n.isEqual(e))throw new c(a.INVALID_ARGUMENT,\"Invalid query. You have a where filter with an inequality (<, <=, >, or >=) on field '\"+e.toString()+\"' and so you must also use '\"+e.toString()+\"' as your first orderBy(), but your first orderBy() is on field '\"+n.toString()+\"' instead.\")}function na(t){if(Un(t)&&0===t.rn.length)throw new c(a.UNIMPLEMENTED,\"limitToLast() queries require specifying at least one orderBy() clause\")}var ra=function(){function e(t,e,n){this.$f=t,this.firestore=e,this.m_=n}return e.prototype.where=function(t,n,r){D(\"Query.where\",arguments,3),q(\"Query.where\",3,r);var i=P(\"Query.where\",[\"<\",\"<=\",\"==\",\"!=\",\">=\",\">\",\"array-contains\",\"in\",\"array-contains-any\",\"not-in\"],2,n),o=Ru(\"Query.where\",t),s=Xu(this.$f,\"Query.where\",this.firestore.Ef,this.firestore.d_,o,i,r);return new e(function(t,e){var n=t.filters.concat([e]);return new kn(t.path,t.collectionGroup,t.rn.slice(),n,t.limit,t.on,t.startAt,t.endAt)}(this.$f,s),this.firestore,this.m_)},e.prototype.orderBy=function(t,n){var r;if(k(\"Query.orderBy\",arguments,1,2),O(\"Query.orderBy\",\"non-empty string\",2,n),void 0===n||\"asc\"===n)r=\"asc\";else{if(\"desc\"!==n)throw new c(a.INVALID_ARGUMENT,\"Function Query.orderBy() has unknown direction '\"+n+\"', expected 'asc' or 'desc'.\");r=\"desc\"}var i=Ru(\"Query.orderBy\",t),o=Ju(this.$f,i,r);return new e(function(t,e){var n=t.rn.concat([e]);return new kn(t.path,t.collectionGroup,n,t.filters.slice(),t.limit,t.on,t.startAt,t.endAt)}(this.$f,o),this.firestore,this.m_)},e.prototype.limit=function(t){return D(\"Query.limit\",arguments,1),L(\"Query.limit\",\"number\",1,t),j(\"Query.limit\",1,t),new e(qn(this.$f,t,\"F\"),this.firestore,this.m_)},e.prototype.limitToLast=function(t){return D(\"Query.limitToLast\",arguments,1),L(\"Query.limitToLast\",\"number\",1,t),j(\"Query.limitToLast\",1,t),new e(qn(this.$f,t,\"L\"),this.firestore,this.m_)},e.prototype.startAt=function(t){for(var n=[],r=1;r<arguments.length;r++)n[r-1]=arguments[r];x(\"Query.startAt\",arguments,1);var i=this.kf(\"Query.startAt\",t,n,!0);return new e(Gn(this.$f,i),this.firestore,this.m_)},e.prototype.startAfter=function(t){for(var n=[],r=1;r<arguments.length;r++)n[r-1]=arguments[r];x(\"Query.startAfter\",arguments,1);var i=this.kf(\"Query.startAfter\",t,n,!1);return new e(Gn(this.$f,i),this.firestore,this.m_)},e.prototype.endBefore=function(t){for(var n=[],r=1;r<arguments.length;r++)n[r-1]=arguments[r];x(\"Query.endBefore\",arguments,1);var i=this.kf(\"Query.endBefore\",t,n,!0);return new e(Bn(this.$f,i),this.firestore,this.m_)},e.prototype.endAt=function(t){for(var n=[],r=1;r<arguments.length;r++)n[r-1]=arguments[r];x(\"Query.endAt\",arguments,1);var i=this.kf(\"Query.endAt\",t,n,!1);return new e(Bn(this.$f,i),this.firestore,this.m_)},e.prototype.isEqual=function(t){if(!(t instanceof e))throw B(\"isEqual\",\"Query\",1,t);return this.firestore===t.firestore&&jn(this.$f,t.$f)&&this.m_===t.m_},e.prototype.withConverter=function(t){return new e(this.$f,this.firestore,t)},e.prototype.kf=function(e,n,r,i){if(q(e,1,n),n instanceof Hu)return D(e,t.__spreadArrays([n],r),1),function(t,e,n,r,i){if(!r)throw new c(a.NOT_FOUND,\"Can't use a DocumentSnapshot that doesn't exist for \"+n+\"().\");for(var o=[],s=0,u=Mn(t);s<u.length;s++){var h=u[s];if(h.field.p())o.push(se(e,r.key));else{var f=r.field(h.field);if(Yt(f))throw new c(a.INVALID_ARGUMENT,'Invalid query. You are trying to start or end a query using a document for which the field \"'+h.field+'\" is an uncommitted server timestamp. (Since the value of this field is unknown, you cannot start/end a query with it.)');if(null===f){var l=h.field.R();throw new c(a.INVALID_ARGUMENT,\"Invalid query. You are trying to start or end a query using a document for which the field '\"+l+\"' (used as the orderBy) does not exist.\")}o.push(f)}}return new rr(o,i)}(this.$f,this.firestore.d_,e,n.Nf,i);var o=[n].concat(r);return function(t,e,n,r,i,o){var s=t.rn;if(i.length>s.length)throw new c(a.INVALID_ARGUMENT,\"Too many arguments provided to \"+r+\"(). The number of arguments must be less than or equal to the number of orderBy() clauses\");for(var u=[],h=0;h<i.length;h++){var f=i[h];if(s[h].field.p()){if(\"string\"!=typeof f)throw new c(a.INVALID_ARGUMENT,\"Invalid query. Expected a string for document ID in \"+r+\"(), but got a \"+typeof f);if(!Vn(t)&&-1!==f.indexOf(\"/\"))throw new c(a.INVALID_ARGUMENT,\"Invalid query. When querying a collection and ordering by FieldPath.documentId(), the value passed to \"+r+\"() must be a plain document ID, but '\"+f+\"' contains a slash.\");var l=t.path.child(E.P(f));if(!A.F(l))throw new c(a.INVALID_ARGUMENT,\"Invalid query. When querying a collection group and ordering by FieldPath.documentId(), the value passed to \"+r+\"() must result in a valid document path, but '\"+l+\"' is not because it contains an odd number of segments.\");var p=new A(l);u.push(se(e,p))}else{var d=Du(n,r,f);u.push(d)}}return new rr(u,o)}(this.$f,this.firestore.d_,this.firestore.Ef,e,o,i)},e.prototype.onSnapshot=function(){for(var t,e,n,r=this,i=[],o=0;o<arguments.length;o++)i[o]=arguments[o];k(\"Query.onSnapshot\",arguments,1,4);var s={},u=0;if(\"object\"!=typeof i[u]||qu(i[u])||(G(\"Query.onSnapshot\",s=i[u],[\"includeMetadataChanges\"]),U(\"Query.onSnapshot\",\"boolean\",\"includeMetadataChanges\",s.includeMetadataChanges),u++),qu(i[u])){var a=i[u];i[u]=null===(t=a.next)||void 0===t?void 0:t.bind(a),i[u+1]=null===(e=a.error)||void 0===e?void 0:e.bind(a),i[u+2]=null===(n=a.complete)||void 0===n?void 0:n.bind(a)}else L(\"Query.onSnapshot\",\"function\",u,i[u]),O(\"Query.onSnapshot\",\"function\",u+1,i[u+1]),O(\"Query.onSnapshot\",\"function\",u+2,i[u+2]);var c={next:function(t){i[u]&&i[u](new ia(r.firestore,r.$f,t,r.m_))},error:i[u+1],complete:i[u+2]};return na(this.$f),this.firestore._f().listen(this.$f,s,c)},e.prototype.get=function(t){var e=this;k(\"Query.get\",arguments,0,1),aa(\"Query.get\",t),na(this.$f);var n=this.firestore._f();return(t&&\"cache\"===t.source?n.G_(this.$f):n.z_(this.$f,t)).then((function(t){return new ia(e.firestore,e.$f,t,e.m_)}))},e}(),ia=function(){function t(t,e,n,r){this.pf=t,this.Mf=e,this.Of=n,this.m_=r,this.Lf=null,this.Bf=null,this.metadata=new Yu(n.hasPendingWrites,n.fromCache)}return Object.defineProperty(t.prototype,\"docs\",{get:function(){var t=[];return this.forEach((function(e){return t.push(e)})),t},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,\"empty\",{get:function(){return this.Of.docs.m()},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,\"size\",{get:function(){return this.Of.docs.size},enumerable:!1,configurable:!0}),t.prototype.forEach=function(t,e){var n=this;k(\"QuerySnapshot.forEach\",arguments,1,2),L(\"QuerySnapshot.forEach\",\"function\",1,t),this.Of.docs.forEach((function(r){t.call(e,n.qf(r,n.metadata.fromCache,n.Of.Qt.has(r.key)))}))},Object.defineProperty(t.prototype,\"query\",{get:function(){return new ra(this.Mf,this.pf,this.m_)},enumerable:!1,configurable:!0}),t.prototype.docChanges=function(t){t&&(G(\"QuerySnapshot.docChanges\",t,[\"includeMetadataChanges\"]),U(\"QuerySnapshot.docChanges\",\"boolean\",\"includeMetadataChanges\",t.includeMetadataChanges));var e=!(!t||!t.includeMetadataChanges);if(e&&this.Of.jt)throw new c(a.INVALID_ARGUMENT,\"To include metadata changes with your document changes, you must also pass { includeMetadataChanges:true } to onSnapshot().\");return this.Lf&&this.Bf===e||(this.Lf=function(t,e,n){if(t.Ut.m()){var r=0;return t.docChanges.map((function(e){return{type:\"added\",doc:n(e.doc,t.fromCache,t.Qt.has(e.doc.key)),oldIndex:-1,newIndex:r++}}))}var i=t.Ut;return t.docChanges.filter((function(t){return e||3!==t.type})).map((function(e){var r=n(e.doc,t.fromCache,t.Qt.has(e.doc.key)),o=-1,s=-1;return 0!==e.type&&(o=i.indexOf(e.doc.key),i=i.delete(e.doc.key)),1!==e.type&&(s=(i=i.add(e.doc)).indexOf(e.doc.key)),{type:ha(e.type),doc:r,oldIndex:o,newIndex:s}}))}(this.Of,e,this.qf.bind(this)),this.Bf=e),this.Lf},t.prototype.isEqual=function(e){if(!(e instanceof t))throw B(\"isEqual\",\"QuerySnapshot\",1,e);return this.pf===e.pf&&jn(this.Mf,e.Mf)&&this.Of.isEqual(e.Of)&&this.m_===e.m_},t.prototype.qf=function(t,e,n){return new $u(this.pf,t.key,t,e,n,this.m_)},t}(),oa=function(e){function n(t,n,r){var i=this;if((i=e.call(this,On(t),n,r)||this).Uf=t,t.length%2!=1)throw new c(a.INVALID_ARGUMENT,\"Invalid collection reference. Collection references must have an odd number of segments, but \"+t.R()+\" has \"+t.length);return i}return t.__extends(n,e),Object.defineProperty(n.prototype,\"id\",{get:function(){return this.$f.path._()},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,\"parent\",{get:function(){var t=this.$f.path.h();return t.m()?null:new Ku(new A(t),this.firestore,null)},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,\"path\",{get:function(){return this.$f.path.R()},enumerable:!1,configurable:!0}),n.prototype.doc=function(t){k(\"CollectionReference.doc\",arguments,0,1),0===arguments.length&&(t=K.k()),L(\"CollectionReference.doc\",\"non-empty string\",1,t);var e=E.P(t);return Ku.gf(this.$f.path.child(e),this.firestore,this.m_)},n.prototype.add=function(t){D(\"CollectionReference.add\",arguments,1);var e=this.m_?this.m_.toFirestore(t):t;L(\"CollectionReference.add\",\"object\",1,e);var n=this.doc();return new Ku(n.w_,this.firestore,null).set(e).then((function(){return n}))},n.prototype.withConverter=function(t){return new n(this.Uf,this.firestore,t)},n}(ra);function sa(t,e){if(void 0===e)return{merge:!1};if(G(t,e,[\"merge\",\"mergeFields\"]),U(t,\"boolean\",\"merge\",e.merge),function(t,e,n,r,i){void 0!==r&&function(t,e,n,r,i){if(!(r instanceof Array))throw new c(a.INVALID_ARGUMENT,\"Function \"+t+\"() requires its \"+e+\" option to be an array, but it was: \"+F(r));for(var o=0;o<r.length;++o)if(!i(r[o]))throw new c(a.INVALID_ARGUMENT,\"Function \"+t+\"() requires all \"+e+\" elements to be a string or a FieldPath, but the value at index \"+o+\" was: \"+F(r[o]))}(t,\"mergeFields\",0,r,(function(t){return\"string\"==typeof t||t instanceof su}))}(t,0,0,e.mergeFields),void 0!==e.mergeFields&&void 0!==e.merge)throw new c(a.INVALID_ARGUMENT,\"Invalid options passed to function \"+t+'(): You cannot specify both \"merge\" and \"mergeFields\".');return e}function ua(t,e){return void 0===e?{}:(G(t,e,[\"serverTimestamps\"]),C(t,0,\"serverTimestamps\",e.serverTimestamps,[\"estimate\",\"previous\",\"none\"]),e)}function aa(t,e){O(t,\"object\",1,e),e&&(G(t,e,[\"source\"]),C(t,0,\"source\",e.source,[\"default\",\"server\",\"cache\"]))}function ca(t,e,n){if(e instanceof wu){if(e.firestore!==n)throw new c(a.INVALID_ARGUMENT,\"Provided document reference is from a different Firestore instance.\");return e}throw B(t,\"DocumentReference\",1,e)}function ha(t){switch(t){case 0:return\"added\";case 2:case 3:return\"modified\";case 1:return\"removed\";default:return y()}}function fa(t,e,n){return t?n&&(n.merge||n.mergeFields)?t.toFirestore(e,n):t.toFirestore(e):e}var la={Firestore:zu,GeoPoint:gu,Timestamp:ot,Blob:et,Transaction:Qu,WriteBatch:Wu,DocumentReference:Ku,DocumentSnapshot:Hu,Query:ra,QueryDocumentSnapshot:$u,QuerySnapshot:ia,CollectionReference:oa,FieldPath:su,FieldValue:vu,setLogLevel:zu.setLogLevel,CACHE_SIZE_UNLIMITED:Bu};function pa(t){!function(t,e){t.INTERNAL.registerComponent(new o.Component(\"firestore\",(function(t){return function(t,e){var n=new ru,r=new nu(n);return new zu(t,e,r,n)}(t.getProvider(\"app\").getImmediate(),t.getProvider(\"auth-internal\"))}),\"PUBLIC\").setServiceProps(Object.assign({},la)))}(t),t.registerVersion(\"@firebase/firestore\",\"1.17.1\")}pa(u.default),exports.__PRIVATE_registerFirestore=pa},NSPt:function(module,exports,__webpack_require__){\"use strict\";Object.defineProperty(exports,\"__esModule\",{value:!0});var firebase=__webpack_require__(\"wj3C\"),tslib=__webpack_require__(\"mrSG\"),util=__webpack_require__(\"zVF4\"),logger$1=__webpack_require__(\"q/0M\"),component=__webpack_require__(\"S+S0\");function _interopDefaultLegacy(e){return e&&\"object\"==typeof e&&\"default\"in e?e:{default:e}}var id,firebase__default=_interopDefaultLegacy(firebase),DOMStorageWrapper=function(){function DOMStorageWrapper(domStorage_){this.domStorage_=domStorage_,this.prefix_=\"firebase:\"}return DOMStorageWrapper.prototype.set=function(key,value){null==value?this.domStorage_.removeItem(this.prefixedName_(key)):this.domStorage_.setItem(this.prefixedName_(key),util.stringify(value))},DOMStorageWrapper.prototype.get=function(key){var storedVal=this.domStorage_.getItem(this.prefixedName_(key));return null==storedVal?null:util.jsonEval(storedVal)},DOMStorageWrapper.prototype.remove=function(key){this.domStorage_.removeItem(this.prefixedName_(key))},DOMStorageWrapper.prototype.prefixedName_=function(name){return this.prefix_+name},DOMStorageWrapper.prototype.toString=function(){return this.domStorage_.toString()},DOMStorageWrapper}(),MemoryStorage=function(){function MemoryStorage(){this.cache_={},this.isInMemoryStorage=!0}return MemoryStorage.prototype.set=function(key,value){null==value?delete this.cache_[key]:this.cache_[key]=value},MemoryStorage.prototype.get=function(key){return util.contains(this.cache_,key)?this.cache_[key]:null},MemoryStorage.prototype.remove=function(key){delete this.cache_[key]},MemoryStorage}(),createStoragefor=function(domStorageName){try{if(\"undefined\"!=typeof window&&void 0!==window[domStorageName]){var domStorage=window[domStorageName];return domStorage.setItem(\"firebase:sentinel\",\"cache\"),domStorage.removeItem(\"firebase:sentinel\"),new DOMStorageWrapper(domStorage)}}catch(e){}return new MemoryStorage},PersistentStorage=createStoragefor(\"localStorage\"),SessionStorage=createStoragefor(\"sessionStorage\"),logClient=new logger$1.Logger(\"@firebase/database\"),LUIDGenerator=(id=1,function(){return id++}),sha1=function(str){var utf8Bytes=util.stringToByteArray(str),sha1=new util.Sha1;sha1.update(utf8Bytes);var sha1Bytes=sha1.digest();return util.base64.encodeByteArray(sha1Bytes)},buildLogMessage_=function(){for(var varArgs=[],_i=0;_i<arguments.length;_i++)varArgs[_i]=arguments[_i];for(var message=\"\",i=0;i<varArgs.length;i++){var arg=varArgs[i];Array.isArray(arg)||arg&&\"object\"==typeof arg&&\"number\"==typeof arg.length?message+=buildLogMessage_.apply(null,arg):message+=\"object\"==typeof arg?util.stringify(arg):arg,message+=\" \"}return message},logger=null,firstLog_=!0,enableLogging=function(logger_,persistent){util.assert(!persistent||!0===logger_||!1===logger_,\"Can't turn on custom loggers persistently.\"),!0===logger_?(logClient.logLevel=logger$1.LogLevel.VERBOSE,logger=logClient.log.bind(logClient),persistent&&SessionStorage.set(\"logging_enabled\",!0)):\"function\"==typeof logger_?logger=logger_:(logger=null,SessionStorage.remove(\"logging_enabled\"))},log=function(){for(var varArgs=[],_i=0;_i<arguments.length;_i++)varArgs[_i]=arguments[_i];if(!0===firstLog_&&(firstLog_=!1,null===logger&&!0===SessionStorage.get(\"logging_enabled\")&&enableLogging(!0)),logger){var message=buildLogMessage_.apply(null,varArgs);logger(message)}},logWrapper=function(prefix){return function(){for(var varArgs=[],_i=0;_i<arguments.length;_i++)varArgs[_i]=arguments[_i];log.apply(void 0,tslib.__spread([prefix],varArgs))}},error=function(){for(var varArgs=[],_i=0;_i<arguments.length;_i++)varArgs[_i]=arguments[_i];var message=\"FIREBASE INTERNAL ERROR: \"+buildLogMessage_.apply(void 0,tslib.__spread(varArgs));logClient.error(message)},fatal=function(){for(var varArgs=[],_i=0;_i<arguments.length;_i++)varArgs[_i]=arguments[_i];var message=\"FIREBASE FATAL ERROR: \"+buildLogMessage_.apply(void 0,tslib.__spread(varArgs));throw logClient.error(message),new Error(message)},warn=function(){for(var varArgs=[],_i=0;_i<arguments.length;_i++)varArgs[_i]=arguments[_i];var message=\"FIREBASE WARNING: \"+buildLogMessage_.apply(void 0,tslib.__spread(varArgs));logClient.warn(message)},isInvalidJSONNumber=function(data){return\"number\"==typeof data&&(data!=data||data===Number.POSITIVE_INFINITY||data===Number.NEGATIVE_INFINITY)},MIN_NAME=\"[MIN_NAME]\",MAX_NAME=\"[MAX_NAME]\",nameCompare=function(a,b){if(a===b)return 0;if(a===MIN_NAME||b===MAX_NAME)return-1;if(b===MIN_NAME||a===MAX_NAME)return 1;var aAsInt=tryParseInt(a),bAsInt=tryParseInt(b);return null!==aAsInt?null!==bAsInt?aAsInt-bAsInt==0?a.length-b.length:aAsInt-bAsInt:-1:null!==bAsInt?1:a<b?-1:1},stringCompare=function(a,b){return a===b?0:a<b?-1:1},requireKey=function(key,obj){if(obj&&key in obj)return obj[key];throw new Error(\"Missing required key (\"+key+\") in object: \"+util.stringify(obj))},ObjectToUniqueKey=function(obj){if(\"object\"!=typeof obj||null===obj)return util.stringify(obj);var keys=[];for(var k in obj)keys.push(k);keys.sort();for(var key=\"{\",i=0;i<keys.length;i++)0!==i&&(key+=\",\"),key+=util.stringify(keys[i]),key+=\":\",key+=ObjectToUniqueKey(obj[keys[i]]);return key+\"}\"},splitStringBySize=function(str,segsize){var len=str.length;if(len<=segsize)return[str];for(var dataSegs=[],c=0;c<len;c+=segsize)dataSegs.push(str.substring(c,c+segsize>len?len:c+segsize));return dataSegs};function each(obj,fn){for(var key in obj)obj.hasOwnProperty(key)&&fn(key,obj[key])}var PUSH_CHARS,lastPushTime,lastRandChars,__EMPTY_NODE,MAX_NODE,__childrenNodeConstructor,nodeFromJSON,MAX_NODE$1,_defaultIndexMap,EMPTY_NODE,doubleToIEEE754String=function(v){var s,e,f,ln,i;util.assert(!isInvalidJSONNumber(v),\"Invalid JSON number\"),0===v?(e=0,f=0,s=1/v==-1/0?1:0):(s=v<0,(v=Math.abs(v))>=Math.pow(2,-1022)?(e=(ln=Math.min(Math.floor(Math.log(v)/Math.LN2),1023))+1023,f=Math.round(v*Math.pow(2,52-ln)-Math.pow(2,52))):(e=0,f=Math.round(v/Math.pow(2,-1074))));var bits=[];for(i=52;i;i-=1)bits.push(f%2?1:0),f=Math.floor(f/2);for(i=11;i;i-=1)bits.push(e%2?1:0),e=Math.floor(e/2);bits.push(s?1:0),bits.reverse();var str=bits.join(\"\"),hexByteString=\"\";for(i=0;i<64;i+=8){var hexByte=parseInt(str.substr(i,8),2).toString(16);1===hexByte.length&&(hexByte=\"0\"+hexByte),hexByteString+=hexByte}return hexByteString.toLowerCase()},INTEGER_REGEXP_=new RegExp(\"^-?(0*)\\\\d{1,10}$\"),tryParseInt=function(str){if(INTEGER_REGEXP_.test(str)){var intVal=Number(str);if(intVal>=-2147483648&&intVal<=2147483647)return intVal}return null},exceptionGuard=function(fn){try{fn()}catch(e){setTimeout((function(){throw warn(\"Exception was thrown by user callback.\",e.stack||\"\"),e}),Math.floor(0))}},setTimeoutNonBlocking=function(fn,time){var timeout=setTimeout(fn,time);return\"object\"==typeof timeout&&timeout.unref&&timeout.unref(),timeout},Path=function(){function Path(pathOrString,pieceNum){if(void 0===pieceNum){this.pieces_=pathOrString.split(\"/\");for(var copyTo=0,i=0;i<this.pieces_.length;i++)this.pieces_[i].length>0&&(this.pieces_[copyTo]=this.pieces_[i],copyTo++);this.pieces_.length=copyTo,this.pieceNum_=0}else this.pieces_=pathOrString,this.pieceNum_=pieceNum}return Object.defineProperty(Path,\"Empty\",{get:function(){return new Path(\"\")},enumerable:!1,configurable:!0}),Path.prototype.getFront=function(){return this.pieceNum_>=this.pieces_.length?null:this.pieces_[this.pieceNum_]},Path.prototype.getLength=function(){return this.pieces_.length-this.pieceNum_},Path.prototype.popFront=function(){var pieceNum=this.pieceNum_;return pieceNum<this.pieces_.length&&pieceNum++,new Path(this.pieces_,pieceNum)},Path.prototype.getBack=function(){return this.pieceNum_<this.pieces_.length?this.pieces_[this.pieces_.length-1]:null},Path.prototype.toString=function(){for(var pathString=\"\",i=this.pieceNum_;i<this.pieces_.length;i++)\"\"!==this.pieces_[i]&&(pathString+=\"/\"+this.pieces_[i]);return pathString||\"/\"},Path.prototype.toUrlEncodedString=function(){for(var pathString=\"\",i=this.pieceNum_;i<this.pieces_.length;i++)\"\"!==this.pieces_[i]&&(pathString+=\"/\"+encodeURIComponent(String(this.pieces_[i])));return pathString||\"/\"},Path.prototype.slice=function(begin){return void 0===begin&&(begin=0),this.pieces_.slice(this.pieceNum_+begin)},Path.prototype.parent=function(){if(this.pieceNum_>=this.pieces_.length)return null;for(var pieces=[],i=this.pieceNum_;i<this.pieces_.length-1;i++)pieces.push(this.pieces_[i]);return new Path(pieces,0)},Path.prototype.child=function(childPathObj){for(var pieces=[],i=this.pieceNum_;i<this.pieces_.length;i++)pieces.push(this.pieces_[i]);if(childPathObj instanceof Path)for(i=childPathObj.pieceNum_;i<childPathObj.pieces_.length;i++)pieces.push(childPathObj.pieces_[i]);else{var childPieces=childPathObj.split(\"/\");for(i=0;i<childPieces.length;i++)childPieces[i].length>0&&pieces.push(childPieces[i])}return new Path(pieces,0)},Path.prototype.isEmpty=function(){return this.pieceNum_>=this.pieces_.length},Path.relativePath=function(outerPath,innerPath){var outer=outerPath.getFront(),inner=innerPath.getFront();if(null===outer)return innerPath;if(outer===inner)return Path.relativePath(outerPath.popFront(),innerPath.popFront());throw new Error(\"INTERNAL ERROR: innerPath (\"+innerPath+\") is not within outerPath (\"+outerPath+\")\")},Path.comparePaths=function(left,right){for(var leftKeys=left.slice(),rightKeys=right.slice(),i=0;i<leftKeys.length&&i<rightKeys.length;i++){var cmp=nameCompare(leftKeys[i],rightKeys[i]);if(0!==cmp)return cmp}return leftKeys.length===rightKeys.length?0:leftKeys.length<rightKeys.length?-1:1},Path.prototype.equals=function(other){if(this.getLength()!==other.getLength())return!1;for(var i=this.pieceNum_,j=other.pieceNum_;i<=this.pieces_.length;i++,j++)if(this.pieces_[i]!==other.pieces_[j])return!1;return!0},Path.prototype.contains=function(other){var i=this.pieceNum_,j=other.pieceNum_;if(this.getLength()>other.getLength())return!1;for(;i<this.pieces_.length;){if(this.pieces_[i]!==other.pieces_[j])return!1;++i,++j}return!0},Path}(),ValidationPath=function(){function ValidationPath(path,errorPrefix_){this.errorPrefix_=errorPrefix_,this.parts_=path.slice(),this.byteLength_=Math.max(1,this.parts_.length);for(var i=0;i<this.parts_.length;i++)this.byteLength_+=util.stringLength(this.parts_[i]);this.checkValid_()}return Object.defineProperty(ValidationPath,\"MAX_PATH_DEPTH\",{get:function(){return 32},enumerable:!1,configurable:!0}),Object.defineProperty(ValidationPath,\"MAX_PATH_LENGTH_BYTES\",{get:function(){return 768},enumerable:!1,configurable:!0}),ValidationPath.prototype.push=function(child){this.parts_.length>0&&(this.byteLength_+=1),this.parts_.push(child),this.byteLength_+=util.stringLength(child),this.checkValid_()},ValidationPath.prototype.pop=function(){var last=this.parts_.pop();this.byteLength_-=util.stringLength(last),this.parts_.length>0&&(this.byteLength_-=1)},ValidationPath.prototype.checkValid_=function(){if(this.byteLength_>ValidationPath.MAX_PATH_LENGTH_BYTES)throw new Error(this.errorPrefix_+\"has a key path longer than \"+ValidationPath.MAX_PATH_LENGTH_BYTES+\" bytes (\"+this.byteLength_+\").\");if(this.parts_.length>ValidationPath.MAX_PATH_DEPTH)throw new Error(this.errorPrefix_+\"path specified exceeds the maximum depth that can be written (\"+ValidationPath.MAX_PATH_DEPTH+\") or object contains a cycle \"+this.toErrorString())},ValidationPath.prototype.toErrorString=function(){return 0===this.parts_.length?\"\":\"in property '\"+this.parts_.join(\".\")+\"'\"},ValidationPath}(),RepoInfo=function(){function RepoInfo(host,secure,namespace,webSocketOnly,nodeAdmin,persistenceKey,includeNamespaceInQueryParams){void 0===nodeAdmin&&(nodeAdmin=!1),void 0===persistenceKey&&(persistenceKey=\"\"),void 0===includeNamespaceInQueryParams&&(includeNamespaceInQueryParams=!1),this.secure=secure,this.namespace=namespace,this.webSocketOnly=webSocketOnly,this.nodeAdmin=nodeAdmin,this.persistenceKey=persistenceKey,this.includeNamespaceInQueryParams=includeNamespaceInQueryParams,this.host=host.toLowerCase(),this.domain=this.host.substr(this.host.indexOf(\".\")+1),this.internalHost=PersistentStorage.get(\"host:\"+host)||this.host}return RepoInfo.prototype.needsQueryParam=function(){return this.host!==this.internalHost||this.isCustomHost()||this.includeNamespaceInQueryParams},RepoInfo.prototype.isCacheableHost=function(){return\"s-\"===this.internalHost.substr(0,2)},RepoInfo.prototype.isDemoHost=function(){return\"firebaseio-demo.com\"===this.domain},RepoInfo.prototype.isCustomHost=function(){return\"firebaseio.com\"!==this.domain&&\"firebaseio-demo.com\"!==this.domain},RepoInfo.prototype.updateHost=function(newHost){newHost!==this.internalHost&&(this.internalHost=newHost,this.isCacheableHost()&&PersistentStorage.set(\"host:\"+this.host,this.internalHost))},RepoInfo.prototype.connectionURL=function(type,params){var connURL;if(util.assert(\"string\"==typeof type,\"typeof type must == string\"),util.assert(\"object\"==typeof params,\"typeof params must == object\"),\"websocket\"===type)connURL=(this.secure?\"wss://\":\"ws://\")+this.internalHost+\"/.ws?\";else{if(\"long_polling\"!==type)throw new Error(\"Unknown connection type: \"+type);connURL=(this.secure?\"https://\":\"http://\")+this.internalHost+\"/.lp?\"}this.needsQueryParam()&&(params.ns=this.namespace);var pairs=[];return each(params,(function(key,value){pairs.push(key+\"=\"+value)})),connURL+pairs.join(\"&\")},RepoInfo.prototype.toString=function(){var str=this.toURLString();return this.persistenceKey&&(str+=\"<\"+this.persistenceKey+\">\"),str},RepoInfo.prototype.toURLString=function(){return(this.secure?\"https://\":\"http://\")+this.host},RepoInfo}(),parseRepoInfo=function(dataURL,nodeAdmin){var parsedUrl=parseDatabaseURL(dataURL),namespace=parsedUrl.namespace;return\"firebase.com\"===parsedUrl.domain&&fatal(parsedUrl.host+\" is no longer supported. Please use <YOUR FIREBASE>.firebaseio.com instead\"),namespace&&\"undefined\"!==namespace||\"localhost\"===parsedUrl.domain||fatal(\"Cannot parse Firebase url. Please use https://<YOUR FIREBASE>.firebaseio.com\"),parsedUrl.secure||\"undefined\"!=typeof window&&window.location&&window.location.protocol&&-1!==window.location.protocol.indexOf(\"https:\")&&warn(\"Insecure Firebase access from a secure page. Please use https in calls to new Firebase().\"),{repoInfo:new RepoInfo(parsedUrl.host,parsedUrl.secure,namespace,nodeAdmin,\"ws\"===parsedUrl.scheme||\"wss\"===parsedUrl.scheme,\"\",namespace!==parsedUrl.subdomain),path:new Path(parsedUrl.pathString)}},parseDatabaseURL=function(dataURL){var host=\"\",domain=\"\",subdomain=\"\",pathString=\"\",namespace=\"\",secure=!0,scheme=\"https\",port=443;if(\"string\"==typeof dataURL){var colonInd=dataURL.indexOf(\"//\");colonInd>=0&&(scheme=dataURL.substring(0,colonInd-1),dataURL=dataURL.substring(colonInd+2));var slashInd=dataURL.indexOf(\"/\");-1===slashInd&&(slashInd=dataURL.length);var questionMarkInd=dataURL.indexOf(\"?\");-1===questionMarkInd&&(questionMarkInd=dataURL.length),host=dataURL.substring(0,Math.min(slashInd,questionMarkInd)),slashInd<questionMarkInd&&(pathString=function(pathString){for(var pathStringDecoded=\"\",pieces=pathString.split(\"/\"),i=0;i<pieces.length;i++)if(pieces[i].length>0){var piece=pieces[i];try{piece=decodeURIComponent(piece.replace(/\\+/g,\" \"))}catch(e){}pathStringDecoded+=\"/\"+piece}return pathStringDecoded}(dataURL.substring(slashInd,questionMarkInd)));var queryParams=function(queryString){var e_1,_a,results={};\"?\"===queryString.charAt(0)&&(queryString=queryString.substring(1));try{for(var _b=tslib.__values(queryString.split(\"&\")),_c=_b.next();!_c.done;_c=_b.next()){var segment=_c.value;if(0!==segment.length){var kv=segment.split(\"=\");2===kv.length?results[decodeURIComponent(kv[0])]=decodeURIComponent(kv[1]):warn(\"Invalid query segment '\"+segment+\"' in query '\"+queryString+\"'\")}}}catch(e_1_1){e_1={error:e_1_1}}finally{try{_c&&!_c.done&&(_a=_b.return)&&_a.call(_b)}finally{if(e_1)throw e_1.error}}return results}(dataURL.substring(Math.min(dataURL.length,questionMarkInd)));(colonInd=host.indexOf(\":\"))>=0?(secure=\"https\"===scheme||\"wss\"===scheme,port=parseInt(host.substring(colonInd+1),10)):colonInd=host.length;var hostWithoutPort=host.slice(0,colonInd);if(\"localhost\"===hostWithoutPort.toLowerCase())domain=\"localhost\";else if(hostWithoutPort.split(\".\").length<=2)domain=hostWithoutPort;else{var dotInd=host.indexOf(\".\");subdomain=host.substring(0,dotInd).toLowerCase(),domain=host.substring(dotInd+1),namespace=subdomain}\"ns\"in queryParams&&(namespace=queryParams.ns)}return{host:host,port:port,domain:domain,subdomain:subdomain,secure:secure,scheme:scheme,pathString:pathString,namespace:namespace}},INVALID_KEY_REGEX_=/[\\[\\].#$\\/\\u0000-\\u001F\\u007F]/,INVALID_PATH_REGEX_=/[\\[\\].#$\\u0000-\\u001F\\u007F]/,isValidKey=function(key){return\"string\"==typeof key&&0!==key.length&&!INVALID_KEY_REGEX_.test(key)},isValidPathString=function(pathString){return\"string\"==typeof pathString&&0!==pathString.length&&!INVALID_PATH_REGEX_.test(pathString)},isValidPriority=function(priority){return null===priority||\"string\"==typeof priority||\"number\"==typeof priority&&!isInvalidJSONNumber(priority)||priority&&\"object\"==typeof priority&&util.contains(priority,\".sv\")},validateFirebaseDataArg=function(fnName,argumentNumber,data,path,optional){optional&&void 0===data||validateFirebaseData(util.errorPrefix(fnName,argumentNumber,optional),data,path)},validateFirebaseData=function(errorPrefix,data,path_){var path=path_ instanceof Path?new ValidationPath(path_,errorPrefix):path_;if(void 0===data)throw new Error(errorPrefix+\"contains undefined \"+path.toErrorString());if(\"function\"==typeof data)throw new Error(errorPrefix+\"contains a function \"+path.toErrorString()+\" with contents = \"+data.toString());if(isInvalidJSONNumber(data))throw new Error(errorPrefix+\"contains \"+data.toString()+\" \"+path.toErrorString());if(\"string\"==typeof data&&data.length>10485760/3&&util.stringLength(data)>10485760)throw new Error(errorPrefix+\"contains a string greater than 10485760 utf8 bytes \"+path.toErrorString()+\" ('\"+data.substring(0,50)+\"...')\");if(data&&\"object\"==typeof data){var hasDotValue_1=!1,hasActualChild_1=!1;if(each(data,(function(key,value){if(\".value\"===key)hasDotValue_1=!0;else if(\".priority\"!==key&&\".sv\"!==key&&(hasActualChild_1=!0,!isValidKey(key)))throw new Error(errorPrefix+\" contains an invalid key (\"+key+\") \"+path.toErrorString()+'.  Keys must be non-empty strings and can\\'t contain \".\", \"#\", \"$\", \"/\", \"[\", or \"]\"');path.push(key),validateFirebaseData(errorPrefix,value,path),path.pop()})),hasDotValue_1&&hasActualChild_1)throw new Error(errorPrefix+' contains \".value\" child '+path.toErrorString()+\" in addition to actual children.\")}},validateFirebaseMergeDataArg=function(fnName,argumentNumber,data,path,optional){if(!optional||void 0!==data){var errorPrefix=util.errorPrefix(fnName,argumentNumber,optional);if(!data||\"object\"!=typeof data||Array.isArray(data))throw new Error(errorPrefix+\" must be an object containing the children to replace.\");var mergePaths=[];each(data,(function(key,value){var curPath=new Path(key);if(validateFirebaseData(errorPrefix,value,path.child(curPath)),\".priority\"===curPath.getBack()&&!isValidPriority(value))throw new Error(errorPrefix+\"contains an invalid value for '\"+curPath.toString()+\"', which must be a valid Firebase priority (a string, finite number, server value, or null).\");mergePaths.push(curPath)})),function(errorPrefix,mergePaths){var i,curPath;for(i=0;i<mergePaths.length;i++)for(var keys=(curPath=mergePaths[i]).slice(),j=0;j<keys.length;j++)if(\".priority\"===keys[j]&&j===keys.length-1);else if(!isValidKey(keys[j]))throw new Error(errorPrefix+\"contains an invalid key (\"+keys[j]+\") in path \"+curPath.toString()+'. Keys must be non-empty strings and can\\'t contain \".\", \"#\", \"$\", \"/\", \"[\", or \"]\"');mergePaths.sort(Path.comparePaths);var prevPath=null;for(i=0;i<mergePaths.length;i++){if(curPath=mergePaths[i],null!==prevPath&&prevPath.contains(curPath))throw new Error(errorPrefix+\"contains a path \"+prevPath.toString()+\" that is ancestor of another path \"+curPath.toString());prevPath=curPath}}(errorPrefix,mergePaths)}},validatePriority=function(fnName,argumentNumber,priority,optional){if(!optional||void 0!==priority){if(isInvalidJSONNumber(priority))throw new Error(util.errorPrefix(fnName,argumentNumber,optional)+\"is \"+priority.toString()+\", but must be a valid Firebase priority (a string, finite number, server value, or null).\");if(!isValidPriority(priority))throw new Error(util.errorPrefix(fnName,argumentNumber,optional)+\"must be a valid Firebase priority (a string, finite number, server value, or null).\")}},validateEventType=function(fnName,argumentNumber,eventType,optional){if(!optional||void 0!==eventType)switch(eventType){case\"value\":case\"child_added\":case\"child_removed\":case\"child_changed\":case\"child_moved\":break;default:throw new Error(util.errorPrefix(fnName,argumentNumber,optional)+'must be a valid event type = \"value\", \"child_added\", \"child_removed\", \"child_changed\", or \"child_moved\".')}},validateKey=function(fnName,argumentNumber,key,optional){if(!(optional&&void 0===key||isValidKey(key)))throw new Error(util.errorPrefix(fnName,argumentNumber,optional)+'was an invalid key = \"'+key+'\".  Firebase keys must be non-empty strings and can\\'t contain \".\", \"#\", \"$\", \"/\", \"[\", or \"]\").')},validatePathString=function(fnName,argumentNumber,pathString,optional){if(!(optional&&void 0===pathString||isValidPathString(pathString)))throw new Error(util.errorPrefix(fnName,argumentNumber,optional)+'was an invalid path = \"'+pathString+'\". Paths must be non-empty strings and can\\'t contain \".\", \"#\", \"$\", \"[\", or \"]\"')},validateRootPathString=function(fnName,argumentNumber,pathString,optional){pathString&&(pathString=pathString.replace(/^\\/*\\.info(\\/|$)/,\"/\")),validatePathString(fnName,argumentNumber,pathString,optional)},validateWritablePath=function(fnName,path){if(\".info\"===path.getFront())throw new Error(fnName+\" failed = Can't modify data under /.info/\")},validateUrl=function(fnName,argumentNumber,parsedUrl){var pathString=parsedUrl.path.toString();if(\"string\"!=typeof parsedUrl.repoInfo.host||0===parsedUrl.repoInfo.host.length||!isValidKey(parsedUrl.repoInfo.namespace)&&\"localhost\"!==parsedUrl.repoInfo.host.split(\":\")[0]||0!==pathString.length&&!function(pathString){return pathString&&(pathString=pathString.replace(/^\\/*\\.info(\\/|$)/,\"/\")),isValidPathString(pathString)}(pathString))throw new Error(util.errorPrefix(fnName,argumentNumber,!1)+'must be a valid firebase URL and the path can\\'t contain \".\", \"#\", \"$\", \"[\", or \"]\".')},validateBoolean=function(fnName,argumentNumber,bool,optional){if((!optional||void 0!==bool)&&\"boolean\"!=typeof bool)throw new Error(util.errorPrefix(fnName,argumentNumber,optional)+\"must be a boolean.\")},OnDisconnect=function(){function OnDisconnect(repo_,path_){this.repo_=repo_,this.path_=path_}return OnDisconnect.prototype.cancel=function(onComplete){util.validateArgCount(\"OnDisconnect.cancel\",0,1,arguments.length),util.validateCallback(\"OnDisconnect.cancel\",1,onComplete,!0);var deferred=new util.Deferred;return this.repo_.onDisconnectCancel(this.path_,deferred.wrapCallback(onComplete)),deferred.promise},OnDisconnect.prototype.remove=function(onComplete){util.validateArgCount(\"OnDisconnect.remove\",0,1,arguments.length),validateWritablePath(\"OnDisconnect.remove\",this.path_),util.validateCallback(\"OnDisconnect.remove\",1,onComplete,!0);var deferred=new util.Deferred;return this.repo_.onDisconnectSet(this.path_,null,deferred.wrapCallback(onComplete)),deferred.promise},OnDisconnect.prototype.set=function(value,onComplete){util.validateArgCount(\"OnDisconnect.set\",1,2,arguments.length),validateWritablePath(\"OnDisconnect.set\",this.path_),validateFirebaseDataArg(\"OnDisconnect.set\",1,value,this.path_,!1),util.validateCallback(\"OnDisconnect.set\",2,onComplete,!0);var deferred=new util.Deferred;return this.repo_.onDisconnectSet(this.path_,value,deferred.wrapCallback(onComplete)),deferred.promise},OnDisconnect.prototype.setWithPriority=function(value,priority,onComplete){util.validateArgCount(\"OnDisconnect.setWithPriority\",2,3,arguments.length),validateWritablePath(\"OnDisconnect.setWithPriority\",this.path_),validateFirebaseDataArg(\"OnDisconnect.setWithPriority\",1,value,this.path_,!1),validatePriority(\"OnDisconnect.setWithPriority\",2,priority,!1),util.validateCallback(\"OnDisconnect.setWithPriority\",3,onComplete,!0);var deferred=new util.Deferred;return this.repo_.onDisconnectSetWithPriority(this.path_,value,priority,deferred.wrapCallback(onComplete)),deferred.promise},OnDisconnect.prototype.update=function(objectToMerge,onComplete){if(util.validateArgCount(\"OnDisconnect.update\",1,2,arguments.length),validateWritablePath(\"OnDisconnect.update\",this.path_),Array.isArray(objectToMerge)){for(var newObjectToMerge={},i=0;i<objectToMerge.length;++i)newObjectToMerge[\"\"+i]=objectToMerge[i];objectToMerge=newObjectToMerge,warn(\"Passing an Array to firebase.database.onDisconnect().update() is deprecated. Use set() if you want to overwrite the existing data, or an Object with integer keys if you really do want to only update some of the children.\")}validateFirebaseMergeDataArg(\"OnDisconnect.update\",1,objectToMerge,this.path_,!1),util.validateCallback(\"OnDisconnect.update\",2,onComplete,!0);var deferred=new util.Deferred;return this.repo_.onDisconnectUpdate(this.path_,objectToMerge,deferred.wrapCallback(onComplete)),deferred.promise},OnDisconnect}(),TransactionResult=function(){function TransactionResult(committed,snapshot){this.committed=committed,this.snapshot=snapshot}return TransactionResult.prototype.toJSON=function(){return util.validateArgCount(\"TransactionResult.toJSON\",0,1,arguments.length),{committed:this.committed,snapshot:this.snapshot.toJSON()}},TransactionResult}(),nextPushId=(PUSH_CHARS=\"-0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ_abcdefghijklmnopqrstuvwxyz\",lastPushTime=0,lastRandChars=[],function(now){var i,duplicateTime=now===lastPushTime;lastPushTime=now;var timeStampChars=new Array(8);for(i=7;i>=0;i--)timeStampChars[i]=PUSH_CHARS.charAt(now%64),now=Math.floor(now/64);util.assert(0===now,\"Cannot push at time == 0\");var id=timeStampChars.join(\"\");if(duplicateTime){for(i=11;i>=0&&63===lastRandChars[i];i--)lastRandChars[i]=0;lastRandChars[i]++}else for(i=0;i<12;i++)lastRandChars[i]=Math.floor(64*Math.random());for(i=0;i<12;i++)id+=PUSH_CHARS.charAt(lastRandChars[i]);return util.assert(20===id.length,\"nextPushId: Length should be 20.\"),id}),NamedNode=function(){function NamedNode(name,node){this.name=name,this.node=node}return NamedNode.Wrap=function(name,node){return new NamedNode(name,node)},NamedNode}(),Index=function(){function Index(){}return Index.prototype.getCompare=function(){return this.compare.bind(this)},Index.prototype.indexedValueChanged=function(oldNode,newNode){var oldWrapped=new NamedNode(MIN_NAME,oldNode),newWrapped=new NamedNode(MIN_NAME,newNode);return 0!==this.compare(oldWrapped,newWrapped)},Index.prototype.minPost=function(){return NamedNode.MIN},Index}(),KeyIndex=function(_super){function KeyIndex(){return null!==_super&&_super.apply(this,arguments)||this}return tslib.__extends(KeyIndex,_super),Object.defineProperty(KeyIndex,\"__EMPTY_NODE\",{get:function(){return __EMPTY_NODE},set:function(val){__EMPTY_NODE=val},enumerable:!1,configurable:!0}),KeyIndex.prototype.compare=function(a,b){return nameCompare(a.name,b.name)},KeyIndex.prototype.isDefinedOn=function(node){throw util.assertionError(\"KeyIndex.isDefinedOn not expected to be called.\")},KeyIndex.prototype.indexedValueChanged=function(oldNode,newNode){return!1},KeyIndex.prototype.minPost=function(){return NamedNode.MIN},KeyIndex.prototype.maxPost=function(){return new NamedNode(MAX_NAME,__EMPTY_NODE)},KeyIndex.prototype.makePost=function(indexValue,name){return util.assert(\"string\"==typeof indexValue,\"KeyIndex indexValue must always be a string.\"),new NamedNode(indexValue,__EMPTY_NODE)},KeyIndex.prototype.toString=function(){return\".key\"},KeyIndex}(Index),KEY_INDEX=new KeyIndex,priorityHashText=function(priority){return\"number\"==typeof priority?\"number:\"+doubleToIEEE754String(priority):\"string:\"+priority},validatePriorityNode=function(priorityNode){if(priorityNode.isLeafNode()){var val=priorityNode.val();util.assert(\"string\"==typeof val||\"number\"==typeof val||\"object\"==typeof val&&util.contains(val,\".sv\"),\"Priority must be a string or number.\")}else util.assert(priorityNode===MAX_NODE||priorityNode.isEmpty(),\"priority of unexpected type.\");util.assert(priorityNode===MAX_NODE||priorityNode.getPriority().isEmpty(),\"Priority nodes can't have a priority of their own.\")},LeafNode=function(){function LeafNode(value_,priorityNode_){void 0===priorityNode_&&(priorityNode_=LeafNode.__childrenNodeConstructor.EMPTY_NODE),this.value_=value_,this.priorityNode_=priorityNode_,this.lazyHash_=null,util.assert(null!=this.value_,\"LeafNode shouldn't be created with null/undefined value.\"),validatePriorityNode(this.priorityNode_)}return Object.defineProperty(LeafNode,\"__childrenNodeConstructor\",{get:function(){return __childrenNodeConstructor},set:function(val){__childrenNodeConstructor=val},enumerable:!1,configurable:!0}),LeafNode.prototype.isLeafNode=function(){return!0},LeafNode.prototype.getPriority=function(){return this.priorityNode_},LeafNode.prototype.updatePriority=function(newPriorityNode){return new LeafNode(this.value_,newPriorityNode)},LeafNode.prototype.getImmediateChild=function(childName){return\".priority\"===childName?this.priorityNode_:LeafNode.__childrenNodeConstructor.EMPTY_NODE},LeafNode.prototype.getChild=function(path){return path.isEmpty()?this:\".priority\"===path.getFront()?this.priorityNode_:LeafNode.__childrenNodeConstructor.EMPTY_NODE},LeafNode.prototype.hasChild=function(){return!1},LeafNode.prototype.getPredecessorChildName=function(childName,childNode){return null},LeafNode.prototype.updateImmediateChild=function(childName,newChildNode){return\".priority\"===childName?this.updatePriority(newChildNode):newChildNode.isEmpty()&&\".priority\"!==childName?this:LeafNode.__childrenNodeConstructor.EMPTY_NODE.updateImmediateChild(childName,newChildNode).updatePriority(this.priorityNode_)},LeafNode.prototype.updateChild=function(path,newChildNode){var front=path.getFront();return null===front?newChildNode:newChildNode.isEmpty()&&\".priority\"!==front?this:(util.assert(\".priority\"!==front||1===path.getLength(),\".priority must be the last token in a path\"),this.updateImmediateChild(front,LeafNode.__childrenNodeConstructor.EMPTY_NODE.updateChild(path.popFront(),newChildNode)))},LeafNode.prototype.isEmpty=function(){return!1},LeafNode.prototype.numChildren=function(){return 0},LeafNode.prototype.forEachChild=function(index,action){return!1},LeafNode.prototype.val=function(exportFormat){return exportFormat&&!this.getPriority().isEmpty()?{\".value\":this.getValue(),\".priority\":this.getPriority().val()}:this.getValue()},LeafNode.prototype.hash=function(){if(null===this.lazyHash_){var toHash=\"\";this.priorityNode_.isEmpty()||(toHash+=\"priority:\"+priorityHashText(this.priorityNode_.val())+\":\");var type=typeof this.value_;toHash+=type+\":\",toHash+=\"number\"===type?doubleToIEEE754String(this.value_):this.value_,this.lazyHash_=sha1(toHash)}return this.lazyHash_},LeafNode.prototype.getValue=function(){return this.value_},LeafNode.prototype.compareTo=function(other){return other===LeafNode.__childrenNodeConstructor.EMPTY_NODE?1:other instanceof LeafNode.__childrenNodeConstructor?-1:(util.assert(other.isLeafNode(),\"Unknown node type\"),this.compareToLeafNode_(other))},LeafNode.prototype.compareToLeafNode_=function(otherLeaf){var otherLeafType=typeof otherLeaf.value_,thisLeafType=typeof this.value_,otherIndex=LeafNode.VALUE_TYPE_ORDER.indexOf(otherLeafType),thisIndex=LeafNode.VALUE_TYPE_ORDER.indexOf(thisLeafType);return util.assert(otherIndex>=0,\"Unknown leaf type: \"+otherLeafType),util.assert(thisIndex>=0,\"Unknown leaf type: \"+thisLeafType),otherIndex===thisIndex?\"object\"===thisLeafType?0:this.value_<otherLeaf.value_?-1:this.value_===otherLeaf.value_?0:1:thisIndex-otherIndex},LeafNode.prototype.withIndex=function(){return this},LeafNode.prototype.isIndexed=function(){return!0},LeafNode.prototype.equals=function(other){return other===this||!!other.isLeafNode()&&this.value_===other.value_&&this.priorityNode_.equals(other.priorityNode_)},LeafNode.VALUE_TYPE_ORDER=[\"object\",\"boolean\",\"number\",\"string\"],LeafNode}(),PRIORITY_INDEX=new(function(_super){function PriorityIndex(){return null!==_super&&_super.apply(this,arguments)||this}return tslib.__extends(PriorityIndex,_super),PriorityIndex.prototype.compare=function(a,b){var aPriority=a.node.getPriority(),bPriority=b.node.getPriority(),indexCmp=aPriority.compareTo(bPriority);return 0===indexCmp?nameCompare(a.name,b.name):indexCmp},PriorityIndex.prototype.isDefinedOn=function(node){return!node.getPriority().isEmpty()},PriorityIndex.prototype.indexedValueChanged=function(oldNode,newNode){return!oldNode.getPriority().equals(newNode.getPriority())},PriorityIndex.prototype.minPost=function(){return NamedNode.MIN},PriorityIndex.prototype.maxPost=function(){return new NamedNode(MAX_NAME,new LeafNode(\"[PRIORITY-POST]\",MAX_NODE$1))},PriorityIndex.prototype.makePost=function(indexValue,name){var priorityNode=nodeFromJSON(indexValue);return new NamedNode(name,new LeafNode(\"[PRIORITY-POST]\",priorityNode))},PriorityIndex.prototype.toString=function(){return\".priority\"},PriorityIndex}(Index)),SortedMapIterator=function(){function SortedMapIterator(node,startKey,comparator,isReverse_,resultGenerator_){void 0===resultGenerator_&&(resultGenerator_=null),this.isReverse_=isReverse_,this.resultGenerator_=resultGenerator_,this.nodeStack_=[];for(var cmp=1;!node.isEmpty();)if(node=node,cmp=startKey?comparator(node.key,startKey):1,isReverse_&&(cmp*=-1),cmp<0)node=this.isReverse_?node.left:node.right;else{if(0===cmp){this.nodeStack_.push(node);break}this.nodeStack_.push(node),node=this.isReverse_?node.right:node.left}}return SortedMapIterator.prototype.getNext=function(){if(0===this.nodeStack_.length)return null;var result,node=this.nodeStack_.pop();if(result=this.resultGenerator_?this.resultGenerator_(node.key,node.value):{key:node.key,value:node.value},this.isReverse_)for(node=node.left;!node.isEmpty();)this.nodeStack_.push(node),node=node.right;else for(node=node.right;!node.isEmpty();)this.nodeStack_.push(node),node=node.left;return result},SortedMapIterator.prototype.hasNext=function(){return this.nodeStack_.length>0},SortedMapIterator.prototype.peek=function(){if(0===this.nodeStack_.length)return null;var node=this.nodeStack_[this.nodeStack_.length-1];return this.resultGenerator_?this.resultGenerator_(node.key,node.value):{key:node.key,value:node.value}},SortedMapIterator}(),LLRBNode=function(){function LLRBNode(key,value,color,left,right){this.key=key,this.value=value,this.color=null!=color?color:LLRBNode.RED,this.left=null!=left?left:SortedMap.EMPTY_NODE,this.right=null!=right?right:SortedMap.EMPTY_NODE}return LLRBNode.prototype.copy=function(key,value,color,left,right){return new LLRBNode(null!=key?key:this.key,null!=value?value:this.value,null!=color?color:this.color,null!=left?left:this.left,null!=right?right:this.right)},LLRBNode.prototype.count=function(){return this.left.count()+1+this.right.count()},LLRBNode.prototype.isEmpty=function(){return!1},LLRBNode.prototype.inorderTraversal=function(action){return this.left.inorderTraversal(action)||!!action(this.key,this.value)||this.right.inorderTraversal(action)},LLRBNode.prototype.reverseTraversal=function(action){return this.right.reverseTraversal(action)||action(this.key,this.value)||this.left.reverseTraversal(action)},LLRBNode.prototype.min_=function(){return this.left.isEmpty()?this:this.left.min_()},LLRBNode.prototype.minKey=function(){return this.min_().key},LLRBNode.prototype.maxKey=function(){return this.right.isEmpty()?this.key:this.right.maxKey()},LLRBNode.prototype.insert=function(key,value,comparator){var n=this,cmp=comparator(key,n.key);return(n=cmp<0?n.copy(null,null,null,n.left.insert(key,value,comparator),null):0===cmp?n.copy(null,value,null,null,null):n.copy(null,null,null,null,n.right.insert(key,value,comparator))).fixUp_()},LLRBNode.prototype.removeMin_=function(){if(this.left.isEmpty())return SortedMap.EMPTY_NODE;var n=this;return n.left.isRed_()||n.left.left.isRed_()||(n=n.moveRedLeft_()),(n=n.copy(null,null,null,n.left.removeMin_(),null)).fixUp_()},LLRBNode.prototype.remove=function(key,comparator){var n,smallest;if(comparator(key,(n=this).key)<0)n.left.isEmpty()||n.left.isRed_()||n.left.left.isRed_()||(n=n.moveRedLeft_()),n=n.copy(null,null,null,n.left.remove(key,comparator),null);else{if(n.left.isRed_()&&(n=n.rotateRight_()),n.right.isEmpty()||n.right.isRed_()||n.right.left.isRed_()||(n=n.moveRedRight_()),0===comparator(key,n.key)){if(n.right.isEmpty())return SortedMap.EMPTY_NODE;smallest=n.right.min_(),n=n.copy(smallest.key,smallest.value,null,null,n.right.removeMin_())}n=n.copy(null,null,null,null,n.right.remove(key,comparator))}return n.fixUp_()},LLRBNode.prototype.isRed_=function(){return this.color},LLRBNode.prototype.fixUp_=function(){var n=this;return n.right.isRed_()&&!n.left.isRed_()&&(n=n.rotateLeft_()),n.left.isRed_()&&n.left.left.isRed_()&&(n=n.rotateRight_()),n.left.isRed_()&&n.right.isRed_()&&(n=n.colorFlip_()),n},LLRBNode.prototype.moveRedLeft_=function(){var n=this.colorFlip_();return n.right.left.isRed_()&&(n=(n=(n=n.copy(null,null,null,null,n.right.rotateRight_())).rotateLeft_()).colorFlip_()),n},LLRBNode.prototype.moveRedRight_=function(){var n=this.colorFlip_();return n.left.left.isRed_()&&(n=(n=n.rotateRight_()).colorFlip_()),n},LLRBNode.prototype.rotateLeft_=function(){var nl=this.copy(null,null,LLRBNode.RED,null,this.right.left);return this.right.copy(null,null,this.color,nl,null)},LLRBNode.prototype.rotateRight_=function(){var nr=this.copy(null,null,LLRBNode.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,nr)},LLRBNode.prototype.colorFlip_=function(){var left=this.left.copy(null,null,!this.left.color,null,null),right=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,left,right)},LLRBNode.prototype.checkMaxDepth_=function(){var blackDepth=this.check_();return Math.pow(2,blackDepth)<=this.count()+1},LLRBNode.prototype.check_=function(){if(this.isRed_()&&this.left.isRed_())throw new Error(\"Red node has red child(\"+this.key+\",\"+this.value+\")\");if(this.right.isRed_())throw new Error(\"Right child of (\"+this.key+\",\"+this.value+\") is red\");var blackDepth=this.left.check_();if(blackDepth!==this.right.check_())throw new Error(\"Black depths differ\");return blackDepth+(this.isRed_()?0:1)},LLRBNode.RED=!0,LLRBNode.BLACK=!1,LLRBNode}(),LLRBEmptyNode=function(){function LLRBEmptyNode(){}return LLRBEmptyNode.prototype.copy=function(key,value,color,left,right){return this},LLRBEmptyNode.prototype.insert=function(key,value,comparator){return new LLRBNode(key,value,null)},LLRBEmptyNode.prototype.remove=function(key,comparator){return this},LLRBEmptyNode.prototype.count=function(){return 0},LLRBEmptyNode.prototype.isEmpty=function(){return!0},LLRBEmptyNode.prototype.inorderTraversal=function(action){return!1},LLRBEmptyNode.prototype.reverseTraversal=function(action){return!1},LLRBEmptyNode.prototype.minKey=function(){return null},LLRBEmptyNode.prototype.maxKey=function(){return null},LLRBEmptyNode.prototype.check_=function(){return 0},LLRBEmptyNode.prototype.isRed_=function(){return!1},LLRBEmptyNode}(),SortedMap=function(){function SortedMap(comparator_,root_){void 0===root_&&(root_=SortedMap.EMPTY_NODE),this.comparator_=comparator_,this.root_=root_}return SortedMap.prototype.insert=function(key,value){return new SortedMap(this.comparator_,this.root_.insert(key,value,this.comparator_).copy(null,null,LLRBNode.BLACK,null,null))},SortedMap.prototype.remove=function(key){return new SortedMap(this.comparator_,this.root_.remove(key,this.comparator_).copy(null,null,LLRBNode.BLACK,null,null))},SortedMap.prototype.get=function(key){for(var cmp,node=this.root_;!node.isEmpty();){if(0===(cmp=this.comparator_(key,node.key)))return node.value;cmp<0?node=node.left:cmp>0&&(node=node.right)}return null},SortedMap.prototype.getPredecessorKey=function(key){for(var cmp,node=this.root_,rightParent=null;!node.isEmpty();){if(0===(cmp=this.comparator_(key,node.key))){if(node.left.isEmpty())return rightParent?rightParent.key:null;for(node=node.left;!node.right.isEmpty();)node=node.right;return node.key}cmp<0?node=node.left:cmp>0&&(rightParent=node,node=node.right)}throw new Error(\"Attempted to find predecessor key for a nonexistent key.  What gives?\")},SortedMap.prototype.isEmpty=function(){return this.root_.isEmpty()},SortedMap.prototype.count=function(){return this.root_.count()},SortedMap.prototype.minKey=function(){return this.root_.minKey()},SortedMap.prototype.maxKey=function(){return this.root_.maxKey()},SortedMap.prototype.inorderTraversal=function(action){return this.root_.inorderTraversal(action)},SortedMap.prototype.reverseTraversal=function(action){return this.root_.reverseTraversal(action)},SortedMap.prototype.getIterator=function(resultGenerator){return new SortedMapIterator(this.root_,null,this.comparator_,!1,resultGenerator)},SortedMap.prototype.getIteratorFrom=function(key,resultGenerator){return new SortedMapIterator(this.root_,key,this.comparator_,!1,resultGenerator)},SortedMap.prototype.getReverseIteratorFrom=function(key,resultGenerator){return new SortedMapIterator(this.root_,key,this.comparator_,!0,resultGenerator)},SortedMap.prototype.getReverseIterator=function(resultGenerator){return new SortedMapIterator(this.root_,null,this.comparator_,!0,resultGenerator)},SortedMap.EMPTY_NODE=new LLRBEmptyNode,SortedMap}(),LOG_2=Math.log(2),Base12Num=function(){function Base12Num(length){this.count=parseInt(Math.log(length+1)/LOG_2,10),this.current_=this.count-1;var mask=parseInt(Array(this.count+1).join(\"1\"),2);this.bits_=length+1&mask}return Base12Num.prototype.nextBitIsOne=function(){var result=!(this.bits_&1<<this.current_);return this.current_--,result},Base12Num}(),buildChildSet=function(childList,cmp,keyFn,mapSortFn){childList.sort(cmp);var buildBalancedTree=function(low,high){var namedNode,key,length=high-low;if(0===length)return null;if(1===length)return namedNode=childList[low],key=keyFn?keyFn(namedNode):namedNode,new LLRBNode(key,namedNode.node,LLRBNode.BLACK,null,null);var middle=parseInt(length/2,10)+low,left=buildBalancedTree(low,middle),right=buildBalancedTree(middle+1,high);return namedNode=childList[middle],key=keyFn?keyFn(namedNode):namedNode,new LLRBNode(key,namedNode.node,LLRBNode.BLACK,left,right)},root=function(base12){for(var node=null,root=null,index=childList.length,buildPennant=function(chunkSize,color){var low=index-chunkSize,high=index;index-=chunkSize;var childTree=buildBalancedTree(low+1,high),namedNode=childList[low],key=keyFn?keyFn(namedNode):namedNode;attachPennant(new LLRBNode(key,namedNode.node,color,null,childTree))},attachPennant=function(pennant){node?(node.left=pennant,node=pennant):(root=pennant,node=pennant)},i=0;i<base12.count;++i){var isOne=base12.nextBitIsOne(),chunkSize=Math.pow(2,base12.count-(i+1));isOne?buildPennant(chunkSize,LLRBNode.BLACK):(buildPennant(chunkSize,LLRBNode.BLACK),buildPennant(chunkSize,LLRBNode.RED))}return root}(new Base12Num(childList.length));return new SortedMap(mapSortFn||cmp,root)},fallbackObject={},IndexMap=function(){function IndexMap(indexes_,indexSet_){this.indexes_=indexes_,this.indexSet_=indexSet_}return Object.defineProperty(IndexMap,\"Default\",{get:function(){return util.assert(fallbackObject&&PRIORITY_INDEX,\"ChildrenNode.ts has not been loaded\"),_defaultIndexMap=_defaultIndexMap||new IndexMap({\".priority\":fallbackObject},{\".priority\":PRIORITY_INDEX})},enumerable:!1,configurable:!0}),IndexMap.prototype.get=function(indexKey){var sortedMap=util.safeGet(this.indexes_,indexKey);if(!sortedMap)throw new Error(\"No index defined for \"+indexKey);return sortedMap instanceof SortedMap?sortedMap:null},IndexMap.prototype.hasIndex=function(indexDefinition){return util.contains(this.indexSet_,indexDefinition.toString())},IndexMap.prototype.addIndex=function(indexDefinition,existingChildren){util.assert(indexDefinition!==KEY_INDEX,\"KeyIndex always exists and isn't meant to be added to the IndexMap.\");for(var newIndex,childList=[],sawIndexedValue=!1,iter=existingChildren.getIterator(NamedNode.Wrap),next=iter.getNext();next;)sawIndexedValue=sawIndexedValue||indexDefinition.isDefinedOn(next.node),childList.push(next),next=iter.getNext();newIndex=sawIndexedValue?buildChildSet(childList,indexDefinition.getCompare()):fallbackObject;var indexName=indexDefinition.toString(),newIndexSet=tslib.__assign({},this.indexSet_);newIndexSet[indexName]=indexDefinition;var newIndexes=tslib.__assign({},this.indexes_);return newIndexes[indexName]=newIndex,new IndexMap(newIndexes,newIndexSet)},IndexMap.prototype.addToIndexes=function(namedNode,existingChildren){var _this=this;return new IndexMap(util.map(this.indexes_,(function(indexedChildren,indexName){var index=util.safeGet(_this.indexSet_,indexName);if(util.assert(index,\"Missing index implementation for \"+indexName),indexedChildren===fallbackObject){if(index.isDefinedOn(namedNode.node)){for(var childList=[],iter=existingChildren.getIterator(NamedNode.Wrap),next=iter.getNext();next;)next.name!==namedNode.name&&childList.push(next),next=iter.getNext();return childList.push(namedNode),buildChildSet(childList,index.getCompare())}return fallbackObject}var existingSnap=existingChildren.get(namedNode.name),newChildren=indexedChildren;return existingSnap&&(newChildren=newChildren.remove(new NamedNode(namedNode.name,existingSnap))),newChildren.insert(namedNode,namedNode.node)})),this.indexSet_)},IndexMap.prototype.removeFromIndexes=function(namedNode,existingChildren){return new IndexMap(util.map(this.indexes_,(function(indexedChildren){if(indexedChildren===fallbackObject)return indexedChildren;var existingSnap=existingChildren.get(namedNode.name);return existingSnap?indexedChildren.remove(new NamedNode(namedNode.name,existingSnap)):indexedChildren})),this.indexSet_)},IndexMap}();function NAME_ONLY_COMPARATOR(left,right){return nameCompare(left.name,right.name)}function NAME_COMPARATOR(left,right){return nameCompare(left,right)}var ChildrenNode=function(){function ChildrenNode(children_,priorityNode_,indexMap_){this.children_=children_,this.priorityNode_=priorityNode_,this.indexMap_=indexMap_,this.lazyHash_=null,this.priorityNode_&&validatePriorityNode(this.priorityNode_),this.children_.isEmpty()&&util.assert(!this.priorityNode_||this.priorityNode_.isEmpty(),\"An empty node cannot have a priority\")}return Object.defineProperty(ChildrenNode,\"EMPTY_NODE\",{get:function(){return EMPTY_NODE||(EMPTY_NODE=new ChildrenNode(new SortedMap(NAME_COMPARATOR),null,IndexMap.Default))},enumerable:!1,configurable:!0}),ChildrenNode.prototype.isLeafNode=function(){return!1},ChildrenNode.prototype.getPriority=function(){return this.priorityNode_||EMPTY_NODE},ChildrenNode.prototype.updatePriority=function(newPriorityNode){return this.children_.isEmpty()?this:new ChildrenNode(this.children_,newPriorityNode,this.indexMap_)},ChildrenNode.prototype.getImmediateChild=function(childName){if(\".priority\"===childName)return this.getPriority();var child=this.children_.get(childName);return null===child?EMPTY_NODE:child},ChildrenNode.prototype.getChild=function(path){var front=path.getFront();return null===front?this:this.getImmediateChild(front).getChild(path.popFront())},ChildrenNode.prototype.hasChild=function(childName){return null!==this.children_.get(childName)},ChildrenNode.prototype.updateImmediateChild=function(childName,newChildNode){if(util.assert(newChildNode,\"We should always be passing snapshot nodes\"),\".priority\"===childName)return this.updatePriority(newChildNode);var namedNode=new NamedNode(childName,newChildNode),newChildren=void 0,newIndexMap=void 0;newChildNode.isEmpty()?(newChildren=this.children_.remove(childName),newIndexMap=this.indexMap_.removeFromIndexes(namedNode,this.children_)):(newChildren=this.children_.insert(childName,newChildNode),newIndexMap=this.indexMap_.addToIndexes(namedNode,this.children_));var newPriority=newChildren.isEmpty()?EMPTY_NODE:this.priorityNode_;return new ChildrenNode(newChildren,newPriority,newIndexMap)},ChildrenNode.prototype.updateChild=function(path,newChildNode){var front=path.getFront();if(null===front)return newChildNode;util.assert(\".priority\"!==path.getFront()||1===path.getLength(),\".priority must be the last token in a path\");var newImmediateChild=this.getImmediateChild(front).updateChild(path.popFront(),newChildNode);return this.updateImmediateChild(front,newImmediateChild)},ChildrenNode.prototype.isEmpty=function(){return this.children_.isEmpty()},ChildrenNode.prototype.numChildren=function(){return this.children_.count()},ChildrenNode.prototype.val=function(exportFormat){if(this.isEmpty())return null;var obj={},numKeys=0,maxKey=0,allIntegerKeys=!0;if(this.forEachChild(PRIORITY_INDEX,(function(key,childNode){obj[key]=childNode.val(exportFormat),numKeys++,allIntegerKeys&&ChildrenNode.INTEGER_REGEXP_.test(key)?maxKey=Math.max(maxKey,Number(key)):allIntegerKeys=!1})),!exportFormat&&allIntegerKeys&&maxKey<2*numKeys){var array=[];for(var key in obj)array[key]=obj[key];return array}return exportFormat&&!this.getPriority().isEmpty()&&(obj[\".priority\"]=this.getPriority().val()),obj},ChildrenNode.prototype.hash=function(){if(null===this.lazyHash_){var toHash_1=\"\";this.getPriority().isEmpty()||(toHash_1+=\"priority:\"+priorityHashText(this.getPriority().val())+\":\"),this.forEachChild(PRIORITY_INDEX,(function(key,childNode){var childHash=childNode.hash();\"\"!==childHash&&(toHash_1+=\":\"+key+\":\"+childHash)})),this.lazyHash_=\"\"===toHash_1?\"\":sha1(toHash_1)}return this.lazyHash_},ChildrenNode.prototype.getPredecessorChildName=function(childName,childNode,index){var idx=this.resolveIndex_(index);if(idx){var predecessor=idx.getPredecessorKey(new NamedNode(childName,childNode));return predecessor?predecessor.name:null}return this.children_.getPredecessorKey(childName)},ChildrenNode.prototype.getFirstChildName=function(indexDefinition){var idx=this.resolveIndex_(indexDefinition);if(idx){var minKey=idx.minKey();return minKey&&minKey.name}return this.children_.minKey()},ChildrenNode.prototype.getFirstChild=function(indexDefinition){var minKey=this.getFirstChildName(indexDefinition);return minKey?new NamedNode(minKey,this.children_.get(minKey)):null},ChildrenNode.prototype.getLastChildName=function(indexDefinition){var idx=this.resolveIndex_(indexDefinition);if(idx){var maxKey=idx.maxKey();return maxKey&&maxKey.name}return this.children_.maxKey()},ChildrenNode.prototype.getLastChild=function(indexDefinition){var maxKey=this.getLastChildName(indexDefinition);return maxKey?new NamedNode(maxKey,this.children_.get(maxKey)):null},ChildrenNode.prototype.forEachChild=function(index,action){var idx=this.resolveIndex_(index);return idx?idx.inorderTraversal((function(wrappedNode){return action(wrappedNode.name,wrappedNode.node)})):this.children_.inorderTraversal(action)},ChildrenNode.prototype.getIterator=function(indexDefinition){return this.getIteratorFrom(indexDefinition.minPost(),indexDefinition)},ChildrenNode.prototype.getIteratorFrom=function(startPost,indexDefinition){var idx=this.resolveIndex_(indexDefinition);if(idx)return idx.getIteratorFrom(startPost,(function(key){return key}));for(var iterator=this.children_.getIteratorFrom(startPost.name,NamedNode.Wrap),next=iterator.peek();null!=next&&indexDefinition.compare(next,startPost)<0;)iterator.getNext(),next=iterator.peek();return iterator},ChildrenNode.prototype.getReverseIterator=function(indexDefinition){return this.getReverseIteratorFrom(indexDefinition.maxPost(),indexDefinition)},ChildrenNode.prototype.getReverseIteratorFrom=function(endPost,indexDefinition){var idx=this.resolveIndex_(indexDefinition);if(idx)return idx.getReverseIteratorFrom(endPost,(function(key){return key}));for(var iterator=this.children_.getReverseIteratorFrom(endPost.name,NamedNode.Wrap),next=iterator.peek();null!=next&&indexDefinition.compare(next,endPost)>0;)iterator.getNext(),next=iterator.peek();return iterator},ChildrenNode.prototype.compareTo=function(other){return this.isEmpty()?other.isEmpty()?0:-1:other.isLeafNode()||other.isEmpty()?1:other===MAX_NODE$2?-1:0},ChildrenNode.prototype.withIndex=function(indexDefinition){if(indexDefinition===KEY_INDEX||this.indexMap_.hasIndex(indexDefinition))return this;var newIndexMap=this.indexMap_.addIndex(indexDefinition,this.children_);return new ChildrenNode(this.children_,this.priorityNode_,newIndexMap)},ChildrenNode.prototype.isIndexed=function(index){return index===KEY_INDEX||this.indexMap_.hasIndex(index)},ChildrenNode.prototype.equals=function(other){if(other===this)return!0;if(other.isLeafNode())return!1;var otherChildrenNode=other;if(this.getPriority().equals(otherChildrenNode.getPriority())){if(this.children_.count()===otherChildrenNode.children_.count()){for(var thisIter=this.getIterator(PRIORITY_INDEX),otherIter=otherChildrenNode.getIterator(PRIORITY_INDEX),thisCurrent=thisIter.getNext(),otherCurrent=otherIter.getNext();thisCurrent&&otherCurrent;){if(thisCurrent.name!==otherCurrent.name||!thisCurrent.node.equals(otherCurrent.node))return!1;thisCurrent=thisIter.getNext(),otherCurrent=otherIter.getNext()}return null===thisCurrent&&null===otherCurrent}return!1}return!1},ChildrenNode.prototype.resolveIndex_=function(indexDefinition){return indexDefinition===KEY_INDEX?null:this.indexMap_.get(indexDefinition.toString())},ChildrenNode.INTEGER_REGEXP_=/^(0|[1-9]\\d*)$/,ChildrenNode}(),MAX_NODE$2=new(function(_super){function MaxNode(){return _super.call(this,new SortedMap(NAME_COMPARATOR),ChildrenNode.EMPTY_NODE,IndexMap.Default)||this}return tslib.__extends(MaxNode,_super),MaxNode.prototype.compareTo=function(other){return other===this?0:1},MaxNode.prototype.equals=function(other){return other===this},MaxNode.prototype.getPriority=function(){return this},MaxNode.prototype.getImmediateChild=function(childName){return ChildrenNode.EMPTY_NODE},MaxNode.prototype.isEmpty=function(){return!1},MaxNode}(ChildrenNode));function nodeFromJSON$1(json,priority){if(void 0===priority&&(priority=null),null===json)return ChildrenNode.EMPTY_NODE;if(\"object\"==typeof json&&\".priority\"in json&&(priority=json[\".priority\"]),util.assert(null===priority||\"string\"==typeof priority||\"number\"==typeof priority||\"object\"==typeof priority&&\".sv\"in priority,\"Invalid priority type found: \"+typeof priority),\"object\"==typeof json&&\".value\"in json&&null!==json[\".value\"]&&(json=json[\".value\"]),\"object\"!=typeof json||\".sv\"in json)return new LeafNode(json,nodeFromJSON$1(priority));if(json instanceof Array){var node_1=ChildrenNode.EMPTY_NODE;return each(json,(function(key,childData){if(util.contains(json,key)&&\".\"!==key.substring(0,1)){var childNode=nodeFromJSON$1(childData);!childNode.isLeafNode()&&childNode.isEmpty()||(node_1=node_1.updateImmediateChild(key,childNode))}})),node_1.updatePriority(nodeFromJSON$1(priority))}var children_1=[],childrenHavePriority_1=!1;if(each(json,(function(key,child){if(\".\"!==key.substring(0,1)){var childNode=nodeFromJSON$1(child);childNode.isEmpty()||(childrenHavePriority_1=childrenHavePriority_1||!childNode.getPriority().isEmpty(),children_1.push(new NamedNode(key,childNode)))}})),0===children_1.length)return ChildrenNode.EMPTY_NODE;var childSet=buildChildSet(children_1,NAME_ONLY_COMPARATOR,(function(namedNode){return namedNode.name}),NAME_COMPARATOR);if(childrenHavePriority_1){var sortedChildSet=buildChildSet(children_1,PRIORITY_INDEX.getCompare());return new ChildrenNode(childSet,nodeFromJSON$1(priority),new IndexMap({\".priority\":sortedChildSet},{\".priority\":PRIORITY_INDEX}))}return new ChildrenNode(childSet,nodeFromJSON$1(priority),IndexMap.Default)}Object.defineProperties(NamedNode,{MIN:{value:new NamedNode(MIN_NAME,ChildrenNode.EMPTY_NODE)},MAX:{value:new NamedNode(MAX_NAME,MAX_NODE$2)}}),KeyIndex.__EMPTY_NODE=ChildrenNode.EMPTY_NODE,LeafNode.__childrenNodeConstructor=ChildrenNode,MAX_NODE=MAX_NODE$2,MAX_NODE$1=MAX_NODE$2,nodeFromJSON=nodeFromJSON$1;var __referenceConstructor,VALUE_INDEX=new(function(_super){function ValueIndex(){return null!==_super&&_super.apply(this,arguments)||this}return tslib.__extends(ValueIndex,_super),ValueIndex.prototype.compare=function(a,b){var indexCmp=a.node.compareTo(b.node);return 0===indexCmp?nameCompare(a.name,b.name):indexCmp},ValueIndex.prototype.isDefinedOn=function(node){return!0},ValueIndex.prototype.indexedValueChanged=function(oldNode,newNode){return!oldNode.equals(newNode)},ValueIndex.prototype.minPost=function(){return NamedNode.MIN},ValueIndex.prototype.maxPost=function(){return NamedNode.MAX},ValueIndex.prototype.makePost=function(indexValue,name){var valueNode=nodeFromJSON$1(indexValue);return new NamedNode(name,valueNode)},ValueIndex.prototype.toString=function(){return\".value\"},ValueIndex}(Index)),PathIndex=function(_super){function PathIndex(indexPath_){var _this=_super.call(this)||this;return _this.indexPath_=indexPath_,util.assert(!indexPath_.isEmpty()&&\".priority\"!==indexPath_.getFront(),\"Can't create PathIndex with empty path or .priority key\"),_this}return tslib.__extends(PathIndex,_super),PathIndex.prototype.extractChild=function(snap){return snap.getChild(this.indexPath_)},PathIndex.prototype.isDefinedOn=function(node){return!node.getChild(this.indexPath_).isEmpty()},PathIndex.prototype.compare=function(a,b){var aChild=this.extractChild(a.node),bChild=this.extractChild(b.node),indexCmp=aChild.compareTo(bChild);return 0===indexCmp?nameCompare(a.name,b.name):indexCmp},PathIndex.prototype.makePost=function(indexValue,name){var valueNode=nodeFromJSON$1(indexValue),node=ChildrenNode.EMPTY_NODE.updateChild(this.indexPath_,valueNode);return new NamedNode(name,node)},PathIndex.prototype.maxPost=function(){var node=ChildrenNode.EMPTY_NODE.updateChild(this.indexPath_,MAX_NODE$2);return new NamedNode(MAX_NAME,node)},PathIndex.prototype.toString=function(){return this.indexPath_.slice().join(\"/\")},PathIndex}(Index),DataSnapshot=function(){function DataSnapshot(node_,ref_,index_){this.node_=node_,this.ref_=ref_,this.index_=index_}return DataSnapshot.prototype.val=function(){return util.validateArgCount(\"DataSnapshot.val\",0,0,arguments.length),this.node_.val()},DataSnapshot.prototype.exportVal=function(){return util.validateArgCount(\"DataSnapshot.exportVal\",0,0,arguments.length),this.node_.val(!0)},DataSnapshot.prototype.toJSON=function(){return util.validateArgCount(\"DataSnapshot.toJSON\",0,1,arguments.length),this.exportVal()},DataSnapshot.prototype.exists=function(){return util.validateArgCount(\"DataSnapshot.exists\",0,0,arguments.length),!this.node_.isEmpty()},DataSnapshot.prototype.child=function(childPathString){util.validateArgCount(\"DataSnapshot.child\",0,1,arguments.length),childPathString=String(childPathString),validatePathString(\"DataSnapshot.child\",1,childPathString,!1);var childPath=new Path(childPathString),childRef=this.ref_.child(childPath);return new DataSnapshot(this.node_.getChild(childPath),childRef,PRIORITY_INDEX)},DataSnapshot.prototype.hasChild=function(childPathString){util.validateArgCount(\"DataSnapshot.hasChild\",1,1,arguments.length),validatePathString(\"DataSnapshot.hasChild\",1,childPathString,!1);var childPath=new Path(childPathString);return!this.node_.getChild(childPath).isEmpty()},DataSnapshot.prototype.getPriority=function(){return util.validateArgCount(\"DataSnapshot.getPriority\",0,0,arguments.length),this.node_.getPriority().val()},DataSnapshot.prototype.forEach=function(action){var _this=this;if(util.validateArgCount(\"DataSnapshot.forEach\",1,1,arguments.length),util.validateCallback(\"DataSnapshot.forEach\",1,action,!1),this.node_.isLeafNode())return!1;var childrenNode=this.node_;return!!childrenNode.forEachChild(this.index_,(function(key,node){return action(new DataSnapshot(node,_this.ref_.child(key),PRIORITY_INDEX))}))},DataSnapshot.prototype.hasChildren=function(){return util.validateArgCount(\"DataSnapshot.hasChildren\",0,0,arguments.length),!this.node_.isLeafNode()&&!this.node_.isEmpty()},Object.defineProperty(DataSnapshot.prototype,\"key\",{get:function(){return this.ref_.getKey()},enumerable:!1,configurable:!0}),DataSnapshot.prototype.numChildren=function(){return util.validateArgCount(\"DataSnapshot.numChildren\",0,0,arguments.length),this.node_.numChildren()},DataSnapshot.prototype.getRef=function(){return util.validateArgCount(\"DataSnapshot.ref\",0,0,arguments.length),this.ref_},Object.defineProperty(DataSnapshot.prototype,\"ref\",{get:function(){return this.getRef()},enumerable:!1,configurable:!0}),DataSnapshot}(),DataEvent=function(){function DataEvent(eventType,eventRegistration,snapshot,prevName){this.eventType=eventType,this.eventRegistration=eventRegistration,this.snapshot=snapshot,this.prevName=prevName}return DataEvent.prototype.getPath=function(){var ref=this.snapshot.getRef();return\"value\"===this.eventType?ref.path:ref.getParent().path},DataEvent.prototype.getEventType=function(){return this.eventType},DataEvent.prototype.getEventRunner=function(){return this.eventRegistration.getEventRunner(this)},DataEvent.prototype.toString=function(){return this.getPath().toString()+\":\"+this.eventType+\":\"+util.stringify(this.snapshot.exportVal())},DataEvent}(),CancelEvent=function(){function CancelEvent(eventRegistration,error,path){this.eventRegistration=eventRegistration,this.error=error,this.path=path}return CancelEvent.prototype.getPath=function(){return this.path},CancelEvent.prototype.getEventType=function(){return\"cancel\"},CancelEvent.prototype.getEventRunner=function(){return this.eventRegistration.getEventRunner(this)},CancelEvent.prototype.toString=function(){return this.path.toString()+\":cancel\"},CancelEvent}(),ValueEventRegistration=function(){function ValueEventRegistration(callback_,cancelCallback_,context_){this.callback_=callback_,this.cancelCallback_=cancelCallback_,this.context_=context_}return ValueEventRegistration.prototype.respondsTo=function(eventType){return\"value\"===eventType},ValueEventRegistration.prototype.createEvent=function(change,query){var index=query.getQueryParams().getIndex();return new DataEvent(\"value\",this,new DataSnapshot(change.snapshotNode,query.getRef(),index))},ValueEventRegistration.prototype.getEventRunner=function(eventData){var ctx=this.context_;if(\"cancel\"===eventData.getEventType()){util.assert(this.cancelCallback_,\"Raising a cancel event on a listener with no cancel callback\");var cancelCB_1=this.cancelCallback_;return function(){cancelCB_1.call(ctx,eventData.error)}}var cb_1=this.callback_;return function(){cb_1.call(ctx,eventData.snapshot)}},ValueEventRegistration.prototype.createCancelEvent=function(error,path){return this.cancelCallback_?new CancelEvent(this,error,path):null},ValueEventRegistration.prototype.matches=function(other){return other instanceof ValueEventRegistration&&(!other.callback_||!this.callback_||other.callback_===this.callback_&&other.context_===this.context_)},ValueEventRegistration.prototype.hasAnyCallback=function(){return null!==this.callback_},ValueEventRegistration}(),ChildEventRegistration=function(){function ChildEventRegistration(callbacks_,cancelCallback_,context_){this.callbacks_=callbacks_,this.cancelCallback_=cancelCallback_,this.context_=context_}return ChildEventRegistration.prototype.respondsTo=function(eventType){var eventToCheck=\"children_added\"===eventType?\"child_added\":eventType;return util.contains(this.callbacks_,eventToCheck=\"children_removed\"===eventToCheck?\"child_removed\":eventToCheck)},ChildEventRegistration.prototype.createCancelEvent=function(error,path){return this.cancelCallback_?new CancelEvent(this,error,path):null},ChildEventRegistration.prototype.createEvent=function(change,query){util.assert(null!=change.childName,\"Child events should have a childName.\");var ref=query.getRef().child(change.childName),index=query.getQueryParams().getIndex();return new DataEvent(change.type,this,new DataSnapshot(change.snapshotNode,ref,index),change.prevName)},ChildEventRegistration.prototype.getEventRunner=function(eventData){var ctx=this.context_;if(\"cancel\"===eventData.getEventType()){util.assert(this.cancelCallback_,\"Raising a cancel event on a listener with no cancel callback\");var cancelCB_2=this.cancelCallback_;return function(){cancelCB_2.call(ctx,eventData.error)}}var cb_2=this.callbacks_[eventData.eventType];return function(){cb_2.call(ctx,eventData.snapshot,eventData.prevName)}},ChildEventRegistration.prototype.matches=function(other){var _this=this;if(other instanceof ChildEventRegistration){if(!this.callbacks_||!other.callbacks_)return!0;if(this.context_===other.context_){var otherKeys=Object.keys(other.callbacks_),thisKeys=Object.keys(this.callbacks_),otherCount=otherKeys.length;if(otherCount===thisKeys.length){if(1===otherCount){var otherKey=otherKeys[0],thisKey=thisKeys[0];return!(thisKey!==otherKey||other.callbacks_[otherKey]&&this.callbacks_[thisKey]&&other.callbacks_[otherKey]!==this.callbacks_[thisKey])}return thisKeys.every((function(eventType){return other.callbacks_[eventType]===_this.callbacks_[eventType]}))}}}return!1},ChildEventRegistration.prototype.hasAnyCallback=function(){return null!==this.callbacks_},ChildEventRegistration}(),Query=function(){function Query(repo,path,queryParams_,orderByCalled_){this.repo=repo,this.path=path,this.queryParams_=queryParams_,this.orderByCalled_=orderByCalled_}return Object.defineProperty(Query,\"__referenceConstructor\",{get:function(){return util.assert(__referenceConstructor,\"Reference.ts has not been loaded\"),__referenceConstructor},set:function(val){__referenceConstructor=val},enumerable:!1,configurable:!0}),Query.validateQueryEndpoints_=function(params){var startNode=null,endNode=null;if(params.hasStart()&&(startNode=params.getIndexStartValue()),params.hasEnd()&&(endNode=params.getIndexEndValue()),params.getIndex()===KEY_INDEX){var tooManyArgsError=\"Query: When ordering by key, you may only pass one argument to startAt(), endAt(), or equalTo().\",wrongArgTypeError=\"Query: When ordering by key, the argument passed to startAt(), endAt(),or equalTo() must be a string.\";if(params.hasStart()){if(params.getIndexStartName()!==MIN_NAME)throw new Error(tooManyArgsError);if(\"string\"!=typeof startNode)throw new Error(wrongArgTypeError)}if(params.hasEnd()){if(params.getIndexEndName()!==MAX_NAME)throw new Error(tooManyArgsError);if(\"string\"!=typeof endNode)throw new Error(wrongArgTypeError)}}else if(params.getIndex()===PRIORITY_INDEX){if(null!=startNode&&!isValidPriority(startNode)||null!=endNode&&!isValidPriority(endNode))throw new Error(\"Query: When ordering by priority, the first argument passed to startAt(), endAt(), or equalTo() must be a valid priority value (null, a number, or a string).\")}else if(util.assert(params.getIndex()instanceof PathIndex||params.getIndex()===VALUE_INDEX,\"unknown index type.\"),null!=startNode&&\"object\"==typeof startNode||null!=endNode&&\"object\"==typeof endNode)throw new Error(\"Query: First argument passed to startAt(), endAt(), or equalTo() cannot be an object.\")},Query.validateLimit_=function(params){if(params.hasStart()&&params.hasEnd()&&params.hasLimit()&&!params.hasAnchoredLimit())throw new Error(\"Query: Can't combine startAt(), endAt(), and limit(). Use limitToFirst() or limitToLast() instead.\")},Query.prototype.validateNoPreviousOrderByCall_=function(fnName){if(!0===this.orderByCalled_)throw new Error(fnName+\": You can't combine multiple orderBy calls.\")},Query.prototype.getQueryParams=function(){return this.queryParams_},Query.prototype.getRef=function(){return util.validateArgCount(\"Query.ref\",0,0,arguments.length),new Query.__referenceConstructor(this.repo,this.path)},Query.prototype.on=function(eventType,callback,cancelCallbackOrContext,context){util.validateArgCount(\"Query.on\",2,4,arguments.length),validateEventType(\"Query.on\",1,eventType,!1),util.validateCallback(\"Query.on\",2,callback,!1);var ret=Query.getCancelAndContextArgs_(\"Query.on\",cancelCallbackOrContext,context);if(\"value\"===eventType)this.onValueEvent(callback,ret.cancel,ret.context);else{var callbacks={};callbacks[eventType]=callback,this.onChildEvent(callbacks,ret.cancel,ret.context)}return callback},Query.prototype.onValueEvent=function(callback,cancelCallback,context){var container=new ValueEventRegistration(callback,cancelCallback||null,context||null);this.repo.addEventCallbackForQuery(this,container)},Query.prototype.onChildEvent=function(callbacks,cancelCallback,context){var container=new ChildEventRegistration(callbacks,cancelCallback,context);this.repo.addEventCallbackForQuery(this,container)},Query.prototype.off=function(eventType,callback,context){util.validateArgCount(\"Query.off\",0,3,arguments.length),validateEventType(\"Query.off\",1,eventType,!0),util.validateCallback(\"Query.off\",2,callback,!0),util.validateContextObject(\"Query.off\",3,context,!0);var container=null,callbacks=null;if(\"value\"===eventType){var valueCallback=callback||null;container=new ValueEventRegistration(valueCallback,null,context||null)}else eventType&&(callback&&((callbacks={})[eventType]=callback),container=new ChildEventRegistration(callbacks,null,context||null));this.repo.removeEventCallbackForQuery(this,container)},Query.prototype.once=function(eventType,userCallback,failureCallbackOrContext,context){var _this=this;util.validateArgCount(\"Query.once\",1,4,arguments.length),validateEventType(\"Query.once\",1,eventType,!1),util.validateCallback(\"Query.once\",2,userCallback,!0);var ret=Query.getCancelAndContextArgs_(\"Query.once\",failureCallbackOrContext,context),firstCall=!0,deferred=new util.Deferred;deferred.promise.catch((function(){}));var onceCallback=function(snapshot){firstCall&&(firstCall=!1,_this.off(eventType,onceCallback),userCallback&&userCallback.bind(ret.context)(snapshot),deferred.resolve(snapshot))};return this.on(eventType,onceCallback,(function(err){_this.off(eventType,onceCallback),ret.cancel&&ret.cancel.bind(ret.context)(err),deferred.reject(err)})),deferred.promise},Query.prototype.limitToFirst=function(limit){if(util.validateArgCount(\"Query.limitToFirst\",1,1,arguments.length),\"number\"!=typeof limit||Math.floor(limit)!==limit||limit<=0)throw new Error(\"Query.limitToFirst: First argument must be a positive integer.\");if(this.queryParams_.hasLimit())throw new Error(\"Query.limitToFirst: Limit was already set (by another call to limit, limitToFirst, or limitToLast).\");return new Query(this.repo,this.path,this.queryParams_.limitToFirst(limit),this.orderByCalled_)},Query.prototype.limitToLast=function(limit){if(util.validateArgCount(\"Query.limitToLast\",1,1,arguments.length),\"number\"!=typeof limit||Math.floor(limit)!==limit||limit<=0)throw new Error(\"Query.limitToLast: First argument must be a positive integer.\");if(this.queryParams_.hasLimit())throw new Error(\"Query.limitToLast: Limit was already set (by another call to limit, limitToFirst, or limitToLast).\");return new Query(this.repo,this.path,this.queryParams_.limitToLast(limit),this.orderByCalled_)},Query.prototype.orderByChild=function(path){if(util.validateArgCount(\"Query.orderByChild\",1,1,arguments.length),\"$key\"===path)throw new Error('Query.orderByChild: \"$key\" is invalid.  Use Query.orderByKey() instead.');if(\"$priority\"===path)throw new Error('Query.orderByChild: \"$priority\" is invalid.  Use Query.orderByPriority() instead.');if(\"$value\"===path)throw new Error('Query.orderByChild: \"$value\" is invalid.  Use Query.orderByValue() instead.');validatePathString(\"Query.orderByChild\",1,path,!1),this.validateNoPreviousOrderByCall_(\"Query.orderByChild\");var parsedPath=new Path(path);if(parsedPath.isEmpty())throw new Error(\"Query.orderByChild: cannot pass in empty path.  Use Query.orderByValue() instead.\");var index=new PathIndex(parsedPath),newParams=this.queryParams_.orderBy(index);return Query.validateQueryEndpoints_(newParams),new Query(this.repo,this.path,newParams,!0)},Query.prototype.orderByKey=function(){util.validateArgCount(\"Query.orderByKey\",0,0,arguments.length),this.validateNoPreviousOrderByCall_(\"Query.orderByKey\");var newParams=this.queryParams_.orderBy(KEY_INDEX);return Query.validateQueryEndpoints_(newParams),new Query(this.repo,this.path,newParams,!0)},Query.prototype.orderByPriority=function(){util.validateArgCount(\"Query.orderByPriority\",0,0,arguments.length),this.validateNoPreviousOrderByCall_(\"Query.orderByPriority\");var newParams=this.queryParams_.orderBy(PRIORITY_INDEX);return Query.validateQueryEndpoints_(newParams),new Query(this.repo,this.path,newParams,!0)},Query.prototype.orderByValue=function(){util.validateArgCount(\"Query.orderByValue\",0,0,arguments.length),this.validateNoPreviousOrderByCall_(\"Query.orderByValue\");var newParams=this.queryParams_.orderBy(VALUE_INDEX);return Query.validateQueryEndpoints_(newParams),new Query(this.repo,this.path,newParams,!0)},Query.prototype.startAt=function(value,name){void 0===value&&(value=null),util.validateArgCount(\"Query.startAt\",0,2,arguments.length),validateFirebaseDataArg(\"Query.startAt\",1,value,this.path,!0),validateKey(\"Query.startAt\",2,name,!0);var newParams=this.queryParams_.startAt(value,name);if(Query.validateLimit_(newParams),Query.validateQueryEndpoints_(newParams),this.queryParams_.hasStart())throw new Error(\"Query.startAt: Starting point was already set (by another call to startAt or equalTo).\");return void 0===value&&(value=null,name=null),new Query(this.repo,this.path,newParams,this.orderByCalled_)},Query.prototype.endAt=function(value,name){void 0===value&&(value=null),util.validateArgCount(\"Query.endAt\",0,2,arguments.length),validateFirebaseDataArg(\"Query.endAt\",1,value,this.path,!0),validateKey(\"Query.endAt\",2,name,!0);var newParams=this.queryParams_.endAt(value,name);if(Query.validateLimit_(newParams),Query.validateQueryEndpoints_(newParams),this.queryParams_.hasEnd())throw new Error(\"Query.endAt: Ending point was already set (by another call to endAt or equalTo).\");return new Query(this.repo,this.path,newParams,this.orderByCalled_)},Query.prototype.equalTo=function(value,name){if(util.validateArgCount(\"Query.equalTo\",1,2,arguments.length),validateFirebaseDataArg(\"Query.equalTo\",1,value,this.path,!1),validateKey(\"Query.equalTo\",2,name,!0),this.queryParams_.hasStart())throw new Error(\"Query.equalTo: Starting point was already set (by another call to startAt or equalTo).\");if(this.queryParams_.hasEnd())throw new Error(\"Query.equalTo: Ending point was already set (by another call to endAt or equalTo).\");return this.startAt(value,name).endAt(value,name)},Query.prototype.toString=function(){return util.validateArgCount(\"Query.toString\",0,0,arguments.length),this.repo.toString()+this.path.toUrlEncodedString()},Query.prototype.toJSON=function(){return util.validateArgCount(\"Query.toJSON\",0,1,arguments.length),this.toString()},Query.prototype.queryObject=function(){return this.queryParams_.getQueryObject()},Query.prototype.queryIdentifier=function(){var obj=this.queryObject(),id=ObjectToUniqueKey(obj);return\"{}\"===id?\"default\":id},Query.prototype.isEqual=function(other){if(util.validateArgCount(\"Query.isEqual\",1,1,arguments.length),!(other instanceof Query)){var error=\"Query.isEqual failed: First argument must be an instance of firebase.database.Query.\";throw new Error(error)}var sameRepo=this.repo===other.repo,samePath=this.path.equals(other.path),sameQueryIdentifier=this.queryIdentifier()===other.queryIdentifier();return sameRepo&&samePath&&sameQueryIdentifier},Query.getCancelAndContextArgs_=function(fnName,cancelOrContext,context){var ret={cancel:null,context:null};if(cancelOrContext&&context)ret.cancel=cancelOrContext,util.validateCallback(fnName,3,ret.cancel,!0),ret.context=context,util.validateContextObject(fnName,4,ret.context,!0);else if(cancelOrContext)if(\"object\"==typeof cancelOrContext&&null!==cancelOrContext)ret.context=cancelOrContext;else{if(\"function\"!=typeof cancelOrContext)throw new Error(util.errorPrefix(fnName,3,!0)+\" must either be a cancel callback or a context object.\");ret.cancel=cancelOrContext}return ret},Object.defineProperty(Query.prototype,\"ref\",{get:function(){return this.getRef()},enumerable:!1,configurable:!0}),Query}(),ExistingValueProvider=function(){function ExistingValueProvider(node_){this.node_=node_}return ExistingValueProvider.prototype.getImmediateChild=function(childName){return new ExistingValueProvider(this.node_.getImmediateChild(childName))},ExistingValueProvider.prototype.node=function(){return this.node_},ExistingValueProvider}(),DeferredValueProvider=function(){function DeferredValueProvider(syncTree,path){this.syncTree_=syncTree,this.path_=path}return DeferredValueProvider.prototype.getImmediateChild=function(childName){var childPath=this.path_.child(childName);return new DeferredValueProvider(this.syncTree_,childPath)},DeferredValueProvider.prototype.node=function(){return this.syncTree_.calcCompleteEventCache(this.path_)},DeferredValueProvider}(),resolveDeferredLeafValue=function(value,existingVal,serverValues){return value&&\"object\"==typeof value?(util.assert(\".sv\"in value,\"Unexpected leaf node or priority contents\"),\"string\"==typeof value[\".sv\"]?resolveScalarDeferredValue(value[\".sv\"],existingVal,serverValues):\"object\"==typeof value[\".sv\"]?resolveComplexDeferredValue(value[\".sv\"],existingVal):void util.assert(!1,\"Unexpected server value: \"+JSON.stringify(value,null,2))):value},resolveScalarDeferredValue=function(op,existing,serverValues){switch(op){case\"timestamp\":return serverValues.timestamp;default:util.assert(!1,\"Unexpected server value: \"+op)}},resolveComplexDeferredValue=function(op,existing,unused){op.hasOwnProperty(\"increment\")||util.assert(!1,\"Unexpected server value: \"+JSON.stringify(op,null,2));var delta=op.increment;\"number\"!=typeof delta&&util.assert(!1,\"Unexpected increment value: \"+delta);var existingNode=existing.node();if(util.assert(null!=existingNode,\"Expected ChildrenNode.EMPTY_NODE for nulls\"),!existingNode.isLeafNode())return delta;var existingVal=existingNode.getValue();return\"number\"!=typeof existingVal?delta:existingVal+delta},resolveDeferredValueTree=function(path,node,syncTree,serverValues){return resolveDeferredValue(node,new DeferredValueProvider(syncTree,path),serverValues)},resolveDeferredValueSnapshot=function(node,existing,serverValues){return resolveDeferredValue(node,new ExistingValueProvider(existing),serverValues)};function resolveDeferredValue(node,existingVal,serverValues){var newNode,rawPri=node.getPriority().val(),priority=resolveDeferredLeafValue(rawPri,existingVal.getImmediateChild(\".priority\"),serverValues);if(node.isLeafNode()){var leafNode=node,value=resolveDeferredLeafValue(leafNode.getValue(),existingVal,serverValues);return value!==leafNode.getValue()||priority!==leafNode.getPriority().val()?new LeafNode(value,nodeFromJSON$1(priority)):node}var childrenNode=node;return newNode=childrenNode,priority!==childrenNode.getPriority().val()&&(newNode=newNode.updatePriority(new LeafNode(priority))),childrenNode.forEachChild(PRIORITY_INDEX,(function(childName,childNode){var newChildNode=resolveDeferredValue(childNode,existingVal.getImmediateChild(childName),serverValues);newChildNode!==childNode&&(newNode=newNode.updateImmediateChild(childName,newChildNode))})),newNode}var emptyChildrenSingleton,__referenceConstructor$1,SparseSnapshotTree=function(){function SparseSnapshotTree(){this.value=null,this.children=new Map}return SparseSnapshotTree.prototype.find=function(path){if(null!=this.value)return this.value.getChild(path);if(!path.isEmpty()&&this.children.size>0){var childKey=path.getFront();return path=path.popFront(),this.children.has(childKey)?this.children.get(childKey).find(path):null}return null},SparseSnapshotTree.prototype.remember=function(path,data){if(path.isEmpty())this.value=data,this.children.clear();else if(null!==this.value)this.value=this.value.updateChild(path,data);else{var childKey=path.getFront();this.children.has(childKey)||this.children.set(childKey,new SparseSnapshotTree);var child=this.children.get(childKey);path=path.popFront(),child.remember(path,data)}},SparseSnapshotTree.prototype.forget=function(path){if(path.isEmpty())return this.value=null,this.children.clear(),!0;if(null!==this.value){if(this.value.isLeafNode())return!1;var value=this.value;this.value=null;var self_1=this;return value.forEachChild(PRIORITY_INDEX,(function(key,tree){self_1.remember(new Path(key),tree)})),this.forget(path)}if(this.children.size>0){var childKey=path.getFront();return path=path.popFront(),this.children.has(childKey)&&this.children.get(childKey).forget(path)&&this.children.delete(childKey),0===this.children.size}return!0},SparseSnapshotTree.prototype.forEachTree=function(prefixPath,func){null!==this.value?func(prefixPath,this.value):this.forEachChild((function(key,tree){var path=new Path(prefixPath.toString()+\"/\"+key);tree.forEachTree(path,func)}))},SparseSnapshotTree.prototype.forEachChild=function(func){this.children.forEach((function(tree,key){func(key,tree)}))},SparseSnapshotTree}(),OperationType=function(OperationType){return OperationType[OperationType.OVERWRITE=0]=\"OVERWRITE\",OperationType[OperationType.MERGE=1]=\"MERGE\",OperationType[OperationType.ACK_USER_WRITE=2]=\"ACK_USER_WRITE\",OperationType[OperationType.LISTEN_COMPLETE=3]=\"LISTEN_COMPLETE\",OperationType}({}),OperationSource=function(){function OperationSource(fromUser,fromServer,queryId,tagged){this.fromUser=fromUser,this.fromServer=fromServer,this.queryId=queryId,this.tagged=tagged,util.assert(!tagged||fromServer,\"Tagged queries must be from server.\")}return OperationSource.User=new OperationSource(!0,!1,null,!1),OperationSource.Server=new OperationSource(!1,!0,null,!1),OperationSource.forServerTaggedQuery=function(queryId){return new OperationSource(!1,!0,queryId,!0)},OperationSource}(),AckUserWrite=function(){function AckUserWrite(path,affectedTree,revert){this.path=path,this.affectedTree=affectedTree,this.revert=revert,this.type=OperationType.ACK_USER_WRITE,this.source=OperationSource.User}return AckUserWrite.prototype.operationForChild=function(childName){if(this.path.isEmpty()){if(null!=this.affectedTree.value)return util.assert(this.affectedTree.children.isEmpty(),\"affectedTree should not have overlapping affected paths.\"),this;var childTree=this.affectedTree.subtree(new Path(childName));return new AckUserWrite(Path.Empty,childTree,this.revert)}return util.assert(this.path.getFront()===childName,\"operationForChild called for unrelated child.\"),new AckUserWrite(this.path.popFront(),this.affectedTree,this.revert)},AckUserWrite}(),ImmutableTree=function(){function ImmutableTree(value,children){void 0===children&&(emptyChildrenSingleton||(emptyChildrenSingleton=new SortedMap(stringCompare)),children=emptyChildrenSingleton),this.value=value,this.children=children}return ImmutableTree.fromObject=function(obj){var tree=ImmutableTree.Empty;return each(obj,(function(childPath,childSnap){tree=tree.set(new Path(childPath),childSnap)})),tree},ImmutableTree.prototype.isEmpty=function(){return null===this.value&&this.children.isEmpty()},ImmutableTree.prototype.findRootMostMatchingPathAndValue=function(relativePath,predicate){if(null!=this.value&&predicate(this.value))return{path:Path.Empty,value:this.value};if(relativePath.isEmpty())return null;var front=relativePath.getFront(),child=this.children.get(front);if(null!==child){var childExistingPathAndValue=child.findRootMostMatchingPathAndValue(relativePath.popFront(),predicate);return null!=childExistingPathAndValue?{path:new Path(front).child(childExistingPathAndValue.path),value:childExistingPathAndValue.value}:null}return null},ImmutableTree.prototype.findRootMostValueAndPath=function(relativePath){return this.findRootMostMatchingPathAndValue(relativePath,(function(){return!0}))},ImmutableTree.prototype.subtree=function(relativePath){if(relativePath.isEmpty())return this;var front=relativePath.getFront(),childTree=this.children.get(front);return null!==childTree?childTree.subtree(relativePath.popFront()):ImmutableTree.Empty},ImmutableTree.prototype.set=function(relativePath,toSet){if(relativePath.isEmpty())return new ImmutableTree(toSet,this.children);var front=relativePath.getFront(),newChild=(this.children.get(front)||ImmutableTree.Empty).set(relativePath.popFront(),toSet),newChildren=this.children.insert(front,newChild);return new ImmutableTree(this.value,newChildren)},ImmutableTree.prototype.remove=function(relativePath){if(relativePath.isEmpty())return this.children.isEmpty()?ImmutableTree.Empty:new ImmutableTree(null,this.children);var front=relativePath.getFront(),child=this.children.get(front);if(child){var newChild=child.remove(relativePath.popFront()),newChildren=void 0;return newChildren=newChild.isEmpty()?this.children.remove(front):this.children.insert(front,newChild),null===this.value&&newChildren.isEmpty()?ImmutableTree.Empty:new ImmutableTree(this.value,newChildren)}return this},ImmutableTree.prototype.get=function(relativePath){if(relativePath.isEmpty())return this.value;var front=relativePath.getFront(),child=this.children.get(front);return child?child.get(relativePath.popFront()):null},ImmutableTree.prototype.setTree=function(relativePath,newTree){if(relativePath.isEmpty())return newTree;var newChildren,front=relativePath.getFront(),newChild=(this.children.get(front)||ImmutableTree.Empty).setTree(relativePath.popFront(),newTree);return newChildren=newChild.isEmpty()?this.children.remove(front):this.children.insert(front,newChild),new ImmutableTree(this.value,newChildren)},ImmutableTree.prototype.fold=function(fn){return this.fold_(Path.Empty,fn)},ImmutableTree.prototype.fold_=function(pathSoFar,fn){var accum={};return this.children.inorderTraversal((function(childKey,childTree){accum[childKey]=childTree.fold_(pathSoFar.child(childKey),fn)})),fn(pathSoFar,this.value,accum)},ImmutableTree.prototype.findOnPath=function(path,f){return this.findOnPath_(path,Path.Empty,f)},ImmutableTree.prototype.findOnPath_=function(pathToFollow,pathSoFar,f){var result=!!this.value&&f(pathSoFar,this.value);if(result)return result;if(pathToFollow.isEmpty())return null;var front=pathToFollow.getFront(),nextChild=this.children.get(front);return nextChild?nextChild.findOnPath_(pathToFollow.popFront(),pathSoFar.child(front),f):null},ImmutableTree.prototype.foreachOnPath=function(path,f){return this.foreachOnPath_(path,Path.Empty,f)},ImmutableTree.prototype.foreachOnPath_=function(pathToFollow,currentRelativePath,f){if(pathToFollow.isEmpty())return this;this.value&&f(currentRelativePath,this.value);var front=pathToFollow.getFront(),nextChild=this.children.get(front);return nextChild?nextChild.foreachOnPath_(pathToFollow.popFront(),currentRelativePath.child(front),f):ImmutableTree.Empty},ImmutableTree.prototype.foreach=function(f){this.foreach_(Path.Empty,f)},ImmutableTree.prototype.foreach_=function(currentRelativePath,f){this.children.inorderTraversal((function(childName,childTree){childTree.foreach_(currentRelativePath.child(childName),f)})),this.value&&f(currentRelativePath,this.value)},ImmutableTree.prototype.foreachChild=function(f){this.children.inorderTraversal((function(childName,childTree){childTree.value&&f(childName,childTree.value)}))},ImmutableTree.Empty=new ImmutableTree(null),ImmutableTree}(),ListenComplete=function(){function ListenComplete(source,path){this.source=source,this.path=path,this.type=OperationType.LISTEN_COMPLETE}return ListenComplete.prototype.operationForChild=function(childName){return this.path.isEmpty()?new ListenComplete(this.source,Path.Empty):new ListenComplete(this.source,this.path.popFront())},ListenComplete}(),Overwrite=function(){function Overwrite(source,path,snap){this.source=source,this.path=path,this.snap=snap,this.type=OperationType.OVERWRITE}return Overwrite.prototype.operationForChild=function(childName){return this.path.isEmpty()?new Overwrite(this.source,Path.Empty,this.snap.getImmediateChild(childName)):new Overwrite(this.source,this.path.popFront(),this.snap)},Overwrite}(),Merge=function(){function Merge(source,path,children){this.source=source,this.path=path,this.children=children,this.type=OperationType.MERGE}return Merge.prototype.operationForChild=function(childName){if(this.path.isEmpty()){var childTree=this.children.subtree(new Path(childName));return childTree.isEmpty()?null:childTree.value?new Overwrite(this.source,Path.Empty,childTree.value):new Merge(this.source,Path.Empty,childTree)}return util.assert(this.path.getFront()===childName,\"Can't get a merge for a child not on the path of the operation\"),new Merge(this.source,this.path.popFront(),this.children)},Merge.prototype.toString=function(){return\"Operation(\"+this.path+\": \"+this.source.toString()+\" merge: \"+this.children.toString()+\")\"},Merge}(),CacheNode=function(){function CacheNode(node_,fullyInitialized_,filtered_){this.node_=node_,this.fullyInitialized_=fullyInitialized_,this.filtered_=filtered_}return CacheNode.prototype.isFullyInitialized=function(){return this.fullyInitialized_},CacheNode.prototype.isFiltered=function(){return this.filtered_},CacheNode.prototype.isCompleteForPath=function(path){if(path.isEmpty())return this.isFullyInitialized()&&!this.filtered_;var childKey=path.getFront();return this.isCompleteForChild(childKey)},CacheNode.prototype.isCompleteForChild=function(key){return this.isFullyInitialized()&&!this.filtered_||this.node_.hasChild(key)},CacheNode.prototype.getNode=function(){return this.node_},CacheNode}(),ViewCache=function(){function ViewCache(eventCache_,serverCache_){this.eventCache_=eventCache_,this.serverCache_=serverCache_}return ViewCache.prototype.updateEventSnap=function(eventSnap,complete,filtered){return new ViewCache(new CacheNode(eventSnap,complete,filtered),this.serverCache_)},ViewCache.prototype.updateServerSnap=function(serverSnap,complete,filtered){return new ViewCache(this.eventCache_,new CacheNode(serverSnap,complete,filtered))},ViewCache.prototype.getEventCache=function(){return this.eventCache_},ViewCache.prototype.getCompleteEventSnap=function(){return this.eventCache_.isFullyInitialized()?this.eventCache_.getNode():null},ViewCache.prototype.getServerCache=function(){return this.serverCache_},ViewCache.prototype.getCompleteServerSnap=function(){return this.serverCache_.isFullyInitialized()?this.serverCache_.getNode():null},ViewCache.Empty=new ViewCache(new CacheNode(ChildrenNode.EMPTY_NODE,!1,!1),new CacheNode(ChildrenNode.EMPTY_NODE,!1,!1)),ViewCache}(),Change=function(){function Change(type,snapshotNode,childName,oldSnap,prevName){this.type=type,this.snapshotNode=snapshotNode,this.childName=childName,this.oldSnap=oldSnap,this.prevName=prevName}return Change.valueChange=function(snapshot){return new Change(Change.VALUE,snapshot)},Change.childAddedChange=function(childKey,snapshot){return new Change(Change.CHILD_ADDED,snapshot,childKey)},Change.childRemovedChange=function(childKey,snapshot){return new Change(Change.CHILD_REMOVED,snapshot,childKey)},Change.childChangedChange=function(childKey,newSnapshot,oldSnapshot){return new Change(Change.CHILD_CHANGED,newSnapshot,childKey,oldSnapshot)},Change.childMovedChange=function(childKey,snapshot){return new Change(Change.CHILD_MOVED,snapshot,childKey)},Change.CHILD_ADDED=\"child_added\",Change.CHILD_REMOVED=\"child_removed\",Change.CHILD_CHANGED=\"child_changed\",Change.CHILD_MOVED=\"child_moved\",Change.VALUE=\"value\",Change}(),IndexedFilter=function(){function IndexedFilter(index_){this.index_=index_}return IndexedFilter.prototype.updateChild=function(snap,key,newChild,affectedPath,source,optChangeAccumulator){util.assert(snap.isIndexed(this.index_),\"A node must be indexed if only a child is updated\");var oldChild=snap.getImmediateChild(key);return oldChild.getChild(affectedPath).equals(newChild.getChild(affectedPath))&&oldChild.isEmpty()===newChild.isEmpty()?snap:(null!=optChangeAccumulator&&(newChild.isEmpty()?snap.hasChild(key)?optChangeAccumulator.trackChildChange(Change.childRemovedChange(key,oldChild)):util.assert(snap.isLeafNode(),\"A child remove without an old child only makes sense on a leaf node\"):oldChild.isEmpty()?optChangeAccumulator.trackChildChange(Change.childAddedChange(key,newChild)):optChangeAccumulator.trackChildChange(Change.childChangedChange(key,newChild,oldChild))),snap.isLeafNode()&&newChild.isEmpty()?snap:snap.updateImmediateChild(key,newChild).withIndex(this.index_))},IndexedFilter.prototype.updateFullNode=function(oldSnap,newSnap,optChangeAccumulator){return null!=optChangeAccumulator&&(oldSnap.isLeafNode()||oldSnap.forEachChild(PRIORITY_INDEX,(function(key,childNode){newSnap.hasChild(key)||optChangeAccumulator.trackChildChange(Change.childRemovedChange(key,childNode))})),newSnap.isLeafNode()||newSnap.forEachChild(PRIORITY_INDEX,(function(key,childNode){if(oldSnap.hasChild(key)){var oldChild=oldSnap.getImmediateChild(key);oldChild.equals(childNode)||optChangeAccumulator.trackChildChange(Change.childChangedChange(key,childNode,oldChild))}else optChangeAccumulator.trackChildChange(Change.childAddedChange(key,childNode))}))),newSnap.withIndex(this.index_)},IndexedFilter.prototype.updatePriority=function(oldSnap,newPriority){return oldSnap.isEmpty()?ChildrenNode.EMPTY_NODE:oldSnap.updatePriority(newPriority)},IndexedFilter.prototype.filtersNodes=function(){return!1},IndexedFilter.prototype.getIndexedFilter=function(){return this},IndexedFilter.prototype.getIndex=function(){return this.index_},IndexedFilter}(),ChildChangeAccumulator=function(){function ChildChangeAccumulator(){this.changeMap=new Map}return ChildChangeAccumulator.prototype.trackChildChange=function(change){var type=change.type,childKey=change.childName;util.assert(type===Change.CHILD_ADDED||type===Change.CHILD_CHANGED||type===Change.CHILD_REMOVED,\"Only child changes supported for tracking\"),util.assert(\".priority\"!==childKey,\"Only non-priority child changes can be tracked.\");var oldChange=this.changeMap.get(childKey);if(oldChange){var oldType=oldChange.type;if(type===Change.CHILD_ADDED&&oldType===Change.CHILD_REMOVED)this.changeMap.set(childKey,Change.childChangedChange(childKey,change.snapshotNode,oldChange.snapshotNode));else if(type===Change.CHILD_REMOVED&&oldType===Change.CHILD_ADDED)this.changeMap.delete(childKey);else if(type===Change.CHILD_REMOVED&&oldType===Change.CHILD_CHANGED)this.changeMap.set(childKey,Change.childRemovedChange(childKey,oldChange.oldSnap));else if(type===Change.CHILD_CHANGED&&oldType===Change.CHILD_ADDED)this.changeMap.set(childKey,Change.childAddedChange(childKey,change.snapshotNode));else{if(type!==Change.CHILD_CHANGED||oldType!==Change.CHILD_CHANGED)throw util.assertionError(\"Illegal combination of changes: \"+change+\" occurred after \"+oldChange);this.changeMap.set(childKey,Change.childChangedChange(childKey,change.snapshotNode,oldChange.oldSnap))}}else this.changeMap.set(childKey,change)},ChildChangeAccumulator.prototype.getChanges=function(){return Array.from(this.changeMap.values())},ChildChangeAccumulator}(),NO_COMPLETE_CHILD_SOURCE=new(function(){function NoCompleteChildSource_(){}return NoCompleteChildSource_.prototype.getCompleteChild=function(childKey){return null},NoCompleteChildSource_.prototype.getChildAfterChild=function(index,child,reverse){return null},NoCompleteChildSource_}()),WriteTreeCompleteChildSource=function(){function WriteTreeCompleteChildSource(writes_,viewCache_,optCompleteServerCache_){void 0===optCompleteServerCache_&&(optCompleteServerCache_=null),this.writes_=writes_,this.viewCache_=viewCache_,this.optCompleteServerCache_=optCompleteServerCache_}return WriteTreeCompleteChildSource.prototype.getCompleteChild=function(childKey){var node=this.viewCache_.getEventCache();if(node.isCompleteForChild(childKey))return node.getNode().getImmediateChild(childKey);var serverNode=null!=this.optCompleteServerCache_?new CacheNode(this.optCompleteServerCache_,!0,!1):this.viewCache_.getServerCache();return this.writes_.calcCompleteChild(childKey,serverNode)},WriteTreeCompleteChildSource.prototype.getChildAfterChild=function(index,child,reverse){var completeServerData=null!=this.optCompleteServerCache_?this.optCompleteServerCache_:this.viewCache_.getCompleteServerSnap(),nodes=this.writes_.calcIndexedSlice(completeServerData,child,1,reverse,index);return 0===nodes.length?null:nodes[0]},WriteTreeCompleteChildSource}(),ProcessorResult=function(){return function(viewCache,changes){this.viewCache=viewCache,this.changes=changes}}(),ViewProcessor=function(){function ViewProcessor(filter_){this.filter_=filter_}return ViewProcessor.prototype.assertIndexed=function(viewCache){util.assert(viewCache.getEventCache().getNode().isIndexed(this.filter_.getIndex()),\"Event snap not indexed\"),util.assert(viewCache.getServerCache().getNode().isIndexed(this.filter_.getIndex()),\"Server snap not indexed\")},ViewProcessor.prototype.applyOperation=function(oldViewCache,operation,writesCache,completeCache){var newViewCache,filterServerNode,accumulator=new ChildChangeAccumulator;if(operation.type===OperationType.OVERWRITE){var overwrite=operation;overwrite.source.fromUser?newViewCache=this.applyUserOverwrite_(oldViewCache,overwrite.path,overwrite.snap,writesCache,completeCache,accumulator):(util.assert(overwrite.source.fromServer,\"Unknown source.\"),filterServerNode=overwrite.source.tagged||oldViewCache.getServerCache().isFiltered()&&!overwrite.path.isEmpty(),newViewCache=this.applyServerOverwrite_(oldViewCache,overwrite.path,overwrite.snap,writesCache,completeCache,filterServerNode,accumulator))}else if(operation.type===OperationType.MERGE){var merge=operation;merge.source.fromUser?newViewCache=this.applyUserMerge_(oldViewCache,merge.path,merge.children,writesCache,completeCache,accumulator):(util.assert(merge.source.fromServer,\"Unknown source.\"),filterServerNode=merge.source.tagged||oldViewCache.getServerCache().isFiltered(),newViewCache=this.applyServerMerge_(oldViewCache,merge.path,merge.children,writesCache,completeCache,filterServerNode,accumulator))}else if(operation.type===OperationType.ACK_USER_WRITE){var ackUserWrite=operation;newViewCache=ackUserWrite.revert?this.revertUserWrite_(oldViewCache,ackUserWrite.path,writesCache,completeCache,accumulator):this.ackUserWrite_(oldViewCache,ackUserWrite.path,ackUserWrite.affectedTree,writesCache,completeCache,accumulator)}else{if(operation.type!==OperationType.LISTEN_COMPLETE)throw util.assertionError(\"Unknown operation type: \"+operation.type);newViewCache=this.listenComplete_(oldViewCache,operation.path,writesCache,accumulator)}var changes=accumulator.getChanges();return ViewProcessor.maybeAddValueEvent_(oldViewCache,newViewCache,changes),new ProcessorResult(newViewCache,changes)},ViewProcessor.maybeAddValueEvent_=function(oldViewCache,newViewCache,accumulator){var eventSnap=newViewCache.getEventCache();if(eventSnap.isFullyInitialized()){var isLeafOrEmpty=eventSnap.getNode().isLeafNode()||eventSnap.getNode().isEmpty(),oldCompleteSnap=oldViewCache.getCompleteEventSnap();(accumulator.length>0||!oldViewCache.getEventCache().isFullyInitialized()||isLeafOrEmpty&&!eventSnap.getNode().equals(oldCompleteSnap)||!eventSnap.getNode().getPriority().equals(oldCompleteSnap.getPriority()))&&accumulator.push(Change.valueChange(newViewCache.getCompleteEventSnap()))}},ViewProcessor.prototype.generateEventCacheAfterServerEvent_=function(viewCache,changePath,writesCache,source,accumulator){var oldEventSnap=viewCache.getEventCache();if(null!=writesCache.shadowingWrite(changePath))return viewCache;var newEventCache=void 0,serverNode=void 0;if(changePath.isEmpty())if(util.assert(viewCache.getServerCache().isFullyInitialized(),\"If change path is empty, we must have complete server data\"),viewCache.getServerCache().isFiltered()){var serverCache=viewCache.getCompleteServerSnap(),completeEventChildren=writesCache.calcCompleteEventChildren(serverCache instanceof ChildrenNode?serverCache:ChildrenNode.EMPTY_NODE);newEventCache=this.filter_.updateFullNode(viewCache.getEventCache().getNode(),completeEventChildren,accumulator)}else{var completeNode=writesCache.calcCompleteEventCache(viewCache.getCompleteServerSnap());newEventCache=this.filter_.updateFullNode(viewCache.getEventCache().getNode(),completeNode,accumulator)}else{var childKey=changePath.getFront();if(\".priority\"===childKey){util.assert(1===changePath.getLength(),\"Can't have a priority with additional path components\");var oldEventNode=oldEventSnap.getNode();serverNode=viewCache.getServerCache().getNode();var updatedPriority=writesCache.calcEventCacheAfterServerOverwrite(changePath,oldEventNode,serverNode);newEventCache=null!=updatedPriority?this.filter_.updatePriority(oldEventNode,updatedPriority):oldEventSnap.getNode()}else{var childChangePath=changePath.popFront(),newEventChild=void 0;if(oldEventSnap.isCompleteForChild(childKey)){serverNode=viewCache.getServerCache().getNode();var eventChildUpdate=writesCache.calcEventCacheAfterServerOverwrite(changePath,oldEventSnap.getNode(),serverNode);newEventChild=null!=eventChildUpdate?oldEventSnap.getNode().getImmediateChild(childKey).updateChild(childChangePath,eventChildUpdate):oldEventSnap.getNode().getImmediateChild(childKey)}else newEventChild=writesCache.calcCompleteChild(childKey,viewCache.getServerCache());newEventCache=null!=newEventChild?this.filter_.updateChild(oldEventSnap.getNode(),childKey,newEventChild,childChangePath,source,accumulator):oldEventSnap.getNode()}}return viewCache.updateEventSnap(newEventCache,oldEventSnap.isFullyInitialized()||changePath.isEmpty(),this.filter_.filtersNodes())},ViewProcessor.prototype.applyServerOverwrite_=function(oldViewCache,changePath,changedSnap,writesCache,completeCache,filterServerNode,accumulator){var newServerCache,oldServerSnap=oldViewCache.getServerCache(),serverFilter=filterServerNode?this.filter_:this.filter_.getIndexedFilter();if(changePath.isEmpty())newServerCache=serverFilter.updateFullNode(oldServerSnap.getNode(),changedSnap,null);else if(serverFilter.filtersNodes()&&!oldServerSnap.isFiltered()){var newServerNode=oldServerSnap.getNode().updateChild(changePath,changedSnap);newServerCache=serverFilter.updateFullNode(oldServerSnap.getNode(),newServerNode,null)}else{var childKey=changePath.getFront();if(!oldServerSnap.isCompleteForPath(changePath)&&changePath.getLength()>1)return oldViewCache;var childChangePath=changePath.popFront(),newChildNode=oldServerSnap.getNode().getImmediateChild(childKey).updateChild(childChangePath,changedSnap);newServerCache=\".priority\"===childKey?serverFilter.updatePriority(oldServerSnap.getNode(),newChildNode):serverFilter.updateChild(oldServerSnap.getNode(),childKey,newChildNode,childChangePath,NO_COMPLETE_CHILD_SOURCE,null)}var newViewCache=oldViewCache.updateServerSnap(newServerCache,oldServerSnap.isFullyInitialized()||changePath.isEmpty(),serverFilter.filtersNodes()),source=new WriteTreeCompleteChildSource(writesCache,newViewCache,completeCache);return this.generateEventCacheAfterServerEvent_(newViewCache,changePath,writesCache,source,accumulator)},ViewProcessor.prototype.applyUserOverwrite_=function(oldViewCache,changePath,changedSnap,writesCache,completeCache,accumulator){var newViewCache,newEventCache,oldEventSnap=oldViewCache.getEventCache(),source=new WriteTreeCompleteChildSource(writesCache,oldViewCache,completeCache);if(changePath.isEmpty())newEventCache=this.filter_.updateFullNode(oldViewCache.getEventCache().getNode(),changedSnap,accumulator),newViewCache=oldViewCache.updateEventSnap(newEventCache,!0,this.filter_.filtersNodes());else{var childKey=changePath.getFront();if(\".priority\"===childKey)newEventCache=this.filter_.updatePriority(oldViewCache.getEventCache().getNode(),changedSnap),newViewCache=oldViewCache.updateEventSnap(newEventCache,oldEventSnap.isFullyInitialized(),oldEventSnap.isFiltered());else{var childChangePath=changePath.popFront(),oldChild=oldEventSnap.getNode().getImmediateChild(childKey),newChild=void 0;if(childChangePath.isEmpty())newChild=changedSnap;else{var childNode=source.getCompleteChild(childKey);newChild=null!=childNode?\".priority\"===childChangePath.getBack()&&childNode.getChild(childChangePath.parent()).isEmpty()?childNode:childNode.updateChild(childChangePath,changedSnap):ChildrenNode.EMPTY_NODE}if(oldChild.equals(newChild))newViewCache=oldViewCache;else{var newEventSnap=this.filter_.updateChild(oldEventSnap.getNode(),childKey,newChild,childChangePath,source,accumulator);newViewCache=oldViewCache.updateEventSnap(newEventSnap,oldEventSnap.isFullyInitialized(),this.filter_.filtersNodes())}}}return newViewCache},ViewProcessor.cacheHasChild_=function(viewCache,childKey){return viewCache.getEventCache().isCompleteForChild(childKey)},ViewProcessor.prototype.applyUserMerge_=function(viewCache,path,changedChildren,writesCache,serverCache,accumulator){var _this=this,curViewCache=viewCache;return changedChildren.foreach((function(relativePath,childNode){var writePath=path.child(relativePath);ViewProcessor.cacheHasChild_(viewCache,writePath.getFront())&&(curViewCache=_this.applyUserOverwrite_(curViewCache,writePath,childNode,writesCache,serverCache,accumulator))})),changedChildren.foreach((function(relativePath,childNode){var writePath=path.child(relativePath);ViewProcessor.cacheHasChild_(viewCache,writePath.getFront())||(curViewCache=_this.applyUserOverwrite_(curViewCache,writePath,childNode,writesCache,serverCache,accumulator))})),curViewCache},ViewProcessor.prototype.applyMerge_=function(node,merge){return merge.foreach((function(relativePath,childNode){node=node.updateChild(relativePath,childNode)})),node},ViewProcessor.prototype.applyServerMerge_=function(viewCache,path,changedChildren,writesCache,serverCache,filterServerNode,accumulator){var _this=this;if(viewCache.getServerCache().getNode().isEmpty()&&!viewCache.getServerCache().isFullyInitialized())return viewCache;var viewMergeTree,curViewCache=viewCache;viewMergeTree=path.isEmpty()?changedChildren:ImmutableTree.Empty.setTree(path,changedChildren);var serverNode=viewCache.getServerCache().getNode();return viewMergeTree.children.inorderTraversal((function(childKey,childTree){if(serverNode.hasChild(childKey)){var serverChild=viewCache.getServerCache().getNode().getImmediateChild(childKey),newChild=_this.applyMerge_(serverChild,childTree);curViewCache=_this.applyServerOverwrite_(curViewCache,new Path(childKey),newChild,writesCache,serverCache,filterServerNode,accumulator)}})),viewMergeTree.children.inorderTraversal((function(childKey,childMergeTree){var isUnknownDeepMerge=!viewCache.getServerCache().isCompleteForChild(childKey)&&null==childMergeTree.value;if(!serverNode.hasChild(childKey)&&!isUnknownDeepMerge){var serverChild=viewCache.getServerCache().getNode().getImmediateChild(childKey),newChild=_this.applyMerge_(serverChild,childMergeTree);curViewCache=_this.applyServerOverwrite_(curViewCache,new Path(childKey),newChild,writesCache,serverCache,filterServerNode,accumulator)}})),curViewCache},ViewProcessor.prototype.ackUserWrite_=function(viewCache,ackPath,affectedTree,writesCache,completeCache,accumulator){if(null!=writesCache.shadowingWrite(ackPath))return viewCache;var filterServerNode=viewCache.getServerCache().isFiltered(),serverCache=viewCache.getServerCache();if(null!=affectedTree.value){if(ackPath.isEmpty()&&serverCache.isFullyInitialized()||serverCache.isCompleteForPath(ackPath))return this.applyServerOverwrite_(viewCache,ackPath,serverCache.getNode().getChild(ackPath),writesCache,completeCache,filterServerNode,accumulator);if(ackPath.isEmpty()){var changedChildren_1=ImmutableTree.Empty;return serverCache.getNode().forEachChild(KEY_INDEX,(function(name,node){changedChildren_1=changedChildren_1.set(new Path(name),node)})),this.applyServerMerge_(viewCache,ackPath,changedChildren_1,writesCache,completeCache,filterServerNode,accumulator)}return viewCache}var changedChildren_2=ImmutableTree.Empty;return affectedTree.foreach((function(mergePath,value){var serverCachePath=ackPath.child(mergePath);serverCache.isCompleteForPath(serverCachePath)&&(changedChildren_2=changedChildren_2.set(mergePath,serverCache.getNode().getChild(serverCachePath)))})),this.applyServerMerge_(viewCache,ackPath,changedChildren_2,writesCache,completeCache,filterServerNode,accumulator)},ViewProcessor.prototype.listenComplete_=function(viewCache,path,writesCache,accumulator){var oldServerNode=viewCache.getServerCache(),newViewCache=viewCache.updateServerSnap(oldServerNode.getNode(),oldServerNode.isFullyInitialized()||path.isEmpty(),oldServerNode.isFiltered());return this.generateEventCacheAfterServerEvent_(newViewCache,path,writesCache,NO_COMPLETE_CHILD_SOURCE,accumulator)},ViewProcessor.prototype.revertUserWrite_=function(viewCache,path,writesCache,completeServerCache,accumulator){var complete;if(null!=writesCache.shadowingWrite(path))return viewCache;var source=new WriteTreeCompleteChildSource(writesCache,viewCache,completeServerCache),oldEventCache=viewCache.getEventCache().getNode(),newEventCache=void 0;if(path.isEmpty()||\".priority\"===path.getFront()){var newNode=void 0;if(viewCache.getServerCache().isFullyInitialized())newNode=writesCache.calcCompleteEventCache(viewCache.getCompleteServerSnap());else{var serverChildren=viewCache.getServerCache().getNode();util.assert(serverChildren instanceof ChildrenNode,\"serverChildren would be complete if leaf node\"),newNode=writesCache.calcCompleteEventChildren(serverChildren)}newEventCache=this.filter_.updateFullNode(oldEventCache,newNode=newNode,accumulator)}else{var childKey=path.getFront(),newChild=writesCache.calcCompleteChild(childKey,viewCache.getServerCache());null==newChild&&viewCache.getServerCache().isCompleteForChild(childKey)&&(newChild=oldEventCache.getImmediateChild(childKey)),(newEventCache=null!=newChild?this.filter_.updateChild(oldEventCache,childKey,newChild,path.popFront(),source,accumulator):viewCache.getEventCache().getNode().hasChild(childKey)?this.filter_.updateChild(oldEventCache,childKey,ChildrenNode.EMPTY_NODE,path.popFront(),source,accumulator):oldEventCache).isEmpty()&&viewCache.getServerCache().isFullyInitialized()&&(complete=writesCache.calcCompleteEventCache(viewCache.getCompleteServerSnap())).isLeafNode()&&(newEventCache=this.filter_.updateFullNode(newEventCache,complete,accumulator))}return complete=viewCache.getServerCache().isFullyInitialized()||null!=writesCache.shadowingWrite(Path.Empty),viewCache.updateEventSnap(newEventCache,complete,this.filter_.filtersNodes())},ViewProcessor}(),EventGenerator=function(){function EventGenerator(query_){this.query_=query_,this.index_=this.query_.getQueryParams().getIndex()}return EventGenerator.prototype.generateEventsForChanges=function(changes,eventCache,eventRegistrations){var _this=this,events=[],moves=[];return changes.forEach((function(change){change.type===Change.CHILD_CHANGED&&_this.index_.indexedValueChanged(change.oldSnap,change.snapshotNode)&&moves.push(Change.childMovedChange(change.childName,change.snapshotNode))})),this.generateEventsForType_(events,Change.CHILD_REMOVED,changes,eventRegistrations,eventCache),this.generateEventsForType_(events,Change.CHILD_ADDED,changes,eventRegistrations,eventCache),this.generateEventsForType_(events,Change.CHILD_MOVED,moves,eventRegistrations,eventCache),this.generateEventsForType_(events,Change.CHILD_CHANGED,changes,eventRegistrations,eventCache),this.generateEventsForType_(events,Change.VALUE,changes,eventRegistrations,eventCache),events},EventGenerator.prototype.generateEventsForType_=function(events,eventType,changes,registrations,eventCache){var _this=this,filteredChanges=changes.filter((function(change){return change.type===eventType}));filteredChanges.sort(this.compareChanges_.bind(this)),filteredChanges.forEach((function(change){var materializedChange=_this.materializeSingleChange_(change,eventCache);registrations.forEach((function(registration){registration.respondsTo(change.type)&&events.push(registration.createEvent(materializedChange,_this.query_))}))}))},EventGenerator.prototype.materializeSingleChange_=function(change,eventCache){return\"value\"===change.type||\"child_removed\"===change.type||(change.prevName=eventCache.getPredecessorChildName(change.childName,change.snapshotNode,this.index_)),change},EventGenerator.prototype.compareChanges_=function(a,b){if(null==a.childName||null==b.childName)throw util.assertionError(\"Should only compare child_ events.\");var aWrapped=new NamedNode(a.childName,a.snapshotNode),bWrapped=new NamedNode(b.childName,b.snapshotNode);return this.index_.compare(aWrapped,bWrapped)},EventGenerator}(),View=function(){function View(query_,initialViewCache){this.query_=query_,this.eventRegistrations_=[];var params=this.query_.getQueryParams(),indexFilter=new IndexedFilter(params.getIndex()),filter=params.getNodeFilter();this.processor_=new ViewProcessor(filter);var initialServerCache=initialViewCache.getServerCache(),initialEventCache=initialViewCache.getEventCache(),serverSnap=indexFilter.updateFullNode(ChildrenNode.EMPTY_NODE,initialServerCache.getNode(),null),eventSnap=filter.updateFullNode(ChildrenNode.EMPTY_NODE,initialEventCache.getNode(),null),newServerCache=new CacheNode(serverSnap,initialServerCache.isFullyInitialized(),indexFilter.filtersNodes()),newEventCache=new CacheNode(eventSnap,initialEventCache.isFullyInitialized(),filter.filtersNodes());this.viewCache_=new ViewCache(newEventCache,newServerCache),this.eventGenerator_=new EventGenerator(this.query_)}return View.prototype.getQuery=function(){return this.query_},View.prototype.getServerCache=function(){return this.viewCache_.getServerCache().getNode()},View.prototype.getCompleteServerCache=function(path){var cache=this.viewCache_.getCompleteServerSnap();return cache&&(this.query_.getQueryParams().loadsAllData()||!path.isEmpty()&&!cache.getImmediateChild(path.getFront()).isEmpty())?cache.getChild(path):null},View.prototype.isEmpty=function(){return 0===this.eventRegistrations_.length},View.prototype.addEventRegistration=function(eventRegistration){this.eventRegistrations_.push(eventRegistration)},View.prototype.removeEventRegistration=function(eventRegistration,cancelError){var cancelEvents=[];if(cancelError){util.assert(null==eventRegistration,\"A cancel should cancel all event registrations.\");var path_1=this.query_.path;this.eventRegistrations_.forEach((function(registration){var maybeEvent=registration.createCancelEvent(cancelError=cancelError,path_1);maybeEvent&&cancelEvents.push(maybeEvent)}))}if(eventRegistration){for(var remaining=[],i=0;i<this.eventRegistrations_.length;++i){var existing=this.eventRegistrations_[i];if(existing.matches(eventRegistration)){if(eventRegistration.hasAnyCallback()){remaining=remaining.concat(this.eventRegistrations_.slice(i+1));break}}else remaining.push(existing)}this.eventRegistrations_=remaining}else this.eventRegistrations_=[];return cancelEvents},View.prototype.applyOperation=function(operation,writesCache,completeServerCache){operation.type===OperationType.MERGE&&null!==operation.source.queryId&&(util.assert(this.viewCache_.getCompleteServerSnap(),\"We should always have a full cache before handling merges\"),util.assert(this.viewCache_.getCompleteEventSnap(),\"Missing event cache, even though we have a server cache\"));var oldViewCache=this.viewCache_,result=this.processor_.applyOperation(oldViewCache,operation,writesCache,completeServerCache);return this.processor_.assertIndexed(result.viewCache),util.assert(result.viewCache.getServerCache().isFullyInitialized()||!oldViewCache.getServerCache().isFullyInitialized(),\"Once a server snap is complete, it should never go back\"),this.viewCache_=result.viewCache,this.generateEventsForChanges_(result.changes,result.viewCache.getEventCache().getNode(),null)},View.prototype.getInitialEvents=function(registration){var eventSnap=this.viewCache_.getEventCache(),initialChanges=[];return eventSnap.getNode().isLeafNode()||eventSnap.getNode().forEachChild(PRIORITY_INDEX,(function(key,childNode){initialChanges.push(Change.childAddedChange(key,childNode))})),eventSnap.isFullyInitialized()&&initialChanges.push(Change.valueChange(eventSnap.getNode())),this.generateEventsForChanges_(initialChanges,eventSnap.getNode(),registration)},View.prototype.generateEventsForChanges_=function(changes,eventCache,eventRegistration){return this.eventGenerator_.generateEventsForChanges(changes,eventCache,eventRegistration?[eventRegistration]:this.eventRegistrations_)},View}(),SyncPoint=function(){function SyncPoint(){this.views=new Map}return Object.defineProperty(SyncPoint,\"__referenceConstructor\",{get:function(){return util.assert(__referenceConstructor$1,\"Reference.ts has not been loaded\"),__referenceConstructor$1},set:function(val){util.assert(!__referenceConstructor$1,\"__referenceConstructor has already been defined\"),__referenceConstructor$1=val},enumerable:!1,configurable:!0}),SyncPoint.prototype.isEmpty=function(){return 0===this.views.size},SyncPoint.prototype.applyOperation=function(operation,writesCache,optCompleteServerCache){var e_1,_a,queryId=operation.source.queryId;if(null!==queryId){var view=this.views.get(queryId);return util.assert(null!=view,\"SyncTree gave us an op for an invalid query.\"),view.applyOperation(operation,writesCache,optCompleteServerCache)}var events=[];try{for(var _b=tslib.__values(this.views.values()),_c=_b.next();!_c.done;_c=_b.next())events=events.concat((view=_c.value).applyOperation(operation,writesCache,optCompleteServerCache))}catch(e_1_1){e_1={error:e_1_1}}finally{try{_c&&!_c.done&&(_a=_b.return)&&_a.call(_b)}finally{if(e_1)throw e_1.error}}return events},SyncPoint.prototype.addEventRegistration=function(query,eventRegistration,writesCache,serverCache,serverCacheComplete){var queryId=query.queryIdentifier(),view=this.views.get(queryId);if(!view){var eventCache=writesCache.calcCompleteEventCache(serverCacheComplete?serverCache:null),eventCacheComplete=!1;eventCache?eventCacheComplete=!0:serverCache instanceof ChildrenNode?(eventCache=writesCache.calcCompleteEventChildren(serverCache),eventCacheComplete=!1):(eventCache=ChildrenNode.EMPTY_NODE,eventCacheComplete=!1);var viewCache=new ViewCache(new CacheNode(eventCache,eventCacheComplete,!1),new CacheNode(serverCache,serverCacheComplete,!1));view=new View(query,viewCache),this.views.set(queryId,view)}return view.addEventRegistration(eventRegistration),view.getInitialEvents(eventRegistration)},SyncPoint.prototype.removeEventRegistration=function(query,eventRegistration,cancelError){var e_2,_a,queryId=query.queryIdentifier(),removed=[],cancelEvents=[],hadCompleteView=this.hasCompleteView();if(\"default\"===queryId)try{for(var _b=tslib.__values(this.views.entries()),_c=_b.next();!_c.done;_c=_b.next()){var view,_d=tslib.__read(_c.value,2),viewQueryId=_d[0];cancelEvents=cancelEvents.concat((view=_d[1]).removeEventRegistration(eventRegistration,cancelError)),view.isEmpty()&&(this.views.delete(viewQueryId),view.getQuery().getQueryParams().loadsAllData()||removed.push(view.getQuery()))}}catch(e_2_1){e_2={error:e_2_1}}finally{try{_c&&!_c.done&&(_a=_b.return)&&_a.call(_b)}finally{if(e_2)throw e_2.error}}else(view=this.views.get(queryId))&&(cancelEvents=cancelEvents.concat(view.removeEventRegistration(eventRegistration,cancelError)),view.isEmpty()&&(this.views.delete(queryId),view.getQuery().getQueryParams().loadsAllData()||removed.push(view.getQuery())));return hadCompleteView&&!this.hasCompleteView()&&removed.push(new SyncPoint.__referenceConstructor(query.repo,query.path)),{removed:removed,events:cancelEvents}},SyncPoint.prototype.getQueryViews=function(){var e_3,_a,result=[];try{for(var _b=tslib.__values(this.views.values()),_c=_b.next();!_c.done;_c=_b.next()){var view=_c.value;view.getQuery().getQueryParams().loadsAllData()||result.push(view)}}catch(e_3_1){e_3={error:e_3_1}}finally{try{_c&&!_c.done&&(_a=_b.return)&&_a.call(_b)}finally{if(e_3)throw e_3.error}}return result},SyncPoint.prototype.getCompleteServerCache=function(path){var e_4,_a,serverCache=null;try{for(var _b=tslib.__values(this.views.values()),_c=_b.next();!_c.done;_c=_b.next())serverCache=serverCache||_c.value.getCompleteServerCache(path)}catch(e_4_1){e_4={error:e_4_1}}finally{try{_c&&!_c.done&&(_a=_b.return)&&_a.call(_b)}finally{if(e_4)throw e_4.error}}return serverCache},SyncPoint.prototype.viewForQuery=function(query){if(query.getQueryParams().loadsAllData())return this.getCompleteView();var queryId=query.queryIdentifier();return this.views.get(queryId)},SyncPoint.prototype.viewExistsForQuery=function(query){return null!=this.viewForQuery(query)},SyncPoint.prototype.hasCompleteView=function(){return null!=this.getCompleteView()},SyncPoint.prototype.getCompleteView=function(){var e_5,_a;try{for(var _b=tslib.__values(this.views.values()),_c=_b.next();!_c.done;_c=_b.next()){var view=_c.value;if(view.getQuery().getQueryParams().loadsAllData())return view}}catch(e_5_1){e_5={error:e_5_1}}finally{try{_c&&!_c.done&&(_a=_b.return)&&_a.call(_b)}finally{if(e_5)throw e_5.error}}return null},SyncPoint}(),CompoundWrite=function(){function CompoundWrite(writeTree_){this.writeTree_=writeTree_}return CompoundWrite.prototype.addWrite=function(path,node){if(path.isEmpty())return new CompoundWrite(new ImmutableTree(node));var rootmost=this.writeTree_.findRootMostValueAndPath(path);if(null!=rootmost){var rootMostPath=rootmost.path,value=rootmost.value,relativePath=Path.relativePath(rootMostPath,path);return value=value.updateChild(relativePath,node),new CompoundWrite(this.writeTree_.set(rootMostPath,value))}var subtree=new ImmutableTree(node);return new CompoundWrite(this.writeTree_.setTree(path,subtree))},CompoundWrite.prototype.addWrites=function(path,updates){var newWrite=this;return each(updates,(function(childKey,node){newWrite=newWrite.addWrite(path.child(childKey),node)})),newWrite},CompoundWrite.prototype.removeWrite=function(path){return path.isEmpty()?CompoundWrite.Empty:new CompoundWrite(this.writeTree_.setTree(path,ImmutableTree.Empty))},CompoundWrite.prototype.hasCompleteWrite=function(path){return null!=this.getCompleteNode(path)},CompoundWrite.prototype.getCompleteNode=function(path){var rootmost=this.writeTree_.findRootMostValueAndPath(path);return null!=rootmost?this.writeTree_.get(rootmost.path).getChild(Path.relativePath(rootmost.path,path)):null},CompoundWrite.prototype.getCompleteChildren=function(){var children=[],node=this.writeTree_.value;return null!=node?node.isLeafNode()||node.forEachChild(PRIORITY_INDEX,(function(childName,childNode){children.push(new NamedNode(childName,childNode))})):this.writeTree_.children.inorderTraversal((function(childName,childTree){null!=childTree.value&&children.push(new NamedNode(childName,childTree.value))})),children},CompoundWrite.prototype.childCompoundWrite=function(path){if(path.isEmpty())return this;var shadowingNode=this.getCompleteNode(path);return new CompoundWrite(null!=shadowingNode?new ImmutableTree(shadowingNode):this.writeTree_.subtree(path))},CompoundWrite.prototype.isEmpty=function(){return this.writeTree_.isEmpty()},CompoundWrite.prototype.apply=function(node){return function applySubtreeWrite(relativePath,writeTree,node){if(null!=writeTree.value)return node.updateChild(relativePath,writeTree.value);var priorityWrite_1=null;return writeTree.children.inorderTraversal((function(childKey,childTree){\".priority\"===childKey?(util.assert(null!==childTree.value,\"Priority writes must always be leaf nodes\"),priorityWrite_1=childTree.value):node=applySubtreeWrite(relativePath.child(childKey),childTree,node)})),node.getChild(relativePath).isEmpty()||null===priorityWrite_1||(node=node.updateChild(relativePath.child(\".priority\"),priorityWrite_1)),node}(Path.Empty,this.writeTree_,node)},CompoundWrite.Empty=new CompoundWrite(new ImmutableTree(null)),CompoundWrite}(),WriteTree=function(){function WriteTree(){this.visibleWrites_=CompoundWrite.Empty,this.allWrites_=[],this.lastWriteId_=-1}return WriteTree.prototype.childWrites=function(path){return new WriteTreeRef(path,this)},WriteTree.prototype.addOverwrite=function(path,snap,writeId,visible){util.assert(writeId>this.lastWriteId_,\"Stacking an older write on top of newer ones\"),void 0===visible&&(visible=!0),this.allWrites_.push({path:path,snap:snap,writeId:writeId,visible:visible}),visible&&(this.visibleWrites_=this.visibleWrites_.addWrite(path,snap)),this.lastWriteId_=writeId},WriteTree.prototype.addMerge=function(path,changedChildren,writeId){util.assert(writeId>this.lastWriteId_,\"Stacking an older merge on top of newer ones\"),this.allWrites_.push({path:path,children:changedChildren,writeId:writeId,visible:!0}),this.visibleWrites_=this.visibleWrites_.addWrites(path,changedChildren),this.lastWriteId_=writeId},WriteTree.prototype.getWrite=function(writeId){for(var i=0;i<this.allWrites_.length;i++){var record=this.allWrites_[i];if(record.writeId===writeId)return record}return null},WriteTree.prototype.removeWrite=function(writeId){var _this=this,idx=this.allWrites_.findIndex((function(s){return s.writeId===writeId}));util.assert(idx>=0,\"removeWrite called with nonexistent writeId.\");var writeToRemove=this.allWrites_[idx];this.allWrites_.splice(idx,1);for(var removedWriteWasVisible=writeToRemove.visible,removedWriteOverlapsWithOtherWrites=!1,i=this.allWrites_.length-1;removedWriteWasVisible&&i>=0;){var currentWrite=this.allWrites_[i];currentWrite.visible&&(i>=idx&&this.recordContainsPath_(currentWrite,writeToRemove.path)?removedWriteWasVisible=!1:writeToRemove.path.contains(currentWrite.path)&&(removedWriteOverlapsWithOtherWrites=!0)),i--}return!!removedWriteWasVisible&&(removedWriteOverlapsWithOtherWrites?(this.resetTree_(),!0):(writeToRemove.snap?this.visibleWrites_=this.visibleWrites_.removeWrite(writeToRemove.path):each(writeToRemove.children,(function(childName){_this.visibleWrites_=_this.visibleWrites_.removeWrite(writeToRemove.path.child(childName))})),!0))},WriteTree.prototype.getCompleteWriteData=function(path){return this.visibleWrites_.getCompleteNode(path)},WriteTree.prototype.calcCompleteEventCache=function(treePath,completeServerCache,writeIdsToExclude,includeHiddenWrites){if(writeIdsToExclude||includeHiddenWrites){var merge=this.visibleWrites_.childCompoundWrite(treePath);return!includeHiddenWrites&&merge.isEmpty()?completeServerCache:includeHiddenWrites||null!=completeServerCache||merge.hasCompleteWrite(Path.Empty)?WriteTree.layerTree_(this.allWrites_,(function(write){return(write.visible||includeHiddenWrites)&&(!writeIdsToExclude||!~writeIdsToExclude.indexOf(write.writeId))&&(write.path.contains(treePath)||treePath.contains(write.path))}),treePath).apply(completeServerCache||ChildrenNode.EMPTY_NODE):null}var shadowingNode=this.visibleWrites_.getCompleteNode(treePath);if(null!=shadowingNode)return shadowingNode;var subMerge=this.visibleWrites_.childCompoundWrite(treePath);return subMerge.isEmpty()?completeServerCache:null!=completeServerCache||subMerge.hasCompleteWrite(Path.Empty)?subMerge.apply(completeServerCache||ChildrenNode.EMPTY_NODE):null},WriteTree.prototype.calcCompleteEventChildren=function(treePath,completeServerChildren){var completeChildren=ChildrenNode.EMPTY_NODE,topLevelSet=this.visibleWrites_.getCompleteNode(treePath);if(topLevelSet)return topLevelSet.isLeafNode()||topLevelSet.forEachChild(PRIORITY_INDEX,(function(childName,childSnap){completeChildren=completeChildren.updateImmediateChild(childName,childSnap)})),completeChildren;if(completeServerChildren){var merge_1=this.visibleWrites_.childCompoundWrite(treePath);return completeServerChildren.forEachChild(PRIORITY_INDEX,(function(childName,childNode){var node=merge_1.childCompoundWrite(new Path(childName)).apply(childNode);completeChildren=completeChildren.updateImmediateChild(childName,node)})),merge_1.getCompleteChildren().forEach((function(namedNode){completeChildren=completeChildren.updateImmediateChild(namedNode.name,namedNode.node)})),completeChildren}return this.visibleWrites_.childCompoundWrite(treePath).getCompleteChildren().forEach((function(namedNode){completeChildren=completeChildren.updateImmediateChild(namedNode.name,namedNode.node)})),completeChildren},WriteTree.prototype.calcEventCacheAfterServerOverwrite=function(treePath,childPath,existingEventSnap,existingServerSnap){util.assert(existingEventSnap||existingServerSnap,\"Either existingEventSnap or existingServerSnap must exist\");var path=treePath.child(childPath);if(this.visibleWrites_.hasCompleteWrite(path))return null;var childMerge=this.visibleWrites_.childCompoundWrite(path);return childMerge.isEmpty()?existingServerSnap.getChild(childPath):childMerge.apply(existingServerSnap.getChild(childPath))},WriteTree.prototype.calcCompleteChild=function(treePath,childKey,existingServerSnap){var path=treePath.child(childKey),shadowingNode=this.visibleWrites_.getCompleteNode(path);return null!=shadowingNode?shadowingNode:existingServerSnap.isCompleteForChild(childKey)?this.visibleWrites_.childCompoundWrite(path).apply(existingServerSnap.getNode().getImmediateChild(childKey)):null},WriteTree.prototype.shadowingWrite=function(path){return this.visibleWrites_.getCompleteNode(path)},WriteTree.prototype.calcIndexedSlice=function(treePath,completeServerData,startPost,count,reverse,index){var toIterate,merge=this.visibleWrites_.childCompoundWrite(treePath),shadowingNode=merge.getCompleteNode(Path.Empty);if(null!=shadowingNode)toIterate=shadowingNode;else{if(null==completeServerData)return[];toIterate=merge.apply(completeServerData)}if((toIterate=toIterate.withIndex(index)).isEmpty()||toIterate.isLeafNode())return[];for(var nodes=[],cmp=index.getCompare(),iter=reverse?toIterate.getReverseIteratorFrom(startPost,index):toIterate.getIteratorFrom(startPost,index),next=iter.getNext();next&&nodes.length<count;)0!==cmp(next,startPost)&&nodes.push(next),next=iter.getNext();return nodes},WriteTree.prototype.recordContainsPath_=function(writeRecord,path){if(writeRecord.snap)return writeRecord.path.contains(path);for(var childName in writeRecord.children)if(writeRecord.children.hasOwnProperty(childName)&&writeRecord.path.child(childName).contains(path))return!0;return!1},WriteTree.prototype.resetTree_=function(){this.visibleWrites_=WriteTree.layerTree_(this.allWrites_,WriteTree.DefaultFilter_,Path.Empty),this.lastWriteId_=this.allWrites_.length>0?this.allWrites_[this.allWrites_.length-1].writeId:-1},WriteTree.DefaultFilter_=function(write){return write.visible},WriteTree.layerTree_=function(writes,filter,treeRoot){for(var compoundWrite=CompoundWrite.Empty,i=0;i<writes.length;++i){var write=writes[i];if(filter(write)){var writePath=write.path,relativePath=void 0;if(write.snap)treeRoot.contains(writePath)?(relativePath=Path.relativePath(treeRoot,writePath),compoundWrite=compoundWrite.addWrite(relativePath,write.snap)):writePath.contains(treeRoot)&&(relativePath=Path.relativePath(writePath,treeRoot),compoundWrite=compoundWrite.addWrite(Path.Empty,write.snap.getChild(relativePath)));else{if(!write.children)throw util.assertionError(\"WriteRecord should have .snap or .children\");if(treeRoot.contains(writePath))relativePath=Path.relativePath(treeRoot,writePath),compoundWrite=compoundWrite.addWrites(relativePath,write.children);else if(writePath.contains(treeRoot))if((relativePath=Path.relativePath(writePath,treeRoot)).isEmpty())compoundWrite=compoundWrite.addWrites(Path.Empty,write.children);else{var child=util.safeGet(write.children,relativePath.getFront());if(child){var deepNode=child.getChild(relativePath.popFront());compoundWrite=compoundWrite.addWrite(Path.Empty,deepNode)}}}}}return compoundWrite},WriteTree}(),WriteTreeRef=function(){function WriteTreeRef(path,writeTree){this.treePath_=path,this.writeTree_=writeTree}return WriteTreeRef.prototype.calcCompleteEventCache=function(completeServerCache,writeIdsToExclude,includeHiddenWrites){return this.writeTree_.calcCompleteEventCache(this.treePath_,completeServerCache,writeIdsToExclude,includeHiddenWrites)},WriteTreeRef.prototype.calcCompleteEventChildren=function(completeServerChildren){return this.writeTree_.calcCompleteEventChildren(this.treePath_,completeServerChildren)},WriteTreeRef.prototype.calcEventCacheAfterServerOverwrite=function(path,existingEventSnap,existingServerSnap){return this.writeTree_.calcEventCacheAfterServerOverwrite(this.treePath_,path,existingEventSnap,existingServerSnap)},WriteTreeRef.prototype.shadowingWrite=function(path){return this.writeTree_.shadowingWrite(this.treePath_.child(path))},WriteTreeRef.prototype.calcIndexedSlice=function(completeServerData,startPost,count,reverse,index){return this.writeTree_.calcIndexedSlice(this.treePath_,completeServerData,startPost,count,reverse,index)},WriteTreeRef.prototype.calcCompleteChild=function(childKey,existingServerCache){return this.writeTree_.calcCompleteChild(this.treePath_,childKey,existingServerCache)},WriteTreeRef.prototype.child=function(childName){return new WriteTreeRef(this.treePath_.child(childName),this.writeTree_)},WriteTreeRef}(),SyncTree=function(){function SyncTree(listenProvider_){this.listenProvider_=listenProvider_,this.syncPointTree_=ImmutableTree.Empty,this.pendingWriteTree_=new WriteTree,this.tagToQueryMap=new Map,this.queryToTagMap=new Map}return SyncTree.prototype.applyUserOverwrite=function(path,newData,writeId,visible){return this.pendingWriteTree_.addOverwrite(path,newData,writeId,visible),visible?this.applyOperationToSyncPoints_(new Overwrite(OperationSource.User,path,newData)):[]},SyncTree.prototype.applyUserMerge=function(path,changedChildren,writeId){this.pendingWriteTree_.addMerge(path,changedChildren,writeId);var changeTree=ImmutableTree.fromObject(changedChildren);return this.applyOperationToSyncPoints_(new Merge(OperationSource.User,path,changeTree))},SyncTree.prototype.ackUserWrite=function(writeId,revert){void 0===revert&&(revert=!1);var write=this.pendingWriteTree_.getWrite(writeId);if(this.pendingWriteTree_.removeWrite(writeId)){var affectedTree_1=ImmutableTree.Empty;return null!=write.snap?affectedTree_1=affectedTree_1.set(Path.Empty,!0):each(write.children,(function(pathString,node){affectedTree_1=affectedTree_1.set(new Path(pathString),node)})),this.applyOperationToSyncPoints_(new AckUserWrite(write.path,affectedTree_1,revert))}return[]},SyncTree.prototype.applyServerOverwrite=function(path,newData){return this.applyOperationToSyncPoints_(new Overwrite(OperationSource.Server,path,newData))},SyncTree.prototype.applyServerMerge=function(path,changedChildren){var changeTree=ImmutableTree.fromObject(changedChildren);return this.applyOperationToSyncPoints_(new Merge(OperationSource.Server,path,changeTree))},SyncTree.prototype.applyListenComplete=function(path){return this.applyOperationToSyncPoints_(new ListenComplete(OperationSource.Server,path))},SyncTree.prototype.applyTaggedQueryOverwrite=function(path,snap,tag){var queryKey=this.queryKeyForTag_(tag);if(null!=queryKey){var r=SyncTree.parseQueryKey_(queryKey),queryPath=r.path,queryId=r.queryId,relativePath=Path.relativePath(queryPath,path),op=new Overwrite(OperationSource.forServerTaggedQuery(queryId),relativePath,snap);return this.applyTaggedOperation_(queryPath,op)}return[]},SyncTree.prototype.applyTaggedQueryMerge=function(path,changedChildren,tag){var queryKey=this.queryKeyForTag_(tag);if(queryKey){var r=SyncTree.parseQueryKey_(queryKey),queryPath=r.path,queryId=r.queryId,relativePath=Path.relativePath(queryPath,path),changeTree=ImmutableTree.fromObject(changedChildren),op=new Merge(OperationSource.forServerTaggedQuery(queryId),relativePath,changeTree);return this.applyTaggedOperation_(queryPath,op)}return[]},SyncTree.prototype.applyTaggedListenComplete=function(path,tag){var queryKey=this.queryKeyForTag_(tag);if(queryKey){var r=SyncTree.parseQueryKey_(queryKey),queryPath=r.path,queryId=r.queryId,relativePath=Path.relativePath(queryPath,path),op=new ListenComplete(OperationSource.forServerTaggedQuery(queryId),relativePath);return this.applyTaggedOperation_(queryPath,op)}return[]},SyncTree.prototype.addEventRegistration=function(query,eventRegistration){var path=query.path,serverCache=null,foundAncestorDefaultView=!1;this.syncPointTree_.foreachOnPath(path,(function(pathToSyncPoint,sp){var relativePath=Path.relativePath(pathToSyncPoint,path);serverCache=serverCache||sp.getCompleteServerCache(relativePath),foundAncestorDefaultView=foundAncestorDefaultView||sp.hasCompleteView()}));var serverCacheComplete,syncPoint=this.syncPointTree_.get(path);syncPoint?(foundAncestorDefaultView=foundAncestorDefaultView||syncPoint.hasCompleteView(),serverCache=serverCache||syncPoint.getCompleteServerCache(Path.Empty)):(syncPoint=new SyncPoint,this.syncPointTree_=this.syncPointTree_.set(path,syncPoint)),null!=serverCache?serverCacheComplete=!0:(serverCacheComplete=!1,serverCache=ChildrenNode.EMPTY_NODE,this.syncPointTree_.subtree(path).foreachChild((function(childName,childSyncPoint){var completeCache=childSyncPoint.getCompleteServerCache(Path.Empty);completeCache&&(serverCache=serverCache.updateImmediateChild(childName,completeCache))})));var viewAlreadyExists=syncPoint.viewExistsForQuery(query);if(!viewAlreadyExists&&!query.getQueryParams().loadsAllData()){var queryKey=SyncTree.makeQueryKey_(query);util.assert(!this.queryToTagMap.has(queryKey),\"View does not exist, but we have a tag\");var tag=SyncTree.getNextQueryTag_();this.queryToTagMap.set(queryKey,tag),this.tagToQueryMap.set(tag,queryKey)}var writesCache=this.pendingWriteTree_.childWrites(path),events=syncPoint.addEventRegistration(query,eventRegistration,writesCache,serverCache,serverCacheComplete);if(!viewAlreadyExists&&!foundAncestorDefaultView){var view=syncPoint.viewForQuery(query);events=events.concat(this.setupListener_(query,view))}return events},SyncTree.prototype.removeEventRegistration=function(query,eventRegistration,cancelError){var _this=this,path=query.path,maybeSyncPoint=this.syncPointTree_.get(path),cancelEvents=[];if(maybeSyncPoint&&(\"default\"===query.queryIdentifier()||maybeSyncPoint.viewExistsForQuery(query))){var removedAndEvents=maybeSyncPoint.removeEventRegistration(query,eventRegistration,cancelError);maybeSyncPoint.isEmpty()&&(this.syncPointTree_=this.syncPointTree_.remove(path));var removed=removedAndEvents.removed;cancelEvents=removedAndEvents.events;var removingDefault=-1!==removed.findIndex((function(query){return query.getQueryParams().loadsAllData()})),covered=this.syncPointTree_.findOnPath(path,(function(relativePath,parentSyncPoint){return parentSyncPoint.hasCompleteView()}));if(removingDefault&&!covered){var subtree=this.syncPointTree_.subtree(path);if(!subtree.isEmpty())for(var newViews=this.collectDistinctViewsForSubTree_(subtree),i=0;i<newViews.length;++i){var view=newViews[i],newQuery=view.getQuery(),listener=this.createListenerForView_(view);this.listenProvider_.startListening(SyncTree.queryForListening_(newQuery),this.tagForQuery_(newQuery),listener.hashFn,listener.onComplete)}}!covered&&removed.length>0&&!cancelError&&(removingDefault?this.listenProvider_.stopListening(SyncTree.queryForListening_(query),null):removed.forEach((function(queryToRemove){var tagToRemove=_this.queryToTagMap.get(SyncTree.makeQueryKey_(queryToRemove));_this.listenProvider_.stopListening(SyncTree.queryForListening_(queryToRemove),tagToRemove)}))),this.removeTags_(removed)}return cancelEvents},SyncTree.prototype.calcCompleteEventCache=function(path,writeIdsToExclude){var writeTree=this.pendingWriteTree_,serverCache=this.syncPointTree_.findOnPath(path,(function(pathSoFar,syncPoint){var relativePath=Path.relativePath(pathSoFar,path),serverCache=syncPoint.getCompleteServerCache(relativePath);if(serverCache)return serverCache}));return writeTree.calcCompleteEventCache(path,serverCache,writeIdsToExclude,!0)},SyncTree.prototype.collectDistinctViewsForSubTree_=function(subtree){return subtree.fold((function(relativePath,maybeChildSyncPoint,childMap){if(maybeChildSyncPoint&&maybeChildSyncPoint.hasCompleteView())return[maybeChildSyncPoint.getCompleteView()];var views_1=[];return maybeChildSyncPoint&&(views_1=maybeChildSyncPoint.getQueryViews()),each(childMap,(function(_key,childViews){views_1=views_1.concat(childViews)})),views_1}))},SyncTree.prototype.removeTags_=function(queries){for(var j=0;j<queries.length;++j){var removedQuery=queries[j];if(!removedQuery.getQueryParams().loadsAllData()){var removedQueryKey=SyncTree.makeQueryKey_(removedQuery),removedQueryTag=this.queryToTagMap.get(removedQueryKey);this.queryToTagMap.delete(removedQueryKey),this.tagToQueryMap.delete(removedQueryTag)}}},SyncTree.queryForListening_=function(query){return query.getQueryParams().loadsAllData()&&!query.getQueryParams().isDefault()?query.getRef():query},SyncTree.prototype.setupListener_=function(query,view){var path=query.path,tag=this.tagForQuery_(query),listener=this.createListenerForView_(view),events=this.listenProvider_.startListening(SyncTree.queryForListening_(query),tag,listener.hashFn,listener.onComplete),subtree=this.syncPointTree_.subtree(path);if(tag)util.assert(!subtree.value.hasCompleteView(),\"If we're adding a query, it shouldn't be shadowed\");else for(var queriesToStop=subtree.fold((function(relativePath,maybeChildSyncPoint,childMap){if(!relativePath.isEmpty()&&maybeChildSyncPoint&&maybeChildSyncPoint.hasCompleteView())return[maybeChildSyncPoint.getCompleteView().getQuery()];var queries_1=[];return maybeChildSyncPoint&&(queries_1=queries_1.concat(maybeChildSyncPoint.getQueryViews().map((function(view){return view.getQuery()})))),each(childMap,(function(_key,childQueries){queries_1=queries_1.concat(childQueries)})),queries_1})),i=0;i<queriesToStop.length;++i){var queryToStop=queriesToStop[i];this.listenProvider_.stopListening(SyncTree.queryForListening_(queryToStop),this.tagForQuery_(queryToStop))}return events},SyncTree.prototype.createListenerForView_=function(view){var _this=this,query=view.getQuery(),tag=this.tagForQuery_(query);return{hashFn:function(){return(view.getServerCache()||ChildrenNode.EMPTY_NODE).hash()},onComplete:function(status){if(\"ok\"===status)return tag?_this.applyTaggedListenComplete(query.path,tag):_this.applyListenComplete(query.path);var error=function(code,query){var reason=\"Unknown Error\";\"too_big\"===code?reason=\"The data requested exceeds the maximum size that can be accessed with a single request.\":\"permission_denied\"===code?reason=\"Client doesn't have permission to access the desired data.\":\"unavailable\"===code&&(reason=\"The service is unavailable\");var error=new Error(code+\" at \"+query.path.toString()+\": \"+reason);return error.code=code.toUpperCase(),error}(status,query);return _this.removeEventRegistration(query,null,error)}}},SyncTree.makeQueryKey_=function(query){return query.path.toString()+\"$\"+query.queryIdentifier()},SyncTree.parseQueryKey_=function(queryKey){var splitIndex=queryKey.indexOf(\"$\");return util.assert(-1!==splitIndex&&splitIndex<queryKey.length-1,\"Bad queryKey.\"),{queryId:queryKey.substr(splitIndex+1),path:new Path(queryKey.substr(0,splitIndex))}},SyncTree.prototype.queryKeyForTag_=function(tag){return this.tagToQueryMap.get(tag)},SyncTree.prototype.tagForQuery_=function(query){var queryKey=SyncTree.makeQueryKey_(query);return this.queryToTagMap.get(queryKey)},SyncTree.getNextQueryTag_=function(){return SyncTree.nextQueryTag_++},SyncTree.prototype.applyTaggedOperation_=function(queryPath,operation){var syncPoint=this.syncPointTree_.get(queryPath);util.assert(syncPoint,\"Missing sync point for query tag that we're tracking\");var writesCache=this.pendingWriteTree_.childWrites(queryPath);return syncPoint.applyOperation(operation,writesCache,null)},SyncTree.prototype.applyOperationToSyncPoints_=function(operation){return this.applyOperationHelper_(operation,this.syncPointTree_,null,this.pendingWriteTree_.childWrites(Path.Empty))},SyncTree.prototype.applyOperationHelper_=function(operation,syncPointTree,serverCache,writesCache){if(operation.path.isEmpty())return this.applyOperationDescendantsHelper_(operation,syncPointTree,serverCache,writesCache);var syncPoint=syncPointTree.get(Path.Empty);null==serverCache&&null!=syncPoint&&(serverCache=syncPoint.getCompleteServerCache(Path.Empty));var events=[],childName=operation.path.getFront(),childOperation=operation.operationForChild(childName),childTree=syncPointTree.children.get(childName);if(childTree&&childOperation){var childServerCache=serverCache?serverCache.getImmediateChild(childName):null,childWritesCache=writesCache.child(childName);events=events.concat(this.applyOperationHelper_(childOperation,childTree,childServerCache,childWritesCache))}return syncPoint&&(events=events.concat(syncPoint.applyOperation(operation,writesCache,serverCache))),events},SyncTree.prototype.applyOperationDescendantsHelper_=function(operation,syncPointTree,serverCache,writesCache){var _this=this,syncPoint=syncPointTree.get(Path.Empty);null==serverCache&&null!=syncPoint&&(serverCache=syncPoint.getCompleteServerCache(Path.Empty));var events=[];return syncPointTree.children.inorderTraversal((function(childName,childTree){var childServerCache=serverCache?serverCache.getImmediateChild(childName):null,childWritesCache=writesCache.child(childName),childOperation=operation.operationForChild(childName);childOperation&&(events=events.concat(_this.applyOperationDescendantsHelper_(childOperation,childTree,childServerCache,childWritesCache)))})),syncPoint&&(events=events.concat(syncPoint.applyOperation(operation,writesCache,serverCache))),events},SyncTree.nextQueryTag_=1,SyncTree}(),SnapshotHolder=function(){function SnapshotHolder(){this.rootNode_=ChildrenNode.EMPTY_NODE}return SnapshotHolder.prototype.getNode=function(path){return this.rootNode_.getChild(path)},SnapshotHolder.prototype.updateSnapshot=function(path,newSnapshotNode){this.rootNode_=this.rootNode_.updateChild(path,newSnapshotNode)},SnapshotHolder}(),StatsCollection=function(){function StatsCollection(){this.counters_={}}return StatsCollection.prototype.incrementCounter=function(name,amount){void 0===amount&&(amount=1),util.contains(this.counters_,name)||(this.counters_[name]=0),this.counters_[name]+=amount},StatsCollection.prototype.get=function(){return util.deepCopy(this.counters_)},StatsCollection}(),StatsManager=function(){function StatsManager(){}return StatsManager.getCollection=function(repoInfo){var hashString=repoInfo.toString();return this.collections_[hashString]||(this.collections_[hashString]=new StatsCollection),this.collections_[hashString]},StatsManager.getOrCreateReporter=function(repoInfo,creatorFunction){var hashString=repoInfo.toString();return this.reporters_[hashString]||(this.reporters_[hashString]=creatorFunction()),this.reporters_[hashString]},StatsManager.collections_={},StatsManager.reporters_={},StatsManager}(),StatsListener=function(){function StatsListener(collection_){this.collection_=collection_,this.last_=null}return StatsListener.prototype.get=function(){var newStats=this.collection_.get(),delta=tslib.__assign({},newStats);return this.last_&&each(this.last_,(function(stat,value){delta[stat]=delta[stat]-value})),this.last_=newStats,delta},StatsListener}(),StatsReporter=function(){function StatsReporter(collection,server_){this.server_=server_,this.statsToReport_={},this.statsListener_=new StatsListener(collection);var timeout=1e4+2e4*Math.random();setTimeoutNonBlocking(this.reportStats_.bind(this),Math.floor(timeout))}return StatsReporter.prototype.includeStat=function(stat){this.statsToReport_[stat]=!0},StatsReporter.prototype.reportStats_=function(){var _this=this,stats=this.statsListener_.get(),reportedStats={},haveStatsToReport=!1;each(stats,(function(stat,value){value>0&&util.contains(_this.statsToReport_,stat)&&(reportedStats[stat]=value,haveStatsToReport=!0)})),haveStatsToReport&&this.server_.reportStats(reportedStats),setTimeoutNonBlocking(this.reportStats_.bind(this),Math.floor(2*Math.random()*3e5))},StatsReporter}(),EventQueue=function(){function EventQueue(){this.eventLists_=[],this.recursionDepth_=0}return EventQueue.prototype.queueEvents=function(eventDataList){for(var currList=null,i=0;i<eventDataList.length;i++){var eventData=eventDataList[i],eventPath=eventData.getPath();null===currList||eventPath.equals(currList.getPath())||(this.eventLists_.push(currList),currList=null),null===currList&&(currList=new EventList(eventPath)),currList.add(eventData)}currList&&this.eventLists_.push(currList)},EventQueue.prototype.raiseEventsAtPath=function(path,eventDataList){this.queueEvents(eventDataList),this.raiseQueuedEventsMatchingPredicate_((function(eventPath){return eventPath.equals(path)}))},EventQueue.prototype.raiseEventsForChangedPath=function(changedPath,eventDataList){this.queueEvents(eventDataList),this.raiseQueuedEventsMatchingPredicate_((function(eventPath){return eventPath.contains(changedPath)||changedPath.contains(eventPath)}))},EventQueue.prototype.raiseQueuedEventsMatchingPredicate_=function(predicate){this.recursionDepth_++;for(var sentAll=!0,i=0;i<this.eventLists_.length;i++){var eventList=this.eventLists_[i];eventList&&(predicate(eventList.getPath())?(this.eventLists_[i].raise(),this.eventLists_[i]=null):sentAll=!1)}sentAll&&(this.eventLists_=[]),this.recursionDepth_--},EventQueue}(),EventList=function(){function EventList(path_){this.path_=path_,this.events_=[]}return EventList.prototype.add=function(eventData){this.events_.push(eventData)},EventList.prototype.raise=function(){for(var i=0;i<this.events_.length;i++){var eventData=this.events_[i];if(null!==eventData){this.events_[i]=null;var eventFn=eventData.getEventRunner();logger&&log(\"event: \"+eventData.toString()),exceptionGuard(eventFn)}}},EventList.prototype.getPath=function(){return this.path_},EventList}(),EventEmitter=function(){function EventEmitter(allowedEvents_){this.allowedEvents_=allowedEvents_,this.listeners_={},util.assert(Array.isArray(allowedEvents_)&&allowedEvents_.length>0,\"Requires a non-empty array\")}return EventEmitter.prototype.trigger=function(eventType){for(var varArgs=[],_i=1;_i<arguments.length;_i++)varArgs[_i-1]=arguments[_i];if(Array.isArray(this.listeners_[eventType]))for(var listeners=tslib.__spread(this.listeners_[eventType]),i=0;i<listeners.length;i++)listeners[i].callback.apply(listeners[i].context,varArgs)},EventEmitter.prototype.on=function(eventType,callback,context){this.validateEventType_(eventType),this.listeners_[eventType]=this.listeners_[eventType]||[],this.listeners_[eventType].push({callback:callback,context:context});var eventData=this.getInitialEvent(eventType);eventData&&callback.apply(context,eventData)},EventEmitter.prototype.off=function(eventType,callback,context){this.validateEventType_(eventType);for(var listeners=this.listeners_[eventType]||[],i=0;i<listeners.length;i++)if(listeners[i].callback===callback&&(!context||context===listeners[i].context))return void listeners.splice(i,1)},EventEmitter.prototype.validateEventType_=function(eventType){util.assert(this.allowedEvents_.find((function(et){return et===eventType})),\"Unknown event: \"+eventType)},EventEmitter}(),VisibilityMonitor=function(_super){function VisibilityMonitor(){var hidden,visibilityChange,_this=_super.call(this,[\"visible\"])||this;return\"undefined\"!=typeof document&&void 0!==document.addEventListener&&(void 0!==document.hidden?(visibilityChange=\"visibilitychange\",hidden=\"hidden\"):void 0!==document.mozHidden?(visibilityChange=\"mozvisibilitychange\",hidden=\"mozHidden\"):void 0!==document.msHidden?(visibilityChange=\"msvisibilitychange\",hidden=\"msHidden\"):void 0!==document.webkitHidden&&(visibilityChange=\"webkitvisibilitychange\",hidden=\"webkitHidden\")),_this.visible_=!0,visibilityChange&&document.addEventListener(visibilityChange,(function(){var visible=!document[hidden];visible!==_this.visible_&&(_this.visible_=visible,_this.trigger(\"visible\",visible))}),!1),_this}return tslib.__extends(VisibilityMonitor,_super),VisibilityMonitor.getInstance=function(){return new VisibilityMonitor},VisibilityMonitor.prototype.getInitialEvent=function(eventType){return util.assert(\"visible\"===eventType,\"Unknown event type: \"+eventType),[this.visible_]},VisibilityMonitor}(EventEmitter),OnlineMonitor=function(_super){function OnlineMonitor(){var _this=_super.call(this,[\"online\"])||this;return _this.online_=!0,\"undefined\"==typeof window||void 0===window.addEventListener||util.isMobileCordova()||(window.addEventListener(\"online\",(function(){_this.online_||(_this.online_=!0,_this.trigger(\"online\",!0))}),!1),window.addEventListener(\"offline\",(function(){_this.online_&&(_this.online_=!1,_this.trigger(\"online\",!1))}),!1)),_this}return tslib.__extends(OnlineMonitor,_super),OnlineMonitor.getInstance=function(){return new OnlineMonitor},OnlineMonitor.prototype.getInitialEvent=function(eventType){return util.assert(\"online\"===eventType,\"Unknown event type: \"+eventType),[this.online_]},OnlineMonitor.prototype.currentlyOnline=function(){return this.online_},OnlineMonitor}(EventEmitter),PacketReceiver=function(){function PacketReceiver(onMessage_){this.onMessage_=onMessage_,this.pendingResponses=[],this.currentResponseNum=0,this.closeAfterResponse=-1,this.onClose=null}return PacketReceiver.prototype.closeAfter=function(responseNum,callback){this.closeAfterResponse=responseNum,this.onClose=callback,this.closeAfterResponse<this.currentResponseNum&&(this.onClose(),this.onClose=null)},PacketReceiver.prototype.handleResponse=function(requestNum,data){var _this=this;this.pendingResponses[requestNum]=data;for(var _loop_1=function(){var toProcess=this_1.pendingResponses[this_1.currentResponseNum];delete this_1.pendingResponses[this_1.currentResponseNum];for(var _loop_2=function(i){toProcess[i]&&exceptionGuard((function(){_this.onMessage_(toProcess[i])}))},i=0;i<toProcess.length;++i)_loop_2(i);if(this_1.currentResponseNum===this_1.closeAfterResponse)return this_1.onClose&&(this_1.onClose(),this_1.onClose=null),\"break\";this_1.currentResponseNum++},this_1=this;this.pendingResponses[this.currentResponseNum]&&\"break\"!==_loop_1(););},PacketReceiver}(),BrowserPollConnection=function(){function BrowserPollConnection(connId,repoInfo,applicationId,transportSessionId,lastSessionId){this.connId=connId,this.repoInfo=repoInfo,this.applicationId=applicationId,this.transportSessionId=transportSessionId,this.lastSessionId=lastSessionId,this.bytesSent=0,this.bytesReceived=0,this.everConnected_=!1,this.log_=logWrapper(connId),this.stats_=StatsManager.getCollection(repoInfo),this.urlFn=function(params){return repoInfo.connectionURL(\"long_polling\",params)}}return BrowserPollConnection.prototype.open=function(onMessage,onDisconnect){var _this=this;this.curSegmentNum=0,this.onDisconnect_=onDisconnect,this.myPacketOrderer=new PacketReceiver(onMessage),this.isClosed_=!1,this.connectTimeoutTimer_=setTimeout((function(){_this.log_(\"Timed out trying to connect.\"),_this.onClosed_(),_this.connectTimeoutTimer_=null}),Math.floor(3e4)),function(fn){if(util.isNodeSdk()||\"complete\"===document.readyState)fn();else{var called_1=!1,wrappedFn_1=function(){document.body?called_1||(called_1=!0,fn()):setTimeout(wrappedFn_1,Math.floor(10))};document.addEventListener?(document.addEventListener(\"DOMContentLoaded\",wrappedFn_1,!1),window.addEventListener(\"load\",wrappedFn_1,!1)):document.attachEvent&&(document.attachEvent(\"onreadystatechange\",(function(){\"complete\"===document.readyState&&wrappedFn_1()})),window.attachEvent(\"onload\",wrappedFn_1))}}((function(){if(!_this.isClosed_){_this.scriptTagHolder=new FirebaseIFrameScriptHolder((function(){for(var args=[],_i=0;_i<arguments.length;_i++)args[_i]=arguments[_i];var _a=tslib.__read(args,5),command=_a[0],arg1=_a[1],arg2=_a[2];if(_this.incrementIncomingBytes_(args),_this.scriptTagHolder)if(_this.connectTimeoutTimer_&&(clearTimeout(_this.connectTimeoutTimer_),_this.connectTimeoutTimer_=null),_this.everConnected_=!0,\"start\"===command)_this.id=arg1,_this.password=arg2;else{if(\"close\"!==command)throw new Error(\"Unrecognized command received: \"+command);arg1?(_this.scriptTagHolder.sendNewPolls=!1,_this.myPacketOrderer.closeAfter(arg1,(function(){_this.onClosed_()}))):_this.onClosed_()}}),(function(){for(var args=[],_i=0;_i<arguments.length;_i++)args[_i]=arguments[_i];var _a=tslib.__read(args,2),pN=_a[0],data=_a[1];_this.incrementIncomingBytes_(args),_this.myPacketOrderer.handleResponse(pN,data)}),(function(){_this.onClosed_()}),_this.urlFn);var urlParams={start:\"t\"};urlParams.ser=Math.floor(1e8*Math.random()),_this.scriptTagHolder.uniqueCallbackIdentifier&&(urlParams.cb=_this.scriptTagHolder.uniqueCallbackIdentifier),urlParams.v=\"5\",_this.transportSessionId&&(urlParams.s=_this.transportSessionId),_this.lastSessionId&&(urlParams.ls=_this.lastSessionId),_this.applicationId&&(urlParams.p=_this.applicationId),\"undefined\"!=typeof location&&location.href&&-1!==location.href.indexOf(\"firebaseio.com\")&&(urlParams.r=\"f\");var connectURL=_this.urlFn(urlParams);_this.log_(\"Connecting via long-poll to \"+connectURL),_this.scriptTagHolder.addTag(connectURL,(function(){}))}}))},BrowserPollConnection.prototype.start=function(){this.scriptTagHolder.startLongPoll(this.id,this.password),this.addDisconnectPingFrame(this.id,this.password)},BrowserPollConnection.forceAllow=function(){BrowserPollConnection.forceAllow_=!0},BrowserPollConnection.forceDisallow=function(){BrowserPollConnection.forceDisallow_=!0},BrowserPollConnection.isAvailable=function(){return!(util.isNodeSdk()||!BrowserPollConnection.forceAllow_&&(BrowserPollConnection.forceDisallow_||\"undefined\"==typeof document||null==document.createElement||\"object\"==typeof window&&window.chrome&&window.chrome.extension&&!/^chrome/.test(window.location.href)||\"object\"==typeof Windows&&\"object\"==typeof Windows.UI))},BrowserPollConnection.prototype.markConnectionHealthy=function(){},BrowserPollConnection.prototype.shutdown_=function(){this.isClosed_=!0,this.scriptTagHolder&&(this.scriptTagHolder.close(),this.scriptTagHolder=null),this.myDisconnFrame&&(document.body.removeChild(this.myDisconnFrame),this.myDisconnFrame=null),this.connectTimeoutTimer_&&(clearTimeout(this.connectTimeoutTimer_),this.connectTimeoutTimer_=null)},BrowserPollConnection.prototype.onClosed_=function(){this.isClosed_||(this.log_(\"Longpoll is closing itself\"),this.shutdown_(),this.onDisconnect_&&(this.onDisconnect_(this.everConnected_),this.onDisconnect_=null))},BrowserPollConnection.prototype.close=function(){this.isClosed_||(this.log_(\"Longpoll is being closed.\"),this.shutdown_())},BrowserPollConnection.prototype.send=function(data){var dataStr=util.stringify(data);this.bytesSent+=dataStr.length,this.stats_.incrementCounter(\"bytes_sent\",dataStr.length);for(var base64data=util.base64Encode(dataStr),dataSegs=splitStringBySize(base64data,1840),i=0;i<dataSegs.length;i++)this.scriptTagHolder.enqueueSegment(this.curSegmentNum,dataSegs.length,dataSegs[i]),this.curSegmentNum++},BrowserPollConnection.prototype.addDisconnectPingFrame=function(id,pw){if(!util.isNodeSdk()){this.myDisconnFrame=document.createElement(\"iframe\");var urlParams={dframe:\"t\"};urlParams.id=id,urlParams.pw=pw,this.myDisconnFrame.src=this.urlFn(urlParams),this.myDisconnFrame.style.display=\"none\",document.body.appendChild(this.myDisconnFrame)}},BrowserPollConnection.prototype.incrementIncomingBytes_=function(args){var bytesReceived=util.stringify(args).length;this.bytesReceived+=bytesReceived,this.stats_.incrementCounter(\"bytes_received\",bytesReceived)},BrowserPollConnection}(),FirebaseIFrameScriptHolder=function(){function FirebaseIFrameScriptHolder(commandCB,onMessageCB,onDisconnect,urlFn){if(this.onDisconnect=onDisconnect,this.urlFn=urlFn,this.outstandingRequests=new Set,this.pendingSegs=[],this.currentSerial=Math.floor(1e8*Math.random()),this.sendNewPolls=!0,util.isNodeSdk())this.commandCB=commandCB,this.onMessageCB=onMessageCB;else{this.uniqueCallbackIdentifier=LUIDGenerator(),window[\"pLPCommand\"+this.uniqueCallbackIdentifier]=commandCB,window[\"pRTLPCB\"+this.uniqueCallbackIdentifier]=onMessageCB,this.myIFrame=FirebaseIFrameScriptHolder.createIFrame_();var script=\"\";this.myIFrame.src&&\"javascript:\"===this.myIFrame.src.substr(0,\"javascript:\".length)&&(script='<script>document.domain=\"'+document.domain+'\";<\\/script>');var iframeContents=\"<html><body>\"+script+\"</body></html>\";try{this.myIFrame.doc.open(),this.myIFrame.doc.write(iframeContents),this.myIFrame.doc.close()}catch(e){log(\"frame writing exception\"),e.stack&&log(e.stack),log(e)}}}return FirebaseIFrameScriptHolder.createIFrame_=function(){var iframe=document.createElement(\"iframe\");if(iframe.style.display=\"none\",!document.body)throw\"Document body has not initialized. Wait to initialize Firebase until after the document is ready.\";document.body.appendChild(iframe);try{iframe.contentWindow.document||log(\"No IE domain setting required\")}catch(e){var domain=document.domain;iframe.src=\"javascript:void((function(){document.open();document.domain='\"+domain+\"';document.close();})())\"}return iframe.contentDocument?iframe.doc=iframe.contentDocument:iframe.contentWindow?iframe.doc=iframe.contentWindow.document:iframe.document&&(iframe.doc=iframe.document),iframe},FirebaseIFrameScriptHolder.prototype.close=function(){var _this=this;this.alive=!1,this.myIFrame&&(this.myIFrame.doc.body.innerHTML=\"\",setTimeout((function(){null!==_this.myIFrame&&(document.body.removeChild(_this.myIFrame),_this.myIFrame=null)}),Math.floor(0)));var onDisconnect=this.onDisconnect;onDisconnect&&(this.onDisconnect=null,onDisconnect())},FirebaseIFrameScriptHolder.prototype.startLongPoll=function(id,pw){for(this.myID=id,this.myPW=pw,this.alive=!0;this.newRequest_(););},FirebaseIFrameScriptHolder.prototype.newRequest_=function(){if(this.alive&&this.sendNewPolls&&this.outstandingRequests.size<(this.pendingSegs.length>0?2:1)){this.currentSerial++;var urlParams={};urlParams.id=this.myID,urlParams.pw=this.myPW,urlParams.ser=this.currentSerial;for(var theURL=this.urlFn(urlParams),curDataString=\"\",i=0;this.pendingSegs.length>0&&this.pendingSegs[0].d.length+30+curDataString.length<=1870;){var theSeg=this.pendingSegs.shift();curDataString=curDataString+\"&seg\"+i+\"=\"+theSeg.seg+\"&ts\"+i+\"=\"+theSeg.ts+\"&d\"+i+\"=\"+theSeg.d,i++}return this.addLongPollTag_(theURL+=curDataString,this.currentSerial),!0}return!1},FirebaseIFrameScriptHolder.prototype.enqueueSegment=function(segnum,totalsegs,data){this.pendingSegs.push({seg:segnum,ts:totalsegs,d:data}),this.alive&&this.newRequest_()},FirebaseIFrameScriptHolder.prototype.addLongPollTag_=function(url,serial){var _this=this;this.outstandingRequests.add(serial);var doNewRequest=function(){_this.outstandingRequests.delete(serial),_this.newRequest_()},keepaliveTimeout=setTimeout(doNewRequest,Math.floor(25e3));this.addTag(url,(function(){clearTimeout(keepaliveTimeout),doNewRequest()}))},FirebaseIFrameScriptHolder.prototype.addTag=function(url,loadCB){var _this=this;util.isNodeSdk()?this.doNodeLongPoll(url,loadCB):setTimeout((function(){try{if(!_this.sendNewPolls)return;var newScript_1=_this.myIFrame.doc.createElement(\"script\");newScript_1.type=\"text/javascript\",newScript_1.async=!0,newScript_1.src=url,newScript_1.onload=newScript_1.onreadystatechange=function(){var rstate=newScript_1.readyState;rstate&&\"loaded\"!==rstate&&\"complete\"!==rstate||(newScript_1.onload=newScript_1.onreadystatechange=null,newScript_1.parentNode&&newScript_1.parentNode.removeChild(newScript_1),loadCB())},newScript_1.onerror=function(){log(\"Long-poll script failed to load: \"+url),_this.sendNewPolls=!1,_this.close()},_this.myIFrame.doc.body.appendChild(newScript_1)}catch(e){}}),Math.floor(1))},FirebaseIFrameScriptHolder}(),SDK_VERSION=\"\",WebSocketImpl=null;\"undefined\"!=typeof MozWebSocket?WebSocketImpl=MozWebSocket:\"undefined\"!=typeof WebSocket&&(WebSocketImpl=WebSocket);var WebSocketConnection=function(){function WebSocketConnection(connId,repoInfo,applicationId,transportSessionId,lastSessionId){this.connId=connId,this.applicationId=applicationId,this.keepaliveTimer=null,this.frames=null,this.totalFrames=0,this.bytesSent=0,this.bytesReceived=0,this.log_=logWrapper(this.connId),this.stats_=StatsManager.getCollection(repoInfo),this.connURL=WebSocketConnection.connectionURL_(repoInfo,transportSessionId,lastSessionId),this.nodeAdmin=repoInfo.nodeAdmin}return WebSocketConnection.connectionURL_=function(repoInfo,transportSessionId,lastSessionId){var urlParams={v:\"5\"};return!util.isNodeSdk()&&\"undefined\"!=typeof location&&location.href&&-1!==location.href.indexOf(\"firebaseio.com\")&&(urlParams.r=\"f\"),transportSessionId&&(urlParams.s=transportSessionId),lastSessionId&&(urlParams.ls=lastSessionId),repoInfo.connectionURL(\"websocket\",urlParams)},WebSocketConnection.prototype.open=function(onMessage,onDisconnect){var _this=this;this.onDisconnect=onDisconnect,this.onMessage=onMessage,this.log_(\"Websocket connecting to \"+this.connURL),this.everConnected_=!1,PersistentStorage.set(\"previous_websocket_failure\",!0);try{if(util.isNodeSdk()){var options={headers:{\"User-Agent\":\"Firebase/5/\"+SDK_VERSION+\"/\"+process.platform+\"/\"+(this.nodeAdmin?\"AdminNode\":\"Node\"),\"X-Firebase-GMPID\":this.applicationId||\"\"}},env=process.env,proxy=0===this.connURL.indexOf(\"wss://\")?env.HTTPS_PROXY||env.https_proxy:env.HTTP_PROXY||env.http_proxy;proxy&&(options.proxy={origin:proxy}),this.mySock=new WebSocketImpl(this.connURL,[],options)}else this.mySock=new WebSocketImpl(this.connURL,[],options={headers:{\"X-Firebase-GMPID\":this.applicationId||\"\"}})}catch(e){this.log_(\"Error instantiating WebSocket.\");var error=e.message||e.data;return error&&this.log_(error),void this.onClosed_()}this.mySock.onopen=function(){_this.log_(\"Websocket connected.\"),_this.everConnected_=!0},this.mySock.onclose=function(){_this.log_(\"Websocket connection was disconnected.\"),_this.mySock=null,_this.onClosed_()},this.mySock.onmessage=function(m){_this.handleIncomingFrame(m)},this.mySock.onerror=function(e){_this.log_(\"WebSocket error.  Closing connection.\");var error=e.message||e.data;error&&_this.log_(error),_this.onClosed_()}},WebSocketConnection.prototype.start=function(){},WebSocketConnection.forceDisallow=function(){WebSocketConnection.forceDisallow_=!0},WebSocketConnection.isAvailable=function(){var isOldAndroid=!1;if(\"undefined\"!=typeof navigator&&navigator.userAgent){var oldAndroidMatch=navigator.userAgent.match(/Android ([0-9]{0,}\\.[0-9]{0,})/);oldAndroidMatch&&oldAndroidMatch.length>1&&parseFloat(oldAndroidMatch[1])<4.4&&(isOldAndroid=!0)}return!isOldAndroid&&null!==WebSocketImpl&&!WebSocketConnection.forceDisallow_},WebSocketConnection.previouslyFailed=function(){return PersistentStorage.isInMemoryStorage||!0===PersistentStorage.get(\"previous_websocket_failure\")},WebSocketConnection.prototype.markConnectionHealthy=function(){PersistentStorage.remove(\"previous_websocket_failure\")},WebSocketConnection.prototype.appendFrame_=function(data){if(this.frames.push(data),this.frames.length===this.totalFrames){var fullMess=this.frames.join(\"\");this.frames=null;var jsonMess=util.jsonEval(fullMess);this.onMessage(jsonMess)}},WebSocketConnection.prototype.handleNewFrameCount_=function(frameCount){this.totalFrames=frameCount,this.frames=[]},WebSocketConnection.prototype.extractFrameCount_=function(data){if(util.assert(null===this.frames,\"We already have a frame buffer\"),data.length<=6){var frameCount=Number(data);if(!isNaN(frameCount))return this.handleNewFrameCount_(frameCount),null}return this.handleNewFrameCount_(1),data},WebSocketConnection.prototype.handleIncomingFrame=function(mess){if(null!==this.mySock){var data=mess.data;if(this.bytesReceived+=data.length,this.stats_.incrementCounter(\"bytes_received\",data.length),this.resetKeepAlive(),null!==this.frames)this.appendFrame_(data);else{var remainingData=this.extractFrameCount_(data);null!==remainingData&&this.appendFrame_(remainingData)}}},WebSocketConnection.prototype.send=function(data){this.resetKeepAlive();var dataStr=util.stringify(data);this.bytesSent+=dataStr.length,this.stats_.incrementCounter(\"bytes_sent\",dataStr.length);var dataSegs=splitStringBySize(dataStr,16384);dataSegs.length>1&&this.sendString_(String(dataSegs.length));for(var i=0;i<dataSegs.length;i++)this.sendString_(dataSegs[i])},WebSocketConnection.prototype.shutdown_=function(){this.isClosed_=!0,this.keepaliveTimer&&(clearInterval(this.keepaliveTimer),this.keepaliveTimer=null),this.mySock&&(this.mySock.close(),this.mySock=null)},WebSocketConnection.prototype.onClosed_=function(){this.isClosed_||(this.log_(\"WebSocket is closing itself\"),this.shutdown_(),this.onDisconnect&&(this.onDisconnect(this.everConnected_),this.onDisconnect=null))},WebSocketConnection.prototype.close=function(){this.isClosed_||(this.log_(\"WebSocket is being closed\"),this.shutdown_())},WebSocketConnection.prototype.resetKeepAlive=function(){var _this=this;clearInterval(this.keepaliveTimer),this.keepaliveTimer=setInterval((function(){_this.mySock&&_this.sendString_(\"0\"),_this.resetKeepAlive()}),Math.floor(45e3))},WebSocketConnection.prototype.sendString_=function(str){try{this.mySock.send(str)}catch(e){this.log_(\"Exception thrown from WebSocket.send():\",e.message||e.data,\"Closing connection.\"),setTimeout(this.onClosed_.bind(this),0)}},WebSocketConnection.responsesRequiredToBeHealthy=2,WebSocketConnection.healthyTimeout=3e4,WebSocketConnection}(),TransportManager=function(){function TransportManager(repoInfo){this.initTransports_(repoInfo)}return Object.defineProperty(TransportManager,\"ALL_TRANSPORTS\",{get:function(){return[BrowserPollConnection,WebSocketConnection]},enumerable:!1,configurable:!0}),TransportManager.prototype.initTransports_=function(repoInfo){var e_1,_a,isWebSocketsAvailable=WebSocketConnection&&WebSocketConnection.isAvailable(),isSkipPollConnection=isWebSocketsAvailable&&!WebSocketConnection.previouslyFailed();if(repoInfo.webSocketOnly&&(isWebSocketsAvailable||warn(\"wss:// URL used, but browser isn't known to support websockets.  Trying anyway.\"),isSkipPollConnection=!0),isSkipPollConnection)this.transports_=[WebSocketConnection];else{var transports=this.transports_=[];try{for(var _b=tslib.__values(TransportManager.ALL_TRANSPORTS),_c=_b.next();!_c.done;_c=_b.next()){var transport=_c.value;transport&&transport.isAvailable()&&transports.push(transport)}}catch(e_1_1){e_1={error:e_1_1}}finally{try{_c&&!_c.done&&(_a=_b.return)&&_a.call(_b)}finally{if(e_1)throw e_1.error}}}},TransportManager.prototype.initialTransport=function(){if(this.transports_.length>0)return this.transports_[0];throw new Error(\"No transports available\")},TransportManager.prototype.upgradeTransport=function(){return this.transports_.length>1?this.transports_[1]:null},TransportManager}(),Connection=function(){function Connection(id,repoInfo_,applicationId_,onMessage_,onReady_,onDisconnect_,onKill_,lastSessionId){this.id=id,this.repoInfo_=repoInfo_,this.applicationId_=applicationId_,this.onMessage_=onMessage_,this.onReady_=onReady_,this.onDisconnect_=onDisconnect_,this.onKill_=onKill_,this.lastSessionId=lastSessionId,this.connectionCount=0,this.pendingDataMessages=[],this.state_=0,this.log_=logWrapper(\"c:\"+this.id+\":\"),this.transportManager_=new TransportManager(repoInfo_),this.log_(\"Connection created\"),this.start_()}return Connection.prototype.start_=function(){var _this=this,conn=this.transportManager_.initialTransport();this.conn_=new conn(this.nextTransportId_(),this.repoInfo_,this.applicationId_,void 0,this.lastSessionId),this.primaryResponsesRequired_=conn.responsesRequiredToBeHealthy||0;var onMessageReceived=this.connReceiver_(this.conn_),onConnectionLost=this.disconnReceiver_(this.conn_);this.tx_=this.conn_,this.rx_=this.conn_,this.secondaryConn_=null,this.isHealthy_=!1,setTimeout((function(){_this.conn_&&_this.conn_.open(onMessageReceived,onConnectionLost)}),Math.floor(0));var healthyTimeoutMS=conn.healthyTimeout||0;healthyTimeoutMS>0&&(this.healthyTimeout_=setTimeoutNonBlocking((function(){_this.healthyTimeout_=null,_this.isHealthy_||(_this.conn_&&_this.conn_.bytesReceived>102400?(_this.log_(\"Connection exceeded healthy timeout but has received \"+_this.conn_.bytesReceived+\" bytes.  Marking connection healthy.\"),_this.isHealthy_=!0,_this.conn_.markConnectionHealthy()):_this.conn_&&_this.conn_.bytesSent>10240?_this.log_(\"Connection exceeded healthy timeout but has sent \"+_this.conn_.bytesSent+\" bytes.  Leaving connection alive.\"):(_this.log_(\"Closing unhealthy connection after timeout.\"),_this.close()))}),Math.floor(healthyTimeoutMS)))},Connection.prototype.nextTransportId_=function(){return\"c:\"+this.id+\":\"+this.connectionCount++},Connection.prototype.disconnReceiver_=function(conn){var _this=this;return function(everConnected){conn===_this.conn_?_this.onConnectionLost_(everConnected):conn===_this.secondaryConn_?(_this.log_(\"Secondary connection lost.\"),_this.onSecondaryConnectionLost_()):_this.log_(\"closing an old connection\")}},Connection.prototype.connReceiver_=function(conn){var _this=this;return function(message){2!==_this.state_&&(conn===_this.rx_?_this.onPrimaryMessageReceived_(message):conn===_this.secondaryConn_?_this.onSecondaryMessageReceived_(message):_this.log_(\"message on old connection\"))}},Connection.prototype.sendRequest=function(dataMsg){this.sendData_({t:\"d\",d:dataMsg})},Connection.prototype.tryCleanupConnection=function(){this.tx_===this.secondaryConn_&&this.rx_===this.secondaryConn_&&(this.log_(\"cleaning up and promoting a connection: \"+this.secondaryConn_.connId),this.conn_=this.secondaryConn_,this.secondaryConn_=null)},Connection.prototype.onSecondaryControl_=function(controlData){if(\"t\"in controlData){var cmd=controlData.t;\"a\"===cmd?this.upgradeIfSecondaryHealthy_():\"r\"===cmd?(this.log_(\"Got a reset on secondary, closing it\"),this.secondaryConn_.close(),this.tx_!==this.secondaryConn_&&this.rx_!==this.secondaryConn_||this.close()):\"o\"===cmd&&(this.log_(\"got pong on secondary.\"),this.secondaryResponsesRequired_--,this.upgradeIfSecondaryHealthy_())}},Connection.prototype.onSecondaryMessageReceived_=function(parsedData){var layer=requireKey(\"t\",parsedData),data=requireKey(\"d\",parsedData);if(\"c\"===layer)this.onSecondaryControl_(data);else{if(\"d\"!==layer)throw new Error(\"Unknown protocol layer: \"+layer);this.pendingDataMessages.push(data)}},Connection.prototype.upgradeIfSecondaryHealthy_=function(){this.secondaryResponsesRequired_<=0?(this.log_(\"Secondary connection is healthy.\"),this.isHealthy_=!0,this.secondaryConn_.markConnectionHealthy(),this.proceedWithUpgrade_()):(this.log_(\"sending ping on secondary.\"),this.secondaryConn_.send({t:\"c\",d:{t:\"p\",d:{}}}))},Connection.prototype.proceedWithUpgrade_=function(){this.secondaryConn_.start(),this.log_(\"sending client ack on secondary\"),this.secondaryConn_.send({t:\"c\",d:{t:\"a\",d:{}}}),this.log_(\"Ending transmission on primary\"),this.conn_.send({t:\"c\",d:{t:\"n\",d:{}}}),this.tx_=this.secondaryConn_,this.tryCleanupConnection()},Connection.prototype.onPrimaryMessageReceived_=function(parsedData){var layer=requireKey(\"t\",parsedData),data=requireKey(\"d\",parsedData);\"c\"===layer?this.onControl_(data):\"d\"===layer&&this.onDataMessage_(data)},Connection.prototype.onDataMessage_=function(message){this.onPrimaryResponse_(),this.onMessage_(message)},Connection.prototype.onPrimaryResponse_=function(){this.isHealthy_||(this.primaryResponsesRequired_--,this.primaryResponsesRequired_<=0&&(this.log_(\"Primary connection is healthy.\"),this.isHealthy_=!0,this.conn_.markConnectionHealthy()))},Connection.prototype.onControl_=function(controlData){var cmd=requireKey(\"t\",controlData);if(\"d\"in controlData){var payload=controlData.d;if(\"h\"===cmd)this.onHandshake_(payload);else if(\"n\"===cmd){this.log_(\"recvd end transmission on primary\"),this.rx_=this.secondaryConn_;for(var i=0;i<this.pendingDataMessages.length;++i)this.onDataMessage_(this.pendingDataMessages[i]);this.pendingDataMessages=[],this.tryCleanupConnection()}else\"s\"===cmd?this.onConnectionShutdown_(payload):\"r\"===cmd?this.onReset_(payload):\"e\"===cmd?error(\"Server Error: \"+payload):\"o\"===cmd?(this.log_(\"got pong on primary.\"),this.onPrimaryResponse_(),this.sendPingOnPrimaryIfNecessary_()):error(\"Unknown control packet command: \"+cmd)}},Connection.prototype.onHandshake_=function(handshake){var timestamp=handshake.ts,version=handshake.v,host=handshake.h;this.sessionId=handshake.s,this.repoInfo_.updateHost(host),0===this.state_&&(this.conn_.start(),this.onConnectionEstablished_(this.conn_,timestamp),\"5\"!==version&&warn(\"Protocol version mismatch detected\"),this.tryStartUpgrade_())},Connection.prototype.tryStartUpgrade_=function(){var conn=this.transportManager_.upgradeTransport();conn&&this.startUpgrade_(conn)},Connection.prototype.startUpgrade_=function(conn){var _this=this;this.secondaryConn_=new conn(this.nextTransportId_(),this.repoInfo_,this.applicationId_,this.sessionId),this.secondaryResponsesRequired_=conn.responsesRequiredToBeHealthy||0;var onMessage=this.connReceiver_(this.secondaryConn_),onDisconnect=this.disconnReceiver_(this.secondaryConn_);this.secondaryConn_.open(onMessage,onDisconnect),setTimeoutNonBlocking((function(){_this.secondaryConn_&&(_this.log_(\"Timed out trying to upgrade.\"),_this.secondaryConn_.close())}),Math.floor(6e4))},Connection.prototype.onReset_=function(host){this.log_(\"Reset packet received.  New host: \"+host),this.repoInfo_.updateHost(host),1===this.state_?this.close():(this.closeConnections_(),this.start_())},Connection.prototype.onConnectionEstablished_=function(conn,timestamp){var _this=this;this.log_(\"Realtime connection established.\"),this.conn_=conn,this.state_=1,this.onReady_&&(this.onReady_(timestamp,this.sessionId),this.onReady_=null),0===this.primaryResponsesRequired_?(this.log_(\"Primary connection is healthy.\"),this.isHealthy_=!0):setTimeoutNonBlocking((function(){_this.sendPingOnPrimaryIfNecessary_()}),Math.floor(5e3))},Connection.prototype.sendPingOnPrimaryIfNecessary_=function(){this.isHealthy_||1!==this.state_||(this.log_(\"sending ping on primary.\"),this.sendData_({t:\"c\",d:{t:\"p\",d:{}}}))},Connection.prototype.onSecondaryConnectionLost_=function(){var conn=this.secondaryConn_;this.secondaryConn_=null,this.tx_!==conn&&this.rx_!==conn||this.close()},Connection.prototype.onConnectionLost_=function(everConnected){this.conn_=null,everConnected||0!==this.state_?1===this.state_&&this.log_(\"Realtime connection lost.\"):(this.log_(\"Realtime connection failed.\"),this.repoInfo_.isCacheableHost()&&(PersistentStorage.remove(\"host:\"+this.repoInfo_.host),this.repoInfo_.internalHost=this.repoInfo_.host)),this.close()},Connection.prototype.onConnectionShutdown_=function(reason){this.log_(\"Connection shutdown command received. Shutting down...\"),this.onKill_&&(this.onKill_(reason),this.onKill_=null),this.onDisconnect_=null,this.close()},Connection.prototype.sendData_=function(data){if(1!==this.state_)throw\"Connection is not connected\";this.tx_.send(data)},Connection.prototype.close=function(){2!==this.state_&&(this.log_(\"Closing realtime connection.\"),this.state_=2,this.closeConnections_(),this.onDisconnect_&&(this.onDisconnect_(),this.onDisconnect_=null))},Connection.prototype.closeConnections_=function(){this.log_(\"Shutting down all connections\"),this.conn_&&(this.conn_.close(),this.conn_=null),this.secondaryConn_&&(this.secondaryConn_.close(),this.secondaryConn_=null),this.healthyTimeout_&&(clearTimeout(this.healthyTimeout_),this.healthyTimeout_=null)},Connection}(),ServerActions=function(){function ServerActions(){}return ServerActions.prototype.put=function(pathString,data,onComplete,hash){},ServerActions.prototype.merge=function(pathString,data,onComplete,hash){},ServerActions.prototype.refreshAuthToken=function(token){},ServerActions.prototype.onDisconnectPut=function(pathString,data,onComplete){},ServerActions.prototype.onDisconnectMerge=function(pathString,data,onComplete){},ServerActions.prototype.onDisconnectCancel=function(pathString,onComplete){},ServerActions.prototype.reportStats=function(stats){},ServerActions}(),PersistentConnection=function(_super){function PersistentConnection(repoInfo_,applicationId_,onDataUpdate_,onConnectStatus_,onServerInfoUpdate_,authTokenProvider_,authOverride_){var _this=_super.call(this)||this;if(_this.repoInfo_=repoInfo_,_this.applicationId_=applicationId_,_this.onDataUpdate_=onDataUpdate_,_this.onConnectStatus_=onConnectStatus_,_this.onServerInfoUpdate_=onServerInfoUpdate_,_this.authTokenProvider_=authTokenProvider_,_this.authOverride_=authOverride_,_this.id=PersistentConnection.nextPersistentConnectionId_++,_this.log_=logWrapper(\"p:\"+_this.id+\":\"),_this.interruptReasons_={},_this.listens=new Map,_this.outstandingPuts_=[],_this.outstandingPutCount_=0,_this.onDisconnectRequestQueue_=[],_this.connected_=!1,_this.reconnectDelay_=1e3,_this.maxReconnectDelay_=3e5,_this.securityDebugCallback_=null,_this.lastSessionId=null,_this.establishConnectionTimer_=null,_this.visible_=!1,_this.requestCBHash_={},_this.requestNumber_=0,_this.realtime_=null,_this.authToken_=null,_this.forceTokenRefresh_=!1,_this.invalidAuthTokenCount_=0,_this.firstConnection_=!0,_this.lastConnectionAttemptTime_=null,_this.lastConnectionEstablishedTime_=null,authOverride_&&!util.isNodeSdk())throw new Error(\"Auth override specified in options, but not supported on non Node.js platforms\");return _this.scheduleConnect_(0),VisibilityMonitor.getInstance().on(\"visible\",_this.onVisible_,_this),-1===repoInfo_.host.indexOf(\"fblocal\")&&OnlineMonitor.getInstance().on(\"online\",_this.onOnline_,_this),_this}return tslib.__extends(PersistentConnection,_super),PersistentConnection.prototype.sendRequest=function(action,body,onResponse){var curReqNum=++this.requestNumber_,msg={r:curReqNum,a:action,b:body};this.log_(util.stringify(msg)),util.assert(this.connected_,\"sendRequest call when we're not connected not allowed.\"),this.realtime_.sendRequest(msg),onResponse&&(this.requestCBHash_[curReqNum]=onResponse)},PersistentConnection.prototype.listen=function(query,currentHashFn,tag,onComplete){var queryId=query.queryIdentifier(),pathString=query.path.toString();this.log_(\"Listen called for \"+pathString+\" \"+queryId),this.listens.has(pathString)||this.listens.set(pathString,new Map),util.assert(query.getQueryParams().isDefault()||!query.getQueryParams().loadsAllData(),\"listen() called for non-default but complete query\"),util.assert(!this.listens.get(pathString).has(queryId),\"listen() called twice for same path/queryId.\");var listenSpec={onComplete:onComplete,hashFn:currentHashFn,query:query,tag:tag};this.listens.get(pathString).set(queryId,listenSpec),this.connected_&&this.sendListen_(listenSpec)},PersistentConnection.prototype.sendListen_=function(listenSpec){var _this=this,query=listenSpec.query,pathString=query.path.toString(),queryId=query.queryIdentifier();this.log_(\"Listen on \"+pathString+\" for \"+queryId);var req={p:pathString};listenSpec.tag&&(req.q=query.queryObject(),req.t=listenSpec.tag),req.h=listenSpec.hashFn(),this.sendRequest(\"q\",req,(function(message){var payload=message.d,status=message.s;PersistentConnection.warnOnListenWarnings_(payload,query),(_this.listens.get(pathString)&&_this.listens.get(pathString).get(queryId))===listenSpec&&(_this.log_(\"listen response\",message),\"ok\"!==status&&_this.removeListen_(pathString,queryId),listenSpec.onComplete&&listenSpec.onComplete(status,payload))}))},PersistentConnection.warnOnListenWarnings_=function(payload,query){if(payload&&\"object\"==typeof payload&&util.contains(payload,\"w\")){var warnings=util.safeGet(payload,\"w\");if(Array.isArray(warnings)&&~warnings.indexOf(\"no_index\")){var indexSpec='\".indexOn\": \"'+query.getQueryParams().getIndex().toString()+'\"',indexPath=query.path.toString();warn(\"Using an unspecified index. Your data will be downloaded and filtered on the client. Consider adding \"+indexSpec+\" at \"+indexPath+\" to your security rules for better performance.\")}}},PersistentConnection.prototype.refreshAuthToken=function(token){this.authToken_=token,this.log_(\"Auth token refreshed\"),this.authToken_?this.tryAuth():this.connected_&&this.sendRequest(\"unauth\",{},(function(){})),this.reduceReconnectDelayIfAdminCredential_(token)},PersistentConnection.prototype.reduceReconnectDelayIfAdminCredential_=function(credential){(credential&&40===credential.length||util.isAdmin(credential))&&(this.log_(\"Admin auth credential detected.  Reducing max reconnect time.\"),this.maxReconnectDelay_=3e4)},PersistentConnection.prototype.tryAuth=function(){var _this=this;if(this.connected_&&this.authToken_){var token_1=this.authToken_,authMethod=util.isValidFormat(token_1)?\"auth\":\"gauth\",requestData={cred:token_1};null===this.authOverride_?requestData.noauth=!0:\"object\"==typeof this.authOverride_&&(requestData.authvar=this.authOverride_),this.sendRequest(authMethod,requestData,(function(res){var status=res.s,data=res.d||\"error\";_this.authToken_===token_1&&(\"ok\"===status?_this.invalidAuthTokenCount_=0:_this.onAuthRevoked_(status,data))}))}},PersistentConnection.prototype.unlisten=function(query,tag){var pathString=query.path.toString(),queryId=query.queryIdentifier();this.log_(\"Unlisten called for \"+pathString+\" \"+queryId),util.assert(query.getQueryParams().isDefault()||!query.getQueryParams().loadsAllData(),\"unlisten() called for non-default but complete query\"),this.removeListen_(pathString,queryId)&&this.connected_&&this.sendUnlisten_(pathString,queryId,query.queryObject(),tag)},PersistentConnection.prototype.sendUnlisten_=function(pathString,queryId,queryObj,tag){this.log_(\"Unlisten on \"+pathString+\" for \"+queryId);var req={p:pathString};tag&&(req.q=queryObj,req.t=tag),this.sendRequest(\"n\",req)},PersistentConnection.prototype.onDisconnectPut=function(pathString,data,onComplete){this.connected_?this.sendOnDisconnect_(\"o\",pathString,data,onComplete):this.onDisconnectRequestQueue_.push({pathString:pathString,action:\"o\",data:data,onComplete:onComplete})},PersistentConnection.prototype.onDisconnectMerge=function(pathString,data,onComplete){this.connected_?this.sendOnDisconnect_(\"om\",pathString,data,onComplete):this.onDisconnectRequestQueue_.push({pathString:pathString,action:\"om\",data:data,onComplete:onComplete})},PersistentConnection.prototype.onDisconnectCancel=function(pathString,onComplete){this.connected_?this.sendOnDisconnect_(\"oc\",pathString,null,onComplete):this.onDisconnectRequestQueue_.push({pathString:pathString,action:\"oc\",data:null,onComplete:onComplete})},PersistentConnection.prototype.sendOnDisconnect_=function(action,pathString,data,onComplete){var request={p:pathString,d:data};this.log_(\"onDisconnect \"+action,request),this.sendRequest(action,request,(function(response){onComplete&&setTimeout((function(){onComplete(response.s,response.d)}),Math.floor(0))}))},PersistentConnection.prototype.put=function(pathString,data,onComplete,hash){this.putInternal(\"p\",pathString,data,onComplete,hash)},PersistentConnection.prototype.merge=function(pathString,data,onComplete,hash){this.putInternal(\"m\",pathString,data,onComplete,hash)},PersistentConnection.prototype.putInternal=function(action,pathString,data,onComplete,hash){var request={p:pathString,d:data};void 0!==hash&&(request.h=hash),this.outstandingPuts_.push({action:action,request:request,onComplete:onComplete}),this.outstandingPutCount_++,this.connected_?this.sendPut_(this.outstandingPuts_.length-1):this.log_(\"Buffering put: \"+pathString)},PersistentConnection.prototype.sendPut_=function(index){var _this=this,action=this.outstandingPuts_[index].action,request=this.outstandingPuts_[index].request,onComplete=this.outstandingPuts_[index].onComplete;this.outstandingPuts_[index].queued=this.connected_,this.sendRequest(action,request,(function(message){_this.log_(action+\" response\",message),delete _this.outstandingPuts_[index],_this.outstandingPutCount_--,0===_this.outstandingPutCount_&&(_this.outstandingPuts_=[]),onComplete&&onComplete(message.s,message.d)}))},PersistentConnection.prototype.reportStats=function(stats){var _this=this;if(this.connected_){var request={c:stats};this.log_(\"reportStats\",request),this.sendRequest(\"s\",request,(function(result){\"ok\"!==result.s&&_this.log_(\"reportStats\",\"Error sending stats: \"+result.d)}))}},PersistentConnection.prototype.onDataMessage_=function(message){if(\"r\"in message){this.log_(\"from server: \"+util.stringify(message));var reqNum=message.r,onResponse=this.requestCBHash_[reqNum];onResponse&&(delete this.requestCBHash_[reqNum],onResponse(message.b))}else{if(\"error\"in message)throw\"A server-side error has occurred: \"+message.error;\"a\"in message&&this.onDataPush_(message.a,message.b)}},PersistentConnection.prototype.onDataPush_=function(action,body){this.log_(\"handleServerMessage\",action,body),\"d\"===action?this.onDataUpdate_(body.p,body.d,!1,body.t):\"m\"===action?this.onDataUpdate_(body.p,body.d,!0,body.t):\"c\"===action?this.onListenRevoked_(body.p,body.q):\"ac\"===action?this.onAuthRevoked_(body.s,body.d):\"sd\"===action?this.onSecurityDebugPacket_(body):error(\"Unrecognized action received from server: \"+util.stringify(action)+\"\\nAre you using the latest client?\")},PersistentConnection.prototype.onReady_=function(timestamp,sessionId){this.log_(\"connection ready\"),this.connected_=!0,this.lastConnectionEstablishedTime_=(new Date).getTime(),this.handleTimestamp_(timestamp),this.lastSessionId=sessionId,this.firstConnection_&&this.sendConnectStats_(),this.restoreState_(),this.firstConnection_=!1,this.onConnectStatus_(!0)},PersistentConnection.prototype.scheduleConnect_=function(timeout){var _this=this;util.assert(!this.realtime_,\"Scheduling a connect when we're already connected/ing?\"),this.establishConnectionTimer_&&clearTimeout(this.establishConnectionTimer_),this.establishConnectionTimer_=setTimeout((function(){_this.establishConnectionTimer_=null,_this.establishConnection_()}),Math.floor(timeout))},PersistentConnection.prototype.onVisible_=function(visible){visible&&!this.visible_&&this.reconnectDelay_===this.maxReconnectDelay_&&(this.log_(\"Window became visible.  Reducing delay.\"),this.reconnectDelay_=1e3,this.realtime_||this.scheduleConnect_(0)),this.visible_=visible},PersistentConnection.prototype.onOnline_=function(online){online?(this.log_(\"Browser went online.\"),this.reconnectDelay_=1e3,this.realtime_||this.scheduleConnect_(0)):(this.log_(\"Browser went offline.  Killing connection.\"),this.realtime_&&this.realtime_.close())},PersistentConnection.prototype.onRealtimeDisconnect_=function(){if(this.log_(\"data client disconnected\"),this.connected_=!1,this.realtime_=null,this.cancelSentTransactions_(),this.requestCBHash_={},this.shouldReconnect_()){this.visible_?this.lastConnectionEstablishedTime_&&((new Date).getTime()-this.lastConnectionEstablishedTime_>3e4&&(this.reconnectDelay_=1e3),this.lastConnectionEstablishedTime_=null):(this.log_(\"Window isn't visible.  Delaying reconnect.\"),this.reconnectDelay_=this.maxReconnectDelay_,this.lastConnectionAttemptTime_=(new Date).getTime());var timeSinceLastConnectAttempt=(new Date).getTime()-this.lastConnectionAttemptTime_,reconnectDelay=Math.max(0,this.reconnectDelay_-timeSinceLastConnectAttempt);reconnectDelay=Math.random()*reconnectDelay,this.log_(\"Trying to reconnect in \"+reconnectDelay+\"ms\"),this.scheduleConnect_(reconnectDelay),this.reconnectDelay_=Math.min(this.maxReconnectDelay_,1.3*this.reconnectDelay_)}this.onConnectStatus_(!1)},PersistentConnection.prototype.establishConnection_=function(){var _this=this;if(this.shouldReconnect_()){this.log_(\"Making a connection attempt\"),this.lastConnectionAttemptTime_=(new Date).getTime(),this.lastConnectionEstablishedTime_=null;var onDataMessage_1=this.onDataMessage_.bind(this),onReady_1=this.onReady_.bind(this),onDisconnect_1=this.onRealtimeDisconnect_.bind(this),connId_1=this.id+\":\"+PersistentConnection.nextConnectionId_++,self_1=this,lastSessionId_1=this.lastSessionId,canceled_1=!1,connection_1=null,closeFn_1=function(){connection_1?connection_1.close():(canceled_1=!0,onDisconnect_1())};this.realtime_={close:closeFn_1,sendRequest:function(msg){util.assert(connection_1,\"sendRequest call when we're not connected not allowed.\"),connection_1.sendRequest(msg)}};var forceRefresh=this.forceTokenRefresh_;this.forceTokenRefresh_=!1,this.authTokenProvider_.getToken(forceRefresh).then((function(result){canceled_1?log(\"getToken() completed but was canceled\"):(log(\"getToken() completed. Creating connection.\"),self_1.authToken_=result&&result.accessToken,connection_1=new Connection(connId_1,self_1.repoInfo_,self_1.applicationId_,onDataMessage_1,onReady_1,onDisconnect_1,(function(reason){warn(reason+\" (\"+self_1.repoInfo_.toString()+\")\"),self_1.interrupt(\"server_kill\")}),lastSessionId_1))})).then(null,(function(error){self_1.log_(\"Failed to get token: \"+error),canceled_1||(_this.repoInfo_.nodeAdmin&&warn(error),closeFn_1())}))}},PersistentConnection.prototype.interrupt=function(reason){log(\"Interrupting connection for reason: \"+reason),this.interruptReasons_[reason]=!0,this.realtime_?this.realtime_.close():(this.establishConnectionTimer_&&(clearTimeout(this.establishConnectionTimer_),this.establishConnectionTimer_=null),this.connected_&&this.onRealtimeDisconnect_())},PersistentConnection.prototype.resume=function(reason){log(\"Resuming connection for reason: \"+reason),delete this.interruptReasons_[reason],util.isEmpty(this.interruptReasons_)&&(this.reconnectDelay_=1e3,this.realtime_||this.scheduleConnect_(0))},PersistentConnection.prototype.handleTimestamp_=function(timestamp){var delta=timestamp-(new Date).getTime();this.onServerInfoUpdate_({serverTimeOffset:delta})},PersistentConnection.prototype.cancelSentTransactions_=function(){for(var i=0;i<this.outstandingPuts_.length;i++){var put=this.outstandingPuts_[i];put&&\"h\"in put.request&&put.queued&&(put.onComplete&&put.onComplete(\"disconnect\"),delete this.outstandingPuts_[i],this.outstandingPutCount_--)}0===this.outstandingPutCount_&&(this.outstandingPuts_=[])},PersistentConnection.prototype.onListenRevoked_=function(pathString,query){var queryId;queryId=query?query.map((function(q){return ObjectToUniqueKey(q)})).join(\"$\"):\"default\";var listen=this.removeListen_(pathString,queryId);listen&&listen.onComplete&&listen.onComplete(\"permission_denied\")},PersistentConnection.prototype.removeListen_=function(pathString,queryId){var listen,normalizedPathString=new Path(pathString).toString();if(this.listens.has(normalizedPathString)){var map=this.listens.get(normalizedPathString);listen=map.get(queryId),map.delete(queryId),0===map.size&&this.listens.delete(normalizedPathString)}else listen=void 0;return listen},PersistentConnection.prototype.onAuthRevoked_=function(statusCode,explanation){log(\"Auth token revoked: \"+statusCode+\"/\"+explanation),this.authToken_=null,this.forceTokenRefresh_=!0,this.realtime_.close(),\"invalid_token\"!==statusCode&&\"permission_denied\"!==statusCode||(this.invalidAuthTokenCount_++,this.invalidAuthTokenCount_>=3&&(this.reconnectDelay_=3e4,this.authTokenProvider_.notifyForInvalidToken()))},PersistentConnection.prototype.onSecurityDebugPacket_=function(body){this.securityDebugCallback_?this.securityDebugCallback_(body):\"msg\"in body&&console.log(\"FIREBASE: \"+body.msg.replace(\"\\n\",\"\\nFIREBASE: \"))},PersistentConnection.prototype.restoreState_=function(){var e_1,_a,e_2,_b;this.tryAuth();try{for(var _c=tslib.__values(this.listens.values()),_d=_c.next();!_d.done;_d=_c.next()){var queries=_d.value;try{for(var _e=(e_2=void 0,tslib.__values(queries.values())),_f=_e.next();!_f.done;_f=_e.next())this.sendListen_(_f.value)}catch(e_2_1){e_2={error:e_2_1}}finally{try{_f&&!_f.done&&(_b=_e.return)&&_b.call(_e)}finally{if(e_2)throw e_2.error}}}}catch(e_1_1){e_1={error:e_1_1}}finally{try{_d&&!_d.done&&(_a=_c.return)&&_a.call(_c)}finally{if(e_1)throw e_1.error}}for(var i=0;i<this.outstandingPuts_.length;i++)this.outstandingPuts_[i]&&this.sendPut_(i);for(;this.onDisconnectRequestQueue_.length;){var request=this.onDisconnectRequestQueue_.shift();this.sendOnDisconnect_(request.action,request.pathString,request.data,request.onComplete)}},PersistentConnection.prototype.sendConnectStats_=function(){var stats={},clientName=\"js\";util.isNodeSdk()&&(clientName=this.repoInfo_.nodeAdmin?\"admin_node\":\"node\"),stats[\"sdk.\"+clientName+\".\"+SDK_VERSION.replace(/\\./g,\"-\")]=1,util.isMobileCordova()?stats[\"framework.cordova\"]=1:util.isReactNative()&&(stats[\"framework.reactnative\"]=1),this.reportStats(stats)},PersistentConnection.prototype.shouldReconnect_=function(){var online=OnlineMonitor.getInstance().currentlyOnline();return util.isEmpty(this.interruptReasons_)&&online},PersistentConnection.nextPersistentConnectionId_=0,PersistentConnection.nextConnectionId_=0,PersistentConnection}(ServerActions),ReadonlyRestClient=function(_super){function ReadonlyRestClient(repoInfo_,onDataUpdate_,authTokenProvider_){var _this=_super.call(this)||this;return _this.repoInfo_=repoInfo_,_this.onDataUpdate_=onDataUpdate_,_this.authTokenProvider_=authTokenProvider_,_this.log_=logWrapper(\"p:rest:\"),_this.listens_={},_this}return tslib.__extends(ReadonlyRestClient,_super),ReadonlyRestClient.prototype.reportStats=function(stats){throw new Error(\"Method not implemented.\")},ReadonlyRestClient.getListenId_=function(query,tag){return void 0!==tag?\"tag$\"+tag:(util.assert(query.getQueryParams().isDefault(),\"should have a tag if it's not a default query.\"),query.path.toString())},ReadonlyRestClient.prototype.listen=function(query,currentHashFn,tag,onComplete){var _this=this,pathString=query.path.toString();this.log_(\"Listen called for \"+pathString+\" \"+query.queryIdentifier());var listenId=ReadonlyRestClient.getListenId_(query,tag),thisListen={};this.listens_[listenId]=thisListen;var queryStringParameters=query.getQueryParams().toRestQueryStringParameters();this.restRequest_(pathString+\".json\",queryStringParameters,(function(error,result){var data=result;404===error&&(data=null,error=null),null===error&&_this.onDataUpdate_(pathString,data,!1,tag),util.safeGet(_this.listens_,listenId)===thisListen&&onComplete(error?401===error?\"permission_denied\":\"rest_error:\"+error:\"ok\",null)}))},ReadonlyRestClient.prototype.unlisten=function(query,tag){var listenId=ReadonlyRestClient.getListenId_(query,tag);delete this.listens_[listenId]},ReadonlyRestClient.prototype.refreshAuthToken=function(token){},ReadonlyRestClient.prototype.restRequest_=function(pathString,queryStringParameters,callback){var _this=this;void 0===queryStringParameters&&(queryStringParameters={}),queryStringParameters.format=\"export\",this.authTokenProvider_.getToken(!1).then((function(authTokenData){var authToken=authTokenData&&authTokenData.accessToken;authToken&&(queryStringParameters.auth=authToken);var url=(_this.repoInfo_.secure?\"https://\":\"http://\")+_this.repoInfo_.host+pathString+\"?ns=\"+_this.repoInfo_.namespace+util.querystring(queryStringParameters);_this.log_(\"Sending REST request for \"+url);var xhr=new XMLHttpRequest;xhr.onreadystatechange=function(){if(callback&&4===xhr.readyState){_this.log_(\"REST Response for \"+url+\" received. status:\",xhr.status,\"response:\",xhr.responseText);var res=null;if(xhr.status>=200&&xhr.status<300){try{res=util.jsonEval(xhr.responseText)}catch(e){warn(\"Failed to parse JSON response for \"+url+\": \"+xhr.responseText)}callback(null,res)}else 401!==xhr.status&&404!==xhr.status&&warn(\"Got unsuccessful REST response for \"+url+\" Status: \"+xhr.status),callback(xhr.status);callback=null}},xhr.open(\"GET\",url,!0),xhr.send()}))},ReadonlyRestClient}(ServerActions),Repo=function(){function Repo(repoInfo_,forceRestClient,app,authTokenProvider){var _this=this;if(this.repoInfo_=repoInfo_,this.app=app,this.dataUpdateCount=0,this.statsListener_=null,this.eventQueue_=new EventQueue,this.nextWriteId_=1,this.interceptServerDataCallback_=null,this.onDisconnect_=new SparseSnapshotTree,this.persistentConnection_=null,this.stats_=StatsManager.getCollection(repoInfo_),forceRestClient||(\"object\"==typeof window&&window.navigator&&window.navigator.userAgent||\"\").search(/googlebot|google webmaster tools|bingbot|yahoo! slurp|baiduspider|yandexbot|duckduckbot/i)>=0)this.server_=new ReadonlyRestClient(this.repoInfo_,this.onDataUpdate_.bind(this),authTokenProvider),setTimeout(this.onConnectStatus_.bind(this,!0),0);else{var authOverride=app.options.databaseAuthVariableOverride;if(null!=authOverride){if(\"object\"!=typeof authOverride)throw new Error(\"Only objects are supported for option databaseAuthVariableOverride\");try{util.stringify(authOverride)}catch(e){throw new Error(\"Invalid authOverride provided: \"+e)}}this.persistentConnection_=new PersistentConnection(this.repoInfo_,app.options.appId,this.onDataUpdate_.bind(this),this.onConnectStatus_.bind(this),this.onServerInfoUpdate_.bind(this),authTokenProvider,authOverride),this.server_=this.persistentConnection_}authTokenProvider.addTokenChangeListener((function(token){_this.server_.refreshAuthToken(token)})),this.statsReporter_=StatsManager.getOrCreateReporter(repoInfo_,(function(){return new StatsReporter(_this.stats_,_this.server_)})),this.transactionsInit_(),this.infoData_=new SnapshotHolder,this.infoSyncTree_=new SyncTree({startListening:function(query,tag,currentHashFn,onComplete){var infoEvents=[],node=_this.infoData_.getNode(query.path);return node.isEmpty()||(infoEvents=_this.infoSyncTree_.applyServerOverwrite(query.path,node),setTimeout((function(){onComplete(\"ok\")}),0)),infoEvents},stopListening:function(){}}),this.updateInfo_(\"connected\",!1),this.serverSyncTree_=new SyncTree({startListening:function(query,tag,currentHashFn,onComplete){return _this.server_.listen(query,currentHashFn,tag,(function(status,data){var events=onComplete(status,data);_this.eventQueue_.raiseEventsForChangedPath(query.path,events)})),[]},stopListening:function(query,tag){_this.server_.unlisten(query,tag)}})}return Repo.prototype.toString=function(){return(this.repoInfo_.secure?\"https://\":\"http://\")+this.repoInfo_.host},Repo.prototype.name=function(){return this.repoInfo_.namespace},Repo.prototype.serverTime=function(){var offset=this.infoData_.getNode(new Path(\".info/serverTimeOffset\")).val()||0;return(new Date).getTime()+offset},Repo.prototype.generateServerValues=function(){return(values=(values={timestamp:this.serverTime()})||{}).timestamp=values.timestamp||(new Date).getTime(),values;var values},Repo.prototype.onDataUpdate_=function(pathString,data,isMerge,tag){this.dataUpdateCount++;var path=new Path(pathString);data=this.interceptServerDataCallback_?this.interceptServerDataCallback_(pathString,data):data;var events=[];if(tag)if(isMerge){var taggedChildren=util.map(data,(function(raw){return nodeFromJSON$1(raw)}));events=this.serverSyncTree_.applyTaggedQueryMerge(path,taggedChildren,tag)}else{var taggedSnap=nodeFromJSON$1(data);events=this.serverSyncTree_.applyTaggedQueryOverwrite(path,taggedSnap,tag)}else if(isMerge){var changedChildren=util.map(data,(function(raw){return nodeFromJSON$1(raw)}));events=this.serverSyncTree_.applyServerMerge(path,changedChildren)}else{var snap=nodeFromJSON$1(data);events=this.serverSyncTree_.applyServerOverwrite(path,snap)}var affectedPath=path;events.length>0&&(affectedPath=this.rerunTransactions_(path)),this.eventQueue_.raiseEventsForChangedPath(affectedPath,events)},Repo.prototype.interceptServerData_=function(callback){this.interceptServerDataCallback_=callback},Repo.prototype.onConnectStatus_=function(connectStatus){this.updateInfo_(\"connected\",connectStatus),!1===connectStatus&&this.runOnDisconnectEvents_()},Repo.prototype.onServerInfoUpdate_=function(updates){var _this=this;each(updates,(function(key,value){_this.updateInfo_(key,value)}))},Repo.prototype.updateInfo_=function(pathString,value){var path=new Path(\"/.info/\"+pathString),newNode=nodeFromJSON$1(value);this.infoData_.updateSnapshot(path,newNode);var events=this.infoSyncTree_.applyServerOverwrite(path,newNode);this.eventQueue_.raiseEventsForChangedPath(path,events)},Repo.prototype.getNextWriteId_=function(){return this.nextWriteId_++},Repo.prototype.setWithPriority=function(path,newVal,newPriority,onComplete){var _this=this;this.log_(\"set\",{path:path.toString(),value:newVal,priority:newPriority});var serverValues=this.generateServerValues(),newNodeUnresolved=nodeFromJSON$1(newVal,newPriority),existing=this.serverSyncTree_.calcCompleteEventCache(path),newNode=resolveDeferredValueSnapshot(newNodeUnresolved,existing,serverValues),writeId=this.getNextWriteId_(),events=this.serverSyncTree_.applyUserOverwrite(path,newNode,writeId,!0);this.eventQueue_.queueEvents(events),this.server_.put(path.toString(),newNodeUnresolved.val(!0),(function(status,errorReason){var success=\"ok\"===status;success||warn(\"set at \"+path+\" failed: \"+status);var clearEvents=_this.serverSyncTree_.ackUserWrite(writeId,!success);_this.eventQueue_.raiseEventsForChangedPath(path,clearEvents),_this.callOnCompleteCallback(onComplete,status,errorReason)}));var affectedPath=this.abortTransactions_(path);this.rerunTransactions_(affectedPath),this.eventQueue_.raiseEventsForChangedPath(affectedPath,[])},Repo.prototype.update=function(path,childrenToMerge,onComplete){var _this=this;this.log_(\"update\",{path:path.toString(),value:childrenToMerge});var empty=!0,serverValues=this.generateServerValues(),changedChildren={};if(each(childrenToMerge,(function(changedKey,changedValue){empty=!1,changedChildren[changedKey]=resolveDeferredValueTree(path.child(changedKey),nodeFromJSON$1(changedValue),_this.serverSyncTree_,serverValues)})),empty)log(\"update() called with empty data.  Don't do anything.\"),this.callOnCompleteCallback(onComplete,\"ok\");else{var writeId_1=this.getNextWriteId_(),events=this.serverSyncTree_.applyUserMerge(path,changedChildren,writeId_1);this.eventQueue_.queueEvents(events),this.server_.merge(path.toString(),childrenToMerge,(function(status,errorReason){var success=\"ok\"===status;success||warn(\"update at \"+path+\" failed: \"+status);var clearEvents=_this.serverSyncTree_.ackUserWrite(writeId_1,!success),affectedPath=clearEvents.length>0?_this.rerunTransactions_(path):path;_this.eventQueue_.raiseEventsForChangedPath(affectedPath,clearEvents),_this.callOnCompleteCallback(onComplete,status,errorReason)})),each(childrenToMerge,(function(changedPath){var affectedPath=_this.abortTransactions_(path.child(changedPath));_this.rerunTransactions_(affectedPath)})),this.eventQueue_.raiseEventsForChangedPath(path,[])}},Repo.prototype.runOnDisconnectEvents_=function(){var _this=this;this.log_(\"onDisconnectEvents\");var serverValues=this.generateServerValues(),resolvedOnDisconnectTree=new SparseSnapshotTree;this.onDisconnect_.forEachTree(Path.Empty,(function(path,node){var resolved=resolveDeferredValueTree(path,node,_this.serverSyncTree_,serverValues);resolvedOnDisconnectTree.remember(path,resolved)}));var events=[];resolvedOnDisconnectTree.forEachTree(Path.Empty,(function(path,snap){events=events.concat(_this.serverSyncTree_.applyServerOverwrite(path,snap));var affectedPath=_this.abortTransactions_(path);_this.rerunTransactions_(affectedPath)})),this.onDisconnect_=new SparseSnapshotTree,this.eventQueue_.raiseEventsForChangedPath(Path.Empty,events)},Repo.prototype.onDisconnectCancel=function(path,onComplete){var _this=this;this.server_.onDisconnectCancel(path.toString(),(function(status,errorReason){\"ok\"===status&&_this.onDisconnect_.forget(path),_this.callOnCompleteCallback(onComplete,status,errorReason)}))},Repo.prototype.onDisconnectSet=function(path,value,onComplete){var _this=this,newNode=nodeFromJSON$1(value);this.server_.onDisconnectPut(path.toString(),newNode.val(!0),(function(status,errorReason){\"ok\"===status&&_this.onDisconnect_.remember(path,newNode),_this.callOnCompleteCallback(onComplete,status,errorReason)}))},Repo.prototype.onDisconnectSetWithPriority=function(path,value,priority,onComplete){var _this=this,newNode=nodeFromJSON$1(value,priority);this.server_.onDisconnectPut(path.toString(),newNode.val(!0),(function(status,errorReason){\"ok\"===status&&_this.onDisconnect_.remember(path,newNode),_this.callOnCompleteCallback(onComplete,status,errorReason)}))},Repo.prototype.onDisconnectUpdate=function(path,childrenToMerge,onComplete){var _this=this;if(util.isEmpty(childrenToMerge))return log(\"onDisconnect().update() called with empty data.  Don't do anything.\"),void this.callOnCompleteCallback(onComplete,\"ok\");this.server_.onDisconnectMerge(path.toString(),childrenToMerge,(function(status,errorReason){\"ok\"===status&&each(childrenToMerge,(function(childName,childNode){var newChildNode=nodeFromJSON$1(childNode);_this.onDisconnect_.remember(path.child(childName),newChildNode)})),_this.callOnCompleteCallback(onComplete,status,errorReason)}))},Repo.prototype.addEventCallbackForQuery=function(query,eventRegistration){var events;events=\".info\"===query.path.getFront()?this.infoSyncTree_.addEventRegistration(query,eventRegistration):this.serverSyncTree_.addEventRegistration(query,eventRegistration),this.eventQueue_.raiseEventsAtPath(query.path,events)},Repo.prototype.removeEventCallbackForQuery=function(query,eventRegistration){var events;events=\".info\"===query.path.getFront()?this.infoSyncTree_.removeEventRegistration(query,eventRegistration):this.serverSyncTree_.removeEventRegistration(query,eventRegistration),this.eventQueue_.raiseEventsAtPath(query.path,events)},Repo.prototype.interrupt=function(){this.persistentConnection_&&this.persistentConnection_.interrupt(\"repo_interrupt\")},Repo.prototype.resume=function(){this.persistentConnection_&&this.persistentConnection_.resume(\"repo_interrupt\")},Repo.prototype.stats=function(showDelta){if(void 0===showDelta&&(showDelta=!1),\"undefined\"!=typeof console){var stats;showDelta?(this.statsListener_||(this.statsListener_=new StatsListener(this.stats_)),stats=this.statsListener_.get()):stats=this.stats_.get();var longestName=Object.keys(stats).reduce((function(previousValue,currentValue){return Math.max(currentValue.length,previousValue)}),0);each(stats,(function(stat,value){for(var paddedStat=stat,i=stat.length;i<longestName+2;i++)paddedStat+=\" \";console.log(paddedStat+value)}))}},Repo.prototype.statsIncrementCounter=function(metric){this.stats_.incrementCounter(metric),this.statsReporter_.includeStat(metric)},Repo.prototype.log_=function(){for(var varArgs=[],_i=0;_i<arguments.length;_i++)varArgs[_i]=arguments[_i];var prefix=\"\";this.persistentConnection_&&(prefix=this.persistentConnection_.id+\":\"),log.apply(void 0,tslib.__spread([prefix],varArgs))},Repo.prototype.callOnCompleteCallback=function(callback,status,errorReason){callback&&exceptionGuard((function(){if(\"ok\"===status)callback(null);else{var code=(status||\"error\").toUpperCase(),message=code;errorReason&&(message+=\": \"+errorReason);var error=new Error(message);error.code=code,callback(error)}}))},Object.defineProperty(Repo.prototype,\"database\",{get:function(){return this.__database||(this.__database=new Database(this))},enumerable:!1,configurable:!0}),Repo}(),RangedFilter=function(){function RangedFilter(params){this.indexedFilter_=new IndexedFilter(params.getIndex()),this.index_=params.getIndex(),this.startPost_=RangedFilter.getStartPost_(params),this.endPost_=RangedFilter.getEndPost_(params)}return RangedFilter.prototype.getStartPost=function(){return this.startPost_},RangedFilter.prototype.getEndPost=function(){return this.endPost_},RangedFilter.prototype.matches=function(node){return this.index_.compare(this.getStartPost(),node)<=0&&this.index_.compare(node,this.getEndPost())<=0},RangedFilter.prototype.updateChild=function(snap,key,newChild,affectedPath,source,optChangeAccumulator){return this.matches(new NamedNode(key,newChild))||(newChild=ChildrenNode.EMPTY_NODE),this.indexedFilter_.updateChild(snap,key,newChild,affectedPath,source,optChangeAccumulator)},RangedFilter.prototype.updateFullNode=function(oldSnap,newSnap,optChangeAccumulator){newSnap.isLeafNode()&&(newSnap=ChildrenNode.EMPTY_NODE);var filtered=newSnap.withIndex(this.index_);filtered=filtered.updatePriority(ChildrenNode.EMPTY_NODE);var self=this;return newSnap.forEachChild(PRIORITY_INDEX,(function(key,childNode){self.matches(new NamedNode(key,childNode))||(filtered=filtered.updateImmediateChild(key,ChildrenNode.EMPTY_NODE))})),this.indexedFilter_.updateFullNode(oldSnap,filtered,optChangeAccumulator)},RangedFilter.prototype.updatePriority=function(oldSnap,newPriority){return oldSnap},RangedFilter.prototype.filtersNodes=function(){return!0},RangedFilter.prototype.getIndexedFilter=function(){return this.indexedFilter_},RangedFilter.prototype.getIndex=function(){return this.index_},RangedFilter.getStartPost_=function(params){if(params.hasStart()){var startName=params.getIndexStartName();return params.getIndex().makePost(params.getIndexStartValue(),startName)}return params.getIndex().minPost()},RangedFilter.getEndPost_=function(params){if(params.hasEnd()){var endName=params.getIndexEndName();return params.getIndex().makePost(params.getIndexEndValue(),endName)}return params.getIndex().maxPost()},RangedFilter}(),LimitedFilter=function(){function LimitedFilter(params){this.rangedFilter_=new RangedFilter(params),this.index_=params.getIndex(),this.limit_=params.getLimit(),this.reverse_=!params.isViewFromLeft()}return LimitedFilter.prototype.updateChild=function(snap,key,newChild,affectedPath,source,optChangeAccumulator){return this.rangedFilter_.matches(new NamedNode(key,newChild))||(newChild=ChildrenNode.EMPTY_NODE),snap.getImmediateChild(key).equals(newChild)?snap:snap.numChildren()<this.limit_?this.rangedFilter_.getIndexedFilter().updateChild(snap,key,newChild,affectedPath,source,optChangeAccumulator):this.fullLimitUpdateChild_(snap,key,newChild,source,optChangeAccumulator)},LimitedFilter.prototype.updateFullNode=function(oldSnap,newSnap,optChangeAccumulator){var filtered;if(newSnap.isLeafNode()||newSnap.isEmpty())filtered=ChildrenNode.EMPTY_NODE.withIndex(this.index_);else if(2*this.limit_<newSnap.numChildren()&&newSnap.isIndexed(this.index_)){filtered=ChildrenNode.EMPTY_NODE.withIndex(this.index_);var iterator=void 0;iterator=this.reverse_?newSnap.getReverseIteratorFrom(this.rangedFilter_.getEndPost(),this.index_):newSnap.getIteratorFrom(this.rangedFilter_.getStartPost(),this.index_);for(var count=0;iterator.hasNext()&&count<this.limit_;){var next=iterator.getNext();if(!(this.reverse_?this.index_.compare(this.rangedFilter_.getStartPost(),next)<=0:this.index_.compare(next,this.rangedFilter_.getEndPost())<=0))break;filtered=filtered.updateImmediateChild(next.name,next.node),count++}}else{filtered=(filtered=newSnap.withIndex(this.index_)).updatePriority(ChildrenNode.EMPTY_NODE);var startPost=void 0,endPost=void 0,cmp=void 0;if(iterator=void 0,this.reverse_){iterator=filtered.getReverseIterator(this.index_),startPost=this.rangedFilter_.getEndPost(),endPost=this.rangedFilter_.getStartPost();var indexCompare_1=this.index_.getCompare();cmp=function(a,b){return indexCompare_1(b,a)}}else iterator=filtered.getIterator(this.index_),startPost=this.rangedFilter_.getStartPost(),endPost=this.rangedFilter_.getEndPost(),cmp=this.index_.getCompare();count=0;for(var foundStartPost=!1;iterator.hasNext();)next=iterator.getNext(),!foundStartPost&&cmp(startPost,next)<=0&&(foundStartPost=!0),foundStartPost&&count<this.limit_&&cmp(next,endPost)<=0?count++:filtered=filtered.updateImmediateChild(next.name,ChildrenNode.EMPTY_NODE)}return this.rangedFilter_.getIndexedFilter().updateFullNode(oldSnap,filtered,optChangeAccumulator)},LimitedFilter.prototype.updatePriority=function(oldSnap,newPriority){return oldSnap},LimitedFilter.prototype.filtersNodes=function(){return!0},LimitedFilter.prototype.getIndexedFilter=function(){return this.rangedFilter_.getIndexedFilter()},LimitedFilter.prototype.getIndex=function(){return this.index_},LimitedFilter.prototype.fullLimitUpdateChild_=function(snap,childKey,childSnap,source,changeAccumulator){var cmp;if(this.reverse_){var indexCmp_1=this.index_.getCompare();cmp=function(a,b){return indexCmp_1(b,a)}}else cmp=this.index_.getCompare();var oldEventCache=snap;util.assert(oldEventCache.numChildren()===this.limit_,\"\");var newChildNamedNode=new NamedNode(childKey,childSnap),windowBoundary=this.reverse_?oldEventCache.getFirstChild(this.index_):oldEventCache.getLastChild(this.index_),inRange=this.rangedFilter_.matches(newChildNamedNode);if(oldEventCache.hasChild(childKey)){for(var oldChildSnap=oldEventCache.getImmediateChild(childKey),nextChild=source.getChildAfterChild(this.index_,windowBoundary,this.reverse_);null!=nextChild&&(nextChild.name===childKey||oldEventCache.hasChild(nextChild.name));)nextChild=source.getChildAfterChild(this.index_,nextChild,this.reverse_);var compareNext=null==nextChild?1:cmp(nextChild,newChildNamedNode);if(inRange&&!childSnap.isEmpty()&&compareNext>=0)return null!=changeAccumulator&&changeAccumulator.trackChildChange(Change.childChangedChange(childKey,childSnap,oldChildSnap)),oldEventCache.updateImmediateChild(childKey,childSnap);null!=changeAccumulator&&changeAccumulator.trackChildChange(Change.childRemovedChange(childKey,oldChildSnap));var newEventCache=oldEventCache.updateImmediateChild(childKey,ChildrenNode.EMPTY_NODE);return null!=nextChild&&this.rangedFilter_.matches(nextChild)?(null!=changeAccumulator&&changeAccumulator.trackChildChange(Change.childAddedChange(nextChild.name,nextChild.node)),newEventCache.updateImmediateChild(nextChild.name,nextChild.node)):newEventCache}return childSnap.isEmpty()?snap:inRange&&cmp(windowBoundary,newChildNamedNode)>=0?(null!=changeAccumulator&&(changeAccumulator.trackChildChange(Change.childRemovedChange(windowBoundary.name,windowBoundary.node)),changeAccumulator.trackChildChange(Change.childAddedChange(childKey,childSnap))),oldEventCache.updateImmediateChild(childKey,childSnap).updateImmediateChild(windowBoundary.name,ChildrenNode.EMPTY_NODE)):snap},LimitedFilter}(),QueryParams=function(){function QueryParams(){this.limitSet_=!1,this.startSet_=!1,this.startNameSet_=!1,this.endSet_=!1,this.endNameSet_=!1,this.limit_=0,this.viewFrom_=\"\",this.indexStartValue_=null,this.indexStartName_=\"\",this.indexEndValue_=null,this.indexEndName_=\"\",this.index_=PRIORITY_INDEX}return QueryParams.prototype.hasStart=function(){return this.startSet_},QueryParams.prototype.isViewFromLeft=function(){return\"\"===this.viewFrom_?this.startSet_:this.viewFrom_===QueryParams.WIRE_PROTOCOL_CONSTANTS_.VIEW_FROM_LEFT},QueryParams.prototype.getIndexStartValue=function(){return util.assert(this.startSet_,\"Only valid if start has been set\"),this.indexStartValue_},QueryParams.prototype.getIndexStartName=function(){return util.assert(this.startSet_,\"Only valid if start has been set\"),this.startNameSet_?this.indexStartName_:MIN_NAME},QueryParams.prototype.hasEnd=function(){return this.endSet_},QueryParams.prototype.getIndexEndValue=function(){return util.assert(this.endSet_,\"Only valid if end has been set\"),this.indexEndValue_},QueryParams.prototype.getIndexEndName=function(){return util.assert(this.endSet_,\"Only valid if end has been set\"),this.endNameSet_?this.indexEndName_:MAX_NAME},QueryParams.prototype.hasLimit=function(){return this.limitSet_},QueryParams.prototype.hasAnchoredLimit=function(){return this.limitSet_&&\"\"!==this.viewFrom_},QueryParams.prototype.getLimit=function(){return util.assert(this.limitSet_,\"Only valid if limit has been set\"),this.limit_},QueryParams.prototype.getIndex=function(){return this.index_},QueryParams.prototype.copy_=function(){var copy=new QueryParams;return copy.limitSet_=this.limitSet_,copy.limit_=this.limit_,copy.startSet_=this.startSet_,copy.indexStartValue_=this.indexStartValue_,copy.startNameSet_=this.startNameSet_,copy.indexStartName_=this.indexStartName_,copy.endSet_=this.endSet_,copy.indexEndValue_=this.indexEndValue_,copy.endNameSet_=this.endNameSet_,copy.indexEndName_=this.indexEndName_,copy.index_=this.index_,copy.viewFrom_=this.viewFrom_,copy},QueryParams.prototype.limit=function(newLimit){var newParams=this.copy_();return newParams.limitSet_=!0,newParams.limit_=newLimit,newParams.viewFrom_=\"\",newParams},QueryParams.prototype.limitToFirst=function(newLimit){var newParams=this.copy_();return newParams.limitSet_=!0,newParams.limit_=newLimit,newParams.viewFrom_=QueryParams.WIRE_PROTOCOL_CONSTANTS_.VIEW_FROM_LEFT,newParams},QueryParams.prototype.limitToLast=function(newLimit){var newParams=this.copy_();return newParams.limitSet_=!0,newParams.limit_=newLimit,newParams.viewFrom_=QueryParams.WIRE_PROTOCOL_CONSTANTS_.VIEW_FROM_RIGHT,newParams},QueryParams.prototype.startAt=function(indexValue,key){var newParams=this.copy_();return newParams.startSet_=!0,void 0===indexValue&&(indexValue=null),newParams.indexStartValue_=indexValue,null!=key?(newParams.startNameSet_=!0,newParams.indexStartName_=key):(newParams.startNameSet_=!1,newParams.indexStartName_=\"\"),newParams},QueryParams.prototype.endAt=function(indexValue,key){var newParams=this.copy_();return newParams.endSet_=!0,void 0===indexValue&&(indexValue=null),newParams.indexEndValue_=indexValue,void 0!==key?(newParams.endNameSet_=!0,newParams.indexEndName_=key):(newParams.endNameSet_=!1,newParams.indexEndName_=\"\"),newParams},QueryParams.prototype.orderBy=function(index){var newParams=this.copy_();return newParams.index_=index,newParams},QueryParams.prototype.getQueryObject=function(){var WIRE_PROTOCOL_CONSTANTS=QueryParams.WIRE_PROTOCOL_CONSTANTS_,obj={};if(this.startSet_&&(obj[WIRE_PROTOCOL_CONSTANTS.INDEX_START_VALUE]=this.indexStartValue_,this.startNameSet_&&(obj[WIRE_PROTOCOL_CONSTANTS.INDEX_START_NAME]=this.indexStartName_)),this.endSet_&&(obj[WIRE_PROTOCOL_CONSTANTS.INDEX_END_VALUE]=this.indexEndValue_,this.endNameSet_&&(obj[WIRE_PROTOCOL_CONSTANTS.INDEX_END_NAME]=this.indexEndName_)),this.limitSet_){obj[WIRE_PROTOCOL_CONSTANTS.LIMIT]=this.limit_;var viewFrom=this.viewFrom_;\"\"===viewFrom&&(viewFrom=this.isViewFromLeft()?WIRE_PROTOCOL_CONSTANTS.VIEW_FROM_LEFT:WIRE_PROTOCOL_CONSTANTS.VIEW_FROM_RIGHT),obj[WIRE_PROTOCOL_CONSTANTS.VIEW_FROM]=viewFrom}return this.index_!==PRIORITY_INDEX&&(obj[WIRE_PROTOCOL_CONSTANTS.INDEX]=this.index_.toString()),obj},QueryParams.prototype.loadsAllData=function(){return!(this.startSet_||this.endSet_||this.limitSet_)},QueryParams.prototype.isDefault=function(){return this.loadsAllData()&&this.index_===PRIORITY_INDEX},QueryParams.prototype.getNodeFilter=function(){return this.loadsAllData()?new IndexedFilter(this.getIndex()):this.hasLimit()?new LimitedFilter(this):new RangedFilter(this)},QueryParams.prototype.toRestQueryStringParameters=function(){var orderBy,REST_CONSTANTS=QueryParams.REST_QUERY_CONSTANTS_,qs={};return this.isDefault()||(this.index_===PRIORITY_INDEX?orderBy=REST_CONSTANTS.PRIORITY_INDEX:this.index_===VALUE_INDEX?orderBy=REST_CONSTANTS.VALUE_INDEX:this.index_===KEY_INDEX?orderBy=REST_CONSTANTS.KEY_INDEX:(util.assert(this.index_ instanceof PathIndex,\"Unrecognized index type!\"),orderBy=this.index_.toString()),qs[REST_CONSTANTS.ORDER_BY]=util.stringify(orderBy),this.startSet_&&(qs[REST_CONSTANTS.START_AT]=util.stringify(this.indexStartValue_),this.startNameSet_&&(qs[REST_CONSTANTS.START_AT]+=\",\"+util.stringify(this.indexStartName_))),this.endSet_&&(qs[REST_CONSTANTS.END_AT]=util.stringify(this.indexEndValue_),this.endNameSet_&&(qs[REST_CONSTANTS.END_AT]+=\",\"+util.stringify(this.indexEndName_))),this.limitSet_&&(this.isViewFromLeft()?qs[REST_CONSTANTS.LIMIT_TO_FIRST]=this.limit_:qs[REST_CONSTANTS.LIMIT_TO_LAST]=this.limit_)),qs},QueryParams.WIRE_PROTOCOL_CONSTANTS_={INDEX_START_VALUE:\"sp\",INDEX_START_NAME:\"sn\",INDEX_END_VALUE:\"ep\",INDEX_END_NAME:\"en\",LIMIT:\"l\",VIEW_FROM:\"vf\",VIEW_FROM_LEFT:\"l\",VIEW_FROM_RIGHT:\"r\",INDEX:\"i\"},QueryParams.REST_QUERY_CONSTANTS_={ORDER_BY:\"orderBy\",PRIORITY_INDEX:\"$priority\",VALUE_INDEX:\"$value\",KEY_INDEX:\"$key\",START_AT:\"startAt\",END_AT:\"endAt\",LIMIT_TO_FIRST:\"limitToFirst\",LIMIT_TO_LAST:\"limitToLast\"},QueryParams.DEFAULT=new QueryParams,QueryParams}(),Reference=function(_super){function Reference(repo,path){if(!(repo instanceof Repo))throw new Error(\"new Reference() no longer supported - use app.database().\");return _super.call(this,repo,path,QueryParams.DEFAULT,!1)||this}return tslib.__extends(Reference,_super),Reference.prototype.getKey=function(){return util.validateArgCount(\"Reference.key\",0,0,arguments.length),this.path.isEmpty()?null:this.path.getBack()},Reference.prototype.child=function(pathString){return util.validateArgCount(\"Reference.child\",1,1,arguments.length),\"number\"==typeof pathString?pathString=String(pathString):pathString instanceof Path||(null===this.path.getFront()?validateRootPathString(\"Reference.child\",1,pathString,!1):validatePathString(\"Reference.child\",1,pathString,!1)),new Reference(this.repo,this.path.child(pathString))},Reference.prototype.getParent=function(){util.validateArgCount(\"Reference.parent\",0,0,arguments.length);var parentPath=this.path.parent();return null===parentPath?null:new Reference(this.repo,parentPath)},Reference.prototype.getRoot=function(){util.validateArgCount(\"Reference.root\",0,0,arguments.length);for(var ref=this;null!==ref.getParent();)ref=ref.getParent();return ref},Reference.prototype.databaseProp=function(){return this.repo.database},Reference.prototype.set=function(newVal,onComplete){util.validateArgCount(\"Reference.set\",1,2,arguments.length),validateWritablePath(\"Reference.set\",this.path),validateFirebaseDataArg(\"Reference.set\",1,newVal,this.path,!1),util.validateCallback(\"Reference.set\",2,onComplete,!0);var deferred=new util.Deferred;return this.repo.setWithPriority(this.path,newVal,null,deferred.wrapCallback(onComplete)),deferred.promise},Reference.prototype.update=function(objectToMerge,onComplete){if(util.validateArgCount(\"Reference.update\",1,2,arguments.length),validateWritablePath(\"Reference.update\",this.path),Array.isArray(objectToMerge)){for(var newObjectToMerge={},i=0;i<objectToMerge.length;++i)newObjectToMerge[\"\"+i]=objectToMerge[i];objectToMerge=newObjectToMerge,warn(\"Passing an Array to Firebase.update() is deprecated. Use set() if you want to overwrite the existing data, or an Object with integer keys if you really do want to only update some of the children.\")}validateFirebaseMergeDataArg(\"Reference.update\",1,objectToMerge,this.path,!1),util.validateCallback(\"Reference.update\",2,onComplete,!0);var deferred=new util.Deferred;return this.repo.update(this.path,objectToMerge,deferred.wrapCallback(onComplete)),deferred.promise},Reference.prototype.setWithPriority=function(newVal,newPriority,onComplete){if(util.validateArgCount(\"Reference.setWithPriority\",2,3,arguments.length),validateWritablePath(\"Reference.setWithPriority\",this.path),validateFirebaseDataArg(\"Reference.setWithPriority\",1,newVal,this.path,!1),validatePriority(\"Reference.setWithPriority\",2,newPriority,!1),util.validateCallback(\"Reference.setWithPriority\",3,onComplete,!0),\".length\"===this.getKey()||\".keys\"===this.getKey())throw\"Reference.setWithPriority failed: \"+this.getKey()+\" is a read-only object.\";var deferred=new util.Deferred;return this.repo.setWithPriority(this.path,newVal,newPriority,deferred.wrapCallback(onComplete)),deferred.promise},Reference.prototype.remove=function(onComplete){return util.validateArgCount(\"Reference.remove\",0,1,arguments.length),validateWritablePath(\"Reference.remove\",this.path),util.validateCallback(\"Reference.remove\",1,onComplete,!0),this.set(null,onComplete)},Reference.prototype.transaction=function(transactionUpdate,onComplete,applyLocally){if(util.validateArgCount(\"Reference.transaction\",1,3,arguments.length),validateWritablePath(\"Reference.transaction\",this.path),util.validateCallback(\"Reference.transaction\",1,transactionUpdate,!1),util.validateCallback(\"Reference.transaction\",2,onComplete,!0),validateBoolean(\"Reference.transaction\",3,applyLocally,!0),\".length\"===this.getKey()||\".keys\"===this.getKey())throw\"Reference.transaction failed: \"+this.getKey()+\" is a read-only object.\";void 0===applyLocally&&(applyLocally=!0);var deferred=new util.Deferred;\"function\"==typeof onComplete&&deferred.promise.catch((function(){}));var promiseComplete=function(error,committed,snapshot){error?deferred.reject(error):deferred.resolve(new TransactionResult(committed,snapshot)),\"function\"==typeof onComplete&&onComplete(error,committed,snapshot)};return this.repo.startTransaction(this.path,transactionUpdate,promiseComplete,applyLocally),deferred.promise},Reference.prototype.setPriority=function(priority,onComplete){util.validateArgCount(\"Reference.setPriority\",1,2,arguments.length),validateWritablePath(\"Reference.setPriority\",this.path),validatePriority(\"Reference.setPriority\",1,priority,!1),util.validateCallback(\"Reference.setPriority\",2,onComplete,!0);var deferred=new util.Deferred;return this.repo.setWithPriority(this.path.child(\".priority\"),priority,null,deferred.wrapCallback(onComplete)),deferred.promise},Reference.prototype.push=function(value,onComplete){util.validateArgCount(\"Reference.push\",0,2,arguments.length),validateWritablePath(\"Reference.push\",this.path),validateFirebaseDataArg(\"Reference.push\",1,value,this.path,!0),util.validateCallback(\"Reference.push\",2,onComplete,!0);var promise,now=this.repo.serverTime(),name=nextPushId(now),thennablePushRef=this.child(name),pushRef=this.child(name);return promise=null!=value?thennablePushRef.set(value,onComplete).then((function(){return pushRef})):Promise.resolve(pushRef),thennablePushRef.then=promise.then.bind(promise),thennablePushRef.catch=promise.then.bind(promise,void 0),\"function\"==typeof onComplete&&promise.catch((function(){})),thennablePushRef},Reference.prototype.onDisconnect=function(){return validateWritablePath(\"Reference.onDisconnect\",this.path),new OnDisconnect(this.repo,this.path)},Object.defineProperty(Reference.prototype,\"database\",{get:function(){return this.databaseProp()},enumerable:!1,configurable:!0}),Object.defineProperty(Reference.prototype,\"key\",{get:function(){return this.getKey()},enumerable:!1,configurable:!0}),Object.defineProperty(Reference.prototype,\"parent\",{get:function(){return this.getParent()},enumerable:!1,configurable:!0}),Object.defineProperty(Reference.prototype,\"root\",{get:function(){return this.getRoot()},enumerable:!1,configurable:!0}),Reference}(Query);Query.__referenceConstructor=Reference,SyncPoint.__referenceConstructor=Reference;var TreeNode=function(){return function(){this.children={},this.childCount=0,this.value=null}}(),Tree=function(){function Tree(name_,parent_,node_){void 0===name_&&(name_=\"\"),void 0===parent_&&(parent_=null),void 0===node_&&(node_=new TreeNode),this.name_=name_,this.parent_=parent_,this.node_=node_}return Tree.prototype.subTree=function(pathObj){for(var path=pathObj instanceof Path?pathObj:new Path(pathObj),child=this,next=path.getFront();null!==next;)child=new Tree(next,child,util.safeGet(child.node_.children,next)||new TreeNode),next=(path=path.popFront()).getFront();return child},Tree.prototype.getValue=function(){return this.node_.value},Tree.prototype.setValue=function(value){util.assert(void 0!==value,\"Cannot set value to undefined\"),this.node_.value=value,this.updateParents_()},Tree.prototype.clear=function(){this.node_.value=null,this.node_.children={},this.node_.childCount=0,this.updateParents_()},Tree.prototype.hasChildren=function(){return this.node_.childCount>0},Tree.prototype.isEmpty=function(){return null===this.getValue()&&!this.hasChildren()},Tree.prototype.forEachChild=function(action){var _this=this;each(this.node_.children,(function(child,childTree){action(new Tree(child,_this,childTree))}))},Tree.prototype.forEachDescendant=function(action,includeSelf,childrenFirst){includeSelf&&!childrenFirst&&action(this),this.forEachChild((function(child){child.forEachDescendant(action,!0,childrenFirst)})),includeSelf&&childrenFirst&&action(this)},Tree.prototype.forEachAncestor=function(action,includeSelf){for(var node=includeSelf?this:this.parent();null!==node;){if(action(node))return!0;node=node.parent()}return!1},Tree.prototype.forEachImmediateDescendantWithValue=function(action){this.forEachChild((function(child){null!==child.getValue()?action(child):child.forEachImmediateDescendantWithValue(action)}))},Tree.prototype.path=function(){return new Path(null===this.parent_?this.name_:this.parent_.path()+\"/\"+this.name_)},Tree.prototype.name=function(){return this.name_},Tree.prototype.parent=function(){return this.parent_},Tree.prototype.updateParents_=function(){null!==this.parent_&&this.parent_.updateChild_(this.name_,this)},Tree.prototype.updateChild_=function(childName,child){var childEmpty=child.isEmpty(),childExists=util.contains(this.node_.children,childName);childEmpty&&childExists?(delete this.node_.children[childName],this.node_.childCount--,this.updateParents_()):childEmpty||childExists||(this.node_.children[childName]=child.node_,this.node_.childCount++,this.updateParents_())},Tree}(),TransactionStatus=function(TransactionStatus){return TransactionStatus[TransactionStatus.RUN=0]=\"RUN\",TransactionStatus[TransactionStatus.SENT=1]=\"SENT\",TransactionStatus[TransactionStatus.COMPLETED=2]=\"COMPLETED\",TransactionStatus[TransactionStatus.SENT_NEEDS_ABORT=3]=\"SENT_NEEDS_ABORT\",TransactionStatus[TransactionStatus.NEEDS_ABORT=4]=\"NEEDS_ABORT\",TransactionStatus}({});Repo.MAX_TRANSACTION_RETRIES_=25,Repo.prototype.transactionsInit_=function(){this.transactionQueueTree_=new Tree},Repo.prototype.startTransaction=function(path,transactionUpdate,onComplete,applyLocally){this.log_(\"transaction on \"+path);var valueCallback=function(){},watchRef=new Reference(this,path);watchRef.on(\"value\",valueCallback);var transaction={path:path,update:transactionUpdate,onComplete:onComplete,status:null,order:LUIDGenerator(),applyLocally:applyLocally,retryCount:0,unwatcher:function(){watchRef.off(\"value\",valueCallback)},abortReason:null,currentWriteId:null,currentInputSnapshot:null,currentOutputSnapshotRaw:null,currentOutputSnapshotResolved:null},currentState=this.getLatestState_(path);transaction.currentInputSnapshot=currentState;var newVal=transaction.update(currentState.val());if(void 0===newVal){if(transaction.unwatcher(),transaction.currentOutputSnapshotRaw=null,transaction.currentOutputSnapshotResolved=null,transaction.onComplete){var snapshot=new DataSnapshot(transaction.currentInputSnapshot,new Reference(this,transaction.path),PRIORITY_INDEX);transaction.onComplete(null,!1,snapshot)}}else{validateFirebaseData(\"transaction failed: Data returned \",newVal,transaction.path),transaction.status=TransactionStatus.RUN;var queueNode=this.transactionQueueTree_.subTree(path),nodeQueue=queueNode.getValue()||[];nodeQueue.push(transaction),queueNode.setValue(nodeQueue);var priorityForNode=void 0;\"object\"==typeof newVal&&null!==newVal&&util.contains(newVal,\".priority\")?(priorityForNode=util.safeGet(newVal,\".priority\"),util.assert(isValidPriority(priorityForNode),\"Invalid priority returned by transaction. Priority must be a valid string, finite number, server value, or null.\")):priorityForNode=(this.serverSyncTree_.calcCompleteEventCache(path)||ChildrenNode.EMPTY_NODE).getPriority().val(),priorityForNode=priorityForNode;var serverValues=this.generateServerValues(),newNodeUnresolved=nodeFromJSON$1(newVal,priorityForNode),newNode=resolveDeferredValueSnapshot(newNodeUnresolved,currentState,serverValues);transaction.currentOutputSnapshotRaw=newNodeUnresolved,transaction.currentOutputSnapshotResolved=newNode,transaction.currentWriteId=this.getNextWriteId_();var events=this.serverSyncTree_.applyUserOverwrite(path,newNode,transaction.currentWriteId,transaction.applyLocally);this.eventQueue_.raiseEventsForChangedPath(path,events),this.sendReadyTransactions_()}},Repo.prototype.getLatestState_=function(path,excludeSets){return this.serverSyncTree_.calcCompleteEventCache(path,excludeSets)||ChildrenNode.EMPTY_NODE},Repo.prototype.sendReadyTransactions_=function(node){var _this=this;if(void 0===node&&(node=this.transactionQueueTree_),node||this.pruneCompletedTransactionsBelowNode_(node),null!==node.getValue()){var queue=this.buildTransactionQueue_(node);util.assert(queue.length>0,\"Sending zero length transaction queue\"),queue.every((function(transaction){return transaction.status===TransactionStatus.RUN}))&&this.sendTransactionQueue_(node.path(),queue)}else node.hasChildren()&&node.forEachChild((function(childNode){_this.sendReadyTransactions_(childNode)}))},Repo.prototype.sendTransactionQueue_=function(path,queue){for(var _this=this,setsToIgnore=queue.map((function(txn){return txn.currentWriteId})),latestState=this.getLatestState_(path,setsToIgnore),snapToSend=latestState,latestHash=latestState.hash(),i=0;i<queue.length;i++){var txn=queue[i];util.assert(txn.status===TransactionStatus.RUN,\"tryToSendTransactionQueue_: items in queue should all be run.\"),txn.status=TransactionStatus.SENT,txn.retryCount++;var relativePath=Path.relativePath(path,txn.path);snapToSend=snapToSend.updateChild(relativePath,txn.currentOutputSnapshotRaw)}var dataToSend=snapToSend.val(!0),pathToSend=path;this.server_.put(pathToSend.toString(),dataToSend,(function(status){_this.log_(\"transaction put response\",{path:pathToSend.toString(),status:status});var events=[];if(\"ok\"===status){for(var callbacks=[],i=0;i<queue.length;i++){if(queue[i].status=TransactionStatus.COMPLETED,events=events.concat(_this.serverSyncTree_.ackUserWrite(queue[i].currentWriteId)),queue[i].onComplete){var node=queue[i].currentOutputSnapshotResolved,ref=new Reference(_this,queue[i].path),snapshot=new DataSnapshot(node,ref,PRIORITY_INDEX);callbacks.push(queue[i].onComplete.bind(null,null,!0,snapshot))}queue[i].unwatcher()}for(_this.pruneCompletedTransactionsBelowNode_(_this.transactionQueueTree_.subTree(path)),_this.sendReadyTransactions_(),_this.eventQueue_.raiseEventsForChangedPath(path,events),i=0;i<callbacks.length;i++)exceptionGuard(callbacks[i])}else{if(\"datastale\"===status)for(i=0;i<queue.length;i++)queue[i].status=queue[i].status===TransactionStatus.SENT_NEEDS_ABORT?TransactionStatus.NEEDS_ABORT:TransactionStatus.RUN;else for(warn(\"transaction at \"+pathToSend.toString()+\" failed: \"+status),i=0;i<queue.length;i++)queue[i].status=TransactionStatus.NEEDS_ABORT,queue[i].abortReason=status;_this.rerunTransactions_(path)}}),latestHash)},Repo.prototype.rerunTransactions_=function(changedPath){var rootMostTransactionNode=this.getAncestorTransactionNode_(changedPath),path=rootMostTransactionNode.path(),queue=this.buildTransactionQueue_(rootMostTransactionNode);return this.rerunTransactionQueue_(queue,path),path},Repo.prototype.rerunTransactionQueue_=function(queue,path){if(0!==queue.length){for(var callbacks=[],events=[],setsToIgnore=queue.filter((function(q){return q.status===TransactionStatus.RUN})).map((function(q){return q.currentWriteId})),i=0;i<queue.length;i++){var transaction=queue[i],relativePath=Path.relativePath(path,transaction.path),abortTransaction=!1,abortReason=void 0;if(util.assert(null!==relativePath,\"rerunTransactionsUnderNode_: relativePath should not be null.\"),transaction.status===TransactionStatus.NEEDS_ABORT)abortTransaction=!0,abortReason=transaction.abortReason,events=events.concat(this.serverSyncTree_.ackUserWrite(transaction.currentWriteId,!0));else if(transaction.status===TransactionStatus.RUN)if(transaction.retryCount>=Repo.MAX_TRANSACTION_RETRIES_)abortTransaction=!0,abortReason=\"maxretry\",events=events.concat(this.serverSyncTree_.ackUserWrite(transaction.currentWriteId,!0));else{var currentNode=this.getLatestState_(transaction.path,setsToIgnore);transaction.currentInputSnapshot=currentNode;var newData=queue[i].update(currentNode.val());if(void 0!==newData){validateFirebaseData(\"transaction failed: Data returned \",newData,transaction.path);var newDataNode=nodeFromJSON$1(newData);\"object\"==typeof newData&&null!=newData&&util.contains(newData,\".priority\")||(newDataNode=newDataNode.updatePriority(currentNode.getPriority()));var oldWriteId=transaction.currentWriteId,serverValues=this.generateServerValues(),newNodeResolved=resolveDeferredValueSnapshot(newDataNode,currentNode,serverValues);transaction.currentOutputSnapshotRaw=newDataNode,transaction.currentOutputSnapshotResolved=newNodeResolved,transaction.currentWriteId=this.getNextWriteId_(),setsToIgnore.splice(setsToIgnore.indexOf(oldWriteId),1),events=(events=events.concat(this.serverSyncTree_.applyUserOverwrite(transaction.path,newNodeResolved,transaction.currentWriteId,transaction.applyLocally))).concat(this.serverSyncTree_.ackUserWrite(oldWriteId,!0))}else abortTransaction=!0,abortReason=\"nodata\",events=events.concat(this.serverSyncTree_.ackUserWrite(transaction.currentWriteId,!0))}if(this.eventQueue_.raiseEventsForChangedPath(path,events),events=[],abortTransaction&&(queue[i].status=TransactionStatus.COMPLETED,setTimeout(queue[i].unwatcher,Math.floor(0)),queue[i].onComplete))if(\"nodata\"===abortReason){var ref=new Reference(this,queue[i].path),snapshot=new DataSnapshot(queue[i].currentInputSnapshot,ref,PRIORITY_INDEX);callbacks.push(queue[i].onComplete.bind(null,null,!1,snapshot))}else callbacks.push(queue[i].onComplete.bind(null,new Error(abortReason),!1,null))}for(this.pruneCompletedTransactionsBelowNode_(this.transactionQueueTree_),i=0;i<callbacks.length;i++)exceptionGuard(callbacks[i]);this.sendReadyTransactions_()}},Repo.prototype.getAncestorTransactionNode_=function(path){var front,transactionNode=this.transactionQueueTree_;for(front=path.getFront();null!==front&&null===transactionNode.getValue();)transactionNode=transactionNode.subTree(front),front=(path=path.popFront()).getFront();return transactionNode},Repo.prototype.buildTransactionQueue_=function(transactionNode){var transactionQueue=[];return this.aggregateTransactionQueuesForNode_(transactionNode,transactionQueue),transactionQueue.sort((function(a,b){return a.order-b.order})),transactionQueue},Repo.prototype.aggregateTransactionQueuesForNode_=function(node,queue){var _this=this,nodeQueue=node.getValue();if(null!==nodeQueue)for(var i=0;i<nodeQueue.length;i++)queue.push(nodeQueue[i]);node.forEachChild((function(child){_this.aggregateTransactionQueuesForNode_(child,queue)}))},Repo.prototype.pruneCompletedTransactionsBelowNode_=function(node){var _this=this,queue=node.getValue();if(queue){for(var to=0,from=0;from<queue.length;from++)queue[from].status!==TransactionStatus.COMPLETED&&(queue[to]=queue[from],to++);queue.length=to,node.setValue(queue.length>0?queue:null)}node.forEachChild((function(childNode){_this.pruneCompletedTransactionsBelowNode_(childNode)}))},Repo.prototype.abortTransactions_=function(path){var _this=this,affectedPath=this.getAncestorTransactionNode_(path).path(),transactionNode=this.transactionQueueTree_.subTree(path);return transactionNode.forEachAncestor((function(node){_this.abortTransactionsOnNode_(node)})),this.abortTransactionsOnNode_(transactionNode),transactionNode.forEachDescendant((function(node){_this.abortTransactionsOnNode_(node)})),affectedPath},Repo.prototype.abortTransactionsOnNode_=function(node){var queue=node.getValue();if(null!==queue){for(var callbacks=[],events=[],lastSent=-1,i=0;i<queue.length;i++)queue[i].status===TransactionStatus.SENT_NEEDS_ABORT||(queue[i].status===TransactionStatus.SENT?(util.assert(lastSent===i-1,\"All SENT items should be at beginning of queue.\"),lastSent=i,queue[i].status=TransactionStatus.SENT_NEEDS_ABORT,queue[i].abortReason=\"set\"):(util.assert(queue[i].status===TransactionStatus.RUN,\"Unexpected transaction status in abort\"),queue[i].unwatcher(),events=events.concat(this.serverSyncTree_.ackUserWrite(queue[i].currentWriteId,!0)),queue[i].onComplete&&callbacks.push(queue[i].onComplete.bind(null,new Error(\"set\"),!1,null))));for(-1===lastSent?node.setValue(null):queue.length=lastSent+1,this.eventQueue_.raiseEventsForChangedPath(node.path(),events),i=0;i<callbacks.length;i++)exceptionGuard(callbacks[i])}};var _staticInstance,FirebaseAuthTokenProvider=function(){function FirebaseAuthTokenProvider(app_,authProvider_){var _this=this;this.app_=app_,this.authProvider_=authProvider_,this.auth_=null,this.auth_=authProvider_.getImmediate({optional:!0}),this.auth_||authProvider_.get().then((function(auth){return _this.auth_=auth}))}return FirebaseAuthTokenProvider.prototype.getToken=function(forceRefresh){return this.auth_?this.auth_.getToken(forceRefresh).catch((function(error){return error&&\"auth/token-not-initialized\"===error.code?(log(\"Got auth/token-not-initialized error.  Treating as null token.\"),null):Promise.reject(error)})):Promise.resolve(null)},FirebaseAuthTokenProvider.prototype.addTokenChangeListener=function(listener){this.auth_?this.auth_.addAuthTokenListener(listener):(setTimeout((function(){return listener(null)}),0),this.authProvider_.get().then((function(auth){return auth.addAuthTokenListener(listener)})))},FirebaseAuthTokenProvider.prototype.removeTokenChangeListener=function(listener){this.authProvider_.get().then((function(auth){return auth.removeAuthTokenListener(listener)}))},FirebaseAuthTokenProvider.prototype.notifyForInvalidToken=function(){var errorMessage='Provided authentication credentials for the app named \"'+this.app_.name+'\" are invalid. This usually indicates your app was not initialized correctly. ';warn(errorMessage+=\"credential\"in this.app_.options?'Make sure the \"credential\" property provided to initializeApp() is authorized to access the specified \"databaseURL\" and is from the correct project.':\"serviceAccount\"in this.app_.options?'Make sure the \"serviceAccount\" property provided to initializeApp() is authorized to access the specified \"databaseURL\" and is from the correct project.':'Make sure the \"apiKey\" and \"databaseURL\" properties provided to initializeApp() match the values provided for your app at https://console.firebase.google.com/.')},FirebaseAuthTokenProvider}(),EmulatorAdminTokenProvider=function(){function EmulatorAdminTokenProvider(){}return EmulatorAdminTokenProvider.prototype.getToken=function(forceRefresh){return Promise.resolve({accessToken:EmulatorAdminTokenProvider.EMULATOR_AUTH_TOKEN})},EmulatorAdminTokenProvider.prototype.addTokenChangeListener=function(listener){listener(EmulatorAdminTokenProvider.EMULATOR_AUTH_TOKEN)},EmulatorAdminTokenProvider.prototype.removeTokenChangeListener=function(listener){},EmulatorAdminTokenProvider.prototype.notifyForInvalidToken=function(){},EmulatorAdminTokenProvider.EMULATOR_AUTH_TOKEN=\"owner\",EmulatorAdminTokenProvider}(),RepoManager=function(){function RepoManager(){this.repos_={},this.useRestClient_=!1}return RepoManager.getInstance=function(){return _staticInstance||(_staticInstance=new RepoManager),_staticInstance},RepoManager.prototype.interrupt=function(){var e_1,_a,e_2,_b;try{for(var _c=tslib.__values(Object.keys(this.repos_)),_d=_c.next();!_d.done;_d=_c.next()){var appName=_d.value;try{for(var _e=(e_2=void 0,tslib.__values(Object.keys(this.repos_[appName]))),_f=_e.next();!_f.done;_f=_e.next())this.repos_[appName][_f.value].interrupt()}catch(e_2_1){e_2={error:e_2_1}}finally{try{_f&&!_f.done&&(_b=_e.return)&&_b.call(_e)}finally{if(e_2)throw e_2.error}}}}catch(e_1_1){e_1={error:e_1_1}}finally{try{_d&&!_d.done&&(_a=_c.return)&&_a.call(_c)}finally{if(e_1)throw e_1.error}}},RepoManager.prototype.resume=function(){var e_3,_a,e_4,_b;try{for(var _c=tslib.__values(Object.keys(this.repos_)),_d=_c.next();!_d.done;_d=_c.next()){var appName=_d.value;try{for(var _e=(e_4=void 0,tslib.__values(Object.keys(this.repos_[appName]))),_f=_e.next();!_f.done;_f=_e.next())this.repos_[appName][_f.value].resume()}catch(e_4_1){e_4={error:e_4_1}}finally{try{_f&&!_f.done&&(_b=_e.return)&&_b.call(_e)}finally{if(e_4)throw e_4.error}}}}catch(e_3_1){e_3={error:e_3_1}}finally{try{_d&&!_d.done&&(_a=_c.return)&&_a.call(_c)}finally{if(e_3)throw e_3.error}}},RepoManager.prototype.databaseFromApp=function(app,authProvider,url,nodeAdmin){var dbUrl=url||app.options.databaseURL;void 0===dbUrl&&(app.options.projectId||fatal(\"Can't determine Firebase Database URL. Be sure to include  a Project ID when calling firebase.initializeApp().\"),log(\"Using default host for project \",app.options.projectId),dbUrl=app.options.projectId+\"-default-rtdb.firebaseio.com\");var isEmulator,parsedUrl=parseRepoInfo(dbUrl,nodeAdmin),repoInfo=parsedUrl.repoInfo,dbEmulatorHost=void 0;\"undefined\"!=typeof process&&(dbEmulatorHost=process.env.FIREBASE_DATABASE_EMULATOR_HOST),dbEmulatorHost?(isEmulator=!0,repoInfo=(parsedUrl=parseRepoInfo(dbUrl=\"http://\"+dbEmulatorHost+\"?ns=\"+repoInfo.namespace,nodeAdmin)).repoInfo):isEmulator=!parsedUrl.repoInfo.secure;var authTokenProvider=nodeAdmin&&isEmulator?new EmulatorAdminTokenProvider:new FirebaseAuthTokenProvider(app,authProvider);return validateUrl(\"Invalid Firebase Database URL\",1,parsedUrl),parsedUrl.path.isEmpty()||fatal(\"Database URL must point to the root of a Firebase Database (not including a child path).\"),this.createRepo(repoInfo,app,authTokenProvider).database},RepoManager.prototype.deleteRepo=function(repo){var appRepos=util.safeGet(this.repos_,repo.app.name);appRepos&&util.safeGet(appRepos,repo.repoInfo_.toURLString())===repo||fatal(\"Database \"+repo.app.name+\"(\"+repo.repoInfo_+\") has already been deleted.\"),repo.interrupt(),delete appRepos[repo.repoInfo_.toURLString()]},RepoManager.prototype.createRepo=function(repoInfo,app,authTokenProvider){var appRepos=util.safeGet(this.repos_,app.name);appRepos||(this.repos_[app.name]=appRepos={});var repo=util.safeGet(appRepos,repoInfo.toURLString());return repo&&fatal(\"Database initialized multiple times. Please make sure the format of the database URL matches with each database() call.\"),repo=new Repo(repoInfo,this.useRestClient_,app,authTokenProvider),appRepos[repoInfo.toURLString()]=repo,repo},RepoManager.prototype.forceRestClient=function(forceRestClient){this.useRestClient_=forceRestClient},RepoManager}(),Database=function(){function Database(repo_){this.repo_=repo_,repo_ instanceof Repo||fatal(\"Don't call new Database() directly - please use firebase.database().\"),this.root_=new Reference(repo_,Path.Empty),this.INTERNAL=new DatabaseInternals(this)}return Object.defineProperty(Database.prototype,\"app\",{get:function(){return this.repo_.app},enumerable:!1,configurable:!0}),Database.prototype.ref=function(path){return this.checkDeleted_(\"ref\"),util.validateArgCount(\"database.ref\",0,1,arguments.length),path instanceof Reference?this.refFromURL(path.toString()):void 0!==path?this.root_.child(path):this.root_},Database.prototype.refFromURL=function(url){var apiName=\"database.refFromURL\";this.checkDeleted_(apiName),util.validateArgCount(apiName,1,1,arguments.length);var parsedURL=parseRepoInfo(url,this.repo_.repoInfo_.nodeAdmin);validateUrl(apiName,1,parsedURL);var repoInfo=parsedURL.repoInfo;return repoInfo.host!==this.repo_.repoInfo_.host&&fatal(apiName+\": Host name does not match the current database: (found \"+repoInfo.host+\" but expected \"+this.repo_.repoInfo_.host+\")\"),this.ref(parsedURL.path.toString())},Database.prototype.checkDeleted_=function(apiName){null===this.repo_&&fatal(\"Cannot call \"+apiName+\" on a deleted database.\")},Database.prototype.goOffline=function(){util.validateArgCount(\"database.goOffline\",0,0,arguments.length),this.checkDeleted_(\"goOffline\"),this.repo_.interrupt()},Database.prototype.goOnline=function(){util.validateArgCount(\"database.goOnline\",0,0,arguments.length),this.checkDeleted_(\"goOnline\"),this.repo_.resume()},Database.ServerValue={TIMESTAMP:{\".sv\":\"timestamp\"},increment:function(delta){return{\".sv\":{increment:delta}}}},Database}(),DatabaseInternals=function(){function DatabaseInternals(database){this.database=database}return DatabaseInternals.prototype.delete=function(){return tslib.__awaiter(this,void 0,void 0,(function(){return tslib.__generator(this,(function(_a){return this.database.checkDeleted_(\"delete\"),RepoManager.getInstance().deleteRepo(this.database.repo_),this.database.repo_=null,this.database.root_=null,this.database.INTERNAL=null,this.database=null,[2]}))}))},DatabaseInternals}(),INTERNAL=Object.freeze({__proto__:null,forceLongPolling:function(){WebSocketConnection.forceDisallow(),BrowserPollConnection.forceAllow()},forceWebSockets:function(){BrowserPollConnection.forceDisallow()},isWebSocketsAvailable:function(){return WebSocketConnection.isAvailable()},setSecurityDebugCallback:function(ref,callback){ref.repo.persistentConnection_.securityDebugCallback_=callback},stats:function(ref,showDelta){ref.repo.stats(showDelta)},statsIncrementCounter:function(ref,metric){ref.repo.statsIncrementCounter(metric)},dataUpdateCount:function(ref){return ref.repo.dataUpdateCount},interceptServerData:function(ref,callback){return ref.repo.interceptServerData_(callback)}}),DataConnection=PersistentConnection;PersistentConnection.prototype.simpleListen=function(pathString,onComplete){this.sendRequest(\"q\",{p:pathString},onComplete)},PersistentConnection.prototype.echo=function(data,onEcho){this.sendRequest(\"echo\",{d:data},onEcho)};var TEST_ACCESS=Object.freeze({__proto__:null,DataConnection:DataConnection,RealTimeConnection:Connection,hijackHash:function(newHash){var oldPut=PersistentConnection.prototype.put;return PersistentConnection.prototype.put=function(pathString,data,onComplete,hash){void 0!==hash&&(hash=newHash()),oldPut.call(this,pathString,data,onComplete,hash)},function(){PersistentConnection.prototype.put=oldPut}},ConnectionTarget:RepoInfo,queryIdentifier:function(query){return query.queryIdentifier()},forceRestClient:function(forceRestClient){RepoManager.getInstance().forceRestClient(forceRestClient)}}),ServerValue=Database.ServerValue;function registerDatabase(instance){SDK_VERSION=instance.SDK_VERSION;var namespace=instance.INTERNAL.registerComponent(new component.Component(\"database\",(function(container,url){var app=container.getProvider(\"app\").getImmediate(),authProvider=container.getProvider(\"auth-internal\");return RepoManager.getInstance().databaseFromApp(app,authProvider,url)}),\"PUBLIC\").setServiceProps({Reference:Reference,Query:Query,Database:Database,DataSnapshot:DataSnapshot,enableLogging:enableLogging,INTERNAL:INTERNAL,ServerValue:ServerValue,TEST_ACCESS:TEST_ACCESS}).setMultipleInstances(!0));instance.registerVersion(\"@firebase/database\",\"0.6.13\"),util.isNodeSdk()&&(module.exports=namespace)}registerDatabase(firebase__default.default),exports.DataSnapshot=DataSnapshot,exports.Database=Database,exports.OnDisconnect=OnDisconnect,exports.Query=Query,exports.Reference=Reference,exports.ServerValue=ServerValue,exports.enableLogging=enableLogging,exports.registerDatabase=registerDatabase},\"S+S0\":function(module,exports,__webpack_require__){\"use strict\";Object.defineProperty(exports,\"__esModule\",{value:!0});var tslib=__webpack_require__(\"mrSG\"),util=__webpack_require__(\"zVF4\"),Component=function(){function Component(name,instanceFactory,type){this.name=name,this.instanceFactory=instanceFactory,this.type=type,this.multipleInstances=!1,this.serviceProps={},this.instantiationMode=\"LAZY\"}return Component.prototype.setInstantiationMode=function(mode){return this.instantiationMode=mode,this},Component.prototype.setMultipleInstances=function(multipleInstances){return this.multipleInstances=multipleInstances,this},Component.prototype.setServiceProps=function(props){return this.serviceProps=props,this},Component}(),Provider=function(){function Provider(name,container){this.name=name,this.container=container,this.component=null,this.instances=new Map,this.instancesDeferred=new Map}return Provider.prototype.get=function(identifier){void 0===identifier&&(identifier=\"[DEFAULT]\");var normalizedIdentifier=this.normalizeInstanceIdentifier(identifier);if(!this.instancesDeferred.has(normalizedIdentifier)){var deferred=new util.Deferred;this.instancesDeferred.set(normalizedIdentifier,deferred);try{var instance=this.getOrInitializeService(normalizedIdentifier);instance&&deferred.resolve(instance)}catch(e){}}return this.instancesDeferred.get(normalizedIdentifier).promise},Provider.prototype.getImmediate=function(options){var _a=tslib.__assign({identifier:\"[DEFAULT]\",optional:!1},options),optional=_a.optional,normalizedIdentifier=this.normalizeInstanceIdentifier(_a.identifier);try{var instance=this.getOrInitializeService(normalizedIdentifier);if(!instance){if(optional)return null;throw Error(\"Service \"+this.name+\" is not available\")}return instance}catch(e){if(optional)return null;throw e}},Provider.prototype.getComponent=function(){return this.component},Provider.prototype.setComponent=function(component){var e_1,_a;if(component.name!==this.name)throw Error(\"Mismatching Component \"+component.name+\" for Provider \"+this.name+\".\");if(this.component)throw Error(\"Component for \"+this.name+\" has already been provided\");if(this.component=component,function(component){return\"EAGER\"===component.instantiationMode}(component))try{this.getOrInitializeService(\"[DEFAULT]\")}catch(e){}try{for(var _b=tslib.__values(this.instancesDeferred.entries()),_c=_b.next();!_c.done;_c=_b.next()){var _d=tslib.__read(_c.value,2),instanceDeferred=_d[1],normalizedIdentifier=this.normalizeInstanceIdentifier(_d[0]);try{var instance=this.getOrInitializeService(normalizedIdentifier);instanceDeferred.resolve(instance)}catch(e){}}}catch(e_1_1){e_1={error:e_1_1}}finally{try{_c&&!_c.done&&(_a=_b.return)&&_a.call(_b)}finally{if(e_1)throw e_1.error}}},Provider.prototype.clearInstance=function(identifier){void 0===identifier&&(identifier=\"[DEFAULT]\"),this.instancesDeferred.delete(identifier),this.instances.delete(identifier)},Provider.prototype.delete=function(){return tslib.__awaiter(this,void 0,void 0,(function(){var services;return tslib.__generator(this,(function(_a){switch(_a.label){case 0:return services=Array.from(this.instances.values()),[4,Promise.all(tslib.__spread(services.filter((function(service){return\"INTERNAL\"in service})).map((function(service){return service.INTERNAL.delete()})),services.filter((function(service){return\"_delete\"in service})).map((function(service){return service._delete()}))))];case 1:return _a.sent(),[2]}}))}))},Provider.prototype.isComponentSet=function(){return null!=this.component},Provider.prototype.getOrInitializeService=function(identifier){var instance=this.instances.get(identifier);return!instance&&this.component&&(instance=this.component.instanceFactory(this.container,function(identifier){return\"[DEFAULT]\"===identifier?void 0:identifier}(identifier)),this.instances.set(identifier,instance)),instance||null},Provider.prototype.normalizeInstanceIdentifier=function(identifier){return this.component?this.component.multipleInstances?identifier:\"[DEFAULT]\":identifier},Provider}(),ComponentContainer=function(){function ComponentContainer(name){this.name=name,this.providers=new Map}return ComponentContainer.prototype.addComponent=function(component){var provider=this.getProvider(component.name);if(provider.isComponentSet())throw new Error(\"Component \"+component.name+\" has already been registered with \"+this.name);provider.setComponent(component)},ComponentContainer.prototype.addOrOverwriteComponent=function(component){this.getProvider(component.name).isComponentSet()&&this.providers.delete(component.name),this.addComponent(component)},ComponentContainer.prototype.getProvider=function(name){if(this.providers.has(name))return this.providers.get(name);var provider=new Provider(name,this);return this.providers.set(name,provider),provider},ComponentContainer.prototype.getProviders=function(){return Array.from(this.providers.values())},ComponentContainer}();exports.Component=Component,exports.ComponentContainer=ComponentContainer,exports.Provider=Provider},Wcq6:function(module,exports,__webpack_require__){\"use strict\";function _interopDefaultLegacy(e){return e&&\"object\"==typeof e&&\"default\"in e?e:{default:e}}var firebase__default=_interopDefaultLegacy(__webpack_require__(\"wj3C\"));firebase__default.default.registerVersion(\"firebase\",\"7.21.1\",\"app\"),module.exports=firebase__default.default},mrSG:function(module,__webpack_exports__,__webpack_require__){\"use strict\";__webpack_require__.r(__webpack_exports__),__webpack_require__.d(__webpack_exports__,\"__extends\",(function(){return __extends})),__webpack_require__.d(__webpack_exports__,\"__assign\",(function(){return __assign})),__webpack_require__.d(__webpack_exports__,\"__rest\",(function(){return __rest})),__webpack_require__.d(__webpack_exports__,\"__decorate\",(function(){return __decorate})),__webpack_require__.d(__webpack_exports__,\"__param\",(function(){return __param})),__webpack_require__.d(__webpack_exports__,\"__metadata\",(function(){return __metadata})),__webpack_require__.d(__webpack_exports__,\"__awaiter\",(function(){return __awaiter})),__webpack_require__.d(__webpack_exports__,\"__generator\",(function(){return __generator})),__webpack_require__.d(__webpack_exports__,\"__createBinding\",(function(){return __createBinding})),__webpack_require__.d(__webpack_exports__,\"__exportStar\",(function(){return __exportStar})),__webpack_require__.d(__webpack_exports__,\"__values\",(function(){return __values})),__webpack_require__.d(__webpack_exports__,\"__read\",(function(){return __read})),__webpack_require__.d(__webpack_exports__,\"__spread\",(function(){return __spread})),__webpack_require__.d(__webpack_exports__,\"__spreadArrays\",(function(){return __spreadArrays})),__webpack_require__.d(__webpack_exports__,\"__await\",(function(){return __await})),__webpack_require__.d(__webpack_exports__,\"__asyncGenerator\",(function(){return __asyncGenerator})),__webpack_require__.d(__webpack_exports__,\"__asyncDelegator\",(function(){return __asyncDelegator})),__webpack_require__.d(__webpack_exports__,\"__asyncValues\",(function(){return __asyncValues})),__webpack_require__.d(__webpack_exports__,\"__makeTemplateObject\",(function(){return __makeTemplateObject})),__webpack_require__.d(__webpack_exports__,\"__importStar\",(function(){return __importStar})),__webpack_require__.d(__webpack_exports__,\"__importDefault\",(function(){return __importDefault})),__webpack_require__.d(__webpack_exports__,\"__classPrivateFieldGet\",(function(){return __classPrivateFieldGet})),__webpack_require__.d(__webpack_exports__,\"__classPrivateFieldSet\",(function(){return __classPrivateFieldSet}));var extendStatics=function(d,b){return(extendStatics=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(d,b){d.__proto__=b}||function(d,b){for(var p in b)b.hasOwnProperty(p)&&(d[p]=b[p])})(d,b)};function __extends(d,b){function __(){this.constructor=d}extendStatics(d,b),d.prototype=null===b?Object.create(b):(__.prototype=b.prototype,new __)}var __assign=function(){return(__assign=Object.assign||function(t){for(var s,i=1,n=arguments.length;i<n;i++)for(var p in s=arguments[i])Object.prototype.hasOwnProperty.call(s,p)&&(t[p]=s[p]);return t}).apply(this,arguments)};function __rest(s,e){var t={};for(var p in s)Object.prototype.hasOwnProperty.call(s,p)&&e.indexOf(p)<0&&(t[p]=s[p]);if(null!=s&&\"function\"==typeof Object.getOwnPropertySymbols){var i=0;for(p=Object.getOwnPropertySymbols(s);i<p.length;i++)e.indexOf(p[i])<0&&Object.prototype.propertyIsEnumerable.call(s,p[i])&&(t[p[i]]=s[p[i]])}return t}function __decorate(decorators,target,key,desc){var d,c=arguments.length,r=c<3?target:null===desc?desc=Object.getOwnPropertyDescriptor(target,key):desc;if(\"object\"==typeof Reflect&&\"function\"==typeof Reflect.decorate)r=Reflect.decorate(decorators,target,key,desc);else for(var i=decorators.length-1;i>=0;i--)(d=decorators[i])&&(r=(c<3?d(r):c>3?d(target,key,r):d(target,key))||r);return c>3&&r&&Object.defineProperty(target,key,r),r}function __param(paramIndex,decorator){return function(target,key){decorator(target,key,paramIndex)}}function __metadata(metadataKey,metadataValue){if(\"object\"==typeof Reflect&&\"function\"==typeof Reflect.metadata)return Reflect.metadata(metadataKey,metadataValue)}function __awaiter(thisArg,_arguments,P,generator){return new(P||(P=Promise))((function(resolve,reject){function fulfilled(value){try{step(generator.next(value))}catch(e){reject(e)}}function rejected(value){try{step(generator.throw(value))}catch(e){reject(e)}}function step(result){var value;result.done?resolve(result.value):(value=result.value,value instanceof P?value:new P((function(resolve){resolve(value)}))).then(fulfilled,rejected)}step((generator=generator.apply(thisArg,_arguments||[])).next())}))}function __generator(thisArg,body){var f,y,t,g,_={label:0,sent:function(){if(1&t[0])throw t[1];return t[1]},trys:[],ops:[]};return g={next:verb(0),throw:verb(1),return:verb(2)},\"function\"==typeof Symbol&&(g[Symbol.iterator]=function(){return this}),g;function verb(n){return function(v){return function(op){if(f)throw new TypeError(\"Generator is already executing.\");for(;_;)try{if(f=1,y&&(t=2&op[0]?y.return:op[0]?y.throw||((t=y.return)&&t.call(y),0):y.next)&&!(t=t.call(y,op[1])).done)return t;switch(y=0,t&&(op=[2&op[0],t.value]),op[0]){case 0:case 1:t=op;break;case 4:return _.label++,{value:op[1],done:!1};case 5:_.label++,y=op[1],op=[0];continue;case 7:op=_.ops.pop(),_.trys.pop();continue;default:if(!((t=(t=_.trys).length>0&&t[t.length-1])||6!==op[0]&&2!==op[0])){_=0;continue}if(3===op[0]&&(!t||op[1]>t[0]&&op[1]<t[3])){_.label=op[1];break}if(6===op[0]&&_.label<t[1]){_.label=t[1],t=op;break}if(t&&_.label<t[2]){_.label=t[2],_.ops.push(op);break}t[2]&&_.ops.pop(),_.trys.pop();continue}op=body.call(thisArg,_)}catch(e){op=[6,e],y=0}finally{f=t=0}if(5&op[0])throw op[1];return{value:op[0]?op[1]:void 0,done:!0}}([n,v])}}}function __createBinding(o,m,k,k2){void 0===k2&&(k2=k),o[k2]=m[k]}function __exportStar(m,exports){for(var p in m)\"default\"===p||exports.hasOwnProperty(p)||(exports[p]=m[p])}function __values(o){var s=\"function\"==typeof Symbol&&Symbol.iterator,m=s&&o[s],i=0;if(m)return m.call(o);if(o&&\"number\"==typeof o.length)return{next:function(){return o&&i>=o.length&&(o=void 0),{value:o&&o[i++],done:!o}}};throw new TypeError(s?\"Object is not iterable.\":\"Symbol.iterator is not defined.\")}function __read(o,n){var m=\"function\"==typeof Symbol&&o[Symbol.iterator];if(!m)return o;var r,e,i=m.call(o),ar=[];try{for(;(void 0===n||n-- >0)&&!(r=i.next()).done;)ar.push(r.value)}catch(error){e={error:error}}finally{try{r&&!r.done&&(m=i.return)&&m.call(i)}finally{if(e)throw e.error}}return ar}function __spread(){for(var ar=[],i=0;i<arguments.length;i++)ar=ar.concat(__read(arguments[i]));return ar}function __spreadArrays(){for(var s=0,i=0,il=arguments.length;i<il;i++)s+=arguments[i].length;var r=Array(s),k=0;for(i=0;i<il;i++)for(var a=arguments[i],j=0,jl=a.length;j<jl;j++,k++)r[k]=a[j];return r}function __await(v){return this instanceof __await?(this.v=v,this):new __await(v)}function __asyncGenerator(thisArg,_arguments,generator){if(!Symbol.asyncIterator)throw new TypeError(\"Symbol.asyncIterator is not defined.\");var i,g=generator.apply(thisArg,_arguments||[]),q=[];return i={},verb(\"next\"),verb(\"throw\"),verb(\"return\"),i[Symbol.asyncIterator]=function(){return this},i;function verb(n){g[n]&&(i[n]=function(v){return new Promise((function(a,b){q.push([n,v,a,b])>1||resume(n,v)}))})}function resume(n,v){try{(r=g[n](v)).value instanceof __await?Promise.resolve(r.value.v).then(fulfill,reject):settle(q[0][2],r)}catch(e){settle(q[0][3],e)}var r}function fulfill(value){resume(\"next\",value)}function reject(value){resume(\"throw\",value)}function settle(f,v){f(v),q.shift(),q.length&&resume(q[0][0],q[0][1])}}function __asyncDelegator(o){var i,p;return i={},verb(\"next\"),verb(\"throw\",(function(e){throw e})),verb(\"return\"),i[Symbol.iterator]=function(){return this},i;function verb(n,f){i[n]=o[n]?function(v){return(p=!p)?{value:__await(o[n](v)),done:\"return\"===n}:f?f(v):v}:f}}function __asyncValues(o){if(!Symbol.asyncIterator)throw new TypeError(\"Symbol.asyncIterator is not defined.\");var i,m=o[Symbol.asyncIterator];return m?m.call(o):(o=__values(o),i={},verb(\"next\"),verb(\"throw\"),verb(\"return\"),i[Symbol.asyncIterator]=function(){return this},i);function verb(n){i[n]=o[n]&&function(v){return new Promise((function(resolve,reject){!function(resolve,reject,d,v){Promise.resolve(v).then((function(v){resolve({value:v,done:d})}),reject)}(resolve,reject,(v=o[n](v)).done,v.value)}))}}}function __makeTemplateObject(cooked,raw){return Object.defineProperty?Object.defineProperty(cooked,\"raw\",{value:raw}):cooked.raw=raw,cooked}function __importStar(mod){if(mod&&mod.__esModule)return mod;var result={};if(null!=mod)for(var k in mod)Object.hasOwnProperty.call(mod,k)&&(result[k]=mod[k]);return result.default=mod,result}function __importDefault(mod){return mod&&mod.__esModule?mod:{default:mod}}function __classPrivateFieldGet(receiver,privateMap){if(!privateMap.has(receiver))throw new TypeError(\"attempted to get private field on non-instance\");return privateMap.get(receiver)}function __classPrivateFieldSet(receiver,privateMap,value){if(!privateMap.has(receiver))throw new TypeError(\"attempted to set private field on non-instance\");return privateMap.set(receiver,value),value}},\"q/0M\":function(module,__webpack_exports__,__webpack_require__){\"use strict\";function __spreadArrays(){for(var s=0,i=0,il=arguments.length;i<il;i++)s+=arguments[i].length;var r=Array(s),k=0;for(i=0;i<il;i++)for(var a=arguments[i],j=0,jl=a.length;j<jl;j++,k++)r[k]=a[j];return r}var _a;__webpack_require__.r(__webpack_exports__),__webpack_require__.d(__webpack_exports__,\"LogLevel\",(function(){return LogLevel})),__webpack_require__.d(__webpack_exports__,\"Logger\",(function(){return Logger})),__webpack_require__.d(__webpack_exports__,\"setLogLevel\",(function(){return setLogLevel})),__webpack_require__.d(__webpack_exports__,\"setUserLogHandler\",(function(){return setUserLogHandler}));var instances=[],LogLevel=function(LogLevel){return LogLevel[LogLevel.DEBUG=0]=\"DEBUG\",LogLevel[LogLevel.VERBOSE=1]=\"VERBOSE\",LogLevel[LogLevel.INFO=2]=\"INFO\",LogLevel[LogLevel.WARN=3]=\"WARN\",LogLevel[LogLevel.ERROR=4]=\"ERROR\",LogLevel[LogLevel.SILENT=5]=\"SILENT\",LogLevel}({}),levelStringToEnum={debug:LogLevel.DEBUG,verbose:LogLevel.VERBOSE,info:LogLevel.INFO,warn:LogLevel.WARN,error:LogLevel.ERROR,silent:LogLevel.SILENT},defaultLogLevel=LogLevel.INFO,ConsoleMethod=((_a={})[LogLevel.DEBUG]=\"log\",_a[LogLevel.VERBOSE]=\"log\",_a[LogLevel.INFO]=\"info\",_a[LogLevel.WARN]=\"warn\",_a[LogLevel.ERROR]=\"error\",_a),defaultLogHandler=function(instance,logType){for(var args=[],_i=2;_i<arguments.length;_i++)args[_i-2]=arguments[_i];if(!(logType<instance.logLevel)){var now=(new Date).toISOString(),method=ConsoleMethod[logType];if(!method)throw new Error(\"Attempted to log a message with an invalid logType (value: \"+logType+\")\");console[method].apply(console,__spreadArrays([\"[\"+now+\"]  \"+instance.name+\":\"],args))}},Logger=function(){function Logger(name){this.name=name,this._logLevel=defaultLogLevel,this._logHandler=defaultLogHandler,this._userLogHandler=null,instances.push(this)}return Object.defineProperty(Logger.prototype,\"logLevel\",{get:function(){return this._logLevel},set:function(val){if(!(val in LogLevel))throw new TypeError('Invalid value \"'+val+'\" assigned to `logLevel`');this._logLevel=val},enumerable:!1,configurable:!0}),Logger.prototype.setLogLevel=function(val){this._logLevel=\"string\"==typeof val?levelStringToEnum[val]:val},Object.defineProperty(Logger.prototype,\"logHandler\",{get:function(){return this._logHandler},set:function(val){if(\"function\"!=typeof val)throw new TypeError(\"Value assigned to `logHandler` must be a function\");this._logHandler=val},enumerable:!1,configurable:!0}),Object.defineProperty(Logger.prototype,\"userLogHandler\",{get:function(){return this._userLogHandler},set:function(val){this._userLogHandler=val},enumerable:!1,configurable:!0}),Logger.prototype.debug=function(){for(var args=[],_i=0;_i<arguments.length;_i++)args[_i]=arguments[_i];this._userLogHandler&&this._userLogHandler.apply(this,__spreadArrays([this,LogLevel.DEBUG],args)),this._logHandler.apply(this,__spreadArrays([this,LogLevel.DEBUG],args))},Logger.prototype.log=function(){for(var args=[],_i=0;_i<arguments.length;_i++)args[_i]=arguments[_i];this._userLogHandler&&this._userLogHandler.apply(this,__spreadArrays([this,LogLevel.VERBOSE],args)),this._logHandler.apply(this,__spreadArrays([this,LogLevel.VERBOSE],args))},Logger.prototype.info=function(){for(var args=[],_i=0;_i<arguments.length;_i++)args[_i]=arguments[_i];this._userLogHandler&&this._userLogHandler.apply(this,__spreadArrays([this,LogLevel.INFO],args)),this._logHandler.apply(this,__spreadArrays([this,LogLevel.INFO],args))},Logger.prototype.warn=function(){for(var args=[],_i=0;_i<arguments.length;_i++)args[_i]=arguments[_i];this._userLogHandler&&this._userLogHandler.apply(this,__spreadArrays([this,LogLevel.WARN],args)),this._logHandler.apply(this,__spreadArrays([this,LogLevel.WARN],args))},Logger.prototype.error=function(){for(var args=[],_i=0;_i<arguments.length;_i++)args[_i]=arguments[_i];this._userLogHandler&&this._userLogHandler.apply(this,__spreadArrays([this,LogLevel.ERROR],args)),this._logHandler.apply(this,__spreadArrays([this,LogLevel.ERROR],args))},Logger}();function setLogLevel(level){instances.forEach((function(inst){inst.setLogLevel(level)}))}function setUserLogHandler(logCallback,options){for(var _loop_1=function(instance){var customLogLevel=null;options&&options.level&&(customLogLevel=levelStringToEnum[options.level]),instance.userLogHandler=null===logCallback?null:function(instance,level){for(var args=[],_i=2;_i<arguments.length;_i++)args[_i-2]=arguments[_i];var message=args.map((function(arg){if(null==arg)return null;if(\"string\"==typeof arg)return arg;if(\"number\"==typeof arg||\"boolean\"==typeof arg)return arg.toString();if(arg instanceof Error)return arg.message;try{return JSON.stringify(arg)}catch(ignored){return null}})).filter((function(arg){return arg})).join(\" \");level>=(null!=customLogLevel?customLogLevel:instance.logLevel)&&logCallback({level:LogLevel[level].toLowerCase(),message:message,args:args,type:instance.name})}},_i=0,instances_1=instances;_i<instances_1.length;_i++)_loop_1(instances_1[_i])}},wj3C:function(module,exports,__webpack_require__){\"use strict\";Object.defineProperty(exports,\"__esModule\",{value:!0});var _a,_a$1,tslib=__webpack_require__(\"mrSG\"),util=__webpack_require__(\"zVF4\"),component=__webpack_require__(\"S+S0\"),logger$1=__webpack_require__(\"q/0M\"),ERRORS=((_a={})[\"no-app\"]=\"No Firebase App '{$appName}' has been created - call Firebase App.initializeApp()\",_a[\"bad-app-name\"]=\"Illegal App name: '{$appName}\",_a[\"duplicate-app\"]=\"Firebase App named '{$appName}' already exists\",_a[\"app-deleted\"]=\"Firebase App named '{$appName}' already deleted\",_a[\"invalid-app-argument\"]=\"firebase.{$appName}() takes either no argument or a Firebase App instance.\",_a[\"invalid-log-argument\"]=\"First argument to `onLog` must be null or a function.\",_a),ERROR_FACTORY=new util.ErrorFactory(\"app\",\"Firebase\",ERRORS),PLATFORM_LOG_STRING=((_a$1={})[\"@firebase/app\"]=\"fire-core\",_a$1[\"@firebase/analytics\"]=\"fire-analytics\",_a$1[\"@firebase/auth\"]=\"fire-auth\",_a$1[\"@firebase/database\"]=\"fire-rtdb\",_a$1[\"@firebase/functions\"]=\"fire-fn\",_a$1[\"@firebase/installations\"]=\"fire-iid\",_a$1[\"@firebase/messaging\"]=\"fire-fcm\",_a$1[\"@firebase/performance\"]=\"fire-perf\",_a$1[\"@firebase/remote-config\"]=\"fire-rc\",_a$1[\"@firebase/storage\"]=\"fire-gcs\",_a$1[\"@firebase/firestore\"]=\"fire-fst\",_a$1[\"fire-js\"]=\"fire-js\",_a$1[\"firebase-wrapper\"]=\"fire-js-all\",_a$1),logger=new logger$1.Logger(\"@firebase/app\"),FirebaseAppImpl=function(){function FirebaseAppImpl(options,config,firebase_){var e_1,_a,_this=this;this.firebase_=firebase_,this.isDeleted_=!1,this.name_=config.name,this.automaticDataCollectionEnabled_=config.automaticDataCollectionEnabled||!1,this.options_=util.deepCopy(options),this.container=new component.ComponentContainer(config.name),this._addComponent(new component.Component(\"app\",(function(){return _this}),\"PUBLIC\"));try{for(var _b=tslib.__values(this.firebase_.INTERNAL.components.values()),_c=_b.next();!_c.done;_c=_b.next())this._addComponent(_c.value)}catch(e_1_1){e_1={error:e_1_1}}finally{try{_c&&!_c.done&&(_a=_b.return)&&_a.call(_b)}finally{if(e_1)throw e_1.error}}}return Object.defineProperty(FirebaseAppImpl.prototype,\"automaticDataCollectionEnabled\",{get:function(){return this.checkDestroyed_(),this.automaticDataCollectionEnabled_},set:function(val){this.checkDestroyed_(),this.automaticDataCollectionEnabled_=val},enumerable:!1,configurable:!0}),Object.defineProperty(FirebaseAppImpl.prototype,\"name\",{get:function(){return this.checkDestroyed_(),this.name_},enumerable:!1,configurable:!0}),Object.defineProperty(FirebaseAppImpl.prototype,\"options\",{get:function(){return this.checkDestroyed_(),this.options_},enumerable:!1,configurable:!0}),FirebaseAppImpl.prototype.delete=function(){var _this=this;return new Promise((function(resolve){_this.checkDestroyed_(),resolve()})).then((function(){return _this.firebase_.INTERNAL.removeApp(_this.name_),Promise.all(_this.container.getProviders().map((function(provider){return provider.delete()})))})).then((function(){_this.isDeleted_=!0}))},FirebaseAppImpl.prototype._getService=function(name,instanceIdentifier){return void 0===instanceIdentifier&&(instanceIdentifier=\"[DEFAULT]\"),this.checkDestroyed_(),this.container.getProvider(name).getImmediate({identifier:instanceIdentifier})},FirebaseAppImpl.prototype._removeServiceInstance=function(name,instanceIdentifier){void 0===instanceIdentifier&&(instanceIdentifier=\"[DEFAULT]\"),this.container.getProvider(name).clearInstance(instanceIdentifier)},FirebaseAppImpl.prototype._addComponent=function(component){try{this.container.addComponent(component)}catch(e){logger.debug(\"Component \"+component.name+\" failed to register with FirebaseApp \"+this.name,e)}},FirebaseAppImpl.prototype._addOrOverwriteComponent=function(component){this.container.addOrOverwriteComponent(component)},FirebaseAppImpl.prototype.checkDestroyed_=function(){if(this.isDeleted_)throw ERROR_FACTORY.create(\"app-deleted\",{appName:this.name_})},FirebaseAppImpl}();FirebaseAppImpl.prototype.name&&FirebaseAppImpl.prototype.options||FirebaseAppImpl.prototype.delete||console.log(\"dc\");var firebase=function createFirebaseNamespace(){var namespace=function(firebaseAppImpl){var apps={},components=new Map,namespace={__esModule:!0,initializeApp:function(options,rawConfig){void 0===rawConfig&&(rawConfig={}),\"object\"==typeof rawConfig&&null!==rawConfig||(rawConfig={name:rawConfig});var config=rawConfig;void 0===config.name&&(config.name=\"[DEFAULT]\");var name=config.name;if(\"string\"!=typeof name||!name)throw ERROR_FACTORY.create(\"bad-app-name\",{appName:String(name)});if(util.contains(apps,name))throw ERROR_FACTORY.create(\"duplicate-app\",{appName:name});var app=new firebaseAppImpl(options,config,namespace);return apps[name]=app,app},app:app,registerVersion:function(libraryKeyOrName,version,variant){var _a,library=null!==(_a=PLATFORM_LOG_STRING[libraryKeyOrName])&&void 0!==_a?_a:libraryKeyOrName;variant&&(library+=\"-\"+variant);var libraryMismatch=library.match(/\\s|\\//),versionMismatch=version.match(/\\s|\\//);if(libraryMismatch||versionMismatch){var warning=['Unable to register library \"'+library+'\" with version \"'+version+'\":'];return libraryMismatch&&warning.push('library name \"'+library+'\" contains illegal characters (whitespace or \"/\")'),libraryMismatch&&versionMismatch&&warning.push(\"and\"),versionMismatch&&warning.push('version name \"'+version+'\" contains illegal characters (whitespace or \"/\")'),void logger.warn(warning.join(\" \"))}registerComponent(new component.Component(library+\"-version\",(function(){return{library:library,version:version}}),\"VERSION\"))},setLogLevel:logger$1.setLogLevel,onLog:function(logCallback,options){if(null!==logCallback&&\"function\"!=typeof logCallback)throw ERROR_FACTORY.create(\"invalid-log-argument\",{appName:name});logger$1.setUserLogHandler(logCallback,options)},apps:null,SDK_VERSION:\"7.20.0\",INTERNAL:{registerComponent:registerComponent,removeApp:function(name){delete apps[name]},components:components,useAsService:function(app,name){return\"serverAuth\"===name?null:name}}};function app(name){if(!util.contains(apps,name=name||\"[DEFAULT]\"))throw ERROR_FACTORY.create(\"no-app\",{appName:name});return apps[name]}function registerComponent(component){var e_1,_a,componentName=component.name;if(components.has(componentName))return logger.debug(\"There were multiple attempts to register component \"+componentName+\".\"),\"PUBLIC\"===component.type?namespace[componentName]:null;if(components.set(componentName,component),\"PUBLIC\"===component.type){var serviceNamespace=function(appArg){if(void 0===appArg&&(appArg=app()),\"function\"!=typeof appArg[componentName])throw ERROR_FACTORY.create(\"invalid-app-argument\",{appName:componentName});return appArg[componentName]()};void 0!==component.serviceProps&&util.deepExtend(serviceNamespace,component.serviceProps),namespace[componentName]=serviceNamespace,firebaseAppImpl.prototype[componentName]=function(){for(var args=[],_i=0;_i<arguments.length;_i++)args[_i]=arguments[_i];return this._getService.bind(this,componentName).apply(this,component.multipleInstances?args:[])}}try{for(var _b=tslib.__values(Object.keys(apps)),_c=_b.next();!_c.done;_c=_b.next())apps[_c.value]._addComponent(component)}catch(e_1_1){e_1={error:e_1_1}}finally{try{_c&&!_c.done&&(_a=_b.return)&&_a.call(_b)}finally{if(e_1)throw e_1.error}}return\"PUBLIC\"===component.type?namespace[componentName]:null}return namespace.default=namespace,Object.defineProperty(namespace,\"apps\",{get:function(){return Object.keys(apps).map((function(name){return apps[name]}))}}),app.App=firebaseAppImpl,namespace}(FirebaseAppImpl);return namespace.INTERNAL=tslib.__assign(tslib.__assign({},namespace.INTERNAL),{createFirebaseNamespace:createFirebaseNamespace,extendNamespace:function(props){util.deepExtend(namespace,props)},createSubscribe:util.createSubscribe,ErrorFactory:util.ErrorFactory,deepExtend:util.deepExtend}),namespace}(),PlatformLoggerService=function(){function PlatformLoggerService(container){this.container=container}return PlatformLoggerService.prototype.getPlatformInfoString=function(){return this.container.getProviders().map((function(provider){if(function(provider){var component=provider.getComponent();return\"VERSION\"===(null==component?void 0:component.type)}(provider)){var service=provider.getImmediate();return service.library+\"/\"+service.version}return null})).filter((function(logString){return logString})).join(\" \")},PlatformLoggerService}();if(util.isBrowser()&&void 0!==self.firebase){logger.warn(\"\\n    Warning: Firebase is already defined in the global scope. Please make sure\\n    Firebase library is only loaded once.\\n  \");var sdkVersion=self.firebase.SDK_VERSION;sdkVersion&&sdkVersion.indexOf(\"LITE\")>=0&&logger.warn(\"\\n    Warning: You are trying to load Firebase while using Firebase Performance standalone script.\\n    You should load Firebase Performance with this instance of Firebase to avoid loading duplicate code.\\n    \")}var initializeApp=firebase.initializeApp;firebase.initializeApp=function(){for(var args=[],_i=0;_i<arguments.length;_i++)args[_i]=arguments[_i];return util.isNode()&&logger.warn('\\n      Warning: This is a browser-targeted Firebase bundle but it appears it is being\\n      run in a Node environment.  If running in a Node environment, make sure you\\n      are using the bundle specified by the \"main\" field in package.json.\\n      \\n      If you are using Webpack, you can specify \"main\" as the first item in\\n      \"resolve.mainFields\":\\n      https://webpack.js.org/configuration/resolve/#resolvemainfields\\n      \\n      If using Rollup, use the rollup-plugin-node-resolve plugin and specify \"main\"\\n      as the first item in \"mainFields\", e.g. [\\'main\\', \\'module\\'].\\n      https://github.com/rollup/rollup-plugin-node-resolve\\n      '),initializeApp.apply(void 0,args)};var firebase$1=firebase;!function(firebase,variant){firebase.INTERNAL.registerComponent(new component.Component(\"platform-logger\",(function(container){return new PlatformLoggerService(container)}),\"PRIVATE\")),firebase.registerVersion(\"@firebase/app\",\"0.6.11\",void 0),firebase.registerVersion(\"fire-js\",\"\")}(firebase$1),exports.default=firebase$1,exports.firebase=firebase$1},x7I3:function(module,__webpack_exports__,__webpack_require__){\"use strict\";__webpack_require__.r(__webpack_exports__),__webpack_require__.d(__webpack_exports__,\"ErrorCode\",(function(){return esm_2})),__webpack_require__.d(__webpack_exports__,\"EventType\",(function(){return esm_3})),__webpack_require__.d(__webpack_exports__,\"WebChannel\",(function(){return esm_4})),__webpack_require__.d(__webpack_exports__,\"XhrIo\",(function(){return esm_5})),__webpack_require__.d(__webpack_exports__,\"createWebChannelTransport\",(function(){return esm_1}));var extendStatics=function(d,b){return(extendStatics=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(d,b){d.__proto__=b}||function(d,b){for(var p in b)b.hasOwnProperty(p)&&(d[p]=b[p])})(d,b)};function __values(o){var s=\"function\"==typeof Symbol&&Symbol.iterator,m=s&&o[s],i=0;if(m)return m.call(o);if(o&&\"number\"==typeof o.length)return{next:function(){return o&&i>=o.length&&(o=void 0),{value:o&&o[i++],done:!o}}};throw new TypeError(s?\"Object is not iterable.\":\"Symbol.iterator is not defined.\")}var g,commonjsGlobal=\"undefined\"!=typeof globalThis?globalThis:\"undefined\"!=typeof window?window:\"undefined\"!=typeof global?global:\"undefined\"!=typeof self?self:{},goog=goog||{},k=commonjsGlobal||self;function aa(){}function ba(a){var b=typeof a;return\"object\"!=b?b:a?Array.isArray(a)?\"array\":b:\"null\"}function ca(a){var b=ba(a);return\"array\"==b||\"object\"==b&&\"number\"==typeof a.length}function n(a){var b=typeof a;return\"object\"==b&&null!=a||\"function\"==b}var ea=\"closure_uid_\"+(1e9*Math.random()>>>0),fa=0;function ha(a,b,c){return a.call.apply(a.bind,arguments)}function ja(a,b,c){if(!a)throw Error();if(2<arguments.length){var d=Array.prototype.slice.call(arguments,2);return function(){var e=Array.prototype.slice.call(arguments);return Array.prototype.unshift.apply(e,d),a.apply(b,e)}}return function(){return a.apply(b,arguments)}}function p(a,b,c){return(p=Function.prototype.bind&&-1!=Function.prototype.bind.toString().indexOf(\"native code\")?ha:ja).apply(null,arguments)}function ka(a,b){var c=Array.prototype.slice.call(arguments,1);return function(){var d=c.slice();return d.push.apply(d,arguments),a.apply(this,d)}}var q=Date.now;function r(a,b){function c(){}c.prototype=b.prototype,a.S=b.prototype,a.prototype=new c,a.prototype.constructor=a}function u(){this.j=this.j,this.i=this.i}u.prototype.j=!1,u.prototype.ja=function(){!this.j&&(this.j=!0,this.G(),0)&&function(a){Object.prototype.hasOwnProperty.call(a,ea)&&a[ea]||(a[ea]=++fa)}(this)},u.prototype.G=function(){if(this.i)for(;this.i.length;)this.i.shift()()};var na=Array.prototype.indexOf?function(a,b){return Array.prototype.indexOf.call(a,b,void 0)}:function(a,b){if(\"string\"==typeof a)return\"string\"!=typeof b||1!=b.length?-1:a.indexOf(b,0);for(var c=0;c<a.length;c++)if(c in a&&a[c]===b)return c;return-1},oa=Array.prototype.forEach?function(a,b,c){Array.prototype.forEach.call(a,b,c)}:function(a,b,c){for(var d=a.length,e=\"string\"==typeof a?a.split(\"\"):a,f=0;f<d;f++)f in e&&b.call(c,e[f],f,a)};function ra(a){return Array.prototype.concat.apply([],arguments)}function sa(a){var b=a.length;if(0<b){for(var c=Array(b),d=0;d<b;d++)c[d]=a[d];return c}return[]}function ta(a){return/^[\\s\\xa0]*$/.test(a)}var w,ua=String.prototype.trim?function(a){return a.trim()}:function(a){return/^[\\s\\xa0]*([\\s\\S]*?)[\\s\\xa0]*$/.exec(a)[1]};function v(a,b){return-1!=a.indexOf(b)}function xa(a,b){return a<b?-1:a>b?1:0}a:{var ya=k.navigator;if(ya){var za=ya.userAgent;if(za){w=za;break a}}w=\"\"}function Aa(a,b,c){for(var d in a)b.call(c,a[d],d,a)}function Ba(a){var b={};for(var c in a)b[c]=a[c];return b}var Ca=\"constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf\".split(\" \");function Da(a,b){for(var c,d,e=1;e<arguments.length;e++){for(c in d=arguments[e])a[c]=d[c];for(var f=0;f<Ca.length;f++)c=Ca[f],Object.prototype.hasOwnProperty.call(d,c)&&(a[c]=d[c])}}function Ea(a){return Ea[\" \"](a),a}Ea[\" \"]=aa;var Na,a,Ha=v(w,\"Opera\"),x=v(w,\"Trident\")||v(w,\"MSIE\"),Ia=v(w,\"Edge\"),Ja=Ia||x,Ka=v(w,\"Gecko\")&&!(v(w.toLowerCase(),\"webkit\")&&!v(w,\"Edge\"))&&!(v(w,\"Trident\")||v(w,\"MSIE\"))&&!v(w,\"Edge\"),La=v(w.toLowerCase(),\"webkit\")&&!v(w,\"Edge\");function Ma(){var a=k.document;return a?a.documentMode:void 0}a:{var Oa=\"\",Pa=(a=w,Ka?/rv:([^\\);]+)(\\)|;)/.exec(a):Ia?/Edge\\/([\\d\\.]+)/.exec(a):x?/\\b(?:MSIE|rv)[: ]([^\\);]+)(\\)|;)/.exec(a):La?/WebKit\\/(\\S+)/.exec(a):Ha?/(?:Version)[ \\/]?(\\S+)/.exec(a):void 0);if(Pa&&(Oa=Pa?Pa[1]:\"\"),x){var Qa=Ma();if(null!=Qa&&Qa>parseFloat(Oa)){Na=String(Qa);break a}}Na=Oa}var Ga={};function Ra(a){return function(a,b){var c=Ga;return Object.prototype.hasOwnProperty.call(c,a)?c[a]:c[a]=b()}(a,(function(){for(var b=0,e=ua(String(Na)).split(\".\"),f=ua(String(a)).split(\".\"),h=Math.max(e.length,f.length),m=0;0==b&&m<h;m++){var c=e[m]||\"\",d=f[m]||\"\";do{if(c=/(\\d*)(\\D*)(.*)/.exec(c)||[\"\",\"\",\"\",\"\"],d=/(\\d*)(\\D*)(.*)/.exec(d)||[\"\",\"\",\"\",\"\"],0==c[0].length&&0==d[0].length)break;b=xa(0==c[1].length?0:parseInt(c[1],10),0==d[1].length?0:parseInt(d[1],10))||xa(0==c[2].length,0==d[2].length)||xa(c[2],d[2]),c=c[3],d=d[3]}while(0==b)}return 0<=b}))}var Ua=k.document&&x&&(Ma()||parseInt(Na,10))||void 0,Va=!x||9<=Number(Ua),Wa=x&&!Ra(\"9\"),Xa=function(){if(!k.addEventListener||!Object.defineProperty)return!1;var a=!1,b=Object.defineProperty({},\"passive\",{get:function(){a=!0}});try{k.addEventListener(\"test\",aa,b),k.removeEventListener(\"test\",aa,b)}catch(c){}return a}();function y(a,b){this.type=a,this.a=this.target=b,this.defaultPrevented=!1}function A(a,b){if(y.call(this,a?a.type:\"\"),this.relatedTarget=this.a=this.target=null,this.button=this.screenY=this.screenX=this.clientY=this.clientX=0,this.key=\"\",this.metaKey=this.shiftKey=this.altKey=this.ctrlKey=!1,this.pointerId=0,this.pointerType=\"\",this.c=null,a){var c=this.type=a.type,d=a.changedTouches&&a.changedTouches.length?a.changedTouches[0]:null;if(this.target=a.target||a.srcElement,this.a=b,b=a.relatedTarget){if(Ka){a:{try{Ea(b.nodeName);var e=!0;break a}catch(f){}e=!1}e||(b=null)}}else\"mouseover\"==c?b=a.fromElement:\"mouseout\"==c&&(b=a.toElement);this.relatedTarget=b,d?(this.clientX=void 0!==d.clientX?d.clientX:d.pageX,this.clientY=void 0!==d.clientY?d.clientY:d.pageY,this.screenX=d.screenX||0,this.screenY=d.screenY||0):(this.clientX=void 0!==a.clientX?a.clientX:a.pageX,this.clientY=void 0!==a.clientY?a.clientY:a.pageY,this.screenX=a.screenX||0,this.screenY=a.screenY||0),this.button=a.button,this.key=a.key||\"\",this.ctrlKey=a.ctrlKey,this.altKey=a.altKey,this.shiftKey=a.shiftKey,this.metaKey=a.metaKey,this.pointerId=a.pointerId||0,this.pointerType=\"string\"==typeof a.pointerType?a.pointerType:Ya[a.pointerType]||\"\",this.c=a,a.defaultPrevented&&this.b()}}y.prototype.b=function(){this.defaultPrevented=!0},r(A,y);var Ya={2:\"touch\",3:\"pen\",4:\"mouse\"};A.prototype.b=function(){A.S.b.call(this);var a=this.c;if(a.preventDefault)a.preventDefault();else if(a.returnValue=!1,Wa)try{(a.ctrlKey||112<=a.keyCode&&123>=a.keyCode)&&(a.keyCode=-1)}catch(b){}};var C=\"closure_listenable_\"+(1e6*Math.random()|0),Za=0;function $a(a,b,c,d,e){this.listener=a,this.proxy=null,this.src=b,this.type=c,this.capture=!!d,this.ca=e,this.key=++Za,this.Y=this.Z=!1}function ab(a){a.Y=!0,a.listener=null,a.proxy=null,a.src=null,a.ca=null}function bb(a){this.src=a,this.a={},this.b=0}function db(a,b){var c=b.type;if(c in a.a){var f,d=a.a[c],e=na(d,b);(f=0<=e)&&Array.prototype.splice.call(d,e,1),f&&(ab(b),0==a.a[c].length&&(delete a.a[c],a.b--))}}function cb(a,b,c,d){for(var e=0;e<a.length;++e){var f=a[e];if(!f.Y&&f.listener==b&&f.capture==!!c&&f.ca==d)return e}return-1}bb.prototype.add=function(a,b,c,d,e){var f=a.toString();(a=this.a[f])||(a=this.a[f]=[],this.b++);var h=cb(a,b,d,e);return-1<h?(b=a[h],c||(b.Z=!1)):((b=new $a(b,this.src,f,!!d,e)).Z=c,a.push(b)),b};var eb=\"closure_lm_\"+(1e6*Math.random()|0),fb={};function hb(a,b,c,d,e){if(d&&d.once)return function ib(a,b,c,d,e){if(Array.isArray(b)){for(var f=0;f<b.length;f++)ib(a,b[f],c,d,e);return null}return c=jb(c),a&&a[C]?a.wa(b,c,n(d)?!!d.capture:!!d,e):kb(a,b,c,!0,d,e)}(a,b,c,d,e);if(Array.isArray(b)){for(var f=0;f<b.length;f++)hb(a,b[f],c,d,e);return null}return c=jb(c),a&&a[C]?a.va(b,c,n(d)?!!d.capture:!!d,e):kb(a,b,c,!1,d,e)}function kb(a,b,c,d,e,f){if(!b)throw Error(\"Invalid event type\");var h=n(e)?!!e.capture:!!e;if(h&&!Va)return null;var m=lb(a);if(m||(a[eb]=m=new bb(a)),(c=m.add(b,c,d,h,f)).proxy)return c;if(d=function(){var a=ob,b=Va?function(c){return a.call(b.src,b.listener,c)}:function(c){if(!(c=a.call(b.src,b.listener,c)))return c};return b}(),c.proxy=d,d.src=a,d.listener=c,a.addEventListener)Xa||(e=h),void 0===e&&(e=!1),a.addEventListener(b.toString(),d,e);else if(a.attachEvent)a.attachEvent(nb(b.toString()),d);else{if(!a.addListener||!a.removeListener)throw Error(\"addEventListener and attachEvent are unavailable.\");a.addListener(d)}return c}function rb(a){if(\"number\"!=typeof a&&a&&!a.Y){var b=a.src;if(b&&b[C])db(b.c,a);else{var c=a.type,d=a.proxy;b.removeEventListener?b.removeEventListener(c,d,a.capture):b.detachEvent?b.detachEvent(nb(c),d):b.addListener&&b.removeListener&&b.removeListener(d),(c=lb(b))?(db(c,a),0==c.b&&(c.src=null,b[eb]=null)):ab(a)}}}function nb(a){return a in fb?fb[a]:fb[a]=\"on\"+a}function sb(a,b){var c=a.listener,d=a.ca||a.src;return a.Z&&rb(a),c.call(d,b)}function ob(a,b){if(a.Y)return!0;if(!Va){if(!b)a:{b=[\"window\",\"event\"];for(var c=k,d=0;d<b.length;d++)if(null==(c=c[b[d]])){b=null;break a}b=c}return sb(a,b=new A(b,this))}return sb(a,new A(b,this))}function lb(a){return(a=a[eb])instanceof bb?a:null}var tb=\"__closure_events_fn_\"+(1e9*Math.random()>>>0);function jb(a){return\"function\"==ba(a)?a:(a[tb]||(a[tb]=function(b){return a.handleEvent(b)}),a[tb])}function D(){u.call(this),this.c=new bb(this),this.J=this,this.C=null}function ub(a,b,c,d){if(!(b=a.c.a[String(b)]))return!0;b=b.concat();for(var e=!0,f=0;f<b.length;++f){var h=b[f];if(h&&!h.Y&&h.capture==c){var m=h.listener,l=h.ca||h.src;h.Z&&db(a.c,h),e=!1!==m.call(l,d)&&e}}return e&&!d.defaultPrevented}r(D,u),D.prototype[C]=!0,(g=D.prototype).addEventListener=function(a,b,c,d){hb(this,a,b,c,d)},g.removeEventListener=function(a,b,c,d){!function pb(a,b,c,d,e){if(Array.isArray(b))for(var f=0;f<b.length;f++)pb(a,b[f],c,d,e);else d=n(d)?!!d.capture:!!d,c=jb(c),a&&a[C]?(a=a.c,(b=String(b).toString())in a.a&&-1<(c=cb(f=a.a[b],c,d,e))&&(ab(f[c]),Array.prototype.splice.call(f,c,1),0==f.length&&(delete a.a[b],a.b--))):a&&(a=lb(a))&&(b=a.a[b.toString()],a=-1,b&&(a=cb(b,c,d,e)),(c=-1<a?b[a]:null)&&rb(c))}(this,a,b,c,d)},g.dispatchEvent=function(a){var b,c=this.C;if(c)for(b=[];c;c=c.C)b.push(c);c=this.J;var d=a.type||a;if(\"string\"==typeof a)a=new y(a,c);else if(a instanceof y)a.target=a.target||c;else{var e=a;Da(a=new y(d,c),e)}if(e=!0,b)for(var f=b.length-1;0<=f;f--){var h=a.a=b[f];e=ub(h,d,!0,a)&&e}if(e=ub(h=a.a=c,d,!0,a)&&e,e=ub(h,d,!1,a)&&e,b)for(f=0;f<b.length;f++)e=ub(h=a.a=b[f],d,!1,a)&&e;return e},g.G=function(){if(D.S.G.call(this),this.c){var c,a=this.c;for(c in a.a){for(var d=a.a[c],e=0;e<d.length;e++)ab(d[e]);delete a.a[c],a.b--}}this.C=null},g.va=function(a,b,c,d){return this.c.add(String(a),b,!1,c,d)},g.wa=function(a,b,c,d){return this.c.add(String(a),b,!0,c,d)};var vb=k.JSON.stringify;function wb(){this.b=this.a=null}var Db,yb=new(function(){function class_1(a,b,c){this.f=c,this.c=a,this.g=b,this.b=0,this.a=null}return class_1.prototype.get=function(){var a;return 0<this.b?(this.b--,this.a=(a=this.a).next,a.next=null):a=this.c(),a},class_1}())((function(){return new xb}),(function(a){a.reset()}),100);function zb(){var a=Ab,b=null;return a.a&&(b=a.a,a.a=a.a.next,a.a||(a.b=null),b.next=null),b}function xb(){this.next=this.b=this.a=null}function Bb(a){k.setTimeout((function(){throw a}),0)}function Cb(a,b){Db||function(){var a=k.Promise.resolve(void 0);Db=function(){a.then(Gb)}}(),Fb||(Db(),Fb=!0),Ab.add(a,b)}wb.prototype.add=function(a,b){var c=yb.get();c.set(a,b),this.b?this.b.next=c:this.a=c,this.b=c},xb.prototype.set=function(a,b){this.a=a,this.b=b,this.next=null},xb.prototype.reset=function(){this.next=this.b=this.a=null};var Fb=!1,Ab=new wb;function Gb(){for(var a;a=zb();){try{a.a.call(a.b)}catch(c){Bb(c)}var b=yb;b.g(a),b.b<b.f&&(b.b++,a.next=b.a,b.a=a)}Fb=!1}function Hb(a,b){D.call(this),this.b=a||1,this.a=b||k,this.f=p(this.Ya,this),this.g=q()}function Ib(a){a.aa=!1,a.M&&(a.a.clearTimeout(a.M),a.M=null)}function Jb(a,b,c){if(\"function\"==ba(a))c&&(a=p(a,c));else{if(!a||\"function\"!=typeof a.handleEvent)throw Error(\"Invalid listener argument\");a=p(a.handleEvent,a)}return 2147483647<Number(b)?-1:k.setTimeout(a,b||0)}function Kb(a){a.a=Jb((function(){a.a=null,a.c&&(a.c=!1,Kb(a))}),a.h);var b=a.b;a.b=null,a.g.apply(null,b)}r(Hb,D),(g=Hb.prototype).aa=!1,g.M=null,g.Ya=function(){if(this.aa){var a=q()-this.g;0<a&&a<.8*this.b?this.M=this.a.setTimeout(this.f,this.b-a):(this.M&&(this.a.clearTimeout(this.M),this.M=null),this.dispatchEvent(\"tick\"),this.aa&&(Ib(this),this.start()))}},g.start=function(){this.aa=!0,this.M||(this.M=this.a.setTimeout(this.f,this.b),this.g=q())},g.G=function(){Hb.S.G.call(this),Ib(this),delete this.a};var Lb=function(_super){function Lb(a,b,c){var _this=_super.call(this)||this;return _this.g=null!=c?a.bind(c):a,_this.h=b,_this.b=null,_this.c=!1,_this.a=null,_this}return function(d,b){function __(){this.constructor=d}extendStatics(d,b),d.prototype=null===b?Object.create(b):(__.prototype=b.prototype,new __)}(Lb,_super),Lb.prototype.f=function(a){this.b=arguments,this.a?this.c=!0:Kb(this)},Lb.prototype.G=function(){_super.prototype.G.call(this),this.a&&(k.clearTimeout(this.a),this.a=null,this.c=!1,this.b=null)},Lb}(u);function E(a){u.call(this),this.b=a,this.a={}}r(E,u);var Mb=[];function Nb(a,b,c,d){Array.isArray(c)||(c&&(Mb[0]=c.toString()),c=Mb);for(var e=0;e<c.length;e++){var f=hb(b,c[e],d||a.handleEvent,!1,a.b||a);if(!f)break;a.a[f.key]=f}}function Ob(a){Aa(a.a,(function(b,c){this.a.hasOwnProperty(c)&&rb(b)}),a),a.a={}}function Pb(){this.a=!0}function F(a,b,c,d){a.info((function(){return\"XMLHTTP TEXT (\"+b+\"): \"+function(a,b){if(!a.a)return b;if(!b)return null;try{var c=JSON.parse(b);if(c)for(a=0;a<c.length;a++)if(Array.isArray(c[a])){var d=c[a];if(!(2>d.length)){var e=d[1];if(Array.isArray(e)&&!(1>e.length)){var f=e[0];if(\"noop\"!=f&&\"stop\"!=f&&\"close\"!=f)for(var h=1;h<e.length;h++)e[h]=\"\"}}}return vb(c)}catch(m){return b}}(a,c)+(d?\" \"+d:\"\")}))}E.prototype.G=function(){E.S.G.call(this),Ob(this)},E.prototype.handleEvent=function(){throw Error(\"EventHandler.handleEvent not implemented\")},Pb.prototype.info=function(){};var Ub=null;function Vb(){return Ub=Ub||new D}function Wb(a){y.call(this,\"serverreachability\",a)}function G(a){var b=Vb();b.dispatchEvent(new Wb(b,a))}function Xb(a){y.call(this,\"statevent\",a)}function H(a){var b=Vb();b.dispatchEvent(new Xb(b,a))}function Yb(a){y.call(this,\"timingevent\",a)}function I(a,b){if(\"function\"!=ba(a))throw Error(\"Fn must not be null and must be a function\");return k.setTimeout((function(){a()}),b)}r(Wb,y),r(Xb,y),r(Yb,y);var Zb={NO_ERROR:0,Za:1,gb:2,fb:3,bb:4,eb:5,hb:6,Da:7,TIMEOUT:8,kb:9},$b={ab:\"complete\",ob:\"success\",Ea:\"error\",Da:\"abort\",mb:\"ready\",nb:\"readystatechange\",TIMEOUT:\"timeout\",ib:\"incrementaldata\",lb:\"progress\",cb:\"downloadprogress\",pb:\"uploadprogress\"};function ac(){}function cc(){}ac.prototype.a=null;var fc,J={OPEN:\"a\",$a:\"b\",Ea:\"c\",jb:\"d\"};function dc(){y.call(this,\"d\")}function ec(){y.call(this,\"c\")}function gc(){}function K(a,b,c,d){this.g=a,this.c=b,this.f=c,this.T=d||1,this.J=new E(this),this.P=hc,this.R=new Hb(a=Ja?125:void 0),this.B=null,this.b=!1,this.j=this.l=this.i=this.H=this.u=this.U=this.o=null,this.s=[],this.a=null,this.D=0,this.h=this.m=null,this.N=-1,this.A=!1,this.O=0,this.F=null,this.W=this.C=this.V=this.I=!1}r(dc,y),r(ec,y),r(gc,ac),fc=new gc;var hc=45e3,ic={},jc={};function kc(a,b,c){a.H=1,a.i=lc(L(b)),a.j=c,a.I=!0,mc(a,null)}function mc(a,b){a.u=q(),M(a),a.l=L(a.i);var c=a.l,d=a.T;Array.isArray(d)||(d=[String(d)]),nc(c.b,\"t\",d),a.D=0,a.a=oc(a.g,a.g.C?b:null),0<a.O&&(a.F=new Lb(p(a.Ca,a,a.a),a.O)),Nb(a.J,a.a,\"readystatechange\",a.Wa),b=a.B?Ba(a.B):{},a.j?(a.m||(a.m=\"POST\"),b[\"Content-Type\"]=\"application/x-www-form-urlencoded\",a.a.ba(a.l,a.m,a.j,b)):(a.m=\"GET\",a.a.ba(a.l,a.m,null,b)),G(1),function(a,b,c,d,e,f){a.info((function(){if(a.a)if(f)for(var h=\"\",m=f.split(\"&\"),l=0;l<m.length;l++){var t=m[l].split(\"=\");if(1<t.length){var B=t[0];t=t[1];var z=B.split(\"_\");h=2<=z.length&&\"type\"==z[1]?h+(B+\"=\")+t+\"&\":h+(B+\"=redacted&\")}}else h=null;else h=f;return\"XMLHTTP REQ (\"+d+\") [attempt \"+e+\"]: \"+b+\"\\n\"+c+\"\\n\"+h}))}(a.c,a.m,a.l,a.f,a.T,a.j)}function tc(a,b,c){for(var d=!0;!a.A&&a.D<c.length;){var e=vc(a,c);if(e==jc){4==b&&(a.h=4,H(14),d=!1),F(a.c,a.f,null,\"[Incomplete Response]\");break}if(e==ic){a.h=4,H(15),F(a.c,a.f,c,\"[Invalid Chunk]\"),d=!1;break}F(a.c,a.f,e,null),qc(a,e)}4==b&&0==c.length&&(a.h=1,H(16),d=!1),a.b=a.b&&d,d?0<c.length&&!a.W&&(a.W=!0,(b=a.g).a==a&&b.V&&!b.F&&(b.c.info(\"Great, no buffering proxy detected. Bytes received: \"+c.length),xc(b),b.F=!0)):(F(a.c,a.f,c,\"[Invalid Chunked Response]\"),O(a),rc(a))}function vc(a,b){var c=a.D,d=b.indexOf(\"\\n\",c);return-1==d?jc:(c=Number(b.substring(c,d)),isNaN(c)?ic:(d+=1)+c>b.length?jc:(b=b.substr(d,c),a.D=d+c,b))}function M(a){a.U=q()+a.P,yc(a,a.P)}function yc(a,b){if(null!=a.o)throw Error(\"WatchDog timer not null\");a.o=I(p(a.Ua,a),b)}function pc(a){a.o&&(k.clearTimeout(a.o),a.o=null)}function rc(a){0==a.g.v||a.A||uc(a.g,a)}function O(a){pc(a);var b=a.F;b&&\"function\"==typeof b.ja&&b.ja(),a.F=null,Ib(a.R),Ob(a.J),a.a&&(b=a.a,a.a=null,b.abort(),b.ja())}function qc(a,b){try{var c=a.g;if(0!=c.v&&(c.a==a||zc(c.b,a)))if(c.I=a.N,!a.C&&zc(c.b,a)&&3==c.v){try{var d=c.ka.a.parse(b)}catch(sc){d=null}if(Array.isArray(d)&&3==d.length){var e=d;if(0==e[0]){a:if(!c.j){if(c.a){if(!(c.a.u+3e3<a.u))break a;Ac(c),Bc(c)}Cc(c),H(18)}}else c.oa=e[1],0<c.oa-c.P&&37500>e[2]&&c.H&&0==c.o&&!c.m&&(c.m=I(p(c.Ra,c),6e3));if(1>=Dc(c.b)&&c.ea){try{c.ea()}catch(sc){}c.ea=void 0}}else P(c,11)}else if((a.C||c.a==a)&&Ac(c),!ta(b))for(b=d=c.ka.a.parse(b),d=0;d<b.length;d++)if(c.P=(e=b[d])[0],e=e[1],2==c.v)if(\"c\"==e[0]){c.J=e[1],c.ga=e[2];var f=e[3];null!=f&&(c.ha=f,c.c.info(\"VER=\"+c.ha));var h=e[4];null!=h&&(c.pa=h,c.c.info(\"SVER=\"+c.pa));var m=e[5];if(null!=m&&\"number\"==typeof m&&0<m){var l=1.5*m;c.D=l,c.c.info(\"backChannelRequestTimeoutMs_=\"+l)}l=c;var t=a.a;if(t){var B=t.a?t.a.getResponseHeader(\"X-Client-Wire-Protocol\"):null;if(B){var z=l.b;!z.a&&(v(B,\"spdy\")||v(B,\"quic\")||v(B,\"h2\"))&&(z.f=z.g,z.a=new Set,z.b&&(Ec(z,z.b),z.b=null))}if(l.A){var qb=t.a?t.a.getResponseHeader(\"X-HTTP-Session-Id\"):null;qb&&(l.na=qb,Q(l.B,l.A,qb))}}c.v=3,c.f&&c.f.ta(),c.V&&(c.N=q()-a.u,c.c.info(\"Handshake RTT: \"+c.N+\"ms\"));var va=a;if((l=c).la=Fc(l,l.C?l.ga:null,l.fa),va.C){Gc(l.b,va);var wa=va,wc=l.D;wc&&wa.setTimeout(wc),wa.o&&(pc(wa),M(wa)),l.a=va}else Hc(l);0<c.g.length&&Ic(c)}else\"stop\"!=e[0]&&\"close\"!=e[0]||P(c,7);else 3==c.v&&(\"stop\"==e[0]||\"close\"==e[0]?\"stop\"==e[0]?P(c,7):Jc(c):\"noop\"!=e[0]&&c.f&&c.f.sa(e),c.o=0);G(4)}catch(sc){}}function Lc(a,b){if(a.forEach&&\"function\"==typeof a.forEach)a.forEach(b,void 0);else if(ca(a)||\"string\"==typeof a)oa(a,b,void 0);else{if(a.L&&\"function\"==typeof a.L)var c=a.L();else if(a.K&&\"function\"==typeof a.K)c=void 0;else if(ca(a)||\"string\"==typeof a){c=[];for(var d=a.length,e=0;e<d;e++)c.push(e)}else for(e in c=[],d=0,a)c[d++]=e;e=(d=function(a){if(a.K&&\"function\"==typeof a.K)return a.K();if(\"string\"==typeof a)return a.split(\"\");if(ca(a)){for(var b=[],c=a.length,d=0;d<c;d++)b.push(a[d]);return b}for(d in b=[],c=0,a)b[c++]=a[d];return b}(a)).length;for(var f=0;f<e;f++)b.call(void 0,d[f],c&&c[f],a)}}function R(a,b){this.b={},this.a=[],this.c=0;var c=arguments.length;if(1<c){if(c%2)throw Error(\"Uneven number of arguments\");for(var d=0;d<c;d+=2)this.set(arguments[d],arguments[d+1])}else if(a)if(a instanceof R)for(c=a.L(),d=0;d<c.length;d++)this.set(c[d],a.get(c[d]));else for(d in a)this.set(d,a[d])}function Mc(a){if(a.c!=a.a.length){for(var b=0,c=0;b<a.a.length;){var d=a.a[b];S(a.b,d)&&(a.a[c++]=d),b++}a.a.length=c}if(a.c!=a.a.length){var e={};for(c=b=0;b<a.a.length;)S(e,d=a.a[b])||(a.a[c++]=d,e[d]=1),b++;a.a.length=c}}function S(a,b){return Object.prototype.hasOwnProperty.call(a,b)}(g=K.prototype).setTimeout=function(a){this.P=a},g.Wa=function(a){a=a.target;var b=this.F;b&&3==N(a)?b.f():this.Ca(a)},g.Ca=function(a){try{if(a==this.a)a:{var b=N(this.a),c=this.a.ua(),d=this.a.X();if(!(3>b||3==b&&!Ja&&!this.a.$())){this.A||4!=b||7==c||G(8==c||0>=d?3:2),pc(this);var e=this.a.X();this.N=e;var f=this.a.$();if(this.b=200==e,function(a,b,c,d,e,f,h){a.info((function(){return\"XMLHTTP RESP (\"+d+\") [ attempt \"+e+\"]: \"+b+\"\\n\"+c+\"\\n\"+f+\" \"+h}))}(this.c,this.m,this.l,this.f,this.T,b,e),this.b){if(this.V&&!this.C){b:{if(this.a){var h,m=this.a;if((h=m.a?m.a.getResponseHeader(\"X-HTTP-Initial-Response\"):null)&&!ta(h)){var l=h;break b}}l=null}if(!l){this.b=!1,this.h=3,H(12),O(this),rc(this);break a}F(this.c,this.f,l,\"Initial handshake response via X-HTTP-Initial-Response\"),this.C=!0,qc(this,l)}this.I?(tc(this,b,f),Ja&&this.b&&3==b&&(Nb(this.J,this.R,\"tick\",this.Va),this.R.start())):(F(this.c,this.f,f,null),qc(this,f)),4==b&&O(this),this.b&&!this.A&&(4==b?uc(this.g,this):(this.b=!1,M(this)))}else 400==e&&0<f.indexOf(\"Unknown SID\")?(this.h=3,H(12)):(this.h=0,H(13)),O(this),rc(this)}}}catch(t){}},g.Va=function(){if(this.a){var a=N(this.a),b=this.a.$();this.D<b.length&&(pc(this),tc(this,a,b),this.b&&4!=a&&M(this))}},g.cancel=function(){this.A=!0,O(this)},g.Ua=function(){this.o=null;var a=q();0<=a-this.U?(function(a,b){a.info((function(){return\"TIMEOUT: \"+b}))}(this.c,this.l),2!=this.H&&(G(3),H(17)),O(this),this.h=2,rc(this)):yc(this,this.U-a)},(g=R.prototype).K=function(){Mc(this);for(var a=[],b=0;b<this.a.length;b++)a.push(this.b[this.a[b]]);return a},g.L=function(){return Mc(this),this.a.concat()},g.get=function(a,b){return S(this.b,a)?this.b[a]:b},g.set=function(a,b){S(this.b,a)||(this.c++,this.a.push(a)),this.b[a]=b},g.forEach=function(a,b){for(var c=this.L(),d=0;d<c.length;d++){var e=c[d],f=this.get(e);a.call(b,f,e,this)}};var Nc=/^(?:([^:/?#.]+):)?(?:\\/\\/(?:([^\\\\/?#]*)@)?([^\\\\/?#]*?)(?::([0-9]+))?(?=[\\\\/?#]|$))?([^?#]+)?(?:\\?([^#]*))?(?:#([\\s\\S]*))?$/;function T(a,b){if(this.c=this.j=this.f=\"\",this.h=null,this.i=this.g=\"\",this.a=!1,a instanceof T){this.a=void 0!==b?b:a.a,Pc(this,a.f),this.j=a.j,Qc(this,a.c),Rc(this,a.h),this.g=a.g,b=a.b;var c=new U;c.c=b.c,b.a&&(c.a=new R(b.a),c.b=b.b),Sc(this,c),this.i=a.i}else a&&(c=String(a).match(Nc))?(this.a=!!b,Pc(this,c[1]||\"\",!0),this.j=Tc(c[2]||\"\"),Qc(this,c[3]||\"\",!0),Rc(this,c[4]),this.g=Tc(c[5]||\"\",!0),Sc(this,c[6]||\"\",!0),this.i=Tc(c[7]||\"\")):(this.a=!!b,this.b=new U(null,this.a))}function L(a){return new T(a)}function Pc(a,b,c){a.f=c?Tc(b,!0):b,a.f&&(a.f=a.f.replace(/:$/,\"\"))}function Qc(a,b,c){a.c=c?Tc(b,!0):b}function Rc(a,b){if(b){if(b=Number(b),isNaN(b)||0>b)throw Error(\"Bad port number \"+b);a.h=b}else a.h=null}function Sc(a,b,c){b instanceof U?(a.b=b,function(a,b){b&&!a.f&&(V(a),a.c=null,a.a.forEach((function(c,d){var e=d.toLowerCase();d!=e&&(dd(this,d),nc(this,e,c))}),a)),a.f=b}(a.b,a.a)):(c||(b=Uc(b,$c)),a.b=new U(b,a.a))}function Q(a,b,c){a.b.set(b,c)}function lc(a){return Q(a,\"zx\",Math.floor(2147483648*Math.random()).toString(36)+Math.abs(Math.floor(2147483648*Math.random())^q()).toString(36)),a}function Tc(a,b){return a?b?decodeURI(a.replace(/%25/g,\"%2525\")):decodeURIComponent(a):\"\"}function Uc(a,b,c){return\"string\"==typeof a?(a=encodeURI(a).replace(b,cd),c&&(a=a.replace(/%25([0-9a-fA-F]{2})/g,\"%$1\")),a):null}function cd(a){return\"%\"+((a=a.charCodeAt(0))>>4&15).toString(16)+(15&a).toString(16)}T.prototype.toString=function(){var a=[],b=this.f;b&&a.push(Uc(b,Vc,!0),\":\");var c=this.c;return(c||\"file\"==b)&&(a.push(\"//\"),(b=this.j)&&a.push(Uc(b,Vc,!0),\"@\"),a.push(encodeURIComponent(String(c)).replace(/%25([0-9a-fA-F]{2})/g,\"%$1\")),null!=(c=this.h)&&a.push(\":\",String(c))),(c=this.g)&&(this.c&&\"/\"!=c.charAt(0)&&a.push(\"/\"),a.push(Uc(c,\"/\"==c.charAt(0)?Wc:Xc,!0))),(c=this.b.toString())&&a.push(\"?\",c),(c=this.i)&&a.push(\"#\",Uc(c,Yc)),a.join(\"\")};var Vc=/[#\\/\\?@]/g,Xc=/[#\\?:]/g,Wc=/[#\\?]/g,$c=/[#\\?@]/g,Yc=/#/g;function U(a,b){this.b=this.a=null,this.c=a||null,this.f=!!b}function V(a){a.a||(a.a=new R,a.b=0,a.c&&function(a,b){if(a){a=a.split(\"&\");for(var c=0;c<a.length;c++){var d=a[c].indexOf(\"=\"),e=null;if(0<=d){var f=a[c].substring(0,d);e=a[c].substring(d+1)}else f=a[c];b(f,e?decodeURIComponent(e.replace(/\\+/g,\" \")):\"\")}}}(a.c,(function(b,c){a.add(decodeURIComponent(b.replace(/\\+/g,\" \")),c)})))}function dd(a,b){V(a),b=W(a,b),S(a.a.b,b)&&(a.c=null,a.b-=a.a.get(b).length,S((a=a.a).b,b)&&(delete a.b[b],a.c--,a.a.length>2*a.c&&Mc(a)))}function ed(a,b){return V(a),b=W(a,b),S(a.a.b,b)}function nc(a,b,c){dd(a,b),0<c.length&&(a.c=null,a.a.set(W(a,b),sa(c)),a.b+=c.length)}function W(a,b){return b=String(b),a.f&&(b=b.toLowerCase()),b}function fd(a,b){this.b=a,this.a=b}function gd(a){this.g=a||hd,a=k.PerformanceNavigationTiming?0<(a=k.performance.getEntriesByType(\"navigation\")).length&&(\"hq\"==a[0].nextHopProtocol||\"h2\"==a[0].nextHopProtocol):!!(k.ia&&k.ia.ya&&k.ia.ya()&&k.ia.ya().qb),this.f=a?this.g:1,this.a=null,1<this.f&&(this.a=new Set),this.b=null,this.c=[]}(g=U.prototype).add=function(a,b){V(this),this.c=null,a=W(this,a);var c=this.a.get(a);return c||this.a.set(a,c=[]),c.push(b),this.b+=1,this},g.forEach=function(a,b){V(this),this.a.forEach((function(c,d){oa(c,(function(e){a.call(b,e,d,this)}),this)}),this)},g.L=function(){V(this);for(var a=this.a.K(),b=this.a.L(),c=[],d=0;d<b.length;d++)for(var e=a[d],f=0;f<e.length;f++)c.push(b[d]);return c},g.K=function(a){V(this);var b=[];if(\"string\"==typeof a)ed(this,a)&&(b=ra(b,this.a.get(W(this,a))));else{a=this.a.K();for(var c=0;c<a.length;c++)b=ra(b,a[c])}return b},g.set=function(a,b){return V(this),this.c=null,ed(this,a=W(this,a))&&(this.b-=this.a.get(a).length),this.a.set(a,[b]),this.b+=1,this},g.get=function(a,b){return a&&0<(a=this.K(a)).length?String(a[0]):b},g.toString=function(){if(this.c)return this.c;if(!this.a)return\"\";for(var a=[],b=this.a.L(),c=0;c<b.length;c++){var d=b[c],e=encodeURIComponent(String(d));d=this.K(d);for(var f=0;f<d.length;f++){var h=e;\"\"!==d[f]&&(h+=\"=\"+encodeURIComponent(String(d[f]))),a.push(h)}}return this.c=a.join(\"&\")};var hd=10;function id(a){return!!a.b||!!a.a&&a.a.size>=a.f}function Dc(a){return a.b?1:a.a?a.a.size:0}function zc(a,b){return a.b?a.b==b:!!a.a&&a.a.has(b)}function Ec(a,b){a.a?a.a.add(b):a.b=b}function Gc(a,b){a.b&&a.b==b?a.b=null:a.a&&a.a.has(b)&&a.a.delete(b)}function jd(a){var e_2,_a;if(null!=a.b)return a.c.concat(a.b.s);if(null!=a.a&&0!==a.a.size){var b=a.c;try{for(var _b=__values(a.a.values()),_c=_b.next();!_c.done;_c=_b.next())b=b.concat(_c.value.s)}catch(e_2_1){e_2={error:e_2_1}}finally{try{_c&&!_c.done&&(_a=_b.return)&&_a.call(_b)}finally{if(e_2)throw e_2.error}}return b}return sa(a.c)}function kd(){}function ld(){this.a=new kd}function md(a,b,c){var d=c||\"\";try{Lc(a,(function(e,f){var h=e;n(e)&&(h=vb(e)),b.push(d+f+\"=\"+encodeURIComponent(h))}))}catch(e){throw b.push(d+\"type=\"+encodeURIComponent(\"_badmap\")),e}}function od(a,b,c,d,e){try{b.onload=null,b.onerror=null,b.onabort=null,b.ontimeout=null,e(d)}catch(f){}}gd.prototype.cancel=function(){var e_1,_a;if(this.c=jd(this),this.b)this.b.cancel(),this.b=null;else if(this.a&&0!==this.a.size){try{for(var _b=__values(this.a.values()),_c=_b.next();!_c.done;_c=_b.next())_c.value.cancel()}catch(e_1_1){e_1={error:e_1_1}}finally{try{_c&&!_c.done&&(_a=_b.return)&&_a.call(_b)}finally{if(e_1)throw e_1.error}}this.a.clear()}},kd.prototype.stringify=function(a){return k.JSON.stringify(a,void 0)},kd.prototype.parse=function(a){return k.JSON.parse(a,void 0)};var pd=k.JSON.parse;function X(a){D.call(this),this.headers=new R,this.H=a||null,this.b=!1,this.s=this.a=null,this.B=\"\",this.h=0,this.f=\"\",this.g=this.A=this.l=this.u=!1,this.o=0,this.m=null,this.I=qd,this.D=this.F=!1}r(X,D);var qd=\"\",rd=/^https?$/i,sd=[\"POST\",\"PUT\"];function qa(a){return\"content-type\"==a.toLowerCase()}function td(a,b){a.b=!1,a.a&&(a.g=!0,a.a.abort(),a.g=!1),a.f=b,a.h=5,wd(a),xd(a)}function wd(a){a.u||(a.u=!0,a.dispatchEvent(\"complete\"),a.dispatchEvent(\"error\"))}function yd(a){if(a.b&&void 0!==goog&&(!a.s[1]||4!=N(a)||2!=a.X()))if(a.l&&4==N(a))Jb(a.za,0,a);else if(a.dispatchEvent(\"readystatechange\"),4==N(a)){a.b=!1;try{var d,b=a.X();a:switch(b){case 200:case 201:case 202:case 204:case 206:case 304:case 1223:var c=!0;break a;default:c=!1}if(!(d=c)){var e;if(e=0===b){var f=String(a.B).match(Nc)[1]||null;if(!f&&k.self&&k.self.location){var h=k.self.location.protocol;f=h.substr(0,h.length-1)}e=!rd.test(f?f.toLowerCase():\"\")}d=e}if(d)a.dispatchEvent(\"complete\"),a.dispatchEvent(\"success\");else{a.h=6;try{var m=2<N(a)?a.a.statusText:\"\"}catch(l){m=\"\"}a.f=m+\" [\"+a.X()+\"]\",wd(a)}}finally{xd(a)}}}function xd(a,b){if(a.a){ud(a);var c=a.a,d=a.s[0]?aa:null;a.a=null,a.s=null,b||a.dispatchEvent(\"ready\");try{c.onreadystatechange=d}catch(e){}}}function ud(a){a.a&&a.D&&(a.a.ontimeout=null),a.m&&(k.clearTimeout(a.m),a.m=null)}function N(a){return a.a?a.a.readyState:0}function Ad(a,b,c){a:{for(d in c){var d=!1;break a}d=!0}d||(c=function(a){var b=\"\";return Aa(a,(function(c,d){b+=d,b+=\":\",b+=c,b+=\"\\r\\n\"})),b}(c),\"string\"==typeof a?null!=c&&encodeURIComponent(String(c)):Q(a,b,c))}function Bd(a,b,c){return c&&c.internalChannelParams&&c.internalChannelParams[a]||b}function Cd(a){this.pa=0,this.g=[],this.c=new Pb,this.ga=this.la=this.B=this.fa=this.a=this.na=this.A=this.W=this.i=this.O=this.l=null,this.La=this.R=0,this.Ia=Bd(\"failFast\",!1,a),this.H=this.m=this.j=this.h=this.f=null,this.T=!0,this.I=this.oa=this.P=-1,this.U=this.o=this.u=0,this.Fa=Bd(\"baseRetryDelayMs\",5e3,a),this.Ma=Bd(\"retryDelaySeedMs\",1e4,a),this.Ja=Bd(\"forwardChannelMaxRetries\",2,a),this.ma=Bd(\"forwardChannelRequestTimeoutMs\",2e4,a),this.Ka=a&&a.g||void 0,this.D=void 0,this.C=a&&a.supportsCrossDomainXhr||!1,this.J=\"\",this.b=new gd(a&&a.concurrentRequestLimit),this.ka=new ld,this.da=a&&a.fastHandshake||!1,this.Ga=a&&a.b||!1,a&&a.f&&(this.c.a=!1),a&&a.forceLongPolling&&(this.T=!1),this.V=!this.da&&this.T&&a&&a.c||!1,this.ea=void 0,this.N=0,this.F=!1,this.s=null}function Jc(a){if(Dd(a),3==a.v){var b=a.R++,c=L(a.B);Q(c,\"SID\",a.J),Q(c,\"RID\",b),Q(c,\"TYPE\",\"terminate\"),Ed(a,c),(b=new K(a,a.c,b,void 0)).H=2,b.i=lc(L(c)),c=!1,k.navigator&&k.navigator.sendBeacon&&(c=k.navigator.sendBeacon(b.i.toString(),\"\")),!c&&k.Image&&((new Image).src=b.i,c=!0),c||(b.a=oc(b.g,null),b.a.ba(b.i)),b.u=q(),M(b)}Fd(a)}function Bc(a){a.a&&(xc(a),a.a.cancel(),a.a=null)}function Dd(a){Bc(a),a.j&&(k.clearTimeout(a.j),a.j=null),Ac(a),a.b.cancel(),a.h&&(\"number\"==typeof a.h&&k.clearTimeout(a.h),a.h=null)}function Gd(a,b){a.g.push(new fd(a.La++,b)),3==a.v&&Ic(a)}function Ic(a){id(a.b)||a.h||(a.h=!0,Cb(a.Ba,a),a.u=0)}function Kd(a,b){var c;c=b?b.f:a.R++;var d=L(a.B);Q(d,\"SID\",a.J),Q(d,\"RID\",c),Q(d,\"AID\",a.P),Ed(a,d),a.i&&a.l&&Ad(d,a.i,a.l),c=new K(a,a.c,c,a.u+1),null===a.i&&(c.B=a.l),b&&(a.g=b.s.concat(a.g)),b=Jd(a,c,1e3),c.setTimeout(Math.round(.5*a.ma)+Math.round(.5*a.ma*Math.random())),Ec(a.b,c),kc(c,d,b)}function Ed(a,b){a.f&&Lc({},(function(c,d){Q(b,d,c)}))}function Jd(a,b,c){c=Math.min(a.g.length,c);var d=a.f?p(a.f.Ha,a.f,a):null;a:for(var e=a.g,f=-1;;){var h=[\"count=\"+c];-1==f?0<c?h.push(\"ofs=\"+(f=e[0].b)):f=0:h.push(\"ofs=\"+f);for(var m=!0,l=0;l<c;l++){var t=e[l].b,B=e[l].a;if(0>(t-=f))f=Math.max(0,e[l].b-100),m=!1;else try{md(B,h,\"req\"+t+\"_\")}catch(z){d&&d(B)}}if(m){d=h.join(\"&\");break a}}return a=a.g.splice(0,c),b.s=a,d}function Hc(a){a.a||a.j||(a.U=1,Cb(a.Aa,a),a.o=0)}function Cc(a){return!(a.a||a.j||3<=a.o||(a.U++,a.j=I(p(a.Aa,a),Id(a,a.o)),a.o++,0))}function xc(a){null!=a.s&&(k.clearTimeout(a.s),a.s=null)}function Ld(a){a.a=new K(a,a.c,\"rpc\",a.U),null===a.i&&(a.a.B=a.l),a.a.O=0;var b=L(a.la);Q(b,\"RID\",\"rpc\"),Q(b,\"SID\",a.J),Q(b,\"CI\",a.H?\"0\":\"1\"),Q(b,\"AID\",a.P),Ed(a,b),Q(b,\"TYPE\",\"xmlhttp\"),a.i&&a.l&&Ad(b,a.i,a.l),a.D&&a.a.setTimeout(a.D);var c=a.a;a=a.ga,c.H=1,c.i=lc(L(b)),c.j=null,c.I=!0,mc(c,a)}function Ac(a){null!=a.m&&(k.clearTimeout(a.m),a.m=null)}function uc(a,b){var c=null;if(a.a==b){Ac(a),xc(a),a.a=null;var d=2}else{if(!zc(a.b,b))return;c=b.s,Gc(a.b,b),d=1}if(a.I=b.N,0!=a.v)if(b.b)if(1==d){c=b.j?b.j.length:0,b=q()-b.u;var e=a.u;(d=Vb()).dispatchEvent(new Yb(d,c,b,e)),Ic(a)}else Hc(a);else if(3==(e=b.h)||0==e&&0<a.I||!(1==d&&function(a,b){return!(Dc(a.b)>=a.b.f-(a.h?1:0)||(a.h?(a.g=b.s.concat(a.g),0):1==a.v||2==a.v||a.u>=(a.Ia?0:a.Ja)||(a.h=I(p(a.Ba,a,b),Id(a,a.u)),a.u++,0)))}(a,b)||2==d&&Cc(a)))switch(c&&0<c.length&&(b=a.b,b.c=b.c.concat(c)),e){case 1:P(a,5);break;case 4:P(a,10);break;case 3:P(a,6);break;default:P(a,2)}}function Id(a,b){var c=a.Fa+Math.floor(Math.random()*a.Ma);return a.f||(c*=2),c*b}function P(a,b){if(a.c.info(\"Error code \"+b),2==b){var c=null;a.f&&(c=null);var d=p(a.Xa,a);c||(c=new T(\"//www.google.com/images/cleardot.gif\"),k.location&&\"http\"==k.location.protocol||Pc(c,\"https\"),lc(c)),function(a,b){var c=new Pb;if(k.Image){var d=new Image;d.onload=ka(od,c,d,\"TestLoadImage: loaded\",!0,b),d.onerror=ka(od,c,d,\"TestLoadImage: error\",!1,b),d.onabort=ka(od,c,d,\"TestLoadImage: abort\",!1,b),d.ontimeout=ka(od,c,d,\"TestLoadImage: timeout\",!1,b),k.setTimeout((function(){d.ontimeout&&d.ontimeout()}),1e4),d.src=a}else b(!1)}(c.toString(),d)}else H(2);a.v=0,a.f&&a.f.ra(b),Fd(a),Dd(a)}function Fd(a){a.v=0,a.I=-1,a.f&&(0==jd(a.b).length&&0==a.g.length||(a.b.c.length=0,sa(a.g),a.g.length=0),a.f.qa())}function Fc(a,b,c){var d=function(a){return a instanceof T?L(a):new T(a,void 0)}(c);if(\"\"!=d.c)b&&Qc(d,b+\".\"+d.c),Rc(d,d.h);else{var e=k.location;d=function(a,b,c,d){var e=new T(null,void 0);return a&&Pc(e,a),b&&Qc(e,b),c&&Rc(e,c),d&&(e.g=d),e}(e.protocol,b?b+\".\"+e.hostname:e.hostname,+e.port,c)}return a.W&&Aa(a.W,(function(f,h){Q(d,h,f)})),c=a.na,(b=a.A)&&c&&Q(d,b,c),Q(d,\"VER\",a.ha),Ed(a,d),d}function oc(a,b){if(b&&!a.C)throw Error(\"Can't create secondary domain capable XhrIo object.\");return(b=new X(a.Ka)).F=a.C,b}function Md(){}function Nd(){if(x&&!(10<=Number(Ua)))throw Error(\"Environmental error: no available transport.\")}function Y(a,b){D.call(this),this.a=new Cd(b),this.l=a,this.b=b&&b.messageUrlParams||null,a=b&&b.messageHeaders||null,b&&b.clientProtocolHeaderRequired&&(a?a[\"X-Client-Protocol\"]=\"webchannel\":a={\"X-Client-Protocol\":\"webchannel\"}),this.a.l=a,a=b&&b.initMessageHeaders||null,b&&b.messageContentType&&(a?a[\"X-WebChannel-Content-Type\"]=b.messageContentType:a={\"X-WebChannel-Content-Type\":b.messageContentType}),b&&b.a&&(a?a[\"X-WebChannel-Client-Profile\"]=b.a:a={\"X-WebChannel-Client-Profile\":b.a}),this.a.O=a,(a=b&&b.httpHeadersOverwriteParam)&&!ta(a)&&(this.a.i=a),this.h=b&&b.supportsCrossDomainXhr||!1,this.g=b&&b.sendRawJson||!1,(b=b&&b.httpSessionIdParam)&&!ta(b)&&(this.a.A=b,null!==(a=this.b)&&b in a&&b in(a=this.b)&&delete a[b]),this.f=new Z(this)}function Od(a){dc.call(this);var b=a.__sm__;if(b){a:{for(var c in b){a=c;break a}a=void 0}(this.c=a)?(a=this.c,this.data=null!==b&&a in b?b[a]:void 0):this.data=b}else this.data=a}function Pd(){ec.call(this),this.status=1}function Z(a){this.a=a}(g=X.prototype).ba=function(a,b,c,d){if(this.a)throw Error(\"[goog.net.XhrIo] Object is active with another request=\"+this.B+\"; newUri=\"+a);b=b?b.toUpperCase():\"GET\",this.B=a,this.f=\"\",this.h=0,this.u=!1,this.b=!0,this.a=new XMLHttpRequest,this.s=function(a){var b;return(b=a.a)||(b=a.a={}),b}(this.H?this.H:fc),this.a.onreadystatechange=p(this.za,this);try{this.A=!0,this.a.open(b,String(a),!0),this.A=!1}catch(f){return void td(this,f)}a=c||\"\";var e=new R(this.headers);d&&Lc(d,(function(f,h){e.set(h,f)})),d=function(a){a:{for(var b=qa,c=a.length,d=\"string\"==typeof a?a.split(\"\"):a,e=0;e<c;e++)if(e in d&&b.call(void 0,d[e],e,a)){b=e;break a}b=-1}return 0>b?null:\"string\"==typeof a?a.charAt(b):a[b]}(e.L()),c=k.FormData&&a instanceof k.FormData,!(0<=na(sd,b))||d||c||e.set(\"Content-Type\",\"application/x-www-form-urlencoded;charset=utf-8\"),e.forEach((function(f,h){this.a.setRequestHeader(h,f)}),this),this.I&&(this.a.responseType=this.I),\"withCredentials\"in this.a&&this.a.withCredentials!==this.F&&(this.a.withCredentials=this.F);try{ud(this),0<this.o&&((this.D=function(a){return x&&Ra(9)&&\"number\"==typeof a.timeout&&void 0!==a.ontimeout}(this.a))?(this.a.timeout=this.o,this.a.ontimeout=p(this.xa,this)):this.m=Jb(this.xa,this.o,this)),this.l=!0,this.a.send(a),this.l=!1}catch(f){td(this,f)}},g.xa=function(){void 0!==goog&&this.a&&(this.f=\"Timed out after \"+this.o+\"ms, aborting\",this.h=8,this.dispatchEvent(\"timeout\"),this.abort(8))},g.abort=function(a){this.a&&this.b&&(this.b=!1,this.g=!0,this.a.abort(),this.g=!1,this.h=a||7,this.dispatchEvent(\"complete\"),this.dispatchEvent(\"abort\"),xd(this))},g.G=function(){this.a&&(this.b&&(this.b=!1,this.g=!0,this.a.abort(),this.g=!1),xd(this,!0)),X.S.G.call(this)},g.za=function(){this.j||(this.A||this.l||this.g?yd(this):this.Ta())},g.Ta=function(){yd(this)},g.X=function(){try{return 2<N(this)?this.a.status:-1}catch(a){return-1}},g.$=function(){try{return this.a?this.a.responseText:\"\"}catch(a){return\"\"}},g.Na=function(a){if(this.a){var b=this.a.responseText;return a&&0==b.indexOf(a)&&(b=b.substring(a.length)),pd(b)}},g.ua=function(){return this.h},g.Qa=function(){return\"string\"==typeof this.f?this.f:String(this.f)},(g=Cd.prototype).ha=8,g.v=1,g.Ba=function(a){if(this.h)if(this.h=null,1==this.v){if(!a){this.R=Math.floor(1e5*Math.random()),a=this.R++;var d,b=new K(this,this.c,a,void 0),c=this.l;if(this.O&&(c?Da(c=Ba(c),this.O):c=this.O),null===this.i&&(b.B=c),this.da)a:{for(var e=d=0;e<this.g.length;e++){var f=this.g[e];if(void 0===(f=\"__data__\"in f.a&&\"string\"==typeof(f=f.a.__data__)?f.length:void 0))break;if(4096<(d+=f)){d=e;break a}if(4096===d||e===this.g.length-1){d=e+1;break a}}d=1e3}else d=1e3;d=Jd(this,b,d),Q(e=L(this.B),\"RID\",a),Q(e,\"CVER\",22),this.A&&Q(e,\"X-HTTP-Session-Id\",this.A),Ed(this,e),this.i&&c&&Ad(e,this.i,c),Ec(this.b,b),this.Ga&&Q(e,\"TYPE\",\"init\"),this.da?(Q(e,\"$req\",d),Q(e,\"SID\",\"null\"),b.V=!0,kc(b,e,null)):kc(b,e,d),this.v=2}}else 3==this.v&&(a?Kd(this,a):0==this.g.length||id(this.b)||Kd(this))},g.Aa=function(){if(this.j=null,Ld(this),this.V&&!(this.F||null==this.a||0>=this.N)){var a=2*this.N;this.c.info(\"BP detection timer enabled: \"+a),this.s=I(p(this.Sa,this),a)}},g.Sa=function(){this.s&&(this.s=null,this.c.info(\"BP detection timeout reached.\"),this.c.info(\"Buffering proxy detected and switch to long-polling!\"),this.H=!1,this.F=!0,Bc(this),Ld(this))},g.Ra=function(){null!=this.m&&(this.m=null,Bc(this),Cc(this),H(19))},g.Xa=function(a){a?(this.c.info(\"Successfully pinged google.com\"),H(2)):(this.c.info(\"Failed to ping google.com\"),H(1))},(g=Md.prototype).ta=function(){},g.sa=function(){},g.ra=function(){},g.qa=function(){},g.Ha=function(){},Nd.prototype.a=function(a,b){return new Y(a,b)},r(Y,D),(g=Y.prototype).addEventListener=function(a,b,c,d){Y.S.addEventListener.call(this,a,b,c,d)},g.removeEventListener=function(a,b,c,d){Y.S.removeEventListener.call(this,a,b,c,d)},g.Oa=function(){this.a.f=this.f,this.h&&(this.a.C=!0);var a=this.a,b=this.l,c=this.b||void 0;H(0),a.fa=b,a.W=c||{},a.H=a.T,a.B=Fc(a,null,a.fa),Ic(a)},g.close=function(){Jc(this.a)},g.Pa=function(a){if(\"string\"==typeof a){var b={};b.__data__=a,Gd(this.a,b)}else this.g?((b={}).__data__=vb(a),Gd(this.a,b)):Gd(this.a,a)},g.G=function(){this.a.f=null,delete this.f,Jc(this.a),delete this.a,Y.S.G.call(this)},r(Od,dc),r(Pd,ec),r(Z,Md),Z.prototype.ta=function(){this.a.dispatchEvent(\"a\")},Z.prototype.sa=function(a){this.a.dispatchEvent(new Od(a))},Z.prototype.ra=function(a){this.a.dispatchEvent(new Pd(a))},Z.prototype.qa=function(){this.a.dispatchEvent(\"b\")},Nd.prototype.createWebChannel=Nd.prototype.a,Y.prototype.send=Y.prototype.Pa,Y.prototype.open=Y.prototype.Oa,Y.prototype.close=Y.prototype.close,Zb.NO_ERROR=0,Zb.TIMEOUT=8,Zb.HTTP_ERROR=6,$b.COMPLETE=\"complete\",cc.EventType=J,J.OPEN=\"a\",J.CLOSE=\"b\",J.ERROR=\"c\",J.MESSAGE=\"d\",D.prototype.listen=D.prototype.va,X.prototype.listenOnce=X.prototype.wa,X.prototype.getLastError=X.prototype.Qa,X.prototype.getLastErrorCode=X.prototype.ua,X.prototype.getStatus=X.prototype.X,X.prototype.getResponseJson=X.prototype.Na,X.prototype.getResponseText=X.prototype.$,X.prototype.send=X.prototype.ba;var esm={createWebChannelTransport:function(){return new Nd},ErrorCode:Zb,EventType:$b,WebChannel:cc,XhrIo:X},esm_1=esm.createWebChannelTransport,esm_2=esm.ErrorCode,esm_3=esm.EventType,esm_4=esm.WebChannel,esm_5=esm.XhrIo;__webpack_exports__.default=esm},zUnb:function(module,__webpack_exports__,__webpack_require__){\"use strict\";function isFunction(x){return\"function\"==typeof x}__webpack_require__.r(__webpack_exports__);let _enable_super_gross_mode_that_will_cause_bad_things=!1;const config_config={Promise:void 0,set useDeprecatedSynchronousErrorHandling(value){if(value){const error=new Error;console.warn(\"DEPRECATED! RxJS was set to use deprecated synchronous error handling behavior by code at: \\n\"+error.stack)}else _enable_super_gross_mode_that_will_cause_bad_things&&console.log(\"RxJS: Back to a better error behavior. Thank you. <3\");_enable_super_gross_mode_that_will_cause_bad_things=value},get useDeprecatedSynchronousErrorHandling(){return _enable_super_gross_mode_that_will_cause_bad_things}};function hostReportError(err){setTimeout(()=>{throw err},0)}const empty={closed:!0,next(value){},error(err){if(config_config.useDeprecatedSynchronousErrorHandling)throw err;hostReportError(err)},complete(){}},isArray=(()=>Array.isArray||(x=>x&&\"number\"==typeof x.length))();function isObject(x){return null!==x&&\"object\"==typeof x}const UnsubscriptionError=(()=>{function UnsubscriptionErrorImpl(errors){return Error.call(this),this.message=errors?`${errors.length} errors occurred during unsubscription:\\n${errors.map((err,i)=>`${i+1}) ${err.toString()}`).join(\"\\n  \")}`:\"\",this.name=\"UnsubscriptionError\",this.errors=errors,this}return UnsubscriptionErrorImpl.prototype=Object.create(Error.prototype),UnsubscriptionErrorImpl})();let Subscription_Subscription=(()=>{class Subscription{constructor(unsubscribe){this.closed=!1,this._parentOrParents=null,this._subscriptions=null,unsubscribe&&(this._unsubscribe=unsubscribe)}unsubscribe(){let errors;if(this.closed)return;let{_parentOrParents:_parentOrParents,_unsubscribe:_unsubscribe,_subscriptions:_subscriptions}=this;if(this.closed=!0,this._parentOrParents=null,this._subscriptions=null,_parentOrParents instanceof Subscription)_parentOrParents.remove(this);else if(null!==_parentOrParents)for(let index=0;index<_parentOrParents.length;++index)_parentOrParents[index].remove(this);if(isFunction(_unsubscribe))try{_unsubscribe.call(this)}catch(e){errors=e instanceof UnsubscriptionError?flattenUnsubscriptionErrors(e.errors):[e]}if(isArray(_subscriptions)){let index=-1,len=_subscriptions.length;for(;++index<len;){const sub=_subscriptions[index];if(isObject(sub))try{sub.unsubscribe()}catch(e){errors=errors||[],e instanceof UnsubscriptionError?errors=errors.concat(flattenUnsubscriptionErrors(e.errors)):errors.push(e)}}}if(errors)throw new UnsubscriptionError(errors)}add(teardown){let subscription=teardown;if(!teardown)return Subscription.EMPTY;switch(typeof teardown){case\"function\":subscription=new Subscription(teardown);case\"object\":if(subscription===this||subscription.closed||\"function\"!=typeof subscription.unsubscribe)return subscription;if(this.closed)return subscription.unsubscribe(),subscription;if(!(subscription instanceof Subscription)){const tmp=subscription;subscription=new Subscription,subscription._subscriptions=[tmp]}break;default:throw new Error(\"unrecognized teardown \"+teardown+\" added to Subscription.\")}let{_parentOrParents:_parentOrParents}=subscription;if(null===_parentOrParents)subscription._parentOrParents=this;else if(_parentOrParents instanceof Subscription){if(_parentOrParents===this)return subscription;subscription._parentOrParents=[_parentOrParents,this]}else{if(-1!==_parentOrParents.indexOf(this))return subscription;_parentOrParents.push(this)}const subscriptions=this._subscriptions;return null===subscriptions?this._subscriptions=[subscription]:subscriptions.push(subscription),subscription}remove(subscription){const subscriptions=this._subscriptions;if(subscriptions){const subscriptionIndex=subscriptions.indexOf(subscription);-1!==subscriptionIndex&&subscriptions.splice(subscriptionIndex,1)}}}return Subscription.EMPTY=function(empty){return empty.closed=!0,empty}(new Subscription),Subscription})();function flattenUnsubscriptionErrors(errors){return errors.reduce((errs,err)=>errs.concat(err instanceof UnsubscriptionError?err.errors:err),[])}const rxSubscriber=(()=>\"function\"==typeof Symbol?Symbol(\"rxSubscriber\"):\"@@rxSubscriber_\"+Math.random())();class Subscriber_Subscriber extends Subscription_Subscription{constructor(destinationOrNext,error,complete){switch(super(),this.syncErrorValue=null,this.syncErrorThrown=!1,this.syncErrorThrowable=!1,this.isStopped=!1,arguments.length){case 0:this.destination=empty;break;case 1:if(!destinationOrNext){this.destination=empty;break}if(\"object\"==typeof destinationOrNext){destinationOrNext instanceof Subscriber_Subscriber?(this.syncErrorThrowable=destinationOrNext.syncErrorThrowable,this.destination=destinationOrNext,destinationOrNext.add(this)):(this.syncErrorThrowable=!0,this.destination=new Subscriber_SafeSubscriber(this,destinationOrNext));break}default:this.syncErrorThrowable=!0,this.destination=new Subscriber_SafeSubscriber(this,destinationOrNext,error,complete)}}[rxSubscriber](){return this}static create(next,error,complete){const subscriber=new Subscriber_Subscriber(next,error,complete);return subscriber.syncErrorThrowable=!1,subscriber}next(value){this.isStopped||this._next(value)}error(err){this.isStopped||(this.isStopped=!0,this._error(err))}complete(){this.isStopped||(this.isStopped=!0,this._complete())}unsubscribe(){this.closed||(this.isStopped=!0,super.unsubscribe())}_next(value){this.destination.next(value)}_error(err){this.destination.error(err),this.unsubscribe()}_complete(){this.destination.complete(),this.unsubscribe()}_unsubscribeAndRecycle(){const{_parentOrParents:_parentOrParents}=this;return this._parentOrParents=null,this.unsubscribe(),this.closed=!1,this.isStopped=!1,this._parentOrParents=_parentOrParents,this}}class Subscriber_SafeSubscriber extends Subscriber_Subscriber{constructor(_parentSubscriber,observerOrNext,error,complete){let next;super(),this._parentSubscriber=_parentSubscriber;let context=this;isFunction(observerOrNext)?next=observerOrNext:observerOrNext&&(next=observerOrNext.next,error=observerOrNext.error,complete=observerOrNext.complete,observerOrNext!==empty&&(context=Object.create(observerOrNext),isFunction(context.unsubscribe)&&this.add(context.unsubscribe.bind(context)),context.unsubscribe=this.unsubscribe.bind(this))),this._context=context,this._next=next,this._error=error,this._complete=complete}next(value){if(!this.isStopped&&this._next){const{_parentSubscriber:_parentSubscriber}=this;config_config.useDeprecatedSynchronousErrorHandling&&_parentSubscriber.syncErrorThrowable?this.__tryOrSetError(_parentSubscriber,this._next,value)&&this.unsubscribe():this.__tryOrUnsub(this._next,value)}}error(err){if(!this.isStopped){const{_parentSubscriber:_parentSubscriber}=this,{useDeprecatedSynchronousErrorHandling:useDeprecatedSynchronousErrorHandling}=config_config;if(this._error)useDeprecatedSynchronousErrorHandling&&_parentSubscriber.syncErrorThrowable?(this.__tryOrSetError(_parentSubscriber,this._error,err),this.unsubscribe()):(this.__tryOrUnsub(this._error,err),this.unsubscribe());else if(_parentSubscriber.syncErrorThrowable)useDeprecatedSynchronousErrorHandling?(_parentSubscriber.syncErrorValue=err,_parentSubscriber.syncErrorThrown=!0):hostReportError(err),this.unsubscribe();else{if(this.unsubscribe(),useDeprecatedSynchronousErrorHandling)throw err;hostReportError(err)}}}complete(){if(!this.isStopped){const{_parentSubscriber:_parentSubscriber}=this;if(this._complete){const wrappedComplete=()=>this._complete.call(this._context);config_config.useDeprecatedSynchronousErrorHandling&&_parentSubscriber.syncErrorThrowable?(this.__tryOrSetError(_parentSubscriber,wrappedComplete),this.unsubscribe()):(this.__tryOrUnsub(wrappedComplete),this.unsubscribe())}else this.unsubscribe()}}__tryOrUnsub(fn,value){try{fn.call(this._context,value)}catch(err){if(this.unsubscribe(),config_config.useDeprecatedSynchronousErrorHandling)throw err;hostReportError(err)}}__tryOrSetError(parent,fn,value){if(!config_config.useDeprecatedSynchronousErrorHandling)throw new Error(\"bad call\");try{fn.call(this._context,value)}catch(err){return config_config.useDeprecatedSynchronousErrorHandling?(parent.syncErrorValue=err,parent.syncErrorThrown=!0,!0):(hostReportError(err),!0)}return!1}_unsubscribe(){const{_parentSubscriber:_parentSubscriber}=this;this._context=null,this._parentSubscriber=null,_parentSubscriber.unsubscribe()}}const observable_observable=(()=>\"function\"==typeof Symbol&&Symbol.observable||\"@@observable\")();function identity(x){return x}function pipe(...fns){return pipeFromArray(fns)}function pipeFromArray(fns){return 0===fns.length?identity:1===fns.length?fns[0]:function(input){return fns.reduce((prev,fn)=>fn(prev),input)}}let Observable_Observable=(()=>{class Observable{constructor(subscribe){this._isScalar=!1,subscribe&&(this._subscribe=subscribe)}lift(operator){const observable=new Observable;return observable.source=this,observable.operator=operator,observable}subscribe(observerOrNext,error,complete){const{operator:operator}=this,sink=function(nextOrObserver,error,complete){if(nextOrObserver){if(nextOrObserver instanceof Subscriber_Subscriber)return nextOrObserver;if(nextOrObserver[rxSubscriber])return nextOrObserver[rxSubscriber]()}return nextOrObserver||error||complete?new Subscriber_Subscriber(nextOrObserver,error,complete):new Subscriber_Subscriber(empty)}(observerOrNext,error,complete);if(sink.add(operator?operator.call(sink,this.source):this.source||config_config.useDeprecatedSynchronousErrorHandling&&!sink.syncErrorThrowable?this._subscribe(sink):this._trySubscribe(sink)),config_config.useDeprecatedSynchronousErrorHandling&&sink.syncErrorThrowable&&(sink.syncErrorThrowable=!1,sink.syncErrorThrown))throw sink.syncErrorValue;return sink}_trySubscribe(sink){try{return this._subscribe(sink)}catch(err){config_config.useDeprecatedSynchronousErrorHandling&&(sink.syncErrorThrown=!0,sink.syncErrorValue=err),function(observer){for(;observer;){const{closed:closed,destination:destination,isStopped:isStopped}=observer;if(closed||isStopped)return!1;observer=destination&&destination instanceof Subscriber_Subscriber?destination:null}return!0}(sink)?sink.error(err):console.warn(err)}}forEach(next,promiseCtor){return new(promiseCtor=getPromiseCtor(promiseCtor))((resolve,reject)=>{let subscription;subscription=this.subscribe(value=>{try{next(value)}catch(err){reject(err),subscription&&subscription.unsubscribe()}},reject,resolve)})}_subscribe(subscriber){const{source:source}=this;return source&&source.subscribe(subscriber)}[observable_observable](){return this}pipe(...operations){return 0===operations.length?this:pipeFromArray(operations)(this)}toPromise(promiseCtor){return new(promiseCtor=getPromiseCtor(promiseCtor))((resolve,reject)=>{let value;this.subscribe(x=>value=x,err=>reject(err),()=>resolve(value))})}}return Observable.create=subscribe=>new Observable(subscribe),Observable})();function getPromiseCtor(promiseCtor){if(promiseCtor||(promiseCtor=config_config.Promise||Promise),!promiseCtor)throw new Error(\"no Promise impl found\");return promiseCtor}const ObjectUnsubscribedError=(()=>{function ObjectUnsubscribedErrorImpl(){return Error.call(this),this.message=\"object unsubscribed\",this.name=\"ObjectUnsubscribedError\",this}return ObjectUnsubscribedErrorImpl.prototype=Object.create(Error.prototype),ObjectUnsubscribedErrorImpl})();class SubjectSubscription_SubjectSubscription extends Subscription_Subscription{constructor(subject,subscriber){super(),this.subject=subject,this.subscriber=subscriber,this.closed=!1}unsubscribe(){if(this.closed)return;this.closed=!0;const subject=this.subject,observers=subject.observers;if(this.subject=null,!observers||0===observers.length||subject.isStopped||subject.closed)return;const subscriberIndex=observers.indexOf(this.subscriber);-1!==subscriberIndex&&observers.splice(subscriberIndex,1)}}class Subject_SubjectSubscriber extends Subscriber_Subscriber{constructor(destination){super(destination),this.destination=destination}}let Subject_Subject=(()=>{class Subject extends Observable_Observable{constructor(){super(),this.observers=[],this.closed=!1,this.isStopped=!1,this.hasError=!1,this.thrownError=null}[rxSubscriber](){return new Subject_SubjectSubscriber(this)}lift(operator){const subject=new Subject_AnonymousSubject(this,this);return subject.operator=operator,subject}next(value){if(this.closed)throw new ObjectUnsubscribedError;if(!this.isStopped){const{observers:observers}=this,len=observers.length,copy=observers.slice();for(let i=0;i<len;i++)copy[i].next(value)}}error(err){if(this.closed)throw new ObjectUnsubscribedError;this.hasError=!0,this.thrownError=err,this.isStopped=!0;const{observers:observers}=this,len=observers.length,copy=observers.slice();for(let i=0;i<len;i++)copy[i].error(err);this.observers.length=0}complete(){if(this.closed)throw new ObjectUnsubscribedError;this.isStopped=!0;const{observers:observers}=this,len=observers.length,copy=observers.slice();for(let i=0;i<len;i++)copy[i].complete();this.observers.length=0}unsubscribe(){this.isStopped=!0,this.closed=!0,this.observers=null}_trySubscribe(subscriber){if(this.closed)throw new ObjectUnsubscribedError;return super._trySubscribe(subscriber)}_subscribe(subscriber){if(this.closed)throw new ObjectUnsubscribedError;return this.hasError?(subscriber.error(this.thrownError),Subscription_Subscription.EMPTY):this.isStopped?(subscriber.complete(),Subscription_Subscription.EMPTY):(this.observers.push(subscriber),new SubjectSubscription_SubjectSubscription(this,subscriber))}asObservable(){const observable=new Observable_Observable;return observable.source=this,observable}}return Subject.create=(destination,source)=>new Subject_AnonymousSubject(destination,source),Subject})();class Subject_AnonymousSubject extends Subject_Subject{constructor(destination,source){super(),this.destination=destination,this.source=source}next(value){const{destination:destination}=this;destination&&destination.next&&destination.next(value)}error(err){const{destination:destination}=this;destination&&destination.error&&this.destination.error(err)}complete(){const{destination:destination}=this;destination&&destination.complete&&this.destination.complete()}_subscribe(subscriber){const{source:source}=this;return source?this.source.subscribe(subscriber):Subscription_Subscription.EMPTY}}function isScheduler(value){return value&&\"function\"==typeof value.schedule}class InnerSubscriber_InnerSubscriber extends Subscriber_Subscriber{constructor(parent,outerValue,outerIndex){super(),this.parent=parent,this.outerValue=outerValue,this.outerIndex=outerIndex,this.index=0}_next(value){this.parent.notifyNext(this.outerValue,value,this.outerIndex,this.index++,this)}_error(error){this.parent.notifyError(error,this),this.unsubscribe()}_complete(){this.parent.notifyComplete(this),this.unsubscribe()}}const subscribeToArray=array=>subscriber=>{for(let i=0,len=array.length;i<len&&!subscriber.closed;i++)subscriber.next(array[i]);subscriber.complete()};function getSymbolIterator(){return\"function\"==typeof Symbol&&Symbol.iterator?Symbol.iterator:\"@@iterator\"}const iterator_iterator=getSymbolIterator(),isArrayLike=x=>x&&\"number\"==typeof x.length&&\"function\"!=typeof x;function isPromise(value){return!!value&&\"function\"!=typeof value.subscribe&&\"function\"==typeof value.then}const subscribeTo=result=>{if(result&&\"function\"==typeof result[observable_observable])return obj=result,subscriber=>{const obs=obj[observable_observable]();if(\"function\"!=typeof obs.subscribe)throw new TypeError(\"Provided object does not correctly implement Symbol.observable\");return obs.subscribe(subscriber)};if(isArrayLike(result))return subscribeToArray(result);if(isPromise(result))return promise=result,subscriber=>(promise.then(value=>{subscriber.closed||(subscriber.next(value),subscriber.complete())},err=>subscriber.error(err)).then(null,hostReportError),subscriber);if(result&&\"function\"==typeof result[iterator_iterator])return iterable=result,subscriber=>{const iterator=iterable[iterator_iterator]();for(;;){const item=iterator.next();if(item.done){subscriber.complete();break}if(subscriber.next(item.value),subscriber.closed)break}return\"function\"==typeof iterator.return&&subscriber.add(()=>{iterator.return&&iterator.return()}),subscriber};{const value=isObject(result)?\"an invalid object\":`'${result}'`;throw new TypeError(`You provided ${value} where a stream was expected. You can provide an Observable, Promise, Array, or Iterable.`)}var iterable,promise,obj};function subscribeToResult(outerSubscriber,result,outerValue,outerIndex,innerSubscriber=new InnerSubscriber_InnerSubscriber(outerSubscriber,outerValue,outerIndex)){if(!innerSubscriber.closed)return result instanceof Observable_Observable?result.subscribe(innerSubscriber):subscribeTo(result)(innerSubscriber)}class OuterSubscriber_OuterSubscriber extends Subscriber_Subscriber{notifyNext(outerValue,innerValue,outerIndex,innerIndex,innerSub){this.destination.next(innerValue)}notifyError(error,innerSub){this.destination.error(error)}notifyComplete(innerSub){this.destination.complete()}}function map(project,thisArg){return function(source){if(\"function\"!=typeof project)throw new TypeError(\"argument is not a function. Are you looking for `mapTo()`?\");return source.lift(new MapOperator(project,thisArg))}}class MapOperator{constructor(project,thisArg){this.project=project,this.thisArg=thisArg}call(subscriber,source){return source.subscribe(new map_MapSubscriber(subscriber,this.project,this.thisArg))}}class map_MapSubscriber extends Subscriber_Subscriber{constructor(destination,project,thisArg){super(destination),this.project=project,this.count=0,this.thisArg=thisArg||this}_next(value){let result;try{result=this.project.call(this.thisArg,value,this.count++)}catch(err){return void this.destination.error(err)}this.destination.next(result)}}function scheduleArray(input,scheduler){return new Observable_Observable(subscriber=>{const sub=new Subscription_Subscription;let i=0;return sub.add(scheduler.schedule((function(){i!==input.length?(subscriber.next(input[i++]),subscriber.closed||sub.add(this.schedule())):subscriber.complete()}))),sub})}function from(input,scheduler){return scheduler?function(input,scheduler){if(null!=input){if(function(input){return input&&\"function\"==typeof input[observable_observable]}(input))return function(input,scheduler){return new Observable_Observable(subscriber=>{const sub=new Subscription_Subscription;return sub.add(scheduler.schedule(()=>{const observable=input[observable_observable]();sub.add(observable.subscribe({next(value){sub.add(scheduler.schedule(()=>subscriber.next(value)))},error(err){sub.add(scheduler.schedule(()=>subscriber.error(err)))},complete(){sub.add(scheduler.schedule(()=>subscriber.complete()))}}))})),sub})}(input,scheduler);if(isPromise(input))return function(input,scheduler){return new Observable_Observable(subscriber=>{const sub=new Subscription_Subscription;return sub.add(scheduler.schedule(()=>input.then(value=>{sub.add(scheduler.schedule(()=>{subscriber.next(value),sub.add(scheduler.schedule(()=>subscriber.complete()))}))},err=>{sub.add(scheduler.schedule(()=>subscriber.error(err)))}))),sub})}(input,scheduler);if(isArrayLike(input))return scheduleArray(input,scheduler);if(function(input){return input&&\"function\"==typeof input[iterator_iterator]}(input)||\"string\"==typeof input)return function(input,scheduler){if(!input)throw new Error(\"Iterable cannot be null\");return new Observable_Observable(subscriber=>{const sub=new Subscription_Subscription;let iterator;return sub.add(()=>{iterator&&\"function\"==typeof iterator.return&&iterator.return()}),sub.add(scheduler.schedule(()=>{iterator=input[iterator_iterator](),sub.add(scheduler.schedule((function(){if(subscriber.closed)return;let value,done;try{const result=iterator.next();value=result.value,done=result.done}catch(err){return void subscriber.error(err)}done?subscriber.complete():(subscriber.next(value),this.schedule())})))})),sub})}(input,scheduler)}throw new TypeError((null!==input&&typeof input||input)+\" is not observable\")}(input,scheduler):input instanceof Observable_Observable?input:new Observable_Observable(subscribeTo(input))}function mergeMap(project,resultSelector,concurrent=Number.POSITIVE_INFINITY){return\"function\"==typeof resultSelector?source=>source.pipe(mergeMap((a,i)=>from(project(a,i)).pipe(map((b,ii)=>resultSelector(a,b,i,ii))),concurrent)):(\"number\"==typeof resultSelector&&(concurrent=resultSelector),source=>source.lift(new MergeMapOperator(project,concurrent)))}class MergeMapOperator{constructor(project,concurrent=Number.POSITIVE_INFINITY){this.project=project,this.concurrent=concurrent}call(observer,source){return source.subscribe(new mergeMap_MergeMapSubscriber(observer,this.project,this.concurrent))}}class mergeMap_MergeMapSubscriber extends OuterSubscriber_OuterSubscriber{constructor(destination,project,concurrent=Number.POSITIVE_INFINITY){super(destination),this.project=project,this.concurrent=concurrent,this.hasCompleted=!1,this.buffer=[],this.active=0,this.index=0}_next(value){this.active<this.concurrent?this._tryNext(value):this.buffer.push(value)}_tryNext(value){let result;const index=this.index++;try{result=this.project(value,index)}catch(err){return void this.destination.error(err)}this.active++,this._innerSub(result,value,index)}_innerSub(ish,value,index){const innerSubscriber=new InnerSubscriber_InnerSubscriber(this,value,index),destination=this.destination;destination.add(innerSubscriber);const innerSubscription=subscribeToResult(this,ish,void 0,void 0,innerSubscriber);innerSubscription!==innerSubscriber&&destination.add(innerSubscription)}_complete(){this.hasCompleted=!0,0===this.active&&0===this.buffer.length&&this.destination.complete(),this.unsubscribe()}notifyNext(outerValue,innerValue,outerIndex,innerIndex,innerSub){this.destination.next(innerValue)}notifyComplete(innerSub){const buffer=this.buffer;this.remove(innerSub),this.active--,buffer.length>0?this._next(buffer.shift()):0===this.active&&this.hasCompleted&&this.destination.complete()}}function mergeAll(concurrent=Number.POSITIVE_INFINITY){return mergeMap(identity,concurrent)}function fromArray(input,scheduler){return scheduler?scheduleArray(input,scheduler):new Observable_Observable(subscribeToArray(input))}function merge(...observables){let concurrent=Number.POSITIVE_INFINITY,scheduler=null,last=observables[observables.length-1];return isScheduler(last)?(scheduler=observables.pop(),observables.length>1&&\"number\"==typeof observables[observables.length-1]&&(concurrent=observables.pop())):\"number\"==typeof last&&(concurrent=observables.pop()),null===scheduler&&1===observables.length&&observables[0]instanceof Observable_Observable?observables[0]:mergeAll(concurrent)(fromArray(observables,scheduler))}function refCount_refCount(){return function(source){return source.lift(new RefCountOperator(source))}}class RefCountOperator{constructor(connectable){this.connectable=connectable}call(subscriber,source){const{connectable:connectable}=this;connectable._refCount++;const refCounter=new refCount_RefCountSubscriber(subscriber,connectable),subscription=source.subscribe(refCounter);return refCounter.closed||(refCounter.connection=connectable.connect()),subscription}}class refCount_RefCountSubscriber extends Subscriber_Subscriber{constructor(destination,connectable){super(destination),this.connectable=connectable}_unsubscribe(){const{connectable:connectable}=this;if(!connectable)return void(this.connection=null);this.connectable=null;const refCount=connectable._refCount;if(refCount<=0)return void(this.connection=null);if(connectable._refCount=refCount-1,refCount>1)return void(this.connection=null);const{connection:connection}=this,sharedConnection=connectable._connection;this.connection=null,!sharedConnection||connection&&sharedConnection!==connection||sharedConnection.unsubscribe()}}class ConnectableObservable_ConnectableObservable extends Observable_Observable{constructor(source,subjectFactory){super(),this.source=source,this.subjectFactory=subjectFactory,this._refCount=0,this._isComplete=!1}_subscribe(subscriber){return this.getSubject().subscribe(subscriber)}getSubject(){const subject=this._subject;return subject&&!subject.isStopped||(this._subject=this.subjectFactory()),this._subject}connect(){let connection=this._connection;return connection||(this._isComplete=!1,connection=this._connection=new Subscription_Subscription,connection.add(this.source.subscribe(new ConnectableObservable_ConnectableSubscriber(this.getSubject(),this))),connection.closed&&(this._connection=null,connection=Subscription_Subscription.EMPTY)),connection}refCount(){return refCount_refCount()(this)}}const connectableObservableDescriptor=(()=>{const connectableProto=ConnectableObservable_ConnectableObservable.prototype;return{operator:{value:null},_refCount:{value:0,writable:!0},_subject:{value:null,writable:!0},_connection:{value:null,writable:!0},_subscribe:{value:connectableProto._subscribe},_isComplete:{value:connectableProto._isComplete,writable:!0},getSubject:{value:connectableProto.getSubject},connect:{value:connectableProto.connect},refCount:{value:connectableProto.refCount}}})();class ConnectableObservable_ConnectableSubscriber extends Subject_SubjectSubscriber{constructor(destination,connectable){super(destination),this.connectable=connectable}_error(err){this._unsubscribe(),super._error(err)}_complete(){this.connectable._isComplete=!0,this._unsubscribe(),super._complete()}_unsubscribe(){const connectable=this.connectable;if(connectable){this.connectable=null;const connection=connectable._connection;connectable._refCount=0,connectable._subject=null,connectable._connection=null,connection&&connection.unsubscribe()}}}function shareSubjectFactory(){return new Subject_Subject}function share(){return source=>{return refCount_refCount()((subjectOrSubjectFactory=shareSubjectFactory,function(source){let subjectFactory;subjectFactory=\"function\"==typeof subjectOrSubjectFactory?subjectOrSubjectFactory:function(){return subjectOrSubjectFactory};const connectable=Object.create(source,connectableObservableDescriptor);return connectable.source=source,connectable.subjectFactory=subjectFactory,connectable})(source));var subjectOrSubjectFactory}}function noSideEffects(fn){return{toString:fn}.toString()}function makeParamDecorator(name,props,parentClass){return noSideEffects(()=>{const metaCtor=function(props){return function(...args){if(props){const values=props(...args);for(const propName in values)this[propName]=values[propName]}}}(props);function ParamDecoratorFactory(...args){if(this instanceof ParamDecoratorFactory)return metaCtor.apply(this,args),this;const annotationInstance=new ParamDecoratorFactory(...args);return ParamDecorator.annotation=annotationInstance,ParamDecorator;function ParamDecorator(cls,unusedKey,index){const parameters=cls.hasOwnProperty(\"__parameters__\")?cls.__parameters__:Object.defineProperty(cls,\"__parameters__\",{value:[]}).__parameters__;for(;parameters.length<=index;)parameters.push(null);return(parameters[index]=parameters[index]||[]).push(annotationInstance),cls}}return parentClass&&(ParamDecoratorFactory.prototype=Object.create(parentClass.prototype)),ParamDecoratorFactory.prototype.ngMetadataName=name,ParamDecoratorFactory.annotationCls=ParamDecoratorFactory,ParamDecoratorFactory})}const Inject=makeParamDecorator(\"Inject\",token=>({token:token})),Optional=makeParamDecorator(\"Optional\"),Self=makeParamDecorator(\"Self\"),SkipSelf=makeParamDecorator(\"SkipSelf\");var InjectFlags=function(InjectFlags){return InjectFlags[InjectFlags.Default=0]=\"Default\",InjectFlags[InjectFlags.Host=1]=\"Host\",InjectFlags[InjectFlags.Self=2]=\"Self\",InjectFlags[InjectFlags.SkipSelf=4]=\"SkipSelf\",InjectFlags[InjectFlags.Optional=8]=\"Optional\",InjectFlags}({});function getClosureSafeProperty(objWithPropertyToExtract){for(let key in objWithPropertyToExtract)if(objWithPropertyToExtract[key]===getClosureSafeProperty)return key;throw Error(\"Could not find renamed property on target object.\")}function fillProperties(target,source){for(const key in source)source.hasOwnProperty(key)&&!target.hasOwnProperty(key)&&(target[key]=source[key])}function ɵɵdefineInjectable(opts){return{token:opts.token,providedIn:opts.providedIn||null,factory:opts.factory,value:void 0}}function ɵɵdefineInjector(options){return{factory:options.factory,providers:options.providers||[],imports:options.imports||[]}}function getInjectableDef(type){return getOwnDefinition(type,type[NG_PROV_DEF])||getOwnDefinition(type,type[NG_INJECTABLE_DEF])}function getOwnDefinition(type,def){return def&&def.token===type?def:null}function getInjectorDef(type){return type&&(type.hasOwnProperty(NG_INJ_DEF)||type.hasOwnProperty(NG_INJECTOR_DEF))?type[NG_INJ_DEF]:null}const NG_PROV_DEF=getClosureSafeProperty({\"ɵprov\":getClosureSafeProperty}),NG_INJ_DEF=getClosureSafeProperty({\"ɵinj\":getClosureSafeProperty}),NG_PROV_DEF_FALLBACK=getClosureSafeProperty({\"ɵprovFallback\":getClosureSafeProperty}),NG_INJECTABLE_DEF=getClosureSafeProperty({ngInjectableDef:getClosureSafeProperty}),NG_INJECTOR_DEF=getClosureSafeProperty({ngInjectorDef:getClosureSafeProperty});function stringify(token){if(\"string\"==typeof token)return token;if(Array.isArray(token))return\"[\"+token.map(stringify).join(\", \")+\"]\";if(null==token)return\"\"+token;if(token.overriddenName)return\"\"+token.overriddenName;if(token.name)return\"\"+token.name;const res=token.toString();if(null==res)return\"\"+res;const newLineIndex=res.indexOf(\"\\n\");return-1===newLineIndex?res:res.substring(0,newLineIndex)}function concatStringsWithSpace(before,after){return null==before||\"\"===before?null===after?\"\":after:null==after||\"\"===after?before:before+\" \"+after}const __forward_ref__=getClosureSafeProperty({__forward_ref__:getClosureSafeProperty});function forwardRef(forwardRefFn){return forwardRefFn.__forward_ref__=forwardRef,forwardRefFn.toString=function(){return stringify(this())},forwardRefFn}function resolveForwardRef(type){return isForwardRef(type)?type():type}function isForwardRef(fn){return\"function\"==typeof fn&&fn.hasOwnProperty(__forward_ref__)&&fn.__forward_ref__===forwardRef}const __globalThis=\"undefined\"!=typeof globalThis&&globalThis,__window=\"undefined\"!=typeof window&&window,__self=\"undefined\"!=typeof self&&\"undefined\"!=typeof WorkerGlobalScope&&self instanceof WorkerGlobalScope&&self,__global=\"undefined\"!=typeof global&&global,_global=__globalThis||__global||__window||__self,NG_COMP_DEF=getClosureSafeProperty({\"ɵcmp\":getClosureSafeProperty}),NG_DIR_DEF=getClosureSafeProperty({\"ɵdir\":getClosureSafeProperty}),NG_PIPE_DEF=getClosureSafeProperty({\"ɵpipe\":getClosureSafeProperty}),NG_MOD_DEF=getClosureSafeProperty({\"ɵmod\":getClosureSafeProperty}),NG_LOC_ID_DEF=getClosureSafeProperty({\"ɵloc\":getClosureSafeProperty}),NG_FACTORY_DEF=getClosureSafeProperty({\"ɵfac\":getClosureSafeProperty}),NG_ELEMENT_ID=getClosureSafeProperty({__NG_ELEMENT_ID__:getClosureSafeProperty});class InjectionToken{constructor(_desc,options){this._desc=_desc,this.ngMetadataName=\"InjectionToken\",this.ɵprov=void 0,\"number\"==typeof options?this.__NG_ELEMENT_ID__=options:void 0!==options&&(this.ɵprov=ɵɵdefineInjectable({token:this,providedIn:options.providedIn||\"root\",factory:options.factory}))}toString(){return\"InjectionToken \"+this._desc}}const INJECTOR=new InjectionToken(\"INJECTOR\",-1),THROW_IF_NOT_FOUND={},NEW_LINE=/\\n/gm,USE_VALUE=getClosureSafeProperty({provide:String,useValue:getClosureSafeProperty});let _injectImplementation,_currentInjector=void 0;function setCurrentInjector(injector){const former=_currentInjector;return _currentInjector=injector,former}function setInjectImplementation(impl){const previous=_injectImplementation;return _injectImplementation=impl,previous}function injectInjectorOnly(token,flags=InjectFlags.Default){if(void 0===_currentInjector)throw new Error(\"inject() must be called from an injection context\");return null===_currentInjector?injectRootLimpMode(token,void 0,flags):_currentInjector.get(token,flags&InjectFlags.Optional?null:void 0,flags)}function ɵɵinject(token,flags=InjectFlags.Default){return(_injectImplementation||injectInjectorOnly)(resolveForwardRef(token),flags)}function injectRootLimpMode(token,notFoundValue,flags){const injectableDef=getInjectableDef(token);if(injectableDef&&\"root\"==injectableDef.providedIn)return void 0===injectableDef.value?injectableDef.value=injectableDef.factory():injectableDef.value;if(flags&InjectFlags.Optional)return null;if(void 0!==notFoundValue)return notFoundValue;throw new Error(`Injector: NOT_FOUND [${stringify(token)}]`)}function injectArgs(types){const args=[];for(let i=0;i<types.length;i++){const arg=resolveForwardRef(types[i]);if(Array.isArray(arg)){if(0===arg.length)throw new Error(\"Arguments array must have arguments.\");let type=void 0,flags=InjectFlags.Default;for(let j=0;j<arg.length;j++){const meta=arg[j];meta instanceof Optional||\"Optional\"===meta.ngMetadataName||meta===Optional?flags|=InjectFlags.Optional:meta instanceof SkipSelf||\"SkipSelf\"===meta.ngMetadataName||meta===SkipSelf?flags|=InjectFlags.SkipSelf:meta instanceof Self||\"Self\"===meta.ngMetadataName||meta===Self?flags|=InjectFlags.Self:type=meta instanceof Inject||meta===Inject?meta.token:meta}args.push(ɵɵinject(type,flags))}else args.push(ɵɵinject(arg))}return args}class NullInjector{get(token,notFoundValue=THROW_IF_NOT_FOUND){if(notFoundValue===THROW_IF_NOT_FOUND){const error=new Error(`NullInjectorError: No provider for ${stringify(token)}!`);throw error.name=\"NullInjectorError\",error}return notFoundValue}}class NgModuleRef{}class NgModuleFactory{}function deepForEach(input,fn){input.forEach(value=>Array.isArray(value)?deepForEach(value,fn):fn(value))}function addToArray(arr,index,value){index>=arr.length?arr.push(value):arr.splice(index,0,value)}function removeFromArray(arr,index){return index>=arr.length-1?arr.pop():arr.splice(index,1)[0]}function keyValueArraySet(keyValueArray,key,value){let index=keyValueArrayIndexOf(keyValueArray,key);return index>=0?keyValueArray[1|index]=value:(index=~index,function(array,index,value1,value2){let end=array.length;if(end==index)array.push(value1,value2);else if(1===end)array.push(value2,array[0]),array[0]=value1;else{for(end--,array.push(array[end-1],array[end]);end>index;)array[end]=array[end-2],end--;array[index]=value1,array[index+1]=value2}}(keyValueArray,index,key,value)),index}function keyValueArrayGet(keyValueArray,key){const index=keyValueArrayIndexOf(keyValueArray,key);if(index>=0)return keyValueArray[1|index]}function keyValueArrayIndexOf(keyValueArray,key){return function(array,value,shift){let start=0,end=array.length>>1;for(;end!==start;){const middle=start+(end-start>>1),current=array[middle<<1];if(value===current)return middle<<1;current>value?end=middle:start=middle+1}return~(end<<1)}(keyValueArray,key)}const ChangeDetectionStrategy=function(){var ChangeDetectionStrategy={OnPush:0,Default:1};return ChangeDetectionStrategy[ChangeDetectionStrategy.OnPush]=\"OnPush\",ChangeDetectionStrategy[ChangeDetectionStrategy.Default]=\"Default\",ChangeDetectionStrategy}(),ViewEncapsulation$1=function(){var ViewEncapsulation$1={Emulated:0,Native:1,None:2,ShadowDom:3};return ViewEncapsulation$1[ViewEncapsulation$1.Emulated]=\"Emulated\",ViewEncapsulation$1[ViewEncapsulation$1.Native]=\"Native\",ViewEncapsulation$1[ViewEncapsulation$1.None]=\"None\",ViewEncapsulation$1[ViewEncapsulation$1.ShadowDom]=\"ShadowDom\",ViewEncapsulation$1}(),EMPTY_OBJ={},EMPTY_ARRAY=[];let _renderCompCount=0;function ɵɵdefineComponent(componentDefinition){return noSideEffects(()=>{const type=componentDefinition.type,typePrototype=type.prototype,declaredInputs={},def={type:type,providersResolver:null,decls:componentDefinition.decls,vars:componentDefinition.vars,factory:null,template:componentDefinition.template||null,consts:componentDefinition.consts||null,ngContentSelectors:componentDefinition.ngContentSelectors,hostBindings:componentDefinition.hostBindings||null,hostVars:componentDefinition.hostVars||0,hostAttrs:componentDefinition.hostAttrs||null,contentQueries:componentDefinition.contentQueries||null,declaredInputs:declaredInputs,inputs:null,outputs:null,exportAs:componentDefinition.exportAs||null,onChanges:null,onInit:typePrototype.ngOnInit||null,doCheck:typePrototype.ngDoCheck||null,afterContentInit:typePrototype.ngAfterContentInit||null,afterContentChecked:typePrototype.ngAfterContentChecked||null,afterViewInit:typePrototype.ngAfterViewInit||null,afterViewChecked:typePrototype.ngAfterViewChecked||null,onDestroy:typePrototype.ngOnDestroy||null,onPush:componentDefinition.changeDetection===ChangeDetectionStrategy.OnPush,directiveDefs:null,pipeDefs:null,selectors:componentDefinition.selectors||EMPTY_ARRAY,viewQuery:componentDefinition.viewQuery||null,features:componentDefinition.features||null,data:componentDefinition.data||{},encapsulation:componentDefinition.encapsulation||ViewEncapsulation$1.Emulated,id:\"c\",styles:componentDefinition.styles||EMPTY_ARRAY,_:null,setInput:null,schemas:componentDefinition.schemas||null,tView:null},directiveTypes=componentDefinition.directives,feature=componentDefinition.features,pipeTypes=componentDefinition.pipes;return def.id+=_renderCompCount++,def.inputs=invertObject(componentDefinition.inputs,declaredInputs),def.outputs=invertObject(componentDefinition.outputs),feature&&feature.forEach(fn=>fn(def)),def.directiveDefs=directiveTypes?()=>(\"function\"==typeof directiveTypes?directiveTypes():directiveTypes).map(extractDirectiveDef):null,def.pipeDefs=pipeTypes?()=>(\"function\"==typeof pipeTypes?pipeTypes():pipeTypes).map(extractPipeDef):null,def})}function extractDirectiveDef(type){return getComponentDef(type)||function(type){return type[NG_DIR_DEF]||null}(type)}function extractPipeDef(type){return function(type){return type[NG_PIPE_DEF]||null}(type)}const autoRegisterModuleById={};function ɵɵdefineNgModule(def){const res={type:def.type,bootstrap:def.bootstrap||EMPTY_ARRAY,declarations:def.declarations||EMPTY_ARRAY,imports:def.imports||EMPTY_ARRAY,exports:def.exports||EMPTY_ARRAY,transitiveCompileScopes:null,schemas:def.schemas||null,id:def.id||null};return null!=def.id&&noSideEffects(()=>{autoRegisterModuleById[def.id]=def.type}),res}function invertObject(obj,secondary){if(null==obj)return EMPTY_OBJ;const newLookup={};for(const minifiedKey in obj)if(obj.hasOwnProperty(minifiedKey)){let publicName=obj[minifiedKey],declaredName=publicName;Array.isArray(publicName)&&(declaredName=publicName[1],publicName=publicName[0]),newLookup[publicName]=minifiedKey,secondary&&(secondary[publicName]=declaredName)}return newLookup}const ɵɵdefineDirective=ɵɵdefineComponent;function getComponentDef(type){return type[NG_COMP_DEF]||null}function getFactoryDef(type,throwNotFound){return type.hasOwnProperty(NG_FACTORY_DEF)?type[NG_FACTORY_DEF]:null}function getNgModuleDef(type,throwNotFound){const ngModuleDef=type[NG_MOD_DEF]||null;if(!ngModuleDef&&!0===throwNotFound)throw new Error(`Type ${stringify(type)} does not have 'ɵmod' property.`);return ngModuleDef}function isLView(value){return Array.isArray(value)&&\"object\"==typeof value[1]}function isLContainer(value){return Array.isArray(value)&&!0===value[1]}function isContentQueryHost(tNode){return 0!=(8&tNode.flags)}function isComponentHost(tNode){return 2==(2&tNode.flags)}function isDirectiveHost(tNode){return 1==(1&tNode.flags)}function isComponentDef(def){return null!==def.template}function isRootView(target){return 0!=(512&target[2])}let DOCUMENT=void 0;function getDocument(){return void 0!==DOCUMENT?DOCUMENT:\"undefined\"!=typeof document?document:void 0}function isProceduralRenderer(renderer){return!!renderer.listen}const domRendererFactory3={createRenderer:(hostElement,rendererType)=>getDocument()};function unwrapRNode(value){for(;Array.isArray(value);)value=value[0];return value}function getNativeByIndex(index,lView){return unwrapRNode(lView[index+19])}function getNativeByTNode(tNode,lView){return unwrapRNode(lView[tNode.index])}function getTNode(tView,index){return tView.data[index+19]}function getComponentLViewByIndex(nodeIndex,hostView){const slotValue=hostView[nodeIndex];return isLView(slotValue)?slotValue:slotValue[0]}function readPatchedLView(target){const value=function(target){return target.__ngContext__||null}(target);return value?Array.isArray(value)?value:value.lView:null}function viewAttachedToChangeDetector(view){return 128==(128&view[2])}function getConstant(consts,index){return null===consts||null==index?null:consts[index]}function resetPreOrderHookFlags(lView){lView[18]=0}const instructionState={lFrame:createLFrame(null),bindingsEnabled:!0,checkNoChangesMode:!1};function getBindingsEnabled(){return instructionState.bindingsEnabled}function getLView(){return instructionState.lFrame.lView}function getTView(){return instructionState.lFrame.tView}function ɵɵrestoreView(viewToRestore){instructionState.lFrame.contextLView=viewToRestore}function getPreviousOrParentTNode(){return instructionState.lFrame.previousOrParentTNode}function setPreviousOrParentTNode(tNode,isParent){instructionState.lFrame.previousOrParentTNode=tNode,instructionState.lFrame.isParent=isParent}function getIsParent(){return instructionState.lFrame.isParent}function setIsNotParent(){instructionState.lFrame.isParent=!1}function getCheckNoChangesMode(){return instructionState.checkNoChangesMode}function setCheckNoChangesMode(mode){instructionState.checkNoChangesMode=mode}function nextBindingIndex(){return instructionState.lFrame.bindingIndex++}function incrementBindingIndex(count){const lFrame=instructionState.lFrame,index=lFrame.bindingIndex;return lFrame.bindingIndex=lFrame.bindingIndex+count,index}function setBindingRootForHostBindings(bindingRootIndex,currentDirectiveIndex){const lFrame=instructionState.lFrame;lFrame.bindingIndex=lFrame.bindingRootIndex=bindingRootIndex,lFrame.currentDirectiveIndex=currentDirectiveIndex}function setCurrentQueryIndex(value){instructionState.lFrame.currentQueryIndex=value}function enterDI(newView,tNode){const newLFrame=allocLFrame();instructionState.lFrame=newLFrame,newLFrame.previousOrParentTNode=tNode,newLFrame.lView=newView}function enterView(newView,tNode){const newLFrame=allocLFrame(),tView=newView[1];instructionState.lFrame=newLFrame,newLFrame.previousOrParentTNode=tNode,newLFrame.lView=newView,newLFrame.tView=tView,newLFrame.contextLView=newView,newLFrame.bindingIndex=tView.bindingStartIndex}function allocLFrame(){const currentLFrame=instructionState.lFrame,childLFrame=null===currentLFrame?null:currentLFrame.child;return null===childLFrame?createLFrame(currentLFrame):childLFrame}function createLFrame(parent){const lFrame={previousOrParentTNode:null,isParent:!0,lView:null,tView:null,selectedIndex:0,contextLView:null,elementDepthCount:0,currentNamespace:null,currentSanitizer:null,currentDirectiveIndex:-1,bindingRootIndex:-1,bindingIndex:-1,currentQueryIndex:0,parent:parent,child:null};return null!==parent&&(parent.child=lFrame),lFrame}function leaveViewLight(){const oldLFrame=instructionState.lFrame;return instructionState.lFrame=oldLFrame.parent,oldLFrame.previousOrParentTNode=null,oldLFrame.lView=null,oldLFrame}const leaveDI=leaveViewLight;function leaveView(){const oldLFrame=leaveViewLight();oldLFrame.isParent=!0,oldLFrame.tView=null,oldLFrame.selectedIndex=0,oldLFrame.contextLView=null,oldLFrame.elementDepthCount=0,oldLFrame.currentDirectiveIndex=-1,oldLFrame.currentNamespace=null,oldLFrame.currentSanitizer=null,oldLFrame.bindingRootIndex=-1,oldLFrame.bindingIndex=-1,oldLFrame.currentQueryIndex=0}function getSelectedIndex(){return instructionState.lFrame.selectedIndex}function setSelectedIndex(index){instructionState.lFrame.selectedIndex=index}function getSelectedTNode(){const lFrame=instructionState.lFrame;return getTNode(lFrame.tView,lFrame.selectedIndex)}function registerPostOrderHooks(tView,tNode){for(let i=tNode.directiveStart,end=tNode.directiveEnd;i<end;i++){const directiveDef=tView.data[i];directiveDef.afterContentInit&&(tView.contentHooks||(tView.contentHooks=[])).push(-i,directiveDef.afterContentInit),directiveDef.afterContentChecked&&((tView.contentHooks||(tView.contentHooks=[])).push(i,directiveDef.afterContentChecked),(tView.contentCheckHooks||(tView.contentCheckHooks=[])).push(i,directiveDef.afterContentChecked)),directiveDef.afterViewInit&&(tView.viewHooks||(tView.viewHooks=[])).push(-i,directiveDef.afterViewInit),directiveDef.afterViewChecked&&((tView.viewHooks||(tView.viewHooks=[])).push(i,directiveDef.afterViewChecked),(tView.viewCheckHooks||(tView.viewCheckHooks=[])).push(i,directiveDef.afterViewChecked)),null!=directiveDef.onDestroy&&(tView.destroyHooks||(tView.destroyHooks=[])).push(i,directiveDef.onDestroy)}}function executeCheckHooks(lView,hooks,nodeIndex){callHooks(lView,hooks,3,nodeIndex)}function executeInitAndCheckHooks(lView,hooks,initPhase,nodeIndex){(3&lView[2])===initPhase&&callHooks(lView,hooks,initPhase,nodeIndex)}function incrementInitPhaseFlags(lView,initPhase){let flags=lView[2];(3&flags)===initPhase&&(flags&=1023,flags+=1,lView[2]=flags)}function callHooks(currentView,arr,initPhase,currentNodeIndex){const nodeIndexLimit=null!=currentNodeIndex?currentNodeIndex:-1;let lastNodeIndexFound=0;for(let i=void 0!==currentNodeIndex?65535&currentView[18]:0;i<arr.length;i++)if(\"number\"==typeof arr[i+1]){if(lastNodeIndexFound=arr[i],null!=currentNodeIndex&&lastNodeIndexFound>=currentNodeIndex)break}else arr[i]<0&&(currentView[18]+=65536),(lastNodeIndexFound<nodeIndexLimit||-1==nodeIndexLimit)&&(callHook(currentView,initPhase,arr,i),currentView[18]=(4294901760&currentView[18])+i+2),i++}function callHook(currentView,initPhase,arr,i){const isInitHook=arr[i]<0,hook=arr[i+1],directive=currentView[isInitHook?-arr[i]:arr[i]];isInitHook?currentView[2]>>10<currentView[18]>>16&&(3&currentView[2])===initPhase&&(currentView[2]+=1024,hook.call(directive)):hook.call(directive)}class NodeInjectorFactory{constructor(factory,isViewProvider,injectImplementation){this.factory=factory,this.resolving=!1,this.canSeeViewProviders=isViewProvider,this.injectImpl=injectImplementation}}function setUpAttributes(renderer,native,attrs){const isProc=isProceduralRenderer(renderer);let i=0;for(;i<attrs.length;){const value=attrs[i];if(\"number\"==typeof value){if(0!==value)break;i++;const namespaceURI=attrs[i++],attrName=attrs[i++],attrVal=attrs[i++];isProc?renderer.setAttribute(native,attrName,attrVal,namespaceURI):native.setAttributeNS(namespaceURI,attrName,attrVal)}else{const attrName=value,attrVal=attrs[++i];isAnimationProp(attrName)?isProc&&renderer.setProperty(native,attrName,attrVal):isProc?renderer.setAttribute(native,attrName,attrVal):native.setAttribute(attrName,attrVal),i++}}return i}function isNameOnlyAttributeMarker(marker){return 3===marker||4===marker||6===marker}function isAnimationProp(name){return 64===name.charCodeAt(0)}function mergeHostAttrs(dst,src){if(null===src||0===src.length);else if(null===dst||0===dst.length)dst=src.slice();else{let srcMarker=-1;for(let i=0;i<src.length;i++){const item=src[i];\"number\"==typeof item?srcMarker=item:0===srcMarker||mergeHostAttribute(dst,srcMarker,item,null,-1===srcMarker||2===srcMarker?src[++i]:null)}}return dst}function mergeHostAttribute(dst,marker,key1,key2,value){let i=0,markerInsertPosition=dst.length;if(-1===marker)markerInsertPosition=-1;else for(;i<dst.length;){const dstValue=dst[i++];if(\"number\"==typeof dstValue){if(dstValue===marker){markerInsertPosition=-1;break}if(dstValue>marker){markerInsertPosition=i-1;break}}}for(;i<dst.length;){const item=dst[i];if(\"number\"==typeof item)break;if(item===key1){if(null===key2)return void(null!==value&&(dst[i+1]=value));if(key2===dst[i+1])return void(dst[i+2]=value)}i++,null!==key2&&i++,null!==value&&i++}-1!==markerInsertPosition&&(dst.splice(markerInsertPosition,0,marker),i=markerInsertPosition+1),dst.splice(i++,0,key1),null!==key2&&dst.splice(i++,0,key2),null!==value&&dst.splice(i++,0,value)}function hasParentInjector(parentLocation){return-1!==parentLocation}function getParentInjectorIndex(parentLocation){return 32767&parentLocation}function getParentInjectorViewOffset(parentLocation){return parentLocation>>16}function getParentInjectorView(location,startView){let viewOffset=getParentInjectorViewOffset(location),parentView=startView;for(;viewOffset>0;)parentView=parentView[15],viewOffset--;return parentView}function renderStringify(value){return\"string\"==typeof value?value:null==value?\"\":\"\"+value}function stringifyForError(value){return\"function\"==typeof value?value.name||value.toString():\"object\"==typeof value&&null!=value&&\"function\"==typeof value.type?value.type.name||value.type.toString():renderStringify(value)}const defaultScheduler=(()=>(\"undefined\"!=typeof requestAnimationFrame&&requestAnimationFrame||setTimeout).bind(_global))();function maybeUnwrapFn(value){return value instanceof Function?value():value}let includeViewProviders=!0;function setIncludeViewProviders(v){const oldValue=includeViewProviders;return includeViewProviders=v,oldValue}let nextNgElementId=0;function getOrCreateNodeInjectorForNode(tNode,hostView){const existingInjectorIndex=getInjectorIndex(tNode,hostView);if(-1!==existingInjectorIndex)return existingInjectorIndex;const tView=hostView[1];tView.firstCreatePass&&(tNode.injectorIndex=hostView.length,insertBloom(tView.data,tNode),insertBloom(hostView,null),insertBloom(tView.blueprint,null));const parentLoc=getParentInjectorLocation(tNode,hostView),injectorIndex=tNode.injectorIndex;if(hasParentInjector(parentLoc)){const parentIndex=getParentInjectorIndex(parentLoc),parentLView=getParentInjectorView(parentLoc,hostView),parentData=parentLView[1].data;for(let i=0;i<8;i++)hostView[injectorIndex+i]=parentLView[parentIndex+i]|parentData[parentIndex+i]}return hostView[injectorIndex+8]=parentLoc,injectorIndex}function insertBloom(arr,footer){arr.push(0,0,0,0,0,0,0,0,footer)}function getInjectorIndex(tNode,hostView){return-1===tNode.injectorIndex||tNode.parent&&tNode.parent.injectorIndex===tNode.injectorIndex||null==hostView[tNode.injectorIndex+8]?-1:tNode.injectorIndex}function getParentInjectorLocation(tNode,view){if(tNode.parent&&-1!==tNode.parent.injectorIndex)return tNode.parent.injectorIndex;let hostTNode=view[6],viewOffset=1;for(;hostTNode&&-1===hostTNode.injectorIndex;)hostTNode=(view=view[15])?view[6]:null,viewOffset++;return hostTNode?hostTNode.injectorIndex|viewOffset<<16:-1}function diPublicInInjector(injectorIndex,tView,token){!function(injectorIndex,tView,type){let id=\"string\"!=typeof type?type[NG_ELEMENT_ID]:type.charCodeAt(0)||0;null==id&&(id=type[NG_ELEMENT_ID]=nextNgElementId++);const bloomBit=255&id,mask=1<<bloomBit,b6=64&bloomBit,b5=32&bloomBit,tData=tView.data;128&bloomBit?b6?b5?tData[injectorIndex+7]|=mask:tData[injectorIndex+6]|=mask:b5?tData[injectorIndex+5]|=mask:tData[injectorIndex+4]|=mask:b6?b5?tData[injectorIndex+3]|=mask:tData[injectorIndex+2]|=mask:b5?tData[injectorIndex+1]|=mask:tData[injectorIndex]|=mask}(injectorIndex,tView,token)}function getOrCreateInjectable(tNode,lView,token,flags=InjectFlags.Default,notFoundValue){if(null!==tNode){const bloomHash=function(token){if(\"string\"==typeof token)return token.charCodeAt(0)||0;const tokenId=token[NG_ELEMENT_ID];return\"number\"==typeof tokenId&&tokenId>0?255&tokenId:tokenId}(token);if(\"function\"==typeof bloomHash){enterDI(lView,tNode);try{const value=bloomHash();if(null!=value||flags&InjectFlags.Optional)return value;throw new Error(`No provider for ${stringifyForError(token)}!`)}finally{leaveDI()}}else if(\"number\"==typeof bloomHash){if(-1===bloomHash)return new NodeInjector(tNode,lView);let previousTView=null,injectorIndex=getInjectorIndex(tNode,lView),parentLocation=-1,hostTElementNode=flags&InjectFlags.Host?lView[16][6]:null;for((-1===injectorIndex||flags&InjectFlags.SkipSelf)&&(parentLocation=-1===injectorIndex?getParentInjectorLocation(tNode,lView):lView[injectorIndex+8],shouldSearchParent(flags,!1)?(previousTView=lView[1],injectorIndex=getParentInjectorIndex(parentLocation),lView=getParentInjectorView(parentLocation,lView)):injectorIndex=-1);-1!==injectorIndex;){parentLocation=lView[injectorIndex+8];const tView=lView[1];if(bloomHasToken(bloomHash,injectorIndex,tView.data)){const instance=searchTokensOnInjector(injectorIndex,lView,token,previousTView,flags,hostTElementNode);if(instance!==NOT_FOUND)return instance}shouldSearchParent(flags,lView[1].data[injectorIndex+8]===hostTElementNode)&&bloomHasToken(bloomHash,injectorIndex,lView)?(previousTView=tView,injectorIndex=getParentInjectorIndex(parentLocation),lView=getParentInjectorView(parentLocation,lView)):injectorIndex=-1}}}if(flags&InjectFlags.Optional&&void 0===notFoundValue&&(notFoundValue=null),0==(flags&(InjectFlags.Self|InjectFlags.Host))){const moduleInjector=lView[9],previousInjectImplementation=setInjectImplementation(void 0);try{return moduleInjector?moduleInjector.get(token,notFoundValue,flags&InjectFlags.Optional):injectRootLimpMode(token,notFoundValue,flags&InjectFlags.Optional)}finally{setInjectImplementation(previousInjectImplementation)}}if(flags&InjectFlags.Optional)return notFoundValue;throw new Error(`NodeInjector: NOT_FOUND [${stringifyForError(token)}]`)}const NOT_FOUND={};function searchTokensOnInjector(injectorIndex,lView,token,previousTView,flags,hostTElementNode){const currentTView=lView[1],tNode=currentTView.data[injectorIndex+8],injectableIdx=function(tNode,tView,token,canAccessViewProviders,isHostSpecialCase){const nodeProviderIndexes=tNode.providerIndexes,tInjectables=tView.data,injectablesStart=65535&nodeProviderIndexes,directivesStart=tNode.directiveStart,cptViewProvidersCount=nodeProviderIndexes>>16,endIndex=isHostSpecialCase?injectablesStart+cptViewProvidersCount:tNode.directiveEnd;for(let i=canAccessViewProviders?injectablesStart:injectablesStart+cptViewProvidersCount;i<endIndex;i++){const providerTokenOrDef=tInjectables[i];if(i<directivesStart&&token===providerTokenOrDef||i>=directivesStart&&providerTokenOrDef.type===token)return i}if(isHostSpecialCase){const dirDef=tInjectables[directivesStart];if(dirDef&&isComponentDef(dirDef)&&dirDef.type===token)return directivesStart}return null}(tNode,currentTView,token,null==previousTView?isComponentHost(tNode)&&includeViewProviders:previousTView!=currentTView&&3===tNode.type,flags&InjectFlags.Host&&hostTElementNode===tNode);return null!==injectableIdx?getNodeInjectable(lView,currentTView,injectableIdx,tNode):NOT_FOUND}function getNodeInjectable(lView,tView,index,tNode){let value=lView[index];const tData=tView.data;if(value instanceof NodeInjectorFactory){const factory=value;if(factory.resolving)throw new Error(\"Circular dep for \"+stringifyForError(tData[index]));const previousIncludeViewProviders=setIncludeViewProviders(factory.canSeeViewProviders);let previousInjectImplementation;factory.resolving=!0,factory.injectImpl&&(previousInjectImplementation=setInjectImplementation(factory.injectImpl)),enterDI(lView,tNode);try{value=lView[index]=factory.factory(void 0,tData,lView,tNode),tView.firstCreatePass&&index>=tNode.directiveStart&&function(directiveIndex,directiveDef,tView){const{onChanges:onChanges,onInit:onInit,doCheck:doCheck}=directiveDef;onChanges&&((tView.preOrderHooks||(tView.preOrderHooks=[])).push(directiveIndex,onChanges),(tView.preOrderCheckHooks||(tView.preOrderCheckHooks=[])).push(directiveIndex,onChanges)),onInit&&(tView.preOrderHooks||(tView.preOrderHooks=[])).push(-directiveIndex,onInit),doCheck&&((tView.preOrderHooks||(tView.preOrderHooks=[])).push(directiveIndex,doCheck),(tView.preOrderCheckHooks||(tView.preOrderCheckHooks=[])).push(directiveIndex,doCheck))}(index,tData[index],tView)}finally{factory.injectImpl&&setInjectImplementation(previousInjectImplementation),setIncludeViewProviders(previousIncludeViewProviders),factory.resolving=!1,leaveDI()}}return value}function bloomHasToken(bloomHash,injectorIndex,injectorView){const b6=64&bloomHash,b5=32&bloomHash;let value;return value=128&bloomHash?b6?b5?injectorView[injectorIndex+7]:injectorView[injectorIndex+6]:b5?injectorView[injectorIndex+5]:injectorView[injectorIndex+4]:b6?b5?injectorView[injectorIndex+3]:injectorView[injectorIndex+2]:b5?injectorView[injectorIndex+1]:injectorView[injectorIndex],!!(value&1<<bloomHash)}function shouldSearchParent(flags,isFirstHostTNode){return!(flags&InjectFlags.Self||flags&InjectFlags.Host&&isFirstHostTNode)}class NodeInjector{constructor(_tNode,_lView){this._tNode=_tNode,this._lView=_lView}get(token,notFoundValue){return getOrCreateInjectable(this._tNode,this._lView,token,void 0,notFoundValue)}}function ɵɵgetInheritedFactory(type){return noSideEffects(()=>{const proto=Object.getPrototypeOf(type.prototype).constructor,factory=proto[NG_FACTORY_DEF]||function ɵɵgetFactoryOf(type){const typeAny=type;if(isForwardRef(type))return()=>{const factory=ɵɵgetFactoryOf(resolveForwardRef(typeAny));return factory?factory():null};let factory=getFactoryDef(typeAny);if(null===factory){const injectorDef=getInjectorDef(typeAny);factory=injectorDef&&injectorDef.factory}return factory||null}(proto);return null!==factory?factory:t=>new t})}function getDebugContext(error){return error.ngDebugContext}function getOriginalError(error){return error.ngOriginalError}function defaultErrorLogger(console,...values){console.error(...values)}class ErrorHandler{constructor(){this._console=console}handleError(error){const originalError=this._findOriginalError(error),context=this._findContext(error),errorLogger=function(error){return error.ngErrorLogger||defaultErrorLogger}(error);errorLogger(this._console,\"ERROR\",error),originalError&&errorLogger(this._console,\"ORIGINAL ERROR\",originalError),context&&errorLogger(this._console,\"ERROR CONTEXT\",context)}_findContext(error){return error?getDebugContext(error)?getDebugContext(error):this._findContext(getOriginalError(error)):null}_findOriginalError(error){let e=getOriginalError(error);for(;e&&getOriginalError(e);)e=getOriginalError(e);return e}}class SafeValueImpl{constructor(changingThisBreaksApplicationSecurity){this.changingThisBreaksApplicationSecurity=changingThisBreaksApplicationSecurity}toString(){return\"SafeValue must use [property]=binding: \"+this.changingThisBreaksApplicationSecurity+\" (see http://g.co/ng/security#xss)\"}}class SafeHtmlImpl extends SafeValueImpl{getTypeName(){return\"HTML\"}}class SafeStyleImpl extends SafeValueImpl{getTypeName(){return\"Style\"}}class SafeScriptImpl extends SafeValueImpl{getTypeName(){return\"Script\"}}class SafeUrlImpl extends SafeValueImpl{getTypeName(){return\"URL\"}}class SafeResourceUrlImpl extends SafeValueImpl{getTypeName(){return\"ResourceURL\"}}function unwrapSafeValue(value){return value instanceof SafeValueImpl?value.changingThisBreaksApplicationSecurity:value}function allowSanitizationBypassAndThrow(value,type){const actualType=getSanitizationBypassType(value);if(null!=actualType&&actualType!==type){if(\"ResourceURL\"===actualType&&\"URL\"===type)return!0;throw new Error(`Required a safe ${type}, got a ${actualType} (see http://g.co/ng/security#xss)`)}return actualType===type}function getSanitizationBypassType(value){return value instanceof SafeValueImpl&&value.getTypeName()||null}let _runModeLocked=!1;function isDevMode(){return _runModeLocked=!0,true}class InertBodyHelper{constructor(defaultDoc){this.defaultDoc=defaultDoc,this.inertDocument=this.defaultDoc.implementation.createHTMLDocument(\"sanitization-inert\");let inertBodyElement=this.inertDocument.body;if(null==inertBodyElement){const inertHtml=this.inertDocument.createElement(\"html\");this.inertDocument.appendChild(inertHtml),inertBodyElement=this.inertDocument.createElement(\"body\"),inertHtml.appendChild(inertBodyElement)}inertBodyElement.innerHTML='<svg><g onload=\"this.parentNode.remove()\"></g></svg>',!inertBodyElement.querySelector||inertBodyElement.querySelector(\"svg\")?(inertBodyElement.innerHTML='<svg><p><style><img src=\"</style><img src=x onerror=alert(1)//\">',this.getInertBodyElement=inertBodyElement.querySelector&&inertBodyElement.querySelector(\"svg img\")&&function(){try{return!!window.DOMParser}catch(_a){return!1}}()?this.getInertBodyElement_DOMParser:this.getInertBodyElement_InertDocument):this.getInertBodyElement=this.getInertBodyElement_XHR}getInertBodyElement_XHR(html){html=\"<body><remove></remove>\"+html+\"</body>\";try{html=encodeURI(html)}catch(_a){return null}const xhr=new XMLHttpRequest;xhr.responseType=\"document\",xhr.open(\"GET\",\"data:text/html;charset=utf-8,\"+html,!1),xhr.send(void 0);const body=xhr.response.body;return body.removeChild(body.firstChild),body}getInertBodyElement_DOMParser(html){html=\"<body><remove></remove>\"+html+\"</body>\";try{const body=(new window.DOMParser).parseFromString(html,\"text/html\").body;return body.removeChild(body.firstChild),body}catch(_a){return null}}getInertBodyElement_InertDocument(html){const templateEl=this.inertDocument.createElement(\"template\");if(\"content\"in templateEl)return templateEl.innerHTML=html,templateEl;const inertBody=this.inertDocument.createElement(\"body\");return inertBody.innerHTML=html,this.defaultDoc.documentMode&&this.stripCustomNsAttrs(inertBody),inertBody}stripCustomNsAttrs(el){const elAttrs=el.attributes;for(let i=elAttrs.length-1;0<i;i--){const attrName=elAttrs.item(i).name;\"xmlns:ns1\"!==attrName&&0!==attrName.indexOf(\"ns1:\")||el.removeAttribute(attrName)}let childNode=el.firstChild;for(;childNode;)childNode.nodeType===Node.ELEMENT_NODE&&this.stripCustomNsAttrs(childNode),childNode=childNode.nextSibling}}const SAFE_URL_PATTERN=/^(?:(?:https?|mailto|ftp|tel|file):|[^&:/?#]*(?:[/?#]|$))/gi,DATA_URL_PATTERN=/^data:(?:image\\/(?:bmp|gif|jpeg|jpg|png|tiff|webp)|video\\/(?:mpeg|mp4|ogg|webm)|audio\\/(?:mp3|oga|ogg|opus));base64,[a-z0-9+\\/]+=*$/i;function _sanitizeUrl(url){return(url=String(url)).match(SAFE_URL_PATTERN)||url.match(DATA_URL_PATTERN)?url:(isDevMode()&&console.warn(`WARNING: sanitizing unsafe URL value ${url} (see http://g.co/ng/security#xss)`),\"unsafe:\"+url)}function tagSet(tags){const res={};for(const t of tags.split(\",\"))res[t]=!0;return res}function core_merge(...sets){const res={};for(const s of sets)for(const v in s)s.hasOwnProperty(v)&&(res[v]=!0);return res}const VOID_ELEMENTS=tagSet(\"area,br,col,hr,img,wbr\"),OPTIONAL_END_TAG_BLOCK_ELEMENTS=tagSet(\"colgroup,dd,dt,li,p,tbody,td,tfoot,th,thead,tr\"),OPTIONAL_END_TAG_INLINE_ELEMENTS=tagSet(\"rp,rt\"),OPTIONAL_END_TAG_ELEMENTS=core_merge(OPTIONAL_END_TAG_INLINE_ELEMENTS,OPTIONAL_END_TAG_BLOCK_ELEMENTS),VALID_ELEMENTS=core_merge(VOID_ELEMENTS,core_merge(OPTIONAL_END_TAG_BLOCK_ELEMENTS,tagSet(\"address,article,aside,blockquote,caption,center,del,details,dialog,dir,div,dl,figure,figcaption,footer,h1,h2,h3,h4,h5,h6,header,hgroup,hr,ins,main,map,menu,nav,ol,pre,section,summary,table,ul\")),core_merge(OPTIONAL_END_TAG_INLINE_ELEMENTS,tagSet(\"a,abbr,acronym,audio,b,bdi,bdo,big,br,cite,code,del,dfn,em,font,i,img,ins,kbd,label,map,mark,picture,q,ruby,rp,rt,s,samp,small,source,span,strike,strong,sub,sup,time,track,tt,u,var,video\")),OPTIONAL_END_TAG_ELEMENTS),URI_ATTRS=tagSet(\"background,cite,href,itemtype,longdesc,poster,src,xlink:href\"),SRCSET_ATTRS=tagSet(\"srcset\"),VALID_ATTRS=core_merge(URI_ATTRS,SRCSET_ATTRS,tagSet(\"abbr,accesskey,align,alt,autoplay,axis,bgcolor,border,cellpadding,cellspacing,class,clear,color,cols,colspan,compact,controls,coords,datetime,default,dir,download,face,headers,height,hidden,hreflang,hspace,ismap,itemscope,itemprop,kind,label,lang,language,loop,media,muted,nohref,nowrap,open,preload,rel,rev,role,rows,rowspan,rules,scope,scrolling,shape,size,sizes,span,srclang,start,summary,tabindex,target,title,translate,type,usemap,valign,value,vspace,width\"),tagSet(\"aria-activedescendant,aria-atomic,aria-autocomplete,aria-busy,aria-checked,aria-colcount,aria-colindex,aria-colspan,aria-controls,aria-current,aria-describedby,aria-details,aria-disabled,aria-dropeffect,aria-errormessage,aria-expanded,aria-flowto,aria-grabbed,aria-haspopup,aria-hidden,aria-invalid,aria-keyshortcuts,aria-label,aria-labelledby,aria-level,aria-live,aria-modal,aria-multiline,aria-multiselectable,aria-orientation,aria-owns,aria-placeholder,aria-posinset,aria-pressed,aria-readonly,aria-relevant,aria-required,aria-roledescription,aria-rowcount,aria-rowindex,aria-rowspan,aria-selected,aria-setsize,aria-sort,aria-valuemax,aria-valuemin,aria-valuenow,aria-valuetext\")),SKIP_TRAVERSING_CONTENT_IF_INVALID_ELEMENTS=tagSet(\"script,style,template\");class SanitizingHtmlSerializer{constructor(){this.sanitizedSomething=!1,this.buf=[]}sanitizeChildren(el){let current=el.firstChild,traverseContent=!0;for(;current;)if(current.nodeType===Node.ELEMENT_NODE?traverseContent=this.startElement(current):current.nodeType===Node.TEXT_NODE?this.chars(current.nodeValue):this.sanitizedSomething=!0,traverseContent&&current.firstChild)current=current.firstChild;else for(;current;){current.nodeType===Node.ELEMENT_NODE&&this.endElement(current);let next=this.checkClobberedElement(current,current.nextSibling);if(next){current=next;break}current=this.checkClobberedElement(current,current.parentNode)}return this.buf.join(\"\")}startElement(element){const tagName=element.nodeName.toLowerCase();if(!VALID_ELEMENTS.hasOwnProperty(tagName))return this.sanitizedSomething=!0,!SKIP_TRAVERSING_CONTENT_IF_INVALID_ELEMENTS.hasOwnProperty(tagName);this.buf.push(\"<\"),this.buf.push(tagName);const elAttrs=element.attributes;for(let i=0;i<elAttrs.length;i++){const elAttr=elAttrs.item(i),attrName=elAttr.name,lower=attrName.toLowerCase();if(!VALID_ATTRS.hasOwnProperty(lower)){this.sanitizedSomething=!0;continue}let value=elAttr.value;URI_ATTRS[lower]&&(value=_sanitizeUrl(value)),SRCSET_ATTRS[lower]&&(srcset=value,value=(srcset=String(srcset)).split(\",\").map(srcset=>_sanitizeUrl(srcset.trim())).join(\", \")),this.buf.push(\" \",attrName,'=\"',encodeEntities(value),'\"')}var srcset;return this.buf.push(\">\"),!0}endElement(current){const tagName=current.nodeName.toLowerCase();VALID_ELEMENTS.hasOwnProperty(tagName)&&!VOID_ELEMENTS.hasOwnProperty(tagName)&&(this.buf.push(\"</\"),this.buf.push(tagName),this.buf.push(\">\"))}chars(chars){this.buf.push(encodeEntities(chars))}checkClobberedElement(node,nextNode){if(nextNode&&(node.compareDocumentPosition(nextNode)&Node.DOCUMENT_POSITION_CONTAINED_BY)===Node.DOCUMENT_POSITION_CONTAINED_BY)throw new Error(\"Failed to sanitize html because the element is clobbered: \"+node.outerHTML);return nextNode}}const SURROGATE_PAIR_REGEXP=/[\\uD800-\\uDBFF][\\uDC00-\\uDFFF]/g,NON_ALPHANUMERIC_REGEXP=/([^\\#-~ |!])/g;function encodeEntities(value){return value.replace(/&/g,\"&amp;\").replace(SURROGATE_PAIR_REGEXP,(function(match){return\"&#\"+(1024*(match.charCodeAt(0)-55296)+(match.charCodeAt(1)-56320)+65536)+\";\"})).replace(NON_ALPHANUMERIC_REGEXP,(function(match){return\"&#\"+match.charCodeAt(0)+\";\"})).replace(/</g,\"&lt;\").replace(/>/g,\"&gt;\")}let inertBodyHelper;function _sanitizeHtml(defaultDoc,unsafeHtmlInput){let inertBodyElement=null;try{inertBodyHelper=inertBodyHelper||new InertBodyHelper(defaultDoc);let unsafeHtml=unsafeHtmlInput?String(unsafeHtmlInput):\"\";inertBodyElement=inertBodyHelper.getInertBodyElement(unsafeHtml);let mXSSAttempts=5,parsedHtml=unsafeHtml;do{if(0===mXSSAttempts)throw new Error(\"Failed to sanitize html because the input is unstable\");mXSSAttempts--,unsafeHtml=parsedHtml,parsedHtml=inertBodyElement.innerHTML,inertBodyElement=inertBodyHelper.getInertBodyElement(unsafeHtml)}while(unsafeHtml!==parsedHtml);const sanitizer=new SanitizingHtmlSerializer,safeHtml=sanitizer.sanitizeChildren(getTemplateContent(inertBodyElement)||inertBodyElement);return isDevMode()&&sanitizer.sanitizedSomething&&console.warn(\"WARNING: sanitizing HTML stripped some content, see http://g.co/ng/security#xss\"),safeHtml}finally{if(inertBodyElement){const parent=getTemplateContent(inertBodyElement)||inertBodyElement;for(;parent.firstChild;)parent.removeChild(parent.firstChild)}}}function getTemplateContent(el){return\"content\"in el&&function(el){return el.nodeType===Node.ELEMENT_NODE&&\"TEMPLATE\"===el.nodeName}(el)?el.content:null}const SecurityContext=function(){var SecurityContext={NONE:0,HTML:1,STYLE:2,SCRIPT:3,URL:4,RESOURCE_URL:5};return SecurityContext[SecurityContext.NONE]=\"NONE\",SecurityContext[SecurityContext.HTML]=\"HTML\",SecurityContext[SecurityContext.STYLE]=\"STYLE\",SecurityContext[SecurityContext.SCRIPT]=\"SCRIPT\",SecurityContext[SecurityContext.URL]=\"URL\",SecurityContext[SecurityContext.RESOURCE_URL]=\"RESOURCE_URL\",SecurityContext}(),SAFE_STYLE_VALUE=new RegExp(\"^([-,.\\\"'%_!# a-zA-Z0-9]+|(?:(?:matrix|translate|scale|rotate|skew|perspective)(?:X|Y|Z|3d)?|(?:rgb|hsl)a?|(?:repeating-)?(?:linear|radial)-gradient|(?:attr|calc|var))\\\\([-0-9.%, #a-zA-Z]+\\\\))$\",\"g\"),URL_RE=/^url\\(([^)]+)\\)$/;function ɵɵsanitizeHtml(unsafeHtml){const sanitizer=getSanitizer();return sanitizer?sanitizer.sanitize(SecurityContext.HTML,unsafeHtml)||\"\":allowSanitizationBypassAndThrow(unsafeHtml,\"HTML\")?unwrapSafeValue(unsafeHtml):_sanitizeHtml(getDocument(),renderStringify(unsafeHtml))}function ɵɵsanitizeUrl(unsafeUrl){const sanitizer=getSanitizer();return sanitizer?sanitizer.sanitize(SecurityContext.URL,unsafeUrl)||\"\":allowSanitizationBypassAndThrow(unsafeUrl,\"URL\")?unwrapSafeValue(unsafeUrl):_sanitizeUrl(renderStringify(unsafeUrl))}function getSanitizer(){const lView=getLView();return lView&&lView[12]}function attachPatchData(target,data){target.__ngContext__=data}function throwMultipleComponentError(tNode){throw new Error(\"Multiple components match node with tagname \"+tNode.tagName)}function throwMixedMultiProviderError(){throw new Error(\"Cannot mix multi providers and regular providers\")}function classIndexOf(className,classToSearch,startingIndex){let end=className.length;for(;;){const foundIndex=className.indexOf(classToSearch,startingIndex);if(-1===foundIndex)return foundIndex;if(0===foundIndex||className.charCodeAt(foundIndex-1)<=32){const length=classToSearch.length;if(foundIndex+length===end||className.charCodeAt(foundIndex+length)<=32)return foundIndex}startingIndex=foundIndex+1}}function isCssClassMatching(attrs,cssClassToMatch,isProjectionMode){let i=0;for(;i<attrs.length;){let item=attrs[i++];if(isProjectionMode&&\"class\"===item){if(item=attrs[i],-1!==classIndexOf(item.toLowerCase(),cssClassToMatch,0))return!0}else if(1===item){for(;i<attrs.length&&\"string\"==typeof(item=attrs[i++]);)if(item.toLowerCase()===cssClassToMatch)return!0;return!1}}return!1}function hasTagAndTypeMatch(tNode,currentSelector,isProjectionMode){return currentSelector===(0!==tNode.type||isProjectionMode?tNode.tagName:\"ng-template\")}function isNodeMatchingSelector(tNode,selector,isProjectionMode){let mode=4;const nodeAttrs=tNode.attrs||[],nameOnlyMarkerIdx=function(nodeAttrs){for(let i=0;i<nodeAttrs.length;i++)if(isNameOnlyAttributeMarker(nodeAttrs[i]))return i;return nodeAttrs.length}(nodeAttrs);let skipToNextSelector=!1;for(let i=0;i<selector.length;i++){const current=selector[i];if(\"number\"!=typeof current){if(!skipToNextSelector)if(4&mode){if(mode=2|1&mode,\"\"!==current&&!hasTagAndTypeMatch(tNode,current,isProjectionMode)||\"\"===current&&1===selector.length){if(isPositive(mode))return!1;skipToNextSelector=!0}}else{const selectorAttrValue=8&mode?current:selector[++i];if(8&mode&&null!==tNode.attrs){if(!isCssClassMatching(tNode.attrs,selectorAttrValue,isProjectionMode)){if(isPositive(mode))return!1;skipToNextSelector=!0}continue}const attrIndexInNode=findAttrIndexInNode(8&mode?\"class\":current,nodeAttrs,0==tNode.type&&\"ng-template\"!==tNode.tagName,isProjectionMode);if(-1===attrIndexInNode){if(isPositive(mode))return!1;skipToNextSelector=!0;continue}if(\"\"!==selectorAttrValue){let nodeAttrValue;nodeAttrValue=attrIndexInNode>nameOnlyMarkerIdx?\"\":nodeAttrs[attrIndexInNode+1].toLowerCase();const compareAgainstClassName=8&mode?nodeAttrValue:null;if(compareAgainstClassName&&-1!==classIndexOf(compareAgainstClassName,selectorAttrValue,0)||2&mode&&selectorAttrValue!==nodeAttrValue){if(isPositive(mode))return!1;skipToNextSelector=!0}}}}else{if(!skipToNextSelector&&!isPositive(mode)&&!isPositive(current))return!1;if(skipToNextSelector&&isPositive(current))continue;skipToNextSelector=!1,mode=current|1&mode}}return isPositive(mode)||skipToNextSelector}function isPositive(mode){return 0==(1&mode)}function findAttrIndexInNode(name,attrs,isInlineTemplate,isProjectionMode){if(null===attrs)return-1;let i=0;if(isProjectionMode||!isInlineTemplate){let bindingsMode=!1;for(;i<attrs.length;){const maybeAttrName=attrs[i];if(maybeAttrName===name)return i;if(3===maybeAttrName||6===maybeAttrName)bindingsMode=!0;else{if(1===maybeAttrName||2===maybeAttrName){let value=attrs[++i];for(;\"string\"==typeof value;)value=attrs[++i];continue}if(4===maybeAttrName)break;if(0===maybeAttrName){i+=4;continue}}i+=bindingsMode?1:2}return-1}return function(attrs,name){let i=attrs.indexOf(4);if(i>-1)for(i++;i<attrs.length;){if(attrs[i]===name)return i;i++}return-1}(attrs,name)}function isNodeMatchingSelectorList(tNode,selector,isProjectionMode=!1){for(let i=0;i<selector.length;i++)if(isNodeMatchingSelector(tNode,selector[i],isProjectionMode))return!0;return!1}function maybeWrapInNotSelector(isNegativeMode,chunk){return isNegativeMode?\":not(\"+chunk.trim()+\")\":chunk}function stringifyCSSSelector(selector){let result=selector[0],i=1,mode=2,currentChunk=\"\",isNegativeMode=!1;for(;i<selector.length;){let valueOrMarker=selector[i];if(\"string\"==typeof valueOrMarker)if(2&mode){const attrValue=selector[++i];currentChunk+=\"[\"+valueOrMarker+(attrValue.length>0?'=\"'+attrValue+'\"':\"\")+\"]\"}else 8&mode?currentChunk+=\".\"+valueOrMarker:4&mode&&(currentChunk+=\" \"+valueOrMarker);else\"\"===currentChunk||isPositive(valueOrMarker)||(result+=maybeWrapInNotSelector(isNegativeMode,currentChunk),currentChunk=\"\"),mode=valueOrMarker,isNegativeMode=isNegativeMode||!isPositive(mode);i++}return\"\"!==currentChunk&&(result+=maybeWrapInNotSelector(isNegativeMode,currentChunk)),result}const NO_CHANGE={};function getLViewParent(lView){const parent=lView[3];return isLContainer(parent)?parent[3]:parent}function ɵɵadvance(delta){selectIndexInternal(getTView(),getLView(),getSelectedIndex()+delta,getCheckNoChangesMode())}function selectIndexInternal(tView,lView,index,checkNoChangesMode){if(!checkNoChangesMode)if(3==(3&lView[2])){const preOrderCheckHooks=tView.preOrderCheckHooks;null!==preOrderCheckHooks&&executeCheckHooks(lView,preOrderCheckHooks,index)}else{const preOrderHooks=tView.preOrderHooks;null!==preOrderHooks&&executeInitAndCheckHooks(lView,preOrderHooks,0,index)}setSelectedIndex(index)}function toTStylingRange(prev,next){return prev<<17|next<<2}function getTStylingRangePrev(tStylingRange){return tStylingRange>>17&32767}function setTStylingRangePrevDuplicate(tStylingRange){return 2|tStylingRange}function getTStylingRangeNext(tStylingRange){return(131068&tStylingRange)>>2}function setTStylingRangeNext(tStylingRange,next){return-131069&tStylingRange|next<<2}function setTStylingRangeNextDuplicate(tStylingRange){return 1|tStylingRange}function refreshContentQueries(tView,lView){const contentQueries=tView.contentQueries;if(null!==contentQueries)for(let i=0;i<contentQueries.length;i+=2){const queryStartIdx=contentQueries[i],directiveDefIdx=contentQueries[i+1];if(-1!==directiveDefIdx){const directiveDef=tView.data[directiveDefIdx];setCurrentQueryIndex(queryStartIdx),directiveDef.contentQueries(2,lView[directiveDefIdx],directiveDefIdx)}}}function elementCreate(name,renderer,namespace){return isProceduralRenderer(renderer)?renderer.createElement(name,namespace):null===namespace?renderer.createElement(name):renderer.createElementNS(namespace,name)}function createLView(parentLView,tView,context,flags,host,tHostNode,rendererFactory,renderer,sanitizer,injector){const lView=tView.blueprint.slice();return lView[0]=host,lView[2]=140|flags,resetPreOrderHookFlags(lView),lView[3]=lView[15]=parentLView,lView[8]=context,lView[10]=rendererFactory||parentLView&&parentLView[10],lView[11]=renderer||parentLView&&parentLView[11],lView[12]=sanitizer||parentLView&&parentLView[12]||null,lView[9]=injector||parentLView&&parentLView[9]||null,lView[6]=tHostNode,lView[16]=2==tView.type?parentLView[16]:lView,lView}function getOrCreateTNode(tView,tHostNode,index,type,name,attrs){const adjustedIndex=index+19,tNode=tView.data[adjustedIndex]||function(tView,tHostNode,adjustedIndex,type,name,attrs){const previousOrParentTNode=getPreviousOrParentTNode(),isParent=getIsParent(),parent=isParent?previousOrParentTNode:previousOrParentTNode&&previousOrParentTNode.parent,tNode=tView.data[adjustedIndex]=createTNode(0,parent&&parent!==tHostNode?parent:null,type,adjustedIndex,name,attrs);return null===tView.firstChild&&(tView.firstChild=tNode),previousOrParentTNode&&(!isParent||null!=previousOrParentTNode.child||null===tNode.parent&&2!==previousOrParentTNode.type?isParent||(previousOrParentTNode.next=tNode):previousOrParentTNode.child=tNode),tNode}(tView,tHostNode,adjustedIndex,type,name,attrs);return setPreviousOrParentTNode(tNode,!0),tNode}function renderView(tView,lView,context){enterView(lView,lView[6]);try{const viewQuery=tView.viewQuery;null!==viewQuery&&executeViewQueryFn(1,viewQuery,context);const templateFn=tView.template;null!==templateFn&&executeTemplate(tView,lView,templateFn,1,context),tView.firstCreatePass&&(tView.firstCreatePass=!1),tView.staticContentQueries&&refreshContentQueries(tView,lView),tView.staticViewQueries&&executeViewQueryFn(2,tView.viewQuery,context);const components=tView.components;null!==components&&function(hostLView,components){for(let i=0;i<components.length;i++)renderComponent(hostLView,components[i])}(lView,components)}finally{lView[2]&=-5,leaveView()}}function refreshView(tView,lView,templateFn,context){const flags=lView[2];if(256==(256&flags))return;enterView(lView,lView[6]);const checkNoChangesMode=getCheckNoChangesMode();try{resetPreOrderHookFlags(lView),instructionState.lFrame.bindingIndex=tView.bindingStartIndex,null!==templateFn&&executeTemplate(tView,lView,templateFn,2,context);const hooksInitPhaseCompleted=3==(3&flags);if(!checkNoChangesMode)if(hooksInitPhaseCompleted){const preOrderCheckHooks=tView.preOrderCheckHooks;null!==preOrderCheckHooks&&executeCheckHooks(lView,preOrderCheckHooks,null)}else{const preOrderHooks=tView.preOrderHooks;null!==preOrderHooks&&executeInitAndCheckHooks(lView,preOrderHooks,0,null),incrementInitPhaseFlags(lView,0)}if(function(lView){let viewOrContainer=lView[13];for(;null!==viewOrContainer;){let activeIndexFlag;if(isLContainer(viewOrContainer)&&(activeIndexFlag=viewOrContainer[2])>>1==-1){for(let i=9;i<viewOrContainer.length;i++){const embeddedLView=viewOrContainer[i],embeddedTView=embeddedLView[1];viewAttachedToChangeDetector(embeddedLView)&&refreshView(embeddedTView,embeddedLView,embeddedTView.template,embeddedLView[8])}0!=(1&activeIndexFlag)&&refreshTransplantedViews(viewOrContainer,lView[16])}viewOrContainer=viewOrContainer[4]}}(lView),null!==tView.contentQueries&&refreshContentQueries(tView,lView),!checkNoChangesMode)if(hooksInitPhaseCompleted){const contentCheckHooks=tView.contentCheckHooks;null!==contentCheckHooks&&executeCheckHooks(lView,contentCheckHooks)}else{const contentHooks=tView.contentHooks;null!==contentHooks&&executeInitAndCheckHooks(lView,contentHooks,1),incrementInitPhaseFlags(lView,1)}!function(tView,lView){try{const expandoInstructions=tView.expandoInstructions;if(null!==expandoInstructions){let bindingRootIndex=tView.expandoStartIndex,currentDirectiveIndex=-1,currentElementIndex=-1;for(let i=0;i<expandoInstructions.length;i++){const instruction=expandoInstructions[i];\"number\"==typeof instruction?instruction<=0?(currentElementIndex=0-instruction,setSelectedIndex(currentElementIndex),bindingRootIndex+=9+expandoInstructions[++i],currentDirectiveIndex=bindingRootIndex):bindingRootIndex+=instruction:(null!==instruction&&(setBindingRootForHostBindings(bindingRootIndex,currentDirectiveIndex),instruction(2,lView[currentDirectiveIndex])),currentDirectiveIndex++)}}}finally{setSelectedIndex(-1)}}(tView,lView);const components=tView.components;null!==components&&function(hostLView,components){for(let i=0;i<components.length;i++)refreshComponent(hostLView,components[i])}(lView,components);const viewQuery=tView.viewQuery;if(null!==viewQuery&&executeViewQueryFn(2,viewQuery,context),!checkNoChangesMode)if(hooksInitPhaseCompleted){const viewCheckHooks=tView.viewCheckHooks;null!==viewCheckHooks&&executeCheckHooks(lView,viewCheckHooks)}else{const viewHooks=tView.viewHooks;null!==viewHooks&&executeInitAndCheckHooks(lView,viewHooks,2),incrementInitPhaseFlags(lView,2)}!0===tView.firstUpdatePass&&(tView.firstUpdatePass=!1),checkNoChangesMode||(lView[2]&=-73)}finally{leaveView()}}function renderComponentOrTemplate(tView,lView,templateFn,context){const rendererFactory=lView[10],normalExecutionPath=!getCheckNoChangesMode(),creationModeIsActive=4==(4&lView[2]);try{normalExecutionPath&&!creationModeIsActive&&rendererFactory.begin&&rendererFactory.begin(),creationModeIsActive&&renderView(tView,lView,context),refreshView(tView,lView,templateFn,context)}finally{normalExecutionPath&&!creationModeIsActive&&rendererFactory.end&&rendererFactory.end()}}function executeTemplate(tView,lView,templateFn,rf,context){const prevSelectedIndex=getSelectedIndex();try{setSelectedIndex(-1),2&rf&&lView.length>19&&selectIndexInternal(tView,lView,0,getCheckNoChangesMode()),templateFn(rf,context)}finally{setSelectedIndex(prevSelectedIndex)}}function executeContentQueries(tView,tNode,lView){if(isContentQueryHost(tNode)){const end=tNode.directiveEnd;for(let directiveIndex=tNode.directiveStart;directiveIndex<end;directiveIndex++){const def=tView.data[directiveIndex];def.contentQueries&&def.contentQueries(1,lView[directiveIndex],directiveIndex)}}}function createDirectivesInstances(tView,lView,tNode){getBindingsEnabled()&&(function(tView,lView,tNode,native){const start=tNode.directiveStart,end=tNode.directiveEnd;tView.firstCreatePass||getOrCreateNodeInjectorForNode(tNode,lView),attachPatchData(native,lView);const initialInputs=tNode.initialInputs;for(let i=start;i<end;i++){const def=tView.data[i],isComponent=isComponentDef(def);isComponent&&addComponentLogic(lView,tNode,def);const directive=getNodeInjectable(lView,tView,i,tNode);attachPatchData(directive,lView),null!==initialInputs&&setInputsFromAttrs(0,i-start,directive,def,0,initialInputs),isComponent&&(getComponentLViewByIndex(tNode.index,lView)[8]=directive)}}(tView,lView,tNode,getNativeByTNode(tNode,lView)),128==(128&tNode.flags)&&function(tView,lView,tNode){const start=tNode.directiveStart,end=tNode.directiveEnd,expando=tView.expandoInstructions,firstCreatePass=tView.firstCreatePass,elementIndex=tNode.index-19;try{setSelectedIndex(elementIndex);for(let i=start;i<end;i++){const def=tView.data[i],directive=lView[i];null!==def.hostBindings||0!==def.hostVars||null!==def.hostAttrs?invokeHostBindingsInCreationMode(def,directive):firstCreatePass&&expando.push(null)}}finally{setSelectedIndex(-1)}}(tView,lView,tNode))}function saveResolvedLocalsInData(viewData,tNode,localRefExtractor=getNativeByTNode){const localNames=tNode.localNames;if(null!==localNames){let localIndex=tNode.index+1;for(let i=0;i<localNames.length;i+=2){const index=localNames[i+1],value=-1===index?localRefExtractor(tNode,viewData):viewData[index];viewData[localIndex++]=value}}}function getOrCreateTComponentView(def){return def.tView||(def.tView=createTView(1,-1,def.template,def.decls,def.vars,def.directiveDefs,def.pipeDefs,def.viewQuery,def.schemas,def.consts))}function createTView(type,viewIndex,templateFn,decls,vars,directives,pipes,viewQuery,schemas,consts){const bindingStartIndex=19+decls,initialViewLength=bindingStartIndex+vars,blueprint=function(bindingStartIndex,initialViewLength){const blueprint=[];for(let i=0;i<initialViewLength;i++)blueprint.push(i<bindingStartIndex?null:NO_CHANGE);return blueprint}(bindingStartIndex,initialViewLength);return blueprint[1]={type:type,id:viewIndex,blueprint:blueprint,template:templateFn,queries:null,viewQuery:viewQuery,node:null,data:blueprint.slice().fill(null,bindingStartIndex),bindingStartIndex:bindingStartIndex,expandoStartIndex:initialViewLength,expandoInstructions:null,firstCreatePass:!0,firstUpdatePass:!0,staticViewQueries:!1,staticContentQueries:!1,preOrderHooks:null,preOrderCheckHooks:null,contentHooks:null,contentCheckHooks:null,viewHooks:null,viewCheckHooks:null,destroyHooks:null,cleanup:null,contentQueries:null,components:null,directiveRegistry:\"function\"==typeof directives?directives():directives,pipeRegistry:\"function\"==typeof pipes?pipes():pipes,firstChild:null,schemas:schemas,consts:consts}}function createTNode(tView,tParent,type,adjustedIndex,tagName,attrs){return{type:type,index:adjustedIndex,injectorIndex:tParent?tParent.injectorIndex:-1,directiveStart:-1,directiveEnd:-1,directiveStylingLast:-1,propertyBindings:null,flags:0,providerIndexes:0,tagName:tagName,attrs:attrs,mergedAttrs:null,localNames:null,initialInputs:void 0,inputs:null,outputs:null,tViews:null,next:null,projectionNext:null,child:null,parent:tParent,projection:null,styles:null,residualStyles:void 0,classes:null,residualClasses:void 0,classBindings:0,styleBindings:0}}function generatePropertyAliases(inputAliasMap,directiveDefIdx,propStore){for(let publicName in inputAliasMap)if(inputAliasMap.hasOwnProperty(publicName)){const internalName=inputAliasMap[publicName];(propStore=null===propStore?{}:propStore).hasOwnProperty(publicName)?propStore[publicName].push(directiveDefIdx,internalName):propStore[publicName]=[directiveDefIdx,internalName]}return propStore}function elementPropertyInternal(tView,tNode,lView,propName,value,renderer,sanitizer,nativeOnly){const element=getNativeByTNode(tNode,lView);let dataValue,inputData=tNode.inputs;!nativeOnly&&null!=inputData&&(dataValue=inputData[propName])?(setInputsForProperty(tView,lView,dataValue,propName,value),isComponentHost(tNode)&&function(lView,viewIndex){const childComponentLView=getComponentLViewByIndex(viewIndex,lView);16&childComponentLView[2]||(childComponentLView[2]|=64)}(lView,tNode.index)):3===tNode.type&&(propName=function(name){return\"class\"===name?\"className\":\"for\"===name?\"htmlFor\":\"formaction\"===name?\"formAction\":\"innerHtml\"===name?\"innerHTML\":\"readonly\"===name?\"readOnly\":\"tabindex\"===name?\"tabIndex\":name}(propName),value=null!=sanitizer?sanitizer(value,tNode.tagName||\"\",propName):value,isProceduralRenderer(renderer)?renderer.setProperty(element,propName,value):isAnimationProp(propName)||(element.setProperty?element.setProperty(propName,value):element[propName]=value))}function resolveDirectives(tView,lView,tNode,localRefs){let hasDirectives=!1;if(getBindingsEnabled()){const directiveDefs=function(tView,viewData,tNode){const registry=tView.directiveRegistry;let matches=null;if(registry)for(let i=0;i<registry.length;i++){const def=registry[i];isNodeMatchingSelectorList(tNode,def.selectors,!1)&&(matches||(matches=[]),diPublicInInjector(getOrCreateNodeInjectorForNode(tNode,viewData),tView,def.type),isComponentDef(def)?(2&tNode.flags&&throwMultipleComponentError(tNode),markAsComponentHost(tView,tNode),matches.unshift(def)):matches.push(def))}return matches}(tView,lView,tNode),exportsMap=null===localRefs?null:{\"\":-1};if(null!==directiveDefs){let totalDirectiveHostVars=0;hasDirectives=!0,initTNodeFlags(tNode,tView.data.length,directiveDefs.length);for(let i=0;i<directiveDefs.length;i++){const def=directiveDefs[i];def.providersResolver&&def.providersResolver(def)}generateExpandoInstructionBlock(tView,tNode,directiveDefs.length);let preOrderHooksFound=!1,preOrderCheckHooksFound=!1;for(let i=0;i<directiveDefs.length;i++){const def=directiveDefs[i];tNode.mergedAttrs=mergeHostAttrs(tNode.mergedAttrs,def.hostAttrs),baseResolveDirective(tView,lView,def),saveNameToExportMap(tView.data.length-1,def,exportsMap),null!==def.contentQueries&&(tNode.flags|=8),null===def.hostBindings&&null===def.hostAttrs&&0===def.hostVars||(tNode.flags|=128),!preOrderHooksFound&&(def.onChanges||def.onInit||def.doCheck)&&((tView.preOrderHooks||(tView.preOrderHooks=[])).push(tNode.index-19),preOrderHooksFound=!0),preOrderCheckHooksFound||!def.onChanges&&!def.doCheck||((tView.preOrderCheckHooks||(tView.preOrderCheckHooks=[])).push(tNode.index-19),preOrderCheckHooksFound=!0),addHostBindingsToExpandoInstructions(tView,def),totalDirectiveHostVars+=def.hostVars}!function(tView,tNode){const end=tNode.directiveEnd,defs=tView.data,tNodeAttrs=tNode.attrs,inputsFromAttrs=[];let inputsStore=null,outputsStore=null;for(let i=tNode.directiveStart;i<end;i++){const directiveDef=defs[i],directiveInputs=directiveDef.inputs;inputsFromAttrs.push(null!==tNodeAttrs?generateInitialInputs(directiveInputs,tNodeAttrs):null),inputsStore=generatePropertyAliases(directiveInputs,i,inputsStore),outputsStore=generatePropertyAliases(directiveDef.outputs,i,outputsStore)}null!==inputsStore&&(inputsStore.hasOwnProperty(\"class\")&&(tNode.flags|=16),inputsStore.hasOwnProperty(\"style\")&&(tNode.flags|=32)),tNode.initialInputs=inputsFromAttrs,tNode.inputs=inputsStore,tNode.outputs=outputsStore}(tView,tNode),growHostVarsSpace(tView,lView,totalDirectiveHostVars)}exportsMap&&function(tNode,localRefs,exportsMap){if(localRefs){const localNames=tNode.localNames=[];for(let i=0;i<localRefs.length;i+=2){const index=exportsMap[localRefs[i+1]];if(null==index)throw new Error(`Export of name '${localRefs[i+1]}' not found!`);localNames.push(localRefs[i],index)}}}(tNode,localRefs,exportsMap)}return tNode.mergedAttrs=mergeHostAttrs(tNode.mergedAttrs,tNode.attrs),hasDirectives}function addHostBindingsToExpandoInstructions(tView,def){const expando=tView.expandoInstructions;expando.push(def.hostBindings),0!==def.hostVars&&expando.push(def.hostVars)}function growHostVarsSpace(tView,lView,count){for(let i=0;i<count;i++)lView.push(NO_CHANGE),tView.blueprint.push(NO_CHANGE),tView.data.push(null)}function invokeHostBindingsInCreationMode(def,directive){null!==def.hostBindings&&def.hostBindings(1,directive)}function generateExpandoInstructionBlock(tView,tNode,directiveCount){const elementIndex=19-tNode.index,providerCount=tView.data.length-(65535&tNode.providerIndexes);(tView.expandoInstructions||(tView.expandoInstructions=[])).push(elementIndex,providerCount,directiveCount)}function markAsComponentHost(tView,hostTNode){hostTNode.flags|=2,(tView.components||(tView.components=[])).push(hostTNode.index)}function saveNameToExportMap(index,def,exportsMap){if(exportsMap){if(def.exportAs)for(let i=0;i<def.exportAs.length;i++)exportsMap[def.exportAs[i]]=index;isComponentDef(def)&&(exportsMap[\"\"]=index)}}function initTNodeFlags(tNode,index,numberOfDirectives){tNode.flags|=1,tNode.directiveStart=index,tNode.directiveEnd=index+numberOfDirectives,tNode.providerIndexes=index}function baseResolveDirective(tView,viewData,def){tView.data.push(def);const directiveFactory=def.factory||(def.factory=getFactoryDef(def.type)),nodeInjectorFactory=new NodeInjectorFactory(directiveFactory,isComponentDef(def),null);tView.blueprint.push(nodeInjectorFactory),viewData.push(nodeInjectorFactory)}function addComponentLogic(lView,hostTNode,def){const native=getNativeByTNode(hostTNode,lView),tView=getOrCreateTComponentView(def),rendererFactory=lView[10],componentView=addToViewTree(lView,createLView(lView,tView,null,def.onPush?64:16,native,hostTNode,rendererFactory,rendererFactory.createRenderer(native,def)));lView[hostTNode.index]=componentView}function setInputsFromAttrs(lView,directiveIndex,instance,def,tNode,initialInputData){const initialInputs=initialInputData[directiveIndex];if(null!==initialInputs){const setInput=def.setInput;for(let i=0;i<initialInputs.length;){const publicName=initialInputs[i++],privateName=initialInputs[i++],value=initialInputs[i++];null!==setInput?def.setInput(instance,value,publicName,privateName):instance[privateName]=value}}}function generateInitialInputs(inputs,attrs){let inputsToStore=null,i=0;for(;i<attrs.length;){const attrName=attrs[i];if(0!==attrName)if(5!==attrName){if(\"number\"==typeof attrName)break;inputs.hasOwnProperty(attrName)&&(null===inputsToStore&&(inputsToStore=[]),inputsToStore.push(attrName,inputs[attrName],attrs[i+1])),i+=2}else i+=2;else i+=4}return inputsToStore}function createLContainer(hostNative,currentView,native,tNode){return new Array(hostNative,!0,-2,currentView,null,null,tNode,native,null)}function refreshTransplantedViews(lContainer,declaredComponentLView){const movedViews=lContainer[5];for(let i=0;i<movedViews.length;i++){const movedLView=movedViews[i],insertedComponentLView=movedLView[3][3][16];if(insertedComponentLView!==declaredComponentLView&&0==(16&insertedComponentLView[2])){const movedTView=movedLView[1];refreshView(movedTView,movedLView,movedTView.template,movedLView[8])}}}function refreshComponent(hostLView,componentHostIdx){const componentView=getComponentLViewByIndex(componentHostIdx,hostLView);if(viewAttachedToChangeDetector(componentView)&&80&componentView[2]){const componentTView=componentView[1];refreshView(componentTView,componentView,componentTView.template,componentView[8])}}function renderComponent(hostLView,componentHostIdx){const componentView=getComponentLViewByIndex(componentHostIdx,hostLView),componentTView=componentView[1];!function(tView,lView){for(let i=lView.length;i<tView.blueprint.length;i++)lView.push(tView.blueprint[i])}(componentTView,componentView),renderView(componentTView,componentView,componentView[8])}function addToViewTree(lView,lViewOrLContainer){return lView[13]?lView[14][4]=lViewOrLContainer:lView[13]=lViewOrLContainer,lView[14]=lViewOrLContainer,lViewOrLContainer}function markViewDirty(lView){for(;lView;){lView[2]|=64;const parent=getLViewParent(lView);if(isRootView(lView)&&!parent)return lView;lView=parent}return null}function detectChangesInternal(tView,lView,context){const rendererFactory=lView[10];rendererFactory.begin&&rendererFactory.begin();try{refreshView(tView,lView,tView.template,context)}catch(error){throw handleError(lView,error),error}finally{rendererFactory.end&&rendererFactory.end()}}function detectChangesInRootView(lView){!function(rootContext){for(let i=0;i<rootContext.components.length;i++){const rootComponent=rootContext.components[i],lView=readPatchedLView(rootComponent),tView=lView[1];renderComponentOrTemplate(tView,lView,tView.template,rootComponent)}}(lView[8])}function executeViewQueryFn(flags,viewQueryFn,component){setCurrentQueryIndex(0),viewQueryFn(flags,component)}const CLEAN_PROMISE=(()=>Promise.resolve(null))();function getLCleanup(view){return view[7]||(view[7]=[])}function handleError(lView,error){const injector=lView[9],errorHandler=injector?injector.get(ErrorHandler,null):null;errorHandler&&errorHandler.handleError(error)}function setInputsForProperty(tView,lView,inputs,publicName,value){for(let i=0;i<inputs.length;){const index=inputs[i++],privateName=inputs[i++],instance=lView[index],def=tView.data[index];null!==def.setInput?def.setInput(instance,value,publicName,privateName):instance[privateName]=value}}function getLContainer(tNode,embeddedView){const container=embeddedView[3];return-1===tNode.index?isLContainer(container)?container:null:container}function getContainerRenderParent(tViewNode,view){const container=getLContainer(tViewNode,view);return container?nativeParentNode(view[11],container[7]):null}function applyToElementOrContainer(action,renderer,parent,lNodeToHandle,beforeNode){if(null!=lNodeToHandle){let lContainer,isComponent=!1;isLContainer(lNodeToHandle)?lContainer=lNodeToHandle:isLView(lNodeToHandle)&&(isComponent=!0,lNodeToHandle=lNodeToHandle[0]);const rNode=unwrapRNode(lNodeToHandle);0===action&&null!==parent?null==beforeNode?nativeAppendChild(renderer,parent,rNode):nativeInsertBefore(renderer,parent,rNode,beforeNode||null):1===action&&null!==parent?nativeInsertBefore(renderer,parent,rNode,beforeNode||null):2===action?function(renderer,rNode,isHostElement){const nativeParent=nativeParentNode(renderer,rNode);nativeParent&&function(renderer,parent,child,isHostElement){isProceduralRenderer(renderer)?renderer.removeChild(parent,child,isHostElement):parent.removeChild(child)}(renderer,nativeParent,rNode,isHostElement)}(renderer,rNode,isComponent):3===action&&renderer.destroyNode(rNode),null!=lContainer&&function(renderer,action,lContainer,renderParent,beforeNode){const anchor=lContainer[7];anchor!==unwrapRNode(lContainer)&&applyToElementOrContainer(action,renderer,renderParent,anchor,beforeNode);for(let i=9;i<lContainer.length;i++){const lView=lContainer[i];applyView(lView[1],lView,renderer,action,renderParent,anchor)}}(renderer,action,lContainer,parent,beforeNode)}}function addRemoveViewFromContainer(tView,lView,insertMode,beforeNode){const renderParent=getContainerRenderParent(tView.node,lView);renderParent&&applyView(tView,lView,lView[11],insertMode?1:2,renderParent,beforeNode)}function detachMovedView(declarationContainer,lView){const movedViews=declarationContainer[5],declaredViewIndex=movedViews.indexOf(lView);movedViews.splice(declaredViewIndex,1)}function detachView(lContainer,removeIndex){if(lContainer.length<=9)return;const indexInContainer=9+removeIndex,viewToDetach=lContainer[indexInContainer];if(viewToDetach){const declarationLContainer=viewToDetach[17];null!==declarationLContainer&&declarationLContainer!==lContainer&&detachMovedView(declarationLContainer,viewToDetach),removeIndex>0&&(lContainer[indexInContainer-1][4]=viewToDetach[4]);const removedLView=removeFromArray(lContainer,9+removeIndex);addRemoveViewFromContainer(viewToDetach[1],viewToDetach,!1,null);const lQueries=removedLView[5];null!==lQueries&&lQueries.detachView(removedLView[1]),viewToDetach[3]=null,viewToDetach[4]=null,viewToDetach[2]&=-129}return viewToDetach}function destroyLView(tView,lView){if(!(256&lView[2])){const renderer=lView[11];isProceduralRenderer(renderer)&&renderer.destroyNode&&applyView(tView,lView,renderer,3,null,null),function(rootView){let lViewOrLContainer=rootView[13];if(!lViewOrLContainer)return cleanUpView(rootView[1],rootView);for(;lViewOrLContainer;){let next=null;if(isLView(lViewOrLContainer))next=lViewOrLContainer[13];else{const firstView=lViewOrLContainer[9];firstView&&(next=firstView)}if(!next){for(;lViewOrLContainer&&!lViewOrLContainer[4]&&lViewOrLContainer!==rootView;)isLView(lViewOrLContainer)&&cleanUpView(lViewOrLContainer[1],lViewOrLContainer),lViewOrLContainer=getParentState(lViewOrLContainer,rootView);null===lViewOrLContainer&&(lViewOrLContainer=rootView),isLView(lViewOrLContainer)&&cleanUpView(lViewOrLContainer[1],lViewOrLContainer),next=lViewOrLContainer&&lViewOrLContainer[4]}lViewOrLContainer=next}}(lView)}}function getParentState(lViewOrLContainer,rootView){let tNode;return isLView(lViewOrLContainer)&&(tNode=lViewOrLContainer[6])&&2===tNode.type?getLContainer(tNode,lViewOrLContainer):lViewOrLContainer[3]===rootView?null:lViewOrLContainer[3]}function cleanUpView(tView,lView){if(!(256&lView[2])){lView[2]&=-129,lView[2]|=256,function(tView,lView){let destroyHooks;if(null!=tView&&null!=(destroyHooks=tView.destroyHooks))for(let i=0;i<destroyHooks.length;i+=2){const context=lView[destroyHooks[i]];context instanceof NodeInjectorFactory||destroyHooks[i+1].call(context)}}(tView,lView),function(tView,lView){const tCleanup=tView.cleanup;if(null!==tCleanup){const lCleanup=lView[7];for(let i=0;i<tCleanup.length-1;i+=2)if(\"string\"==typeof tCleanup[i]){const idxOrTargetGetter=tCleanup[i+1],target=\"function\"==typeof idxOrTargetGetter?idxOrTargetGetter(lView):unwrapRNode(lView[idxOrTargetGetter]),listener=lCleanup[tCleanup[i+2]],useCaptureOrSubIdx=tCleanup[i+3];\"boolean\"==typeof useCaptureOrSubIdx?target.removeEventListener(tCleanup[i],listener,useCaptureOrSubIdx):useCaptureOrSubIdx>=0?lCleanup[useCaptureOrSubIdx]():lCleanup[-useCaptureOrSubIdx].unsubscribe(),i+=2}else tCleanup[i].call(lCleanup[tCleanup[i+1]]);lView[7]=null}}(tView,lView);const hostTNode=lView[6];hostTNode&&3===hostTNode.type&&isProceduralRenderer(lView[11])&&lView[11].destroy();const declarationContainer=lView[17];if(null!==declarationContainer&&isLContainer(lView[3])){declarationContainer!==lView[3]&&detachMovedView(declarationContainer,lView);const lQueries=lView[5];null!==lQueries&&lQueries.detachView(tView)}}}function nativeInsertBefore(renderer,parent,child,beforeNode){isProceduralRenderer(renderer)?renderer.insertBefore(parent,child,beforeNode):parent.insertBefore(child,beforeNode,!0)}function nativeAppendChild(renderer,parent,child){isProceduralRenderer(renderer)?renderer.appendChild(parent,child):parent.appendChild(child)}function nativeAppendOrInsertBefore(renderer,parent,child,beforeNode){null!==beforeNode?nativeInsertBefore(renderer,parent,child,beforeNode):nativeAppendChild(renderer,parent,child)}function nativeParentNode(renderer,node){return isProceduralRenderer(renderer)?renderer.parentNode(node):node.parentNode}function appendChild(tView,lView,childEl,childTNode){const renderParent=function(tView,tNode,currentView){let parentTNode=tNode.parent;for(;null!=parentTNode&&(4===parentTNode.type||5===parentTNode.type);)parentTNode=(tNode=parentTNode).parent;if(null==parentTNode){const hostTNode=currentView[6];return 2===hostTNode.type?getContainerRenderParent(hostTNode,currentView):currentView[0]}if(tNode&&5===tNode.type&&4&tNode.flags)return getNativeByTNode(tNode,currentView).parentNode;if(2&parentTNode.flags){const tData=tView.data,encapsulation=tData[tData[parentTNode.index].directiveStart].encapsulation;if(encapsulation!==ViewEncapsulation$1.ShadowDom&&encapsulation!==ViewEncapsulation$1.Native)return null}return getNativeByTNode(parentTNode,currentView)}(tView,childTNode,lView);if(null!=renderParent){const renderer=lView[11],anchorNode=function(parentTNode,lView){if(2===parentTNode.type){const lContainer=getLContainer(parentTNode,lView);return null===lContainer?null:getBeforeNodeForView(lContainer.indexOf(lView,9)-9,lContainer)}return 4===parentTNode.type||5===parentTNode.type?getNativeByTNode(parentTNode,lView):null}(childTNode.parent||lView[6],lView);if(Array.isArray(childEl))for(let i=0;i<childEl.length;i++)nativeAppendOrInsertBefore(renderer,renderParent,childEl[i],anchorNode);else nativeAppendOrInsertBefore(renderer,renderParent,childEl,anchorNode)}}function getBeforeNodeForView(viewIndexInContainer,lContainer){const nextViewIndex=9+viewIndexInContainer+1;if(nextViewIndex<lContainer.length){const lView=lContainer[nextViewIndex],firstTNodeOfView=lView[1].firstChild;if(null!==firstTNodeOfView)return function getFirstNativeNode(lView,tNode){if(null!==tNode){const tNodeType=tNode.type;if(3===tNodeType)return getNativeByTNode(tNode,lView);if(0===tNodeType)return getBeforeNodeForView(-1,lView[tNode.index]);if(4===tNodeType||5===tNodeType){const elIcuContainerChild=tNode.child;if(null!==elIcuContainerChild)return getFirstNativeNode(lView,elIcuContainerChild);{const rNodeOrLContainer=lView[tNode.index];return isLContainer(rNodeOrLContainer)?getBeforeNodeForView(-1,rNodeOrLContainer):unwrapRNode(rNodeOrLContainer)}}{const componentView=lView[16],componentHost=componentView[6],parentView=getLViewParent(componentView),firstProjectedTNode=componentHost.projection[tNode.projection];return null!=firstProjectedTNode?getFirstNativeNode(parentView,firstProjectedTNode):getFirstNativeNode(lView,tNode.next)}}return null}(lView,firstTNodeOfView)}return lContainer[7]}function applyNodes(renderer,action,tNode,lView,renderParent,beforeNode,isProjection){for(;null!=tNode;){const rawSlotValue=lView[tNode.index],tNodeType=tNode.type;isProjection&&0===action&&(rawSlotValue&&attachPatchData(unwrapRNode(rawSlotValue),lView),tNode.flags|=4),64!=(64&tNode.flags)&&(4===tNodeType||5===tNodeType?(applyNodes(renderer,action,tNode.child,lView,renderParent,beforeNode,!1),applyToElementOrContainer(action,renderer,renderParent,rawSlotValue,beforeNode)):1===tNodeType?applyProjectionRecursive(renderer,action,lView,tNode,renderParent,beforeNode):applyToElementOrContainer(action,renderer,renderParent,rawSlotValue,beforeNode)),tNode=isProjection?tNode.projectionNext:tNode.next}}function applyView(tView,lView,renderer,action,renderParent,beforeNode){applyNodes(renderer,action,tView.node.child,lView,renderParent,beforeNode,!1)}function applyProjectionRecursive(renderer,action,lView,tProjectionNode,renderParent,beforeNode){const componentLView=lView[16],nodeToProjectOrRNodes=componentLView[6].projection[tProjectionNode.projection];if(Array.isArray(nodeToProjectOrRNodes))for(let i=0;i<nodeToProjectOrRNodes.length;i++)applyToElementOrContainer(action,renderer,renderParent,nodeToProjectOrRNodes[i],beforeNode);else applyNodes(renderer,action,nodeToProjectOrRNodes,componentLView[3],renderParent,beforeNode,!0)}function writeDirectStyle(renderer,element,newValue){isProceduralRenderer(renderer)?renderer.setAttribute(element,\"style\",newValue):element.style.cssText=newValue}function writeDirectClass(renderer,element,newValue){isProceduralRenderer(renderer)?\"\"===newValue?renderer.removeAttribute(element,\"class\"):renderer.setAttribute(element,\"class\",newValue):element.className=newValue}class ViewRef{constructor(_lView,_cdRefInjectingView){this._lView=_lView,this._cdRefInjectingView=_cdRefInjectingView,this._appRef=null,this._viewContainerRef=null,this._tViewNode=null}get rootNodes(){const lView=this._lView;return null==lView[0]?function collectNativeNodes(tView,lView,tNode,result,isProjection=!1){for(;null!==tNode;){const lNode=lView[tNode.index];if(null!==lNode&&result.push(unwrapRNode(lNode)),isLContainer(lNode))for(let i=9;i<lNode.length;i++){const lViewInAContainer=lNode[i],lViewFirstChildTNode=lViewInAContainer[1].firstChild;null!==lViewFirstChildTNode&&collectNativeNodes(lViewInAContainer[1],lViewInAContainer,lViewFirstChildTNode,result)}const tNodeType=tNode.type;if(4===tNodeType||5===tNodeType)collectNativeNodes(tView,lView,tNode.child,result);else if(1===tNodeType){const componentView=lView[16],componentHost=componentView[6],parentView=getLViewParent(componentView);let firstProjectedNode=componentHost.projection[tNode.projection];null!==firstProjectedNode&&null!==parentView&&collectNativeNodes(parentView[1],parentView,firstProjectedNode,result,!0)}tNode=isProjection?tNode.projectionNext:tNode.next}return result}(lView[1],lView,lView[6].child,[]):[]}get context(){return this._lView[8]}get destroyed(){return 256==(256&this._lView[2])}destroy(){if(this._appRef)this._appRef.detachView(this);else if(this._viewContainerRef){const index=this._viewContainerRef.indexOf(this);index>-1&&this._viewContainerRef.detach(index),this._viewContainerRef=null}destroyLView(this._lView[1],this._lView)}onDestroy(callback){var tView,lView,cleanupFn;tView=this._lView[1],cleanupFn=callback,getLCleanup(lView=this._lView).push(cleanupFn),tView.firstCreatePass&&function(tView){return tView.cleanup||(tView.cleanup=[])}(tView).push(lView[7].length-1,null)}markForCheck(){markViewDirty(this._cdRefInjectingView||this._lView)}detach(){this._lView[2]&=-129}reattach(){this._lView[2]|=128}detectChanges(){detectChangesInternal(this._lView[1],this._lView,this.context)}checkNoChanges(){!function(tView,view,context){setCheckNoChangesMode(!0);try{detectChangesInternal(tView,view,context)}finally{setCheckNoChangesMode(!1)}}(this._lView[1],this._lView,this.context)}attachToViewContainerRef(vcRef){if(this._appRef)throw new Error(\"This view is already attached directly to the ApplicationRef!\");this._viewContainerRef=vcRef}detachFromAppRef(){var lView;this._appRef=null,applyView(this._lView[1],lView=this._lView,lView[11],2,null,null)}attachToAppRef(appRef){if(this._viewContainerRef)throw new Error(\"This view is already attached to a ViewContainer!\");this._appRef=appRef}}class RootViewRef extends ViewRef{constructor(_view){super(_view),this._view=_view}detectChanges(){detectChangesInRootView(this._view)}checkNoChanges(){!function(lView){setCheckNoChangesMode(!0);try{detectChangesInRootView(lView)}finally{setCheckNoChangesMode(!1)}}(this._view)}get context(){return null}}let R3ElementRef,R3TemplateRef,R3ViewContainerRef;function createElementRef(ElementRefToken,tNode,view){return R3ElementRef||(R3ElementRef=class extends ElementRefToken{}),new R3ElementRef(getNativeByTNode(tNode,view))}let ChangeDetectorRef=(()=>{class ChangeDetectorRef{}return ChangeDetectorRef.__NG_ELEMENT_ID__=()=>SWITCH_CHANGE_DETECTOR_REF_FACTORY(),ChangeDetectorRef})();const SWITCH_CHANGE_DETECTOR_REF_FACTORY=function(isPipe=!1){return function(tNode,lView,isPipe){if(!isPipe&&isComponentHost(tNode)){const componentView=getComponentLViewByIndex(tNode.index,lView);return new ViewRef(componentView,componentView)}return 3===tNode.type||0===tNode.type||4===tNode.type||5===tNode.type?new ViewRef(lView[16],lView):null}(getPreviousOrParentTNode(),getLView(),isPipe)},INJECTOR_SCOPE=new InjectionToken(\"Set Injector scope.\"),NOT_YET={},CIRCULAR={},EMPTY_ARRAY$2=[];let NULL_INJECTOR=void 0;function getNullInjector(){return void 0===NULL_INJECTOR&&(NULL_INJECTOR=new NullInjector),NULL_INJECTOR}function createInjectorWithoutInjectorInstances(defType,parent=null,additionalProviders=null,name){return new R3Injector(defType,additionalProviders,parent||getNullInjector(),name)}class R3Injector{constructor(def,additionalProviders,parent,source=null){this.parent=parent,this.records=new Map,this.injectorDefTypes=new Set,this.onDestroy=new Set,this._destroyed=!1;const dedupStack=[];additionalProviders&&deepForEach(additionalProviders,provider=>this.processProvider(provider,def,additionalProviders)),deepForEach([def],injectorDef=>this.processInjectorType(injectorDef,[],dedupStack)),this.records.set(INJECTOR,makeRecord(void 0,this));const record=this.records.get(INJECTOR_SCOPE);this.scope=null!=record?record.value:null,this.source=source||(\"object\"==typeof def?null:stringify(def))}get destroyed(){return this._destroyed}destroy(){this.assertNotDestroyed(),this._destroyed=!0;try{this.onDestroy.forEach(service=>service.ngOnDestroy())}finally{this.records.clear(),this.onDestroy.clear(),this.injectorDefTypes.clear()}}get(token,notFoundValue=THROW_IF_NOT_FOUND,flags=InjectFlags.Default){this.assertNotDestroyed();const previousInjector=setCurrentInjector(this);try{if(!(flags&InjectFlags.SkipSelf)){let record=this.records.get(token);if(void 0===record){const def=(\"function\"==typeof(value=token)||\"object\"==typeof value&&value instanceof InjectionToken)&&getInjectableDef(token);record=def&&this.injectableDefInScope(def)?makeRecord(injectableDefOrInjectorDefFactory(token),NOT_YET):null,this.records.set(token,record)}if(null!=record)return this.hydrate(token,record)}return(flags&InjectFlags.Self?getNullInjector():this.parent).get(token,notFoundValue=flags&InjectFlags.Optional&&notFoundValue===THROW_IF_NOT_FOUND?null:notFoundValue)}catch(e){if(\"NullInjectorError\"===e.name){if((e.ngTempTokenPath=e.ngTempTokenPath||[]).unshift(stringify(token)),previousInjector)throw e;return function(e,token,injectorErrorName,source){const tokenPath=e.ngTempTokenPath;throw token.__source&&tokenPath.unshift(token.__source),e.message=function(text,obj,injectorErrorName,source=null){text=text&&\"\\n\"===text.charAt(0)&&\"ɵ\"==text.charAt(1)?text.substr(2):text;let context=stringify(obj);if(Array.isArray(obj))context=obj.map(stringify).join(\" -> \");else if(\"object\"==typeof obj){let parts=[];for(let key in obj)if(obj.hasOwnProperty(key)){let value=obj[key];parts.push(key+\":\"+(\"string\"==typeof value?JSON.stringify(value):stringify(value)))}context=`{${parts.join(\", \")}}`}return`${injectorErrorName}${source?\"(\"+source+\")\":\"\"}[${context}]: ${text.replace(NEW_LINE,\"\\n  \")}`}(\"\\n\"+e.message,tokenPath,injectorErrorName,source),e.ngTokenPath=tokenPath,e.ngTempTokenPath=null,e}(e,token,\"R3InjectorError\",this.source)}throw e}finally{setCurrentInjector(previousInjector)}var value}_resolveInjectorDefTypes(){this.injectorDefTypes.forEach(defType=>this.get(defType))}toString(){const tokens=[];return this.records.forEach((v,token)=>tokens.push(stringify(token))),`R3Injector[${tokens.join(\", \")}]`}assertNotDestroyed(){if(this._destroyed)throw new Error(\"Injector has already been destroyed.\")}processInjectorType(defOrWrappedDef,parents,dedupStack){if(!(defOrWrappedDef=resolveForwardRef(defOrWrappedDef)))return!1;let def=getInjectorDef(defOrWrappedDef);const ngModule=null==def&&defOrWrappedDef.ngModule||void 0,defType=void 0===ngModule?defOrWrappedDef:ngModule,isDuplicate=-1!==dedupStack.indexOf(defType);if(void 0!==ngModule&&(def=getInjectorDef(ngModule)),null==def)return!1;if(null!=def.imports&&!isDuplicate){let importTypesWithProviders;dedupStack.push(defType);try{deepForEach(def.imports,imported=>{this.processInjectorType(imported,parents,dedupStack)&&(void 0===importTypesWithProviders&&(importTypesWithProviders=[]),importTypesWithProviders.push(imported))})}finally{}if(void 0!==importTypesWithProviders)for(let i=0;i<importTypesWithProviders.length;i++){const{ngModule:ngModule,providers:providers}=importTypesWithProviders[i];deepForEach(providers,provider=>this.processProvider(provider,ngModule,providers||EMPTY_ARRAY$2))}}this.injectorDefTypes.add(defType),this.records.set(defType,makeRecord(def.factory,NOT_YET));const defProviders=def.providers;if(null!=defProviders&&!isDuplicate){const injectorType=defOrWrappedDef;deepForEach(defProviders,provider=>this.processProvider(provider,injectorType,defProviders))}return void 0!==ngModule&&void 0!==defOrWrappedDef.providers}processProvider(provider,ngModuleType,providers){let token=isTypeProvider(provider=resolveForwardRef(provider))?provider:resolveForwardRef(provider&&provider.provide);const record=function(provider,ngModuleType,providers){return isValueProvider(provider)?makeRecord(void 0,provider.useValue):makeRecord(providerToFactory(provider,ngModuleType,providers),NOT_YET)}(provider,ngModuleType,providers);if(isTypeProvider(provider)||!0!==provider.multi){const existing=this.records.get(token);existing&&void 0!==existing.multi&&throwMixedMultiProviderError()}else{let multiRecord=this.records.get(token);multiRecord?void 0===multiRecord.multi&&throwMixedMultiProviderError():(multiRecord=makeRecord(void 0,NOT_YET,!0),multiRecord.factory=()=>injectArgs(multiRecord.multi),this.records.set(token,multiRecord)),token=provider,multiRecord.multi.push(provider)}this.records.set(token,record)}hydrate(token,record){var value;return record.value===CIRCULAR?function(token){throw new Error(\"Cannot instantiate cyclic dependency! \"+token)}(stringify(token)):record.value===NOT_YET&&(record.value=CIRCULAR,record.value=record.factory()),\"object\"==typeof record.value&&record.value&&null!==(value=record.value)&&\"object\"==typeof value&&\"function\"==typeof value.ngOnDestroy&&this.onDestroy.add(record.value),record.value}injectableDefInScope(def){return!!def.providedIn&&(\"string\"==typeof def.providedIn?\"any\"===def.providedIn||def.providedIn===this.scope:this.injectorDefTypes.has(def.providedIn))}}function injectableDefOrInjectorDefFactory(token){const injectableDef=getInjectableDef(token),factory=null!==injectableDef?injectableDef.factory:getFactoryDef(token);if(null!==factory)return factory;const injectorDef=getInjectorDef(token);if(null!==injectorDef)return injectorDef.factory;if(token instanceof InjectionToken)throw new Error(`Token ${stringify(token)} is missing a ɵprov definition.`);if(token instanceof Function)return function(token){const paramLength=token.length;if(paramLength>0){const args=function(size,value){const list=[];for(let i=0;i<size;i++)list.push(\"?\");return list}(paramLength);throw new Error(`Can't resolve all parameters for ${stringify(token)}: (${args.join(\", \")}).`)}const inheritedInjectableDef=function(type){const def=type&&(type[NG_PROV_DEF]||type[NG_INJECTABLE_DEF]||type[NG_PROV_DEF_FALLBACK]&&type[NG_PROV_DEF_FALLBACK]());if(def){const typeName=function(type){if(type.hasOwnProperty(\"name\"))return type.name;const match=(\"\"+type).match(/^function\\s*([^\\s(]+)/);return null===match?\"\":match[1]}(type);return console.warn(`DEPRECATED: DI is instantiating a token \"${typeName}\" that inherits its @Injectable decorator but does not provide one itself.\\nThis will become an error in v10. Please add @Injectable() to the \"${typeName}\" class.`),def}return null}(token);return null!==inheritedInjectableDef?()=>inheritedInjectableDef.factory(token):()=>new token}(token);throw new Error(\"unreachable\")}function providerToFactory(provider,ngModuleType,providers){let factory=void 0;if(isTypeProvider(provider)){const unwrappedProvider=resolveForwardRef(provider);return getFactoryDef(unwrappedProvider)||injectableDefOrInjectorDefFactory(unwrappedProvider)}if(isValueProvider(provider))factory=()=>resolveForwardRef(provider.useValue);else if((value=provider)&&value.useFactory)factory=()=>provider.useFactory(...injectArgs(provider.deps||[]));else if(function(value){return!(!value||!value.useExisting)}(provider))factory=()=>ɵɵinject(resolveForwardRef(provider.useExisting));else{const classRef=resolveForwardRef(provider&&(provider.useClass||provider.provide));if(classRef||function(ngModuleType,providers,provider){let ngModuleDetail=\"\";throw ngModuleType&&providers&&(ngModuleDetail=` - only instances of Provider and Type are allowed, got: [${providers.map(v=>v==provider?\"?\"+provider+\"?\":\"...\").join(\", \")}]`),new Error(`Invalid provider for the NgModule '${stringify(ngModuleType)}'`+ngModuleDetail)}(ngModuleType,providers,provider),!function(value){return!!value.deps}(provider))return getFactoryDef(classRef)||injectableDefOrInjectorDefFactory(classRef);factory=()=>new classRef(...injectArgs(provider.deps))}var value;return factory}function makeRecord(factory,value,multi=!1){return{factory:factory,value:value,multi:multi?[]:void 0}}function isValueProvider(value){return null!==value&&\"object\"==typeof value&&USE_VALUE in value}function isTypeProvider(value){return\"function\"==typeof value}const INJECTOR_IMPL=function(providers,parent,name){return function(defType,parent=null,additionalProviders=null,name){const injector=createInjectorWithoutInjectorInstances(defType,parent,additionalProviders,name);return injector._resolveInjectorDefTypes(),injector}({name:name},parent,providers,name)};let Injector=(()=>{class Injector{static create(options,parent){return Array.isArray(options)?INJECTOR_IMPL(options,parent,\"\"):INJECTOR_IMPL(options.providers,options.parent,options.name||\"\")}}return Injector.THROW_IF_NOT_FOUND=THROW_IF_NOT_FOUND,Injector.NULL=new NullInjector,Injector.ɵprov=ɵɵdefineInjectable({token:Injector,providedIn:\"any\",factory:()=>ɵɵinject(INJECTOR)}),Injector.__NG_ELEMENT_ID__=-1,Injector})();const ANALYZE_FOR_ENTRY_COMPONENTS=new InjectionToken(\"AnalyzeForEntryComponents\");let componentResourceResolutionQueue=new Map;const componentDefPendingResolution=new Set;function unwrapResponse(response){return\"string\"==typeof response?response:response.text()}function computeStaticStyling(tNode,attrs){let styles=tNode.styles,classes=tNode.classes,mode=0;for(let i=0;i<attrs.length;i++){const value=attrs[i];\"number\"==typeof value?mode=value:1==mode?classes=concatStringsWithSpace(classes,value):2==mode&&(styles=concatStringsWithSpace(styles,value+\": \"+attrs[++i]+\";\"))}null!==styles&&(tNode.styles=styles),null!==classes&&(tNode.classes=classes)}let _symbolIterator=null;function core_getSymbolIterator(){if(!_symbolIterator){const Symbol=_global.Symbol;if(Symbol&&Symbol.iterator)_symbolIterator=Symbol.iterator;else{const keys=Object.getOwnPropertyNames(Map.prototype);for(let i=0;i<keys.length;++i){const key=keys[i];\"entries\"!==key&&\"size\"!==key&&Map.prototype[key]===Map.prototype.entries&&(_symbolIterator=key)}}}return _symbolIterator}function looseIdentical(a,b){return a===b||\"number\"==typeof a&&\"number\"==typeof b&&isNaN(a)&&isNaN(b)}function isListLikeIterable$1(obj){return!!isJsObject$1(obj)&&(Array.isArray(obj)||!(obj instanceof Map)&&core_getSymbolIterator()in obj)}function isJsObject$1(o){return null!==o&&(\"function\"==typeof o||\"object\"==typeof o)}function bindingUpdated(lView,bindingIndex,value){return!Object.is(lView[bindingIndex],value)&&(lView[bindingIndex]=value,!0)}function ɵɵattribute(name,value,sanitizer,namespace){const lView=getLView();return bindingUpdated(lView,nextBindingIndex(),value)&&(getTView(),function(tNode,lView,name,value,sanitizer,namespace){const element=getNativeByTNode(tNode,lView),renderer=lView[11];if(null==value)isProceduralRenderer(renderer)?renderer.removeAttribute(element,name,namespace):element.removeAttribute(name);else{const strValue=null==sanitizer?renderStringify(value):sanitizer(value,tNode.tagName||\"\",name);isProceduralRenderer(renderer)?renderer.setAttribute(element,name,strValue,namespace):namespace?element.setAttributeNS(namespace,name,strValue):element.setAttribute(name,strValue)}}(getSelectedTNode(),lView,name,value,sanitizer,namespace)),ɵɵattribute}function interpolation1(lView,prefix,v0,suffix){return bindingUpdated(lView,nextBindingIndex(),v0)?prefix+renderStringify(v0)+suffix:NO_CHANGE}function ɵɵtemplate(index,templateFn,decls,vars,tagName,attrsIndex,localRefsIndex,localRefExtractor){const lView=getLView(),tView=getTView(),adjustedIndex=index+19,tNode=tView.firstCreatePass?function(index,tView,lView,templateFn,decls,vars,tagName,attrsIndex,localRefsIndex){const tViewConsts=tView.consts,tNode=getOrCreateTNode(tView,lView[6],index,0,tagName||null,getConstant(tViewConsts,attrsIndex));resolveDirectives(tView,lView,tNode,getConstant(tViewConsts,localRefsIndex)),registerPostOrderHooks(tView,tNode);const embeddedTView=tNode.tViews=createTView(2,-1,templateFn,decls,vars,tView.directiveRegistry,tView.pipeRegistry,null,tView.schemas,tViewConsts),embeddedTViewNode=createTNode(0,null,2,-1,null,null);return embeddedTViewNode.injectorIndex=tNode.injectorIndex,embeddedTView.node=embeddedTViewNode,null!==tView.queries&&(tView.queries.template(tView,tNode),embeddedTView.queries=tView.queries.embeddedTView(tNode)),tNode}(index,tView,lView,templateFn,decls,vars,tagName,attrsIndex,localRefsIndex):tView.data[adjustedIndex];setPreviousOrParentTNode(tNode,!1);const comment=lView[11].createComment(\"\");appendChild(tView,lView,comment,tNode),attachPatchData(comment,lView),addToViewTree(lView,lView[adjustedIndex]=createLContainer(comment,lView,comment,tNode)),isDirectiveHost(tNode)&&createDirectivesInstances(tView,lView,tNode),null!=localRefsIndex&&saveResolvedLocalsInData(lView,tNode,localRefExtractor)}function ɵɵreference(index){return function(view,index){return view[index+19]}(instructionState.lFrame.contextLView,index)}function ɵɵdirectiveInject(token,flags=InjectFlags.Default){const lView=getLView();return null==lView?ɵɵinject(token,flags):getOrCreateInjectable(getPreviousOrParentTNode(),lView,resolveForwardRef(token),flags)}function ɵɵinjectAttribute(attrNameToInject){return function(tNode,attrNameToInject){if(\"class\"===attrNameToInject)return tNode.classes;if(\"style\"===attrNameToInject)return tNode.styles;const attrs=tNode.attrs;if(attrs){const attrsLength=attrs.length;let i=0;for(;i<attrsLength;){const value=attrs[i];if(isNameOnlyAttributeMarker(value))break;if(0===value)i+=2;else if(\"number\"==typeof value)for(i++;i<attrsLength&&\"string\"==typeof attrs[i];)i++;else{if(value===attrNameToInject)return attrs[i+1];i+=2}}}return null}(getPreviousOrParentTNode(),attrNameToInject)}function ɵɵinvalidFactory(){throw new Error(\"invalid\")}function ɵɵproperty(propName,value,sanitizer){const lView=getLView();return bindingUpdated(lView,nextBindingIndex(),value)&&elementPropertyInternal(getTView(),getSelectedTNode(),lView,propName,value,lView[11],sanitizer,!1),ɵɵproperty}function setDirectiveInputsWhichShadowsStyling(tView,tNode,lView,value,isClassBased){const property=isClassBased?\"class\":\"style\";setInputsForProperty(tView,lView,tNode.inputs[property],property,value)}function ɵɵelementStart(index,name,attrsIndex,localRefsIndex){const lView=getLView(),tView=getTView(),adjustedIndex=19+index,renderer=lView[11],native=lView[adjustedIndex]=elementCreate(name,renderer,instructionState.lFrame.currentNamespace),tNode=tView.firstCreatePass?function(index,tView,lView,native,name,attrsIndex,localRefsIndex){const tViewConsts=tView.consts,attrs=getConstant(tViewConsts,attrsIndex),tNode=getOrCreateTNode(tView,lView[6],index,3,name,attrs);return resolveDirectives(tView,lView,tNode,getConstant(tViewConsts,localRefsIndex)),null!==tNode.mergedAttrs&&computeStaticStyling(tNode,tNode.mergedAttrs),null!==tView.queries&&tView.queries.elementStart(tView,tNode),tNode}(index,tView,lView,0,name,attrsIndex,localRefsIndex):tView.data[adjustedIndex];setPreviousOrParentTNode(tNode,!0);const mergedAttrs=tNode.mergedAttrs;null!==mergedAttrs&&setUpAttributes(renderer,native,mergedAttrs);const classes=tNode.classes;null!==classes&&writeDirectClass(renderer,native,classes);const styles=tNode.styles;null!==styles&&writeDirectStyle(renderer,native,styles),appendChild(tView,lView,native,tNode),0===instructionState.lFrame.elementDepthCount&&attachPatchData(native,lView),instructionState.lFrame.elementDepthCount++,isDirectiveHost(tNode)&&(createDirectivesInstances(tView,lView,tNode),executeContentQueries(tView,tNode,lView)),null!==localRefsIndex&&saveResolvedLocalsInData(lView,tNode)}function ɵɵelementEnd(){let previousOrParentTNode=getPreviousOrParentTNode();getIsParent()?setIsNotParent():(previousOrParentTNode=previousOrParentTNode.parent,setPreviousOrParentTNode(previousOrParentTNode,!1));const tNode=previousOrParentTNode;instructionState.lFrame.elementDepthCount--;const tView=getTView();tView.firstCreatePass&&(registerPostOrderHooks(tView,previousOrParentTNode),isContentQueryHost(previousOrParentTNode)&&tView.queries.elementEnd(previousOrParentTNode)),null!==tNode.classes&&function(tNode){return 0!=(16&tNode.flags)}(tNode)&&setDirectiveInputsWhichShadowsStyling(tView,tNode,getLView(),tNode.classes,!0),null!==tNode.styles&&function(tNode){return 0!=(32&tNode.flags)}(tNode)&&setDirectiveInputsWhichShadowsStyling(tView,tNode,getLView(),tNode.styles,!1)}function ɵɵelement(index,name,attrsIndex,localRefsIndex){ɵɵelementStart(index,name,attrsIndex,localRefsIndex),ɵɵelementEnd()}function ɵɵgetCurrentView(){return getLView()}function core_isPromise(obj){return!!obj&&\"function\"==typeof obj.then}function isObservable(obj){return!!obj&&\"function\"==typeof obj.subscribe}function ɵɵlistener(eventName,listenerFn,useCapture=!1,eventTargetResolver){const lView=getLView(),tView=getTView(),tNode=getPreviousOrParentTNode();return function(tView,lView,renderer,tNode,eventName,listenerFn,useCapture=!1,eventTargetResolver){const isTNodeDirectiveHost=isDirectiveHost(tNode),tCleanup=tView.firstCreatePass&&(tView.cleanup||(tView.cleanup=[])),lCleanup=getLCleanup(lView);let processOutputs=!0;if(3===tNode.type){const native=getNativeByTNode(tNode,lView),resolved=eventTargetResolver?eventTargetResolver(native):EMPTY_OBJ,target=resolved.target||native,lCleanupIndex=lCleanup.length,idxOrTargetGetter=eventTargetResolver?_lView=>eventTargetResolver(unwrapRNode(_lView[tNode.index])).target:tNode.index;if(isProceduralRenderer(renderer)){let existingListener=null;if(!eventTargetResolver&&isTNodeDirectiveHost&&(existingListener=function(tView,lView,eventName,tNodeIdx){const tCleanup=tView.cleanup;if(null!=tCleanup)for(let i=0;i<tCleanup.length-1;i+=2){const cleanupEventName=tCleanup[i];if(cleanupEventName===eventName&&tCleanup[i+1]===tNodeIdx){const lCleanup=lView[7],listenerIdxInLCleanup=tCleanup[i+2];return lCleanup.length>listenerIdxInLCleanup?lCleanup[listenerIdxInLCleanup]:null}\"string\"==typeof cleanupEventName&&(i+=2)}return null}(tView,lView,eventName,tNode.index)),null!==existingListener)(existingListener.__ngLastListenerFn__||existingListener).__ngNextListenerFn__=listenerFn,existingListener.__ngLastListenerFn__=listenerFn,processOutputs=!1;else{listenerFn=wrapListener(tNode,lView,listenerFn,!1);const cleanupFn=renderer.listen(resolved.name||target,eventName,listenerFn);lCleanup.push(listenerFn,cleanupFn),tCleanup&&tCleanup.push(eventName,idxOrTargetGetter,lCleanupIndex,lCleanupIndex+1)}}else listenerFn=wrapListener(tNode,lView,listenerFn,!0),target.addEventListener(eventName,listenerFn,useCapture),lCleanup.push(listenerFn),tCleanup&&tCleanup.push(eventName,idxOrTargetGetter,lCleanupIndex,useCapture)}const outputs=tNode.outputs;let props;if(processOutputs&&null!==outputs&&(props=outputs[eventName])){const propsLength=props.length;if(propsLength)for(let i=0;i<propsLength;i+=2){const subscription=lView[props[i]][props[i+1]].subscribe(listenerFn),idx=lCleanup.length;lCleanup.push(listenerFn,subscription),tCleanup&&tCleanup.push(eventName,tNode.index,idx,-(idx+1))}}}(tView,lView,lView[11],tNode,eventName,listenerFn,useCapture,eventTargetResolver),ɵɵlistener}function executeListenerWithErrorHandling(lView,listenerFn,e){try{return!1!==listenerFn(e)}catch(error){return handleError(lView,error),!1}}function wrapListener(tNode,lView,listenerFn,wrapWithPreventDefault){return function wrapListenerIn_markDirtyAndPreventDefault(e){if(e===Function)return listenerFn;const startView=2&tNode.flags?getComponentLViewByIndex(tNode.index,lView):lView;0==(32&lView[2])&&markViewDirty(startView);let result=executeListenerWithErrorHandling(lView,listenerFn,e),nextListenerFn=wrapListenerIn_markDirtyAndPreventDefault.__ngNextListenerFn__;for(;nextListenerFn;)result=executeListenerWithErrorHandling(lView,nextListenerFn,e)&&result,nextListenerFn=nextListenerFn.__ngNextListenerFn__;return wrapWithPreventDefault&&!1===result&&(e.preventDefault(),e.returnValue=!1),result}}function ɵɵnextContext(level=1){return function(level){return(instructionState.lFrame.contextLView=function(nestingLevel,currentView){for(;nestingLevel>0;)currentView=currentView[15],nestingLevel--;return currentView}(level,instructionState.lFrame.contextLView))[8]}(level)}function ɵɵpropertyInterpolate(propName,v0,sanitizer){return ɵɵpropertyInterpolate1(propName,\"\",v0,\"\",sanitizer),ɵɵpropertyInterpolate}function ɵɵpropertyInterpolate1(propName,prefix,v0,suffix,sanitizer){const lView=getLView(),interpolatedValue=interpolation1(lView,prefix,v0,suffix);return interpolatedValue!==NO_CHANGE&&elementPropertyInternal(getTView(),getSelectedTNode(),lView,propName,interpolatedValue,lView[11],sanitizer,!1),ɵɵpropertyInterpolate1}const EMPTY_ARRAY$3=[];function markDuplicates(tData,tStylingKey,index,isPrevDir,isClassBinding){const tStylingAtIndex=tData[index+1],isMap=null===tStylingKey;let cursor=isPrevDir?getTStylingRangePrev(tStylingAtIndex):getTStylingRangeNext(tStylingAtIndex),foundDuplicate=!1;for(;0!==cursor&&(!1===foundDuplicate||isMap);){const tStyleRangeAtCursor=tData[cursor+1];isStylingMatch(tData[cursor],tStylingKey)&&(foundDuplicate=!0,tData[cursor+1]=isPrevDir?setTStylingRangeNextDuplicate(tStyleRangeAtCursor):setTStylingRangePrevDuplicate(tStyleRangeAtCursor)),cursor=isPrevDir?getTStylingRangePrev(tStyleRangeAtCursor):getTStylingRangeNext(tStyleRangeAtCursor)}foundDuplicate&&(tData[index+1]=isPrevDir?setTStylingRangePrevDuplicate(tStylingAtIndex):setTStylingRangeNextDuplicate(tStylingAtIndex))}function isStylingMatch(tStylingKeyCursor,tStylingKey){return null===tStylingKeyCursor||null==tStylingKey||(Array.isArray(tStylingKeyCursor)?tStylingKeyCursor[1]:tStylingKeyCursor)===tStylingKey||!(!Array.isArray(tStylingKeyCursor)||\"string\"!=typeof tStylingKey)&&keyValueArrayIndexOf(tStylingKeyCursor,tStylingKey)>=0}const parserState={textEnd:0,key:0,keyEnd:0,value:0,valueEnd:0};function getLastParsedKey(text){return text.substring(parserState.key,parserState.keyEnd)}function parseClassNameNext(text,index){const end=parserState.textEnd;return end===index?-1:(index=parserState.keyEnd=function(text,startIndex,endIndex){for(;startIndex<endIndex&&text.charCodeAt(startIndex)>32;)startIndex++;return startIndex}(text,parserState.key=index,end),consumeWhitespace(text,index,end))}function consumeWhitespace(text,startIndex,endIndex){for(;startIndex<endIndex&&text.charCodeAt(startIndex)<=32;)startIndex++;return startIndex}function ɵɵstyleProp(prop,value,suffix){return checkStylingProperty(prop,value,suffix,!1),ɵɵstyleProp}function ɵɵclassProp(className,value){return checkStylingProperty(className,value,null,!0),ɵɵclassProp}function ɵɵclassMap(classes){!function(keyValueArraySet,stringParser,value,isClassBased){const tView=getTView(),bindingIndex=incrementBindingIndex(2);tView.firstUpdatePass&&stylingFirstUpdatePass(tView,null,bindingIndex,true);const lView=getLView();if(value!==NO_CHANGE&&bindingUpdated(lView,bindingIndex,value)){const tNode=tView.data[getSelectedIndex()+19];if(hasStylingInputShadow(tNode,true)&&!isInHostBindings(tView,bindingIndex)){let staticPrefix=tNode.classes;null!==staticPrefix&&(value=concatStringsWithSpace(staticPrefix,value||\"\")),setDirectiveInputsWhichShadowsStyling(tView,tNode,lView,value,true)}else!function(tView,tNode,lView,renderer,oldKeyValueArray,newKeyValueArray,isClassBased,bindingIndex){oldKeyValueArray===NO_CHANGE&&(oldKeyValueArray=EMPTY_ARRAY$3);let oldIndex=0,newIndex=0,oldKey=0<oldKeyValueArray.length?oldKeyValueArray[0]:null,newKey=0<newKeyValueArray.length?newKeyValueArray[0]:null;for(;null!==oldKey||null!==newKey;){const oldValue=oldIndex<oldKeyValueArray.length?oldKeyValueArray[oldIndex+1]:void 0,newValue=newIndex<newKeyValueArray.length?newKeyValueArray[newIndex+1]:void 0;let setKey=null,setValue=void 0;oldKey===newKey?(oldIndex+=2,newIndex+=2,oldValue!==newValue&&(setKey=newKey,setValue=newValue)):null===newKey||null!==oldKey&&oldKey<newKey?(oldIndex+=2,setKey=oldKey):(newIndex+=2,setKey=newKey,setValue=newValue),null!==setKey&&updateStyling(tView,tNode,lView,renderer,setKey,setValue,true,bindingIndex),oldKey=oldIndex<oldKeyValueArray.length?oldKeyValueArray[oldIndex]:null,newKey=newIndex<newKeyValueArray.length?newKeyValueArray[newIndex]:null}}(tView,tNode,lView,lView[11],lView[bindingIndex+1],lView[bindingIndex+1]=function(keyValueArraySet,stringParser,value){if(null==value||\"\"===value)return EMPTY_ARRAY$3;const styleKeyValueArray=[],unwrappedValue=unwrapSafeValue(value);if(Array.isArray(unwrappedValue))for(let i=0;i<unwrappedValue.length;i++)keyValueArraySet(styleKeyValueArray,unwrappedValue[i],!0);else if(\"object\"==typeof unwrappedValue)for(const key in unwrappedValue)unwrappedValue.hasOwnProperty(key)&&keyValueArraySet(styleKeyValueArray,key,unwrappedValue[key]);else\"string\"==typeof unwrappedValue&&stringParser(styleKeyValueArray,unwrappedValue);return styleKeyValueArray}(keyValueArraySet,stringParser,value),0,bindingIndex)}}(keyValueArraySet,classStringParser,classes)}function classStringParser(keyValueArray,text){for(let i=function(text){return function(text){parserState.key=0,parserState.keyEnd=0,parserState.value=0,parserState.valueEnd=0,parserState.textEnd=text.length}(text),parseClassNameNext(text,consumeWhitespace(text,0,parserState.textEnd))}(text);i>=0;i=parseClassNameNext(text,i))keyValueArraySet(keyValueArray,getLastParsedKey(text),!0)}function checkStylingProperty(prop,value,suffixOrSanitizer,isClassBased){const lView=getLView(),tView=getTView(),bindingIndex=incrementBindingIndex(2);if(tView.firstUpdatePass&&stylingFirstUpdatePass(tView,prop,bindingIndex,isClassBased),value!==NO_CHANGE&&bindingUpdated(lView,bindingIndex,value)){let styleSanitizer;null==suffixOrSanitizer&&(styleSanitizer=function(){const lFrame=instructionState.lFrame;return null===lFrame?null:lFrame.currentSanitizer}())&&(suffixOrSanitizer=styleSanitizer),updateStyling(tView,tView.data[getSelectedIndex()+19],lView,lView[11],prop,lView[bindingIndex+1]=function(value,suffixOrSanitizer){return null==value||(\"function\"==typeof suffixOrSanitizer?value=suffixOrSanitizer(value):\"string\"==typeof suffixOrSanitizer?value+=suffixOrSanitizer:\"object\"==typeof value&&(value=stringify(unwrapSafeValue(value)))),value}(value,suffixOrSanitizer),isClassBased,bindingIndex)}}function isInHostBindings(tView,bindingIndex){return bindingIndex>=tView.expandoStartIndex}function stylingFirstUpdatePass(tView,tStylingKey,bindingIndex,isClassBased){const tData=tView.data;if(null===tData[bindingIndex+1]){const tNode=tData[getSelectedIndex()+19],isHostBindings=isInHostBindings(tView,bindingIndex);hasStylingInputShadow(tNode,isClassBased)&&null===tStylingKey&&!isHostBindings&&(tStylingKey=!1),tStylingKey=function(tData,tNode,stylingKey,isClassBased){const hostDirectiveDef=function(tData){const currentDirectiveIndex=instructionState.lFrame.currentDirectiveIndex;return-1===currentDirectiveIndex?null:tData[currentDirectiveIndex]}(tData);let residual=isClassBased?tNode.residualClasses:tNode.residualStyles;if(null===hostDirectiveDef)0===(isClassBased?tNode.classBindings:tNode.styleBindings)&&(stylingKey=collectStylingFromTAttrs(stylingKey=collectStylingFromDirectives(null,tData,tNode,stylingKey,isClassBased),tNode.attrs,isClassBased),residual=null);else{const directiveStylingLast=tNode.directiveStylingLast;if(-1===directiveStylingLast||tData[directiveStylingLast]!==hostDirectiveDef)if(stylingKey=collectStylingFromDirectives(hostDirectiveDef,tData,tNode,stylingKey,isClassBased),null===residual){let templateStylingKey=function(tData,tNode,isClassBased){const bindings=isClassBased?tNode.classBindings:tNode.styleBindings;if(0!==getTStylingRangeNext(bindings))return tData[getTStylingRangePrev(bindings)]}(tData,tNode,isClassBased);void 0!==templateStylingKey&&Array.isArray(templateStylingKey)&&(templateStylingKey=collectStylingFromDirectives(null,tData,tNode,templateStylingKey[1],isClassBased),templateStylingKey=collectStylingFromTAttrs(templateStylingKey,tNode.attrs,isClassBased),function(tData,tNode,isClassBased,tStylingKey){tData[getTStylingRangePrev(isClassBased?tNode.classBindings:tNode.styleBindings)]=tStylingKey}(tData,tNode,isClassBased,templateStylingKey))}else residual=function(tData,tNode,isClassBased){let residual=void 0;const directiveEnd=tNode.directiveEnd;for(let i=1+tNode.directiveStylingLast;i<directiveEnd;i++)residual=collectStylingFromTAttrs(residual,tData[i].hostAttrs,isClassBased);return collectStylingFromTAttrs(residual,tNode.attrs,isClassBased)}(tData,tNode,isClassBased)}return void 0!==residual&&(isClassBased?tNode.residualClasses=residual:tNode.residualStyles=residual),stylingKey}(tData,tNode,tStylingKey,isClassBased),function(tData,tNode,tStylingKeyWithStatic,index,isHostBinding,isClassBinding){let tBindings=isClassBinding?tNode.classBindings:tNode.styleBindings,tmplHead=getTStylingRangePrev(tBindings),tmplTail=getTStylingRangeNext(tBindings);tData[index]=tStylingKeyWithStatic;let tStylingKey,isKeyDuplicateOfStatic=!1;if(Array.isArray(tStylingKeyWithStatic)){const staticKeyValueArray=tStylingKeyWithStatic;tStylingKey=staticKeyValueArray[1],(null===tStylingKey||keyValueArrayIndexOf(staticKeyValueArray,tStylingKey)>0)&&(isKeyDuplicateOfStatic=!0)}else tStylingKey=tStylingKeyWithStatic;if(isHostBinding)if(0!==tmplTail){const previousNode=getTStylingRangePrev(tData[tmplHead+1]);tData[index+1]=toTStylingRange(previousNode,tmplHead),0!==previousNode&&(tData[previousNode+1]=setTStylingRangeNext(tData[previousNode+1],index)),tData[tmplHead+1]=131071&tData[tmplHead+1]|index<<17}else tData[index+1]=toTStylingRange(tmplHead,0),0!==tmplHead&&(tData[tmplHead+1]=setTStylingRangeNext(tData[tmplHead+1],index)),tmplHead=index;else tData[index+1]=toTStylingRange(tmplTail,0),0===tmplHead?tmplHead=index:tData[tmplTail+1]=setTStylingRangeNext(tData[tmplTail+1],index),tmplTail=index;isKeyDuplicateOfStatic&&(tData[index+1]=setTStylingRangePrevDuplicate(tData[index+1])),markDuplicates(tData,tStylingKey,index,!0),markDuplicates(tData,tStylingKey,index,!1),function(tNode,tStylingKey,tData,index,isClassBinding){const residual=isClassBinding?tNode.residualClasses:tNode.residualStyles;null!=residual&&\"string\"==typeof tStylingKey&&keyValueArrayIndexOf(residual,tStylingKey)>=0&&(tData[index+1]=setTStylingRangeNextDuplicate(tData[index+1]))}(tNode,tStylingKey,tData,index,isClassBinding),tBindings=toTStylingRange(tmplHead,tmplTail),isClassBinding?tNode.classBindings=tBindings:tNode.styleBindings=tBindings}(tData,tNode,tStylingKey,bindingIndex,isHostBindings,isClassBased)}}function collectStylingFromDirectives(hostDirectiveDef,tData,tNode,stylingKey,isClassBased){let currentDirective=null;const directiveEnd=tNode.directiveEnd;let directiveStylingLast=tNode.directiveStylingLast;for(-1===directiveStylingLast?directiveStylingLast=tNode.directiveStart:directiveStylingLast++;directiveStylingLast<directiveEnd&&(currentDirective=tData[directiveStylingLast],stylingKey=collectStylingFromTAttrs(stylingKey,currentDirective.hostAttrs,isClassBased),currentDirective!==hostDirectiveDef);)directiveStylingLast++;return null!==hostDirectiveDef&&(tNode.directiveStylingLast=directiveStylingLast),stylingKey}function collectStylingFromTAttrs(stylingKey,attrs,isClassBased){const desiredMarker=isClassBased?1:2;let currentMarker=-1;if(null!==attrs)for(let i=0;i<attrs.length;i++){const item=attrs[i];\"number\"==typeof item?currentMarker=item:currentMarker===desiredMarker&&(Array.isArray(stylingKey)||(stylingKey=void 0===stylingKey?[]:[\"\",stylingKey]),keyValueArraySet(stylingKey,item,!!isClassBased||attrs[++i]))}return void 0===stylingKey?null:stylingKey}function updateStyling(tView,tNode,lView,renderer,prop,value,isClassBased,bindingIndex){if(3!==tNode.type)return;const tData=tView.data,tRange=tData[bindingIndex+1];isStylingValuePresent(1==(1&tRange)?findStylingValue(tData,tNode,lView,prop,getTStylingRangeNext(tRange),isClassBased):void 0)||(isStylingValuePresent(value)||2==(2&tRange)&&(value=findStylingValue(tData,null,lView,prop,bindingIndex,isClassBased)),function(renderer,isClassBased,rNode,prop,value){const isProcedural=isProceduralRenderer(renderer);if(isClassBased)value?isProcedural?renderer.addClass(rNode,prop):rNode.classList.add(prop):isProcedural?renderer.removeClass(rNode,prop):rNode.classList.remove(prop);else{const flags=-1==prop.indexOf(\"-\")?void 0:2;null==value?isProcedural?renderer.removeStyle(rNode,prop,flags):rNode.style.removeProperty(prop):isProcedural?renderer.setStyle(rNode,prop,value,flags):rNode.style.setProperty(prop,value)}}(renderer,isClassBased,getNativeByIndex(getSelectedIndex(),lView),prop,value))}function findStylingValue(tData,tNode,lView,prop,index,isClassBased){const isPrevDirection=null===tNode;let value=void 0;for(;index>0;){const rawKey=tData[index],containsStatics=Array.isArray(rawKey),key=containsStatics?rawKey[1]:rawKey,isStylingMap=null===key;let valueAtLViewIndex=lView[index+1];valueAtLViewIndex===NO_CHANGE&&(valueAtLViewIndex=isStylingMap?EMPTY_ARRAY$3:void 0);let currentValue=isStylingMap?keyValueArrayGet(valueAtLViewIndex,prop):key===prop?valueAtLViewIndex:void 0;if(containsStatics&&!isStylingValuePresent(currentValue)&&(currentValue=keyValueArrayGet(rawKey,prop)),isStylingValuePresent(currentValue)&&(value=currentValue,isPrevDirection))return value;const tRange=tData[index+1];index=isPrevDirection?getTStylingRangePrev(tRange):getTStylingRangeNext(tRange)}if(null!==tNode){let residual=isClassBased?tNode.residualClasses:tNode.residualStyles;null!=residual&&(value=keyValueArrayGet(residual,prop))}return value}function isStylingValuePresent(value){return void 0!==value}function hasStylingInputShadow(tNode,isClassBased){return 0!=(tNode.flags&(isClassBased?16:32))}function ɵɵtext(index,value=\"\"){const lView=getLView(),tView=getTView(),adjustedIndex=index+19,tNode=tView.firstCreatePass?getOrCreateTNode(tView,lView[6],index,3,null,null):tView.data[adjustedIndex],textNative=lView[adjustedIndex]=function(value,renderer){return isProceduralRenderer(renderer)?renderer.createText(value):renderer.createTextNode(value)}(value,lView[11]);appendChild(tView,lView,textNative,tNode),setPreviousOrParentTNode(tNode,!1)}function ɵɵtextInterpolate(v0){return ɵɵtextInterpolate1(\"\",v0,\"\"),ɵɵtextInterpolate}function ɵɵtextInterpolate1(prefix,v0,suffix){const lView=getLView(),interpolated=interpolation1(lView,prefix,v0,suffix);return interpolated!==NO_CHANGE&&function(lView,index,value){const element=getNativeByIndex(index,lView),renderer=lView[11];isProceduralRenderer(renderer)?renderer.setValue(element,value):element.textContent=value}(lView,getSelectedIndex(),interpolated),ɵɵtextInterpolate1}function ɵɵupdateSyntheticHostBinding(propName,value,sanitizer){const lView=getLView();if(bindingUpdated(lView,nextBindingIndex(),value)){const tView=getTView(),tNode=getSelectedTNode();elementPropertyInternal(tView,tNode,lView,propName,value,function(tNode,lView){return function(value){for(;Array.isArray(value);){if(\"object\"==typeof value[1])return value;value=value[0]}return null}(lView[tNode.index])[11]}(tNode,lView),sanitizer,!0)}return ɵɵupdateSyntheticHostBinding}function LifecycleHooksFeature(component,def){const rootTView=readPatchedLView(component)[1],dirIndex=rootTView.data.length-1;registerPostOrderHooks(rootTView,{directiveStart:dirIndex,directiveEnd:dirIndex+1})}function ɵɵInheritDefinitionFeature(definition){let superType=Object.getPrototypeOf(definition.type.prototype).constructor,shouldInheritFields=!0;const inheritanceChain=[definition];for(;superType;){let superDef=void 0;if(isComponentDef(definition))superDef=superType.ɵcmp||superType.ɵdir;else{if(superType.ɵcmp)throw new Error(\"Directives cannot inherit Components\");superDef=superType.ɵdir}if(superDef){if(shouldInheritFields){inheritanceChain.push(superDef);const writeableDef=definition;writeableDef.inputs=maybeUnwrapEmpty(definition.inputs),writeableDef.declaredInputs=maybeUnwrapEmpty(definition.declaredInputs),writeableDef.outputs=maybeUnwrapEmpty(definition.outputs);const superHostBindings=superDef.hostBindings;superHostBindings&&inheritHostBindings(definition,superHostBindings);const superViewQuery=superDef.viewQuery,superContentQueries=superDef.contentQueries;if(superViewQuery&&inheritViewQuery(definition,superViewQuery),superContentQueries&&inheritContentQueries(definition,superContentQueries),fillProperties(definition.inputs,superDef.inputs),fillProperties(definition.declaredInputs,superDef.declaredInputs),fillProperties(definition.outputs,superDef.outputs),isComponentDef(superDef)&&superDef.data.animation){const defData=definition.data;defData.animation=(defData.animation||[]).concat(superDef.data.animation)}writeableDef.afterContentChecked=writeableDef.afterContentChecked||superDef.afterContentChecked,writeableDef.afterContentInit=definition.afterContentInit||superDef.afterContentInit,writeableDef.afterViewChecked=definition.afterViewChecked||superDef.afterViewChecked,writeableDef.afterViewInit=definition.afterViewInit||superDef.afterViewInit,writeableDef.doCheck=definition.doCheck||superDef.doCheck,writeableDef.onDestroy=definition.onDestroy||superDef.onDestroy,writeableDef.onInit=definition.onInit||superDef.onInit}const features=superDef.features;if(features)for(let i=0;i<features.length;i++){const feature=features[i];feature&&feature.ngInherit&&feature(definition),feature===ɵɵInheritDefinitionFeature&&(shouldInheritFields=!1)}}superType=Object.getPrototypeOf(superType)}!function(inheritanceChain){let hostVars=0,hostAttrs=null;for(let i=inheritanceChain.length-1;i>=0;i--){const def=inheritanceChain[i];def.hostVars=hostVars+=def.hostVars,def.hostAttrs=mergeHostAttrs(def.hostAttrs,hostAttrs=mergeHostAttrs(hostAttrs,def.hostAttrs))}}(inheritanceChain)}function maybeUnwrapEmpty(value){return value===EMPTY_OBJ?{}:value===EMPTY_ARRAY?[]:value}function inheritViewQuery(definition,superViewQuery){const prevViewQuery=definition.viewQuery;definition.viewQuery=prevViewQuery?(rf,ctx)=>{superViewQuery(rf,ctx),prevViewQuery(rf,ctx)}:superViewQuery}function inheritContentQueries(definition,superContentQueries){const prevContentQueries=definition.contentQueries;definition.contentQueries=prevContentQueries?(rf,ctx,directiveIndex)=>{superContentQueries(rf,ctx,directiveIndex),prevContentQueries(rf,ctx,directiveIndex)}:superContentQueries}function inheritHostBindings(definition,superHostBindings){const prevHostBindings=definition.hostBindings;definition.hostBindings=prevHostBindings?(rf,ctx)=>{superHostBindings(rf,ctx),prevHostBindings(rf,ctx)}:superHostBindings}class SimpleChange{constructor(previousValue,currentValue,firstChange){this.previousValue=previousValue,this.currentValue=currentValue,this.firstChange=firstChange}isFirstChange(){return this.firstChange}}function ɵɵNgOnChangesFeature(definition){definition.type.prototype.ngOnChanges&&(definition.setInput=ngOnChangesSetInput,definition.onChanges=function(){const simpleChangesStore=getSimpleChangesStore(this),current=simpleChangesStore&&simpleChangesStore.current;if(current){const previous=simpleChangesStore.previous;if(previous===EMPTY_OBJ)simpleChangesStore.previous=current;else for(let key in current)previous[key]=current[key];simpleChangesStore.current=null,this.ngOnChanges(current)}})}function ngOnChangesSetInput(instance,value,publicName,privateName){const simpleChangesStore=getSimpleChangesStore(instance)||function(instance,store){return instance.__ngSimpleChanges__=store}(instance,{previous:EMPTY_OBJ,current:null}),current=simpleChangesStore.current||(simpleChangesStore.current={}),previous=simpleChangesStore.previous,declaredName=this.declaredInputs[publicName],previousChange=previous[declaredName];current[declaredName]=new SimpleChange(previousChange&&previousChange.currentValue,value,previous===EMPTY_OBJ),instance[privateName]=value}function getSimpleChangesStore(instance){return instance.__ngSimpleChanges__||null}function resolveProvider$1(provider,tInjectables,lInjectablesBlueprint,isComponent,isViewProvider){if(provider=resolveForwardRef(provider),Array.isArray(provider))for(let i=0;i<provider.length;i++)resolveProvider$1(provider[i],tInjectables,lInjectablesBlueprint,isComponent,isViewProvider);else{const tView=getTView(),lView=getLView();let token=isTypeProvider(provider)?provider:resolveForwardRef(provider.provide),providerFactory=providerToFactory(provider);const tNode=getPreviousOrParentTNode(),beginIndex=65535&tNode.providerIndexes,endIndex=tNode.directiveStart,cptViewProvidersCount=tNode.providerIndexes>>16;if(isTypeProvider(provider)||!provider.multi){const factory=new NodeInjectorFactory(providerFactory,isViewProvider,ɵɵdirectiveInject),existingFactoryIndex=indexOf(token,tInjectables,isViewProvider?beginIndex:beginIndex+cptViewProvidersCount,endIndex);-1===existingFactoryIndex?(diPublicInInjector(getOrCreateNodeInjectorForNode(tNode,lView),tView,token),registerDestroyHooksIfSupported(tView,provider,tInjectables.length),tInjectables.push(token),tNode.directiveStart++,tNode.directiveEnd++,isViewProvider&&(tNode.providerIndexes+=65536),lInjectablesBlueprint.push(factory),lView.push(factory)):(lInjectablesBlueprint[existingFactoryIndex]=factory,lView[existingFactoryIndex]=factory)}else{const existingProvidersFactoryIndex=indexOf(token,tInjectables,beginIndex+cptViewProvidersCount,endIndex),existingViewProvidersFactoryIndex=indexOf(token,tInjectables,beginIndex,beginIndex+cptViewProvidersCount),doesProvidersFactoryExist=existingProvidersFactoryIndex>=0&&lInjectablesBlueprint[existingProvidersFactoryIndex],doesViewProvidersFactoryExist=existingViewProvidersFactoryIndex>=0&&lInjectablesBlueprint[existingViewProvidersFactoryIndex];if(isViewProvider&&!doesViewProvidersFactoryExist||!isViewProvider&&!doesProvidersFactoryExist){diPublicInInjector(getOrCreateNodeInjectorForNode(tNode,lView),tView,token);const factory=function(factoryFn,index,isViewProvider,isComponent,f){const factory=new NodeInjectorFactory(factoryFn,isViewProvider,ɵɵdirectiveInject);return factory.multi=[],factory.index=index,factory.componentProviders=0,multiFactoryAdd(factory,f,isComponent&&!isViewProvider),factory}(isViewProvider?multiViewProvidersFactoryResolver:multiProvidersFactoryResolver,lInjectablesBlueprint.length,isViewProvider,isComponent,providerFactory);!isViewProvider&&doesViewProvidersFactoryExist&&(lInjectablesBlueprint[existingViewProvidersFactoryIndex].providerFactory=factory),registerDestroyHooksIfSupported(tView,provider,tInjectables.length),tInjectables.push(token),tNode.directiveStart++,tNode.directiveEnd++,isViewProvider&&(tNode.providerIndexes+=65536),lInjectablesBlueprint.push(factory),lView.push(factory)}else registerDestroyHooksIfSupported(tView,provider,existingProvidersFactoryIndex>-1?existingProvidersFactoryIndex:existingViewProvidersFactoryIndex),multiFactoryAdd(lInjectablesBlueprint[isViewProvider?existingViewProvidersFactoryIndex:existingProvidersFactoryIndex],providerFactory,!isViewProvider&&isComponent);!isViewProvider&&isComponent&&doesViewProvidersFactoryExist&&lInjectablesBlueprint[existingViewProvidersFactoryIndex].componentProviders++}}}function registerDestroyHooksIfSupported(tView,provider,contextIndex){if(isTypeProvider(provider)||provider.useClass){const ngOnDestroy=(provider.useClass||provider).prototype.ngOnDestroy;ngOnDestroy&&(tView.destroyHooks||(tView.destroyHooks=[])).push(contextIndex,ngOnDestroy)}}function multiFactoryAdd(multiFactory,factory,isComponentProvider){multiFactory.multi.push(factory),isComponentProvider&&multiFactory.componentProviders++}function indexOf(item,arr,begin,end){for(let i=begin;i<end;i++)if(arr[i]===item)return i;return-1}function multiProvidersFactoryResolver(_,tData,lData,tNode){return multiResolve(this.multi,[])}function multiViewProvidersFactoryResolver(_,tData,lView,tNode){const factories=this.multi;let result;if(this.providerFactory){const componentCount=this.providerFactory.componentProviders,multiProviders=getNodeInjectable(lView,lView[1],this.providerFactory.index,tNode);result=multiProviders.slice(0,componentCount),multiResolve(factories,result);for(let i=componentCount;i<multiProviders.length;i++)result.push(multiProviders[i])}else result=[],multiResolve(factories,result);return result}function multiResolve(factories,result){for(let i=0;i<factories.length;i++)result.push((0,factories[i])());return result}function ɵɵProvidersFeature(providers,viewProviders=[]){return definition=>{definition.providersResolver=(def,processProvidersFn)=>function(def,providers,viewProviders){const tView=getTView();if(tView.firstCreatePass){const isComponent=isComponentDef(def);resolveProvider$1(viewProviders,tView.data,tView.blueprint,isComponent,!0),resolveProvider$1(providers,tView.data,tView.blueprint,isComponent,!1)}}(def,processProvidersFn?processProvidersFn(providers):providers,viewProviders)}}ɵɵNgOnChangesFeature.ngInherit=!0;class ComponentFactory{}class _NullComponentFactoryResolver{resolveComponentFactory(component){throw function(component){const error=Error(`No component factory found for ${stringify(component)}. Did you add it to @NgModule.entryComponents?`);return error.ngComponent=component,error}(component)}}let ComponentFactoryResolver=(()=>{class ComponentFactoryResolver{}return ComponentFactoryResolver.NULL=new _NullComponentFactoryResolver,ComponentFactoryResolver})(),ElementRef=(()=>{class ElementRef{constructor(nativeElement){this.nativeElement=nativeElement}}return ElementRef.__NG_ELEMENT_ID__=()=>SWITCH_ELEMENT_REF_FACTORY(ElementRef),ElementRef})();const SWITCH_ELEMENT_REF_FACTORY=function(ElementRefToken){return createElementRef(ElementRefToken,getPreviousOrParentTNode(),getLView())};class RendererFactory2{}const RendererStyleFlags2=function(){var RendererStyleFlags2={Important:1,DashCase:2};return RendererStyleFlags2[RendererStyleFlags2.Important]=\"Important\",RendererStyleFlags2[RendererStyleFlags2.DashCase]=\"DashCase\",RendererStyleFlags2}();let Renderer2=(()=>{class Renderer2{}return Renderer2.__NG_ELEMENT_ID__=()=>SWITCH_RENDERER2_FACTORY(),Renderer2})();const SWITCH_RENDERER2_FACTORY=function(){const lView=getLView(),nodeAtIndex=getComponentLViewByIndex(getPreviousOrParentTNode().index,lView);return function(view){const renderer=view[11];if(isProceduralRenderer(renderer))return renderer;throw new Error(\"Cannot inject Renderer2 when the application uses Renderer3!\")}(isLView(nodeAtIndex)?nodeAtIndex:lView)};let Sanitizer=(()=>{class Sanitizer{}return Sanitizer.ɵprov=ɵɵdefineInjectable({token:Sanitizer,providedIn:\"root\",factory:()=>null}),Sanitizer})();class Version{constructor(full){this.full=full,this.major=full.split(\".\")[0],this.minor=full.split(\".\")[1],this.patch=full.split(\".\").slice(2).join(\".\")}}const VERSION=new Version(\"9.0.7\");class DefaultIterableDifferFactory{constructor(){}supports(obj){return isListLikeIterable$1(obj)}create(trackByFn){return new DefaultIterableDiffer(trackByFn)}}const trackByIdentity=(index,item)=>item;class DefaultIterableDiffer{constructor(trackByFn){this.length=0,this._linkedRecords=null,this._unlinkedRecords=null,this._previousItHead=null,this._itHead=null,this._itTail=null,this._additionsHead=null,this._additionsTail=null,this._movesHead=null,this._movesTail=null,this._removalsHead=null,this._removalsTail=null,this._identityChangesHead=null,this._identityChangesTail=null,this._trackByFn=trackByFn||trackByIdentity}forEachItem(fn){let record;for(record=this._itHead;null!==record;record=record._next)fn(record)}forEachOperation(fn){let nextIt=this._itHead,nextRemove=this._removalsHead,addRemoveOffset=0,moveOffsets=null;for(;nextIt||nextRemove;){const record=!nextRemove||nextIt&&nextIt.currentIndex<getPreviousIndex(nextRemove,addRemoveOffset,moveOffsets)?nextIt:nextRemove,adjPreviousIndex=getPreviousIndex(record,addRemoveOffset,moveOffsets),currentIndex=record.currentIndex;if(record===nextRemove)addRemoveOffset--,nextRemove=nextRemove._nextRemoved;else if(nextIt=nextIt._next,null==record.previousIndex)addRemoveOffset++;else{moveOffsets||(moveOffsets=[]);const localMovePreviousIndex=adjPreviousIndex-addRemoveOffset,localCurrentIndex=currentIndex-addRemoveOffset;if(localMovePreviousIndex!=localCurrentIndex){for(let i=0;i<localMovePreviousIndex;i++){const offset=i<moveOffsets.length?moveOffsets[i]:moveOffsets[i]=0,index=offset+i;localCurrentIndex<=index&&index<localMovePreviousIndex&&(moveOffsets[i]=offset+1)}moveOffsets[record.previousIndex]=localCurrentIndex-localMovePreviousIndex}}adjPreviousIndex!==currentIndex&&fn(record,adjPreviousIndex,currentIndex)}}forEachPreviousItem(fn){let record;for(record=this._previousItHead;null!==record;record=record._nextPrevious)fn(record)}forEachAddedItem(fn){let record;for(record=this._additionsHead;null!==record;record=record._nextAdded)fn(record)}forEachMovedItem(fn){let record;for(record=this._movesHead;null!==record;record=record._nextMoved)fn(record)}forEachRemovedItem(fn){let record;for(record=this._removalsHead;null!==record;record=record._nextRemoved)fn(record)}forEachIdentityChange(fn){let record;for(record=this._identityChangesHead;null!==record;record=record._nextIdentityChange)fn(record)}diff(collection){if(null==collection&&(collection=[]),!isListLikeIterable$1(collection))throw new Error(`Error trying to diff '${stringify(collection)}'. Only arrays and iterables are allowed`);return this.check(collection)?this:null}onDestroy(){}check(collection){this._reset();let index,item,itemTrackBy,record=this._itHead,mayBeDirty=!1;if(Array.isArray(collection)){this.length=collection.length;for(let index=0;index<this.length;index++)item=collection[index],itemTrackBy=this._trackByFn(index,item),null!==record&&looseIdentical(record.trackById,itemTrackBy)?(mayBeDirty&&(record=this._verifyReinsertion(record,item,itemTrackBy,index)),looseIdentical(record.item,item)||this._addIdentityChange(record,item)):(record=this._mismatch(record,item,itemTrackBy,index),mayBeDirty=!0),record=record._next}else index=0,function(obj,fn){if(Array.isArray(obj))for(let i=0;i<obj.length;i++)fn(obj[i]);else{const iterator=obj[core_getSymbolIterator()]();let item;for(;!(item=iterator.next()).done;)fn(item.value)}}(collection,item=>{itemTrackBy=this._trackByFn(index,item),null!==record&&looseIdentical(record.trackById,itemTrackBy)?(mayBeDirty&&(record=this._verifyReinsertion(record,item,itemTrackBy,index)),looseIdentical(record.item,item)||this._addIdentityChange(record,item)):(record=this._mismatch(record,item,itemTrackBy,index),mayBeDirty=!0),record=record._next,index++}),this.length=index;return this._truncate(record),this.collection=collection,this.isDirty}get isDirty(){return null!==this._additionsHead||null!==this._movesHead||null!==this._removalsHead||null!==this._identityChangesHead}_reset(){if(this.isDirty){let record,nextRecord;for(record=this._previousItHead=this._itHead;null!==record;record=record._next)record._nextPrevious=record._next;for(record=this._additionsHead;null!==record;record=record._nextAdded)record.previousIndex=record.currentIndex;for(this._additionsHead=this._additionsTail=null,record=this._movesHead;null!==record;record=nextRecord)record.previousIndex=record.currentIndex,nextRecord=record._nextMoved;this._movesHead=this._movesTail=null,this._removalsHead=this._removalsTail=null,this._identityChangesHead=this._identityChangesTail=null}}_mismatch(record,item,itemTrackBy,index){let previousRecord;return null===record?previousRecord=this._itTail:(previousRecord=record._prev,this._remove(record)),null!==(record=null===this._linkedRecords?null:this._linkedRecords.get(itemTrackBy,index))?(looseIdentical(record.item,item)||this._addIdentityChange(record,item),this._moveAfter(record,previousRecord,index)):null!==(record=null===this._unlinkedRecords?null:this._unlinkedRecords.get(itemTrackBy,null))?(looseIdentical(record.item,item)||this._addIdentityChange(record,item),this._reinsertAfter(record,previousRecord,index)):record=this._addAfter(new IterableChangeRecord_(item,itemTrackBy),previousRecord,index),record}_verifyReinsertion(record,item,itemTrackBy,index){let reinsertRecord=null===this._unlinkedRecords?null:this._unlinkedRecords.get(itemTrackBy,null);return null!==reinsertRecord?record=this._reinsertAfter(reinsertRecord,record._prev,index):record.currentIndex!=index&&(record.currentIndex=index,this._addToMoves(record,index)),record}_truncate(record){for(;null!==record;){const nextRecord=record._next;this._addToRemovals(this._unlink(record)),record=nextRecord}null!==this._unlinkedRecords&&this._unlinkedRecords.clear(),null!==this._additionsTail&&(this._additionsTail._nextAdded=null),null!==this._movesTail&&(this._movesTail._nextMoved=null),null!==this._itTail&&(this._itTail._next=null),null!==this._removalsTail&&(this._removalsTail._nextRemoved=null),null!==this._identityChangesTail&&(this._identityChangesTail._nextIdentityChange=null)}_reinsertAfter(record,prevRecord,index){null!==this._unlinkedRecords&&this._unlinkedRecords.remove(record);const prev=record._prevRemoved,next=record._nextRemoved;return null===prev?this._removalsHead=next:prev._nextRemoved=next,null===next?this._removalsTail=prev:next._prevRemoved=prev,this._insertAfter(record,prevRecord,index),this._addToMoves(record,index),record}_moveAfter(record,prevRecord,index){return this._unlink(record),this._insertAfter(record,prevRecord,index),this._addToMoves(record,index),record}_addAfter(record,prevRecord,index){return this._insertAfter(record,prevRecord,index),this._additionsTail=null===this._additionsTail?this._additionsHead=record:this._additionsTail._nextAdded=record,record}_insertAfter(record,prevRecord,index){const next=null===prevRecord?this._itHead:prevRecord._next;return record._next=next,record._prev=prevRecord,null===next?this._itTail=record:next._prev=record,null===prevRecord?this._itHead=record:prevRecord._next=record,null===this._linkedRecords&&(this._linkedRecords=new _DuplicateMap),this._linkedRecords.put(record),record.currentIndex=index,record}_remove(record){return this._addToRemovals(this._unlink(record))}_unlink(record){null!==this._linkedRecords&&this._linkedRecords.remove(record);const prev=record._prev,next=record._next;return null===prev?this._itHead=next:prev._next=next,null===next?this._itTail=prev:next._prev=prev,record}_addToMoves(record,toIndex){return record.previousIndex===toIndex||(this._movesTail=null===this._movesTail?this._movesHead=record:this._movesTail._nextMoved=record),record}_addToRemovals(record){return null===this._unlinkedRecords&&(this._unlinkedRecords=new _DuplicateMap),this._unlinkedRecords.put(record),record.currentIndex=null,record._nextRemoved=null,null===this._removalsTail?(this._removalsTail=this._removalsHead=record,record._prevRemoved=null):(record._prevRemoved=this._removalsTail,this._removalsTail=this._removalsTail._nextRemoved=record),record}_addIdentityChange(record,item){return record.item=item,this._identityChangesTail=null===this._identityChangesTail?this._identityChangesHead=record:this._identityChangesTail._nextIdentityChange=record,record}}class IterableChangeRecord_{constructor(item,trackById){this.item=item,this.trackById=trackById,this.currentIndex=null,this.previousIndex=null,this._nextPrevious=null,this._prev=null,this._next=null,this._prevDup=null,this._nextDup=null,this._prevRemoved=null,this._nextRemoved=null,this._nextAdded=null,this._nextMoved=null,this._nextIdentityChange=null}}class _DuplicateItemRecordList{constructor(){this._head=null,this._tail=null}add(record){null===this._head?(this._head=this._tail=record,record._nextDup=null,record._prevDup=null):(this._tail._nextDup=record,record._prevDup=this._tail,record._nextDup=null,this._tail=record)}get(trackById,atOrAfterIndex){let record;for(record=this._head;null!==record;record=record._nextDup)if((null===atOrAfterIndex||atOrAfterIndex<=record.currentIndex)&&looseIdentical(record.trackById,trackById))return record;return null}remove(record){const prev=record._prevDup,next=record._nextDup;return null===prev?this._head=next:prev._nextDup=next,null===next?this._tail=prev:next._prevDup=prev,null===this._head}}class _DuplicateMap{constructor(){this.map=new Map}put(record){const key=record.trackById;let duplicates=this.map.get(key);duplicates||(duplicates=new _DuplicateItemRecordList,this.map.set(key,duplicates)),duplicates.add(record)}get(trackById,atOrAfterIndex){const recordList=this.map.get(trackById);return recordList?recordList.get(trackById,atOrAfterIndex):null}remove(record){const key=record.trackById;return this.map.get(key).remove(record)&&this.map.delete(key),record}get isEmpty(){return 0===this.map.size}clear(){this.map.clear()}}function getPreviousIndex(item,addRemoveOffset,moveOffsets){const previousIndex=item.previousIndex;if(null===previousIndex)return previousIndex;let moveOffset=0;return moveOffsets&&previousIndex<moveOffsets.length&&(moveOffset=moveOffsets[previousIndex]),previousIndex+addRemoveOffset+moveOffset}class DefaultKeyValueDifferFactory{constructor(){}supports(obj){return obj instanceof Map||isJsObject$1(obj)}create(){return new DefaultKeyValueDiffer}}class DefaultKeyValueDiffer{constructor(){this._records=new Map,this._mapHead=null,this._appendAfter=null,this._previousMapHead=null,this._changesHead=null,this._changesTail=null,this._additionsHead=null,this._additionsTail=null,this._removalsHead=null,this._removalsTail=null}get isDirty(){return null!==this._additionsHead||null!==this._changesHead||null!==this._removalsHead}forEachItem(fn){let record;for(record=this._mapHead;null!==record;record=record._next)fn(record)}forEachPreviousItem(fn){let record;for(record=this._previousMapHead;null!==record;record=record._nextPrevious)fn(record)}forEachChangedItem(fn){let record;for(record=this._changesHead;null!==record;record=record._nextChanged)fn(record)}forEachAddedItem(fn){let record;for(record=this._additionsHead;null!==record;record=record._nextAdded)fn(record)}forEachRemovedItem(fn){let record;for(record=this._removalsHead;null!==record;record=record._nextRemoved)fn(record)}diff(map){if(map){if(!(map instanceof Map||isJsObject$1(map)))throw new Error(`Error trying to diff '${stringify(map)}'. Only maps and objects are allowed`)}else map=new Map;return this.check(map)?this:null}onDestroy(){}check(map){this._reset();let insertBefore=this._mapHead;if(this._appendAfter=null,this._forEach(map,(value,key)=>{if(insertBefore&&insertBefore.key===key)this._maybeAddToChanges(insertBefore,value),this._appendAfter=insertBefore,insertBefore=insertBefore._next;else{const record=this._getOrCreateRecordForKey(key,value);insertBefore=this._insertBeforeOrAppend(insertBefore,record)}}),insertBefore){insertBefore._prev&&(insertBefore._prev._next=null),this._removalsHead=insertBefore;for(let record=insertBefore;null!==record;record=record._nextRemoved)record===this._mapHead&&(this._mapHead=null),this._records.delete(record.key),record._nextRemoved=record._next,record.previousValue=record.currentValue,record.currentValue=null,record._prev=null,record._next=null}return this._changesTail&&(this._changesTail._nextChanged=null),this._additionsTail&&(this._additionsTail._nextAdded=null),this.isDirty}_insertBeforeOrAppend(before,record){if(before){const prev=before._prev;return record._next=before,record._prev=prev,before._prev=record,prev&&(prev._next=record),before===this._mapHead&&(this._mapHead=record),this._appendAfter=before,before}return this._appendAfter?(this._appendAfter._next=record,record._prev=this._appendAfter):this._mapHead=record,this._appendAfter=record,null}_getOrCreateRecordForKey(key,value){if(this._records.has(key)){const record=this._records.get(key);this._maybeAddToChanges(record,value);const prev=record._prev,next=record._next;return prev&&(prev._next=next),next&&(next._prev=prev),record._next=null,record._prev=null,record}const record=new KeyValueChangeRecord_(key);return this._records.set(key,record),record.currentValue=value,this._addToAdditions(record),record}_reset(){if(this.isDirty){let record;for(this._previousMapHead=this._mapHead,record=this._previousMapHead;null!==record;record=record._next)record._nextPrevious=record._next;for(record=this._changesHead;null!==record;record=record._nextChanged)record.previousValue=record.currentValue;for(record=this._additionsHead;null!=record;record=record._nextAdded)record.previousValue=record.currentValue;this._changesHead=this._changesTail=null,this._additionsHead=this._additionsTail=null,this._removalsHead=null}}_maybeAddToChanges(record,newValue){looseIdentical(newValue,record.currentValue)||(record.previousValue=record.currentValue,record.currentValue=newValue,this._addToChanges(record))}_addToAdditions(record){null===this._additionsHead?this._additionsHead=this._additionsTail=record:(this._additionsTail._nextAdded=record,this._additionsTail=record)}_addToChanges(record){null===this._changesHead?this._changesHead=this._changesTail=record:(this._changesTail._nextChanged=record,this._changesTail=record)}_forEach(obj,fn){obj instanceof Map?obj.forEach(fn):Object.keys(obj).forEach(k=>fn(obj[k],k))}}class KeyValueChangeRecord_{constructor(key){this.key=key,this.previousValue=null,this.currentValue=null,this._nextPrevious=null,this._next=null,this._prev=null,this._nextAdded=null,this._nextRemoved=null,this._nextChanged=null}}let IterableDiffers=(()=>{class IterableDiffers{constructor(factories){this.factories=factories}static create(factories,parent){if(null!=parent){const copied=parent.factories.slice();factories=factories.concat(copied)}return new IterableDiffers(factories)}static extend(factories){return{provide:IterableDiffers,useFactory:parent=>{if(!parent)throw new Error(\"Cannot extend IterableDiffers without a parent injector\");return IterableDiffers.create(factories,parent)},deps:[[IterableDiffers,new SkipSelf,new Optional]]}}find(iterable){const factory=this.factories.find(f=>f.supports(iterable));if(null!=factory)return factory;throw new Error(`Cannot find a differ supporting object '${iterable}' of type '${type=iterable,type.name||typeof type}'`);var type}}return IterableDiffers.ɵprov=ɵɵdefineInjectable({token:IterableDiffers,providedIn:\"root\",factory:()=>new IterableDiffers([new DefaultIterableDifferFactory])}),IterableDiffers})(),KeyValueDiffers=(()=>{class KeyValueDiffers{constructor(factories){this.factories=factories}static create(factories,parent){if(parent){const copied=parent.factories.slice();factories=factories.concat(copied)}return new KeyValueDiffers(factories)}static extend(factories){return{provide:KeyValueDiffers,useFactory:parent=>{if(!parent)throw new Error(\"Cannot extend KeyValueDiffers without a parent injector\");return KeyValueDiffers.create(factories,parent)},deps:[[KeyValueDiffers,new SkipSelf,new Optional]]}}find(kv){const factory=this.factories.find(f=>f.supports(kv));if(factory)return factory;throw new Error(`Cannot find a differ supporting object '${kv}'`)}}return KeyValueDiffers.ɵprov=ɵɵdefineInjectable({token:KeyValueDiffers,providedIn:\"root\",factory:()=>new KeyValueDiffers([new DefaultKeyValueDifferFactory])}),KeyValueDiffers})();const keyValDiff=[new DefaultKeyValueDifferFactory],defaultIterableDiffers=new IterableDiffers([new DefaultIterableDifferFactory]),defaultKeyValueDiffers=new KeyValueDiffers(keyValDiff);let TemplateRef=(()=>{class TemplateRef{}return TemplateRef.__NG_ELEMENT_ID__=()=>SWITCH_TEMPLATE_REF_FACTORY(TemplateRef,ElementRef),TemplateRef})();const SWITCH_TEMPLATE_REF_FACTORY=function(TemplateRefToken,ElementRefToken){return function(TemplateRefToken,ElementRefToken,hostTNode,hostView){return R3TemplateRef||(R3TemplateRef=class extends TemplateRefToken{constructor(_declarationView,_declarationTContainer,elementRef){super(),this._declarationView=_declarationView,this._declarationTContainer=_declarationTContainer,this.elementRef=elementRef}createEmbeddedView(context){const embeddedTView=this._declarationTContainer.tViews,embeddedLView=createLView(this._declarationView,embeddedTView,context,16,null,embeddedTView.node);embeddedLView[17]=this._declarationView[this._declarationTContainer.index];const declarationViewLQueries=this._declarationView[5];null!==declarationViewLQueries&&(embeddedLView[5]=declarationViewLQueries.createEmbeddedView(embeddedTView)),renderView(embeddedTView,embeddedLView,context);const viewRef=new ViewRef(embeddedLView);return viewRef._tViewNode=embeddedLView[6],viewRef}}),0===hostTNode.type?new R3TemplateRef(hostView,hostTNode,createElementRef(ElementRefToken,hostTNode,hostView)):null}(TemplateRefToken,ElementRefToken,getPreviousOrParentTNode(),getLView())};let ViewContainerRef=(()=>{class ViewContainerRef{}return ViewContainerRef.__NG_ELEMENT_ID__=()=>SWITCH_VIEW_CONTAINER_REF_FACTORY(ViewContainerRef,ElementRef),ViewContainerRef})();const SWITCH_VIEW_CONTAINER_REF_FACTORY=function(ViewContainerRefToken,ElementRefToken){return function(ViewContainerRefToken,ElementRefToken,hostTNode,hostView){let lContainer;R3ViewContainerRef||(R3ViewContainerRef=class extends ViewContainerRefToken{constructor(_lContainer,_hostTNode,_hostView){super(),this._lContainer=_lContainer,this._hostTNode=_hostTNode,this._hostView=_hostView}get element(){return createElementRef(ElementRefToken,this._hostTNode,this._hostView)}get injector(){return new NodeInjector(this._hostTNode,this._hostView)}get parentInjector(){const parentLocation=getParentInjectorLocation(this._hostTNode,this._hostView),parentView=getParentInjectorView(parentLocation,this._hostView),parentTNode=function(location,startView,startTNode){if(startTNode.parent&&-1!==startTNode.parent.injectorIndex){const injectorIndex=startTNode.parent.injectorIndex;let tNode=startTNode.parent;for(;null!=tNode.parent&&injectorIndex==tNode.parent.injectorIndex;)tNode=tNode.parent;return tNode}let viewOffset=getParentInjectorViewOffset(location),parentView=startView,parentTNode=startView[6];for(;viewOffset>1;)parentView=parentView[15],parentTNode=parentView[6],viewOffset--;return parentTNode}(parentLocation,this._hostView,this._hostTNode);return hasParentInjector(parentLocation)&&null!=parentTNode?new NodeInjector(parentTNode,parentView):new NodeInjector(null,this._hostView)}clear(){for(;this.length>0;)this.remove(this.length-1)}get(index){return null!==this._lContainer[8]&&this._lContainer[8][index]||null}get length(){return this._lContainer.length-9}createEmbeddedView(templateRef,context,index){const viewRef=templateRef.createEmbeddedView(context||{});return this.insert(viewRef,index),viewRef}createComponent(componentFactory,index,injector,projectableNodes,ngModuleRef){const contextInjector=injector||this.parentInjector;if(!ngModuleRef&&null==componentFactory.ngModule&&contextInjector){const result=contextInjector.get(NgModuleRef,null);result&&(ngModuleRef=result)}const componentRef=componentFactory.create(contextInjector,projectableNodes,void 0,ngModuleRef);return this.insert(componentRef.hostView,index),componentRef}insert(viewRef,index){const lView=viewRef._lView,tView=lView[1];if(viewRef.destroyed)throw new Error(\"Cannot insert a destroyed View in a ViewContainer!\");if(this.allocateContainerIfNeeded(),isLContainer(lView[3])){const prevIdx=this.indexOf(viewRef);if(-1!==prevIdx)this.detach(prevIdx);else{const prevLContainer=lView[3],prevVCRef=new R3ViewContainerRef(prevLContainer,prevLContainer[6],prevLContainer[3]);prevVCRef.detach(prevVCRef.indexOf(viewRef))}}const adjustedIdx=this._adjustIndex(index);return function(tView,lView,lContainer,index){const indexInContainer=9+index,containerLength=lContainer.length;index>0&&(lContainer[indexInContainer-1][4]=lView),index<containerLength-9?(lView[4]=lContainer[indexInContainer],addToArray(lContainer,9+index,lView)):(lContainer.push(lView),lView[4]=null),lView[3]=lContainer;const declarationLContainer=lView[17];null!==declarationLContainer&&lContainer!==declarationLContainer&&function(declarationContainer,lView){const movedViews=declarationContainer[5],insertedComponentLView=lView[3][3][16];16!=(16&insertedComponentLView[2])&&lView[16]!==insertedComponentLView&&(declarationContainer[2]|=1),null===movedViews?declarationContainer[5]=[lView]:movedViews.push(lView)}(declarationLContainer,lView);const lQueries=lView[5];null!==lQueries&&lQueries.insertView(tView),lView[2]|=128}(tView,lView,this._lContainer,adjustedIdx),addRemoveViewFromContainer(tView,lView,!0,getBeforeNodeForView(adjustedIdx,this._lContainer)),viewRef.attachToViewContainerRef(this),addToArray(this._lContainer[8],adjustedIdx,viewRef),viewRef}move(viewRef,newIndex){if(viewRef.destroyed)throw new Error(\"Cannot move a destroyed View in a ViewContainer!\");return this.insert(viewRef,newIndex)}indexOf(viewRef){const viewRefsArr=this._lContainer[8];return null!==viewRefsArr?viewRefsArr.indexOf(viewRef):-1}remove(index){this.allocateContainerIfNeeded();const adjustedIdx=this._adjustIndex(index,-1);(function(lContainer,removeIndex){const detachedView=detachView(lContainer,removeIndex);detachedView&&destroyLView(detachedView[1],detachedView)})(this._lContainer,adjustedIdx),removeFromArray(this._lContainer[8],adjustedIdx)}detach(index){this.allocateContainerIfNeeded();const adjustedIdx=this._adjustIndex(index,-1),view=detachView(this._lContainer,adjustedIdx);return view&&null!=removeFromArray(this._lContainer[8],adjustedIdx)?new ViewRef(view):null}_adjustIndex(index,shift=0){return null==index?this.length+shift:index}allocateContainerIfNeeded(){null===this._lContainer[8]&&(this._lContainer[8]=[])}});const slotValue=hostView[hostTNode.index];if(isLContainer(slotValue))lContainer=slotValue,function(lContainer,index){lContainer[2]=-2}(lContainer);else{let commentNode;if(4===hostTNode.type)commentNode=unwrapRNode(slotValue);else if(commentNode=hostView[11].createComment(\"\"),isRootView(hostView)){const renderer=hostView[11],hostNative=getNativeByTNode(hostTNode,hostView);nativeInsertBefore(renderer,nativeParentNode(renderer,hostNative),commentNode,function(renderer,node){return isProceduralRenderer(renderer)?renderer.nextSibling(node):node.nextSibling}(renderer,hostNative))}else appendChild(hostView[1],hostView,commentNode,hostTNode);hostView[hostTNode.index]=lContainer=createLContainer(slotValue,hostView,commentNode,hostTNode),addToViewTree(hostView,lContainer)}return new R3ViewContainerRef(lContainer,hostTNode,hostView)}(ViewContainerRefToken,ElementRefToken,getPreviousOrParentTNode(),getLView())},NOT_FOUND_CHECK_ONLY_ELEMENT_INJECTOR={};class ComponentFactoryResolver$1 extends ComponentFactoryResolver{constructor(ngModule){super(),this.ngModule=ngModule}resolveComponentFactory(component){const componentDef=getComponentDef(component);return new ComponentFactory$1(componentDef,this.ngModule)}}function toRefArray(map){const array=[];for(let nonMinified in map)map.hasOwnProperty(nonMinified)&&array.push({propName:map[nonMinified],templateName:nonMinified});return array}const SCHEDULER=new InjectionToken(\"SCHEDULER_TOKEN\",{providedIn:\"root\",factory:()=>defaultScheduler});class ComponentFactory$1 extends ComponentFactory{constructor(componentDef,ngModule){super(),this.componentDef=componentDef,this.ngModule=ngModule,this.componentType=componentDef.type,this.selector=componentDef.selectors.map(stringifyCSSSelector).join(\",\"),this.ngContentSelectors=componentDef.ngContentSelectors?componentDef.ngContentSelectors:[],this.isBoundToModule=!!ngModule}get inputs(){return toRefArray(this.componentDef.inputs)}get outputs(){return toRefArray(this.componentDef.outputs)}create(injector,projectableNodes,rootSelectorOrNode,ngModule){const rootViewInjector=(ngModule=ngModule||this.ngModule)?function(rootViewInjector,moduleInjector){return{get:(token,notFoundValue,flags)=>{const value=rootViewInjector.get(token,NOT_FOUND_CHECK_ONLY_ELEMENT_INJECTOR,flags);return value!==NOT_FOUND_CHECK_ONLY_ELEMENT_INJECTOR||notFoundValue===NOT_FOUND_CHECK_ONLY_ELEMENT_INJECTOR?value:moduleInjector.get(token,notFoundValue,flags)}}}(injector,ngModule.injector):injector,rendererFactory=rootViewInjector.get(RendererFactory2,domRendererFactory3),sanitizer=rootViewInjector.get(Sanitizer,null),hostRenderer=rendererFactory.createRenderer(null,this.componentDef),elementName=this.componentDef.selectors[0][0]||\"div\",hostRNode=rootSelectorOrNode?function(renderer,elementOrSelector,encapsulation){if(isProceduralRenderer(renderer))return renderer.selectRootElement(elementOrSelector,encapsulation===ViewEncapsulation$1.ShadowDom);let rElement=\"string\"==typeof elementOrSelector?renderer.querySelector(elementOrSelector):elementOrSelector;return rElement.textContent=\"\",rElement}(hostRenderer,rootSelectorOrNode,this.componentDef.encapsulation):elementCreate(elementName,rendererFactory.createRenderer(null,this.componentDef),function(elementName){const name=elementName.toLowerCase();return\"svg\"===name?\"http://www.w3.org/2000/svg\":\"math\"===name?\"http://www.w3.org/1998/MathML/\":null}(elementName)),rootFlags=this.componentDef.onPush?576:528,isIsolated=\"string\"==typeof rootSelectorOrNode&&/^#root-ng-internal-isolated-\\d+/.test(rootSelectorOrNode),rootContext={components:[],scheduler:defaultScheduler,clean:CLEAN_PROMISE,playerHandler:null,flags:0},rootTView=createTView(0,-1,null,1,0,null,null,null,null,null),rootLView=createLView(null,rootTView,rootContext,rootFlags,null,null,rendererFactory,hostRenderer,sanitizer,rootViewInjector);let component,tElementNode;enterView(rootLView,null);try{const componentView=function(rNode,def,rootView,rendererFactory,hostRenderer,sanitizer){const tView=rootView[1];rootView[19]=rNode;const tNode=getOrCreateTNode(tView,null,0,3,null,null),mergedAttrs=tNode.mergedAttrs=def.hostAttrs;null!==mergedAttrs&&(computeStaticStyling(tNode,mergedAttrs),null!==rNode&&(setUpAttributes(hostRenderer,rNode,mergedAttrs),null!==tNode.classes&&writeDirectClass(hostRenderer,rNode,tNode.classes),null!==tNode.styles&&writeDirectStyle(hostRenderer,rNode,tNode.styles)));const viewRenderer=rendererFactory.createRenderer(rNode,def),componentView=createLView(rootView,getOrCreateTComponentView(def),null,def.onPush?64:16,rootView[19],tNode,rendererFactory,viewRenderer,void 0);return tView.firstCreatePass&&(diPublicInInjector(getOrCreateNodeInjectorForNode(tNode,rootView),tView,def.type),markAsComponentHost(tView,tNode),initTNodeFlags(tNode,rootView.length,1)),addToViewTree(rootView,componentView),rootView[19]=componentView}(hostRNode,this.componentDef,rootLView,rendererFactory,hostRenderer);if(hostRNode)if(rootSelectorOrNode)setUpAttributes(hostRenderer,hostRNode,[\"ng-version\",VERSION.full]);else{const{attrs:attrs,classes:classes}=function(selector){const attrs=[],classes=[];let i=1,mode=2;for(;i<selector.length;){let valueOrMarker=selector[i];if(\"string\"==typeof valueOrMarker)2===mode?\"\"!==valueOrMarker&&attrs.push(valueOrMarker,selector[++i]):8===mode&&classes.push(valueOrMarker);else{if(!isPositive(mode))break;mode=valueOrMarker}i++}return{attrs:attrs,classes:classes}}(this.componentDef.selectors[0]);attrs&&setUpAttributes(hostRenderer,hostRNode,attrs),classes&&classes.length>0&&writeDirectClass(hostRenderer,hostRNode,classes.join(\" \"))}tElementNode=getTNode(rootLView[1],0),projectableNodes&&(tElementNode.projection=projectableNodes.map(nodesforSlot=>Array.from(nodesforSlot))),component=function(componentView,componentDef,rootLView,rootContext,hostFeatures){const tView=rootLView[1],component=function(tView,lView,def){const rootTNode=getPreviousOrParentTNode();tView.firstCreatePass&&(def.providersResolver&&def.providersResolver(def),generateExpandoInstructionBlock(tView,rootTNode,1),baseResolveDirective(tView,lView,def));const directive=getNodeInjectable(lView,tView,lView.length-1,rootTNode);attachPatchData(directive,lView);const native=getNativeByTNode(rootTNode,lView);return native&&attachPatchData(native,lView),directive}(tView,rootLView,componentDef);rootContext.components.push(component),componentView[8]=component,hostFeatures&&hostFeatures.forEach(feature=>feature(component,componentDef)),componentDef.contentQueries&&componentDef.contentQueries(1,component,rootLView.length-1);const rootTNode=getPreviousOrParentTNode();if(tView.firstCreatePass&&(null!==componentDef.hostBindings||null!==componentDef.hostAttrs)){setSelectedIndex(rootTNode.index-19);const rootTView=rootLView[1];addHostBindingsToExpandoInstructions(rootTView,componentDef),growHostVarsSpace(rootTView,rootLView,componentDef.hostVars),invokeHostBindingsInCreationMode(componentDef,component)}return component}(componentView,this.componentDef,rootLView,rootContext,[LifecycleHooksFeature]),renderView(rootTView,rootLView,null)}finally{leaveView()}const componentRef=new ComponentRef$1(this.componentType,component,createElementRef(ElementRef,tElementNode,rootLView),rootLView,tElementNode);return rootSelectorOrNode&&!isIsolated||(componentRef.hostView._tViewNode.child=tElementNode),componentRef}}class ComponentRef$1 extends class{}{constructor(componentType,instance,location,_rootLView,_tNode){super(),this.location=location,this._rootLView=_rootLView,this._tNode=_tNode,this.destroyCbs=[],this.instance=instance,this.hostView=this.changeDetectorRef=new RootViewRef(_rootLView),this.hostView._tViewNode=function(tView,tParentNode,index,lView){let tNode=tView.node;return null==tNode&&(tView.node=tNode=createTNode(0,null,2,-1,null,null)),lView[6]=tNode}(_rootLView[1],0,0,_rootLView),this.componentType=componentType}get injector(){return new NodeInjector(this._tNode,this._rootLView)}destroy(){this.destroyCbs&&(this.destroyCbs.forEach(fn=>fn()),this.destroyCbs=null,!this.hostView.destroyed&&this.hostView.destroy())}onDestroy(callback){this.destroyCbs&&this.destroyCbs.push(callback)}}const u=void 0;var localeEn=[\"en\",[[\"a\",\"p\"],[\"AM\",\"PM\"],u],[[\"AM\",\"PM\"],u,u],[[\"S\",\"M\",\"T\",\"W\",\"T\",\"F\",\"S\"],[\"Sun\",\"Mon\",\"Tue\",\"Wed\",\"Thu\",\"Fri\",\"Sat\"],[\"Sunday\",\"Monday\",\"Tuesday\",\"Wednesday\",\"Thursday\",\"Friday\",\"Saturday\"],[\"Su\",\"Mo\",\"Tu\",\"We\",\"Th\",\"Fr\",\"Sa\"]],u,[[\"J\",\"F\",\"M\",\"A\",\"M\",\"J\",\"J\",\"A\",\"S\",\"O\",\"N\",\"D\"],[\"Jan\",\"Feb\",\"Mar\",\"Apr\",\"May\",\"Jun\",\"Jul\",\"Aug\",\"Sep\",\"Oct\",\"Nov\",\"Dec\"],[\"January\",\"February\",\"March\",\"April\",\"May\",\"June\",\"July\",\"August\",\"September\",\"October\",\"November\",\"December\"]],u,[[\"B\",\"A\"],[\"BC\",\"AD\"],[\"Before Christ\",\"Anno Domini\"]],0,[6,0],[\"M/d/yy\",\"MMM d, y\",\"MMMM d, y\",\"EEEE, MMMM d, y\"],[\"h:mm a\",\"h:mm:ss a\",\"h:mm:ss a z\",\"h:mm:ss a zzzz\"],[\"{1}, {0}\",u,\"{1} 'at' {0}\",u],[\".\",\",\",\";\",\"%\",\"+\",\"-\",\"E\",\"×\",\"‰\",\"∞\",\"NaN\",\":\"],[\"#,##0.###\",\"#,##0%\",\"¤#,##0.00\",\"#E0\"],\"USD\",\"$\",\"US Dollar\",{},function(n){let i=Math.floor(Math.abs(n)),v=n.toString().replace(/^[^.]*\\.?/,\"\").length;return 1===i&&0===v?1:5}];let LOCALE_DATA={};function getLocaleData(normalizedLocale){return normalizedLocale in LOCALE_DATA||(LOCALE_DATA[normalizedLocale]=_global.ng&&_global.ng.common&&_global.ng.common.locales&&_global.ng.common.locales[normalizedLocale]),LOCALE_DATA[normalizedLocale]}const LocaleDataIndex=function(){var LocaleDataIndex={LocaleId:0,DayPeriodsFormat:1,DayPeriodsStandalone:2,DaysFormat:3,DaysStandalone:4,MonthsFormat:5,MonthsStandalone:6,Eras:7,FirstDayOfWeek:8,WeekendRange:9,DateFormat:10,TimeFormat:11,DateTimeFormat:12,NumberSymbols:13,NumberFormats:14,CurrencyCode:15,CurrencySymbol:16,CurrencyName:17,Currencies:18,PluralCase:19,ExtraData:20};return LocaleDataIndex[LocaleDataIndex.LocaleId]=\"LocaleId\",LocaleDataIndex[LocaleDataIndex.DayPeriodsFormat]=\"DayPeriodsFormat\",LocaleDataIndex[LocaleDataIndex.DayPeriodsStandalone]=\"DayPeriodsStandalone\",LocaleDataIndex[LocaleDataIndex.DaysFormat]=\"DaysFormat\",LocaleDataIndex[LocaleDataIndex.DaysStandalone]=\"DaysStandalone\",LocaleDataIndex[LocaleDataIndex.MonthsFormat]=\"MonthsFormat\",LocaleDataIndex[LocaleDataIndex.MonthsStandalone]=\"MonthsStandalone\",LocaleDataIndex[LocaleDataIndex.Eras]=\"Eras\",LocaleDataIndex[LocaleDataIndex.FirstDayOfWeek]=\"FirstDayOfWeek\",LocaleDataIndex[LocaleDataIndex.WeekendRange]=\"WeekendRange\",LocaleDataIndex[LocaleDataIndex.DateFormat]=\"DateFormat\",LocaleDataIndex[LocaleDataIndex.TimeFormat]=\"TimeFormat\",LocaleDataIndex[LocaleDataIndex.DateTimeFormat]=\"DateTimeFormat\",LocaleDataIndex[LocaleDataIndex.NumberSymbols]=\"NumberSymbols\",LocaleDataIndex[LocaleDataIndex.NumberFormats]=\"NumberFormats\",LocaleDataIndex[LocaleDataIndex.CurrencyCode]=\"CurrencyCode\",LocaleDataIndex[LocaleDataIndex.CurrencySymbol]=\"CurrencySymbol\",LocaleDataIndex[LocaleDataIndex.CurrencyName]=\"CurrencyName\",LocaleDataIndex[LocaleDataIndex.Currencies]=\"Currencies\",LocaleDataIndex[LocaleDataIndex.PluralCase]=\"PluralCase\",LocaleDataIndex[LocaleDataIndex.ExtraData]=\"ExtraData\",LocaleDataIndex}();let LOCALE_ID=\"en-US\";function setLocaleId(localeId){var actual,msg;msg=\"Expected localeId to be defined\",null==(actual=localeId)&&function(msg,actual,expected,comparison){throw new Error(\"ASSERTION ERROR: \"+msg+` [Expected=> null != ${actual} <=Actual]`)}(msg,actual),\"string\"==typeof localeId&&(LOCALE_ID=localeId.toLowerCase().replace(/_/g,\"-\"))}const modules=new Map;class NgModuleRef$1 extends NgModuleRef{constructor(ngModuleType,_parent){super(),this._parent=_parent,this._bootstrapComponents=[],this.injector=this,this.destroyCbs=[],this.componentFactoryResolver=new ComponentFactoryResolver$1(this);const ngModuleDef=getNgModuleDef(ngModuleType),ngLocaleIdDef=ngModuleType[NG_LOC_ID_DEF]||null;ngLocaleIdDef&&setLocaleId(ngLocaleIdDef),this._bootstrapComponents=maybeUnwrapFn(ngModuleDef.bootstrap),this._r3Injector=createInjectorWithoutInjectorInstances(ngModuleType,_parent,[{provide:NgModuleRef,useValue:this},{provide:ComponentFactoryResolver,useValue:this.componentFactoryResolver}],stringify(ngModuleType)),this._r3Injector._resolveInjectorDefTypes(),this.instance=this.get(ngModuleType)}get(token,notFoundValue=Injector.THROW_IF_NOT_FOUND,injectFlags=InjectFlags.Default){return token===Injector||token===NgModuleRef||token===INJECTOR?this:this._r3Injector.get(token,notFoundValue,injectFlags)}destroy(){const injector=this._r3Injector;!injector.destroyed&&injector.destroy(),this.destroyCbs.forEach(fn=>fn()),this.destroyCbs=null}onDestroy(callback){this.destroyCbs.push(callback)}}class NgModuleFactory$1 extends NgModuleFactory{constructor(moduleType){super(),this.moduleType=moduleType,null!==getNgModuleDef(moduleType)&&function registerNgModuleType(ngModuleType){if(null!==ngModuleType.ɵmod.id){const id=ngModuleType.ɵmod.id;(function(id,type,incoming){if(type&&type!==incoming)throw new Error(`Duplicate module registered for ${id} - ${stringify(type)} vs ${stringify(type.name)}`)})(id,modules.get(id),ngModuleType),modules.set(id,ngModuleType)}let imports=ngModuleType.ɵmod.imports;imports instanceof Function&&(imports=imports()),imports&&imports.forEach(i=>registerNgModuleType(i))}(moduleType)}create(parentInjector){return new NgModuleRef$1(this.moduleType,parentInjector)}}class core_EventEmitter extends Subject_Subject{constructor(isAsync=!1){super(),this.__isAsync=isAsync}emit(value){super.next(value)}subscribe(generatorOrNext,error,complete){let schedulerFn,errorFn=err=>null,completeFn=()=>null;generatorOrNext&&\"object\"==typeof generatorOrNext?(schedulerFn=this.__isAsync?value=>{setTimeout(()=>generatorOrNext.next(value))}:value=>{generatorOrNext.next(value)},generatorOrNext.error&&(errorFn=this.__isAsync?err=>{setTimeout(()=>generatorOrNext.error(err))}:err=>{generatorOrNext.error(err)}),generatorOrNext.complete&&(completeFn=this.__isAsync?()=>{setTimeout(()=>generatorOrNext.complete())}:()=>{generatorOrNext.complete()})):(schedulerFn=this.__isAsync?value=>{setTimeout(()=>generatorOrNext(value))}:value=>{generatorOrNext(value)},error&&(errorFn=this.__isAsync?err=>{setTimeout(()=>error(err))}:err=>{error(err)}),complete&&(completeFn=this.__isAsync?()=>{setTimeout(()=>complete())}:()=>{complete()}));const sink=super.subscribe(schedulerFn,errorFn,completeFn);return generatorOrNext instanceof Subscription_Subscription&&generatorOrNext.add(sink),sink}}const APP_INITIALIZER=new InjectionToken(\"Application Initializer\");let ApplicationInitStatus=(()=>{class ApplicationInitStatus{constructor(appInits){this.appInits=appInits,this.initialized=!1,this.done=!1,this.donePromise=new Promise((res,rej)=>{this.resolve=res,this.reject=rej})}runInitializers(){if(this.initialized)return;const asyncInitPromises=[],complete=()=>{this.done=!0,this.resolve()};if(this.appInits)for(let i=0;i<this.appInits.length;i++){const initResult=this.appInits[i]();core_isPromise(initResult)&&asyncInitPromises.push(initResult)}Promise.all(asyncInitPromises).then(()=>{complete()}).catch(e=>{this.reject(e)}),0===asyncInitPromises.length&&complete(),this.initialized=!0}}return ApplicationInitStatus.ɵfac=function(t){return new(t||ApplicationInitStatus)(ɵɵinject(APP_INITIALIZER,8))},ApplicationInitStatus.ɵprov=ɵɵdefineInjectable({token:ApplicationInitStatus,factory:ApplicationInitStatus.ɵfac}),ApplicationInitStatus})();const APP_ID=new InjectionToken(\"AppId\"),APP_ID_RANDOM_PROVIDER={provide:APP_ID,useFactory:function(){return`${_randomChar()}${_randomChar()}${_randomChar()}`},deps:[]};function _randomChar(){return String.fromCharCode(97+Math.floor(25*Math.random()))}const PLATFORM_INITIALIZER=new InjectionToken(\"Platform Initializer\"),PLATFORM_ID=new InjectionToken(\"Platform ID\"),APP_BOOTSTRAP_LISTENER=new InjectionToken(\"appBootstrapListener\");let Console=(()=>{class Console{log(message){console.log(message)}warn(message){console.warn(message)}}return Console.ɵfac=function(t){return new(t||Console)},Console.ɵprov=ɵɵdefineInjectable({token:Console,factory:Console.ɵfac}),Console})();const LOCALE_ID$1=new InjectionToken(\"LocaleId\"),DEFAULT_CURRENCY_CODE=new InjectionToken(\"DefaultCurrencyCode\");class ModuleWithComponentFactories{constructor(ngModuleFactory,componentFactories){this.ngModuleFactory=ngModuleFactory,this.componentFactories=componentFactories}}const Compiler_compileModuleSync__POST_R3__=function(moduleType){return new NgModuleFactory$1(moduleType)},Compiler_compileModuleSync=Compiler_compileModuleSync__POST_R3__,Compiler_compileModuleAsync=function(moduleType){return Promise.resolve(Compiler_compileModuleSync__POST_R3__(moduleType))},Compiler_compileModuleAndAllComponentsSync__POST_R3__=function(moduleType){const ngModuleFactory=Compiler_compileModuleSync__POST_R3__(moduleType),componentFactories=maybeUnwrapFn(getNgModuleDef(moduleType).declarations).reduce((factories,declaration)=>{const componentDef=getComponentDef(declaration);return componentDef&&factories.push(new ComponentFactory$1(componentDef)),factories},[]);return new ModuleWithComponentFactories(ngModuleFactory,componentFactories)},Compiler_compileModuleAndAllComponentsSync=Compiler_compileModuleAndAllComponentsSync__POST_R3__,Compiler_compileModuleAndAllComponentsAsync=function(moduleType){return Promise.resolve(Compiler_compileModuleAndAllComponentsSync__POST_R3__(moduleType))};let Compiler=(()=>{class Compiler{constructor(){this.compileModuleSync=Compiler_compileModuleSync,this.compileModuleAsync=Compiler_compileModuleAsync,this.compileModuleAndAllComponentsSync=Compiler_compileModuleAndAllComponentsSync,this.compileModuleAndAllComponentsAsync=Compiler_compileModuleAndAllComponentsAsync}clearCache(){}clearCacheFor(type){}getModuleId(moduleType){}}return Compiler.ɵfac=function(t){return new(t||Compiler)},Compiler.ɵprov=ɵɵdefineInjectable({token:Compiler,factory:Compiler.ɵfac}),Compiler})();const COMPILER_OPTIONS=new InjectionToken(\"compilerOptions\"),core_promise=(()=>Promise.resolve(0))();function scheduleMicroTask(fn){\"undefined\"==typeof Zone?core_promise.then(()=>{fn&&fn.apply(null,null)}):Zone.current.scheduleMicroTask(\"scheduleMicrotask\",fn)}class NgZone{constructor({enableLongStackTrace:enableLongStackTrace=!1,shouldCoalesceEventChangeDetection:shouldCoalesceEventChangeDetection=!1}){if(this.hasPendingMacrotasks=!1,this.hasPendingMicrotasks=!1,this.isStable=!0,this.onUnstable=new core_EventEmitter(!1),this.onMicrotaskEmpty=new core_EventEmitter(!1),this.onStable=new core_EventEmitter(!1),this.onError=new core_EventEmitter(!1),\"undefined\"==typeof Zone)throw new Error(\"In this configuration Angular requires Zone.js\");Zone.assertZonePatched(),this._nesting=0,this._outer=this._inner=Zone.current,Zone.wtfZoneSpec&&(this._inner=this._inner.fork(Zone.wtfZoneSpec)),Zone.TaskTrackingZoneSpec&&(this._inner=this._inner.fork(new Zone.TaskTrackingZoneSpec)),enableLongStackTrace&&Zone.longStackTraceZoneSpec&&(this._inner=this._inner.fork(Zone.longStackTraceZoneSpec)),this.shouldCoalesceEventChangeDetection=shouldCoalesceEventChangeDetection,this.lastRequestAnimationFrameId=-1,this.nativeRequestAnimationFrame=function(){let nativeRequestAnimationFrame=_global.requestAnimationFrame,nativeCancelAnimationFrame=_global.cancelAnimationFrame;if(\"undefined\"!=typeof Zone&&nativeRequestAnimationFrame&&nativeCancelAnimationFrame){const unpatchedRequestAnimationFrame=nativeRequestAnimationFrame[Zone.__symbol__(\"OriginalDelegate\")];unpatchedRequestAnimationFrame&&(nativeRequestAnimationFrame=unpatchedRequestAnimationFrame);const unpatchedCancelAnimationFrame=nativeCancelAnimationFrame[Zone.__symbol__(\"OriginalDelegate\")];unpatchedCancelAnimationFrame&&(nativeCancelAnimationFrame=unpatchedCancelAnimationFrame)}return{nativeRequestAnimationFrame:nativeRequestAnimationFrame,nativeCancelAnimationFrame:nativeCancelAnimationFrame}}().nativeRequestAnimationFrame,function(zone){const maybeDelayChangeDetection=!!zone.shouldCoalesceEventChangeDetection&&zone.nativeRequestAnimationFrame&&(()=>{!function(zone){-1===zone.lastRequestAnimationFrameId&&(zone.lastRequestAnimationFrameId=zone.nativeRequestAnimationFrame.call(_global,()=>{zone.lastRequestAnimationFrameId=-1,updateMicroTaskStatus(zone),checkStable(zone)}),updateMicroTaskStatus(zone))}(zone)});zone._inner=zone._inner.fork({name:\"angular\",properties:{isAngularZone:!0,maybeDelayChangeDetection:maybeDelayChangeDetection},onInvokeTask:(delegate,current,target,task,applyThis,applyArgs)=>{try{return onEnter(zone),delegate.invokeTask(target,task,applyThis,applyArgs)}finally{maybeDelayChangeDetection&&\"eventTask\"===task.type&&maybeDelayChangeDetection(),onLeave(zone)}},onInvoke:(delegate,current,target,callback,applyThis,applyArgs,source)=>{try{return onEnter(zone),delegate.invoke(target,callback,applyThis,applyArgs,source)}finally{onLeave(zone)}},onHasTask:(delegate,current,target,hasTaskState)=>{delegate.hasTask(target,hasTaskState),current===target&&(\"microTask\"==hasTaskState.change?(zone._hasPendingMicrotasks=hasTaskState.microTask,updateMicroTaskStatus(zone),checkStable(zone)):\"macroTask\"==hasTaskState.change&&(zone.hasPendingMacrotasks=hasTaskState.macroTask))},onHandleError:(delegate,current,target,error)=>(delegate.handleError(target,error),zone.runOutsideAngular(()=>zone.onError.emit(error)),!1)})}(this)}static isInAngularZone(){return!0===Zone.current.get(\"isAngularZone\")}static assertInAngularZone(){if(!NgZone.isInAngularZone())throw new Error(\"Expected to be in Angular Zone, but it is not!\")}static assertNotInAngularZone(){if(NgZone.isInAngularZone())throw new Error(\"Expected to not be in Angular Zone, but it is!\")}run(fn,applyThis,applyArgs){return this._inner.run(fn,applyThis,applyArgs)}runTask(fn,applyThis,applyArgs,name){const zone=this._inner,task=zone.scheduleEventTask(\"NgZoneEvent: \"+name,fn,EMPTY_PAYLOAD,noop$1,noop$1);try{return zone.runTask(task,applyThis,applyArgs)}finally{zone.cancelTask(task)}}runGuarded(fn,applyThis,applyArgs){return this._inner.runGuarded(fn,applyThis,applyArgs)}runOutsideAngular(fn){return this._outer.run(fn)}}function noop$1(){}const EMPTY_PAYLOAD={};function checkStable(zone){if(0==zone._nesting&&!zone.hasPendingMicrotasks&&!zone.isStable)try{zone._nesting++,zone.onMicrotaskEmpty.emit(null)}finally{if(zone._nesting--,!zone.hasPendingMicrotasks)try{zone.runOutsideAngular(()=>zone.onStable.emit(null))}finally{zone.isStable=!0}}}function updateMicroTaskStatus(zone){zone.hasPendingMicrotasks=!!(zone._hasPendingMicrotasks||zone.shouldCoalesceEventChangeDetection&&-1!==zone.lastRequestAnimationFrameId)}function onEnter(zone){zone._nesting++,zone.isStable&&(zone.isStable=!1,zone.onUnstable.emit(null))}function onLeave(zone){zone._nesting--,checkStable(zone)}class NoopNgZone{constructor(){this.hasPendingMicrotasks=!1,this.hasPendingMacrotasks=!1,this.isStable=!0,this.onUnstable=new core_EventEmitter,this.onMicrotaskEmpty=new core_EventEmitter,this.onStable=new core_EventEmitter,this.onError=new core_EventEmitter}run(fn,applyThis,applyArgs){return fn.apply(applyThis,applyArgs)}runGuarded(fn,applyThis,applyArgs){return fn.apply(applyThis,applyArgs)}runOutsideAngular(fn){return fn()}runTask(fn,applyThis,applyArgs,name){return fn.apply(applyThis,applyArgs)}}let Testability=(()=>{class Testability{constructor(_ngZone){this._ngZone=_ngZone,this._pendingCount=0,this._isZoneStable=!0,this._didWork=!1,this._callbacks=[],this.taskTrackingZone=null,this._watchAngularEvents(),_ngZone.run(()=>{this.taskTrackingZone=\"undefined\"==typeof Zone?null:Zone.current.get(\"TaskTrackingZone\")})}_watchAngularEvents(){this._ngZone.onUnstable.subscribe({next:()=>{this._didWork=!0,this._isZoneStable=!1}}),this._ngZone.runOutsideAngular(()=>{this._ngZone.onStable.subscribe({next:()=>{NgZone.assertNotInAngularZone(),scheduleMicroTask(()=>{this._isZoneStable=!0,this._runCallbacksIfReady()})}})})}increasePendingRequestCount(){return this._pendingCount+=1,this._didWork=!0,this._pendingCount}decreasePendingRequestCount(){if(this._pendingCount-=1,this._pendingCount<0)throw new Error(\"pending async requests below zero\");return this._runCallbacksIfReady(),this._pendingCount}isStable(){return this._isZoneStable&&0===this._pendingCount&&!this._ngZone.hasPendingMacrotasks}_runCallbacksIfReady(){if(this.isStable())scheduleMicroTask(()=>{for(;0!==this._callbacks.length;){let cb=this._callbacks.pop();clearTimeout(cb.timeoutId),cb.doneCb(this._didWork)}this._didWork=!1});else{let pending=this.getPendingTasks();this._callbacks=this._callbacks.filter(cb=>!cb.updateCb||!cb.updateCb(pending)||(clearTimeout(cb.timeoutId),!1)),this._didWork=!0}}getPendingTasks(){return this.taskTrackingZone?this.taskTrackingZone.macroTasks.map(t=>({source:t.source,creationLocation:t.creationLocation,data:t.data})):[]}addCallback(cb,timeout,updateCb){let timeoutId=-1;timeout&&timeout>0&&(timeoutId=setTimeout(()=>{this._callbacks=this._callbacks.filter(cb=>cb.timeoutId!==timeoutId),cb(this._didWork,this.getPendingTasks())},timeout)),this._callbacks.push({doneCb:cb,timeoutId:timeoutId,updateCb:updateCb})}whenStable(doneCb,timeout,updateCb){if(updateCb&&!this.taskTrackingZone)throw new Error('Task tracking zone is required when passing an update callback to whenStable(). Is \"zone.js/dist/task-tracking.js\" loaded?');this.addCallback(doneCb,timeout,updateCb),this._runCallbacksIfReady()}getPendingRequestCount(){return this._pendingCount}findProviders(using,provider,exactMatch){return[]}}return Testability.ɵfac=function(t){return new(t||Testability)(ɵɵinject(NgZone))},Testability.ɵprov=ɵɵdefineInjectable({token:Testability,factory:Testability.ɵfac}),Testability})(),TestabilityRegistry=(()=>{class TestabilityRegistry{constructor(){this._applications=new Map,_testabilityGetter.addToWindow(this)}registerApplication(token,testability){this._applications.set(token,testability)}unregisterApplication(token){this._applications.delete(token)}unregisterAllApplications(){this._applications.clear()}getTestability(elem){return this._applications.get(elem)||null}getAllTestabilities(){return Array.from(this._applications.values())}getAllRootElements(){return Array.from(this._applications.keys())}findTestabilityInTree(elem,findInAncestors=!0){return _testabilityGetter.findTestabilityInTree(this,elem,findInAncestors)}}return TestabilityRegistry.ɵfac=function(t){return new(t||TestabilityRegistry)},TestabilityRegistry.ɵprov=ɵɵdefineInjectable({token:TestabilityRegistry,factory:TestabilityRegistry.ɵfac}),TestabilityRegistry})();class _NoopGetTestability{addToWindow(registry){}findTestabilityInTree(registry,elem,findInAncestors){return null}}let _platform,_testabilityGetter=new _NoopGetTestability,compileNgModuleFactory=function(injector,options,moduleType){const moduleFactory=new NgModuleFactory$1(moduleType);if(0===componentResourceResolutionQueue.size)return Promise.resolve(moduleFactory);const compilerProviders=function(parts){const result=[];return parts.forEach(part=>part&&result.push(...part)),result}(injector.get(COMPILER_OPTIONS,[]).concat(options).map(o=>o.providers));if(0===compilerProviders.length)return Promise.resolve(moduleFactory);const compiler=function(){const globalNg=_global.ng;if(!globalNg||!globalNg.ɵcompilerFacade)throw new Error(\"Angular JIT compilation failed: '@angular/compiler' not loaded!\\n  - JIT compilation is discouraged for production use-cases! Consider AOT mode instead.\\n  - Did you bootstrap using '@angular/platform-browser-dynamic' or '@angular/platform-server'?\\n  - Alternatively provide the compiler with 'import \\\"@angular/compiler\\\";' before bootstrapping.\");return globalNg.ɵcompilerFacade}(),resourceLoader=Injector.create({providers:compilerProviders}).get(compiler.ResourceLoader);return function(resourceResolver){const componentResolved=[],urlMap=new Map;function cachedResourceResolve(url){let promise=urlMap.get(url);if(!promise){const resp=(url=>Promise.resolve(resourceLoader.get(url)))(url);urlMap.set(url,promise=resp.then(unwrapResponse))}return promise}return componentResourceResolutionQueue.forEach((component,type)=>{const promises=[];component.templateUrl&&promises.push(cachedResourceResolve(component.templateUrl).then(template=>{component.template=template}));const styleUrls=component.styleUrls,styles=component.styles||(component.styles=[]),styleOffset=component.styles.length;styleUrls&&styleUrls.forEach((styleUrl,index)=>{styles.push(\"\"),promises.push(cachedResourceResolve(styleUrl).then(style=>{styles[styleOffset+index]=style,styleUrls.splice(styleUrls.indexOf(styleUrl),1),0==styleUrls.length&&(component.styleUrls=void 0)}))});const fullyResolved=Promise.all(promises).then(()=>function(type){componentDefPendingResolution.delete(type)}(type));componentResolved.push(fullyResolved)}),componentResourceResolutionQueue=new Map,Promise.all(componentResolved).then(()=>{})}().then(()=>moduleFactory)};const ALLOW_MULTIPLE_PLATFORMS=new InjectionToken(\"AllowMultipleToken\");class NgProbeToken{constructor(name,token){this.name=name,this.token=token}}function createPlatformFactory(parentPlatformFactory,name,providers=[]){const desc=\"Platform: \"+name,marker=new InjectionToken(desc);return(extraProviders=[])=>{let platform=getPlatform();if(!platform||platform.injector.get(ALLOW_MULTIPLE_PLATFORMS,!1))if(parentPlatformFactory)parentPlatformFactory(providers.concat(extraProviders).concat({provide:marker,useValue:!0}));else{const injectedProviders=providers.concat(extraProviders).concat({provide:marker,useValue:!0},{provide:INJECTOR_SCOPE,useValue:\"platform\"});!function(injector){if(_platform&&!_platform.destroyed&&!_platform.injector.get(ALLOW_MULTIPLE_PLATFORMS,!1))throw new Error(\"There can be only one platform. Destroy the previous one to create a new one.\");_platform=injector.get(PlatformRef);const inits=injector.get(PLATFORM_INITIALIZER,null);inits&&inits.forEach(init=>init())}(Injector.create({providers:injectedProviders,name:desc}))}return function(requiredToken){const platform=getPlatform();if(!platform)throw new Error(\"No platform exists!\");if(!platform.injector.get(requiredToken,null))throw new Error(\"A platform with a different configuration has been created. Please destroy it first.\");return platform}(marker)}}function getPlatform(){return _platform&&!_platform.destroyed?_platform:null}let PlatformRef=(()=>{class PlatformRef{constructor(_injector){this._injector=_injector,this._modules=[],this._destroyListeners=[],this._destroyed=!1}bootstrapModuleFactory(moduleFactory,options){const ngZone=function(ngZoneOption,ngZoneEventCoalescing){let ngZone;return ngZone=\"noop\"===ngZoneOption?new NoopNgZone:(\"zone.js\"===ngZoneOption?void 0:ngZoneOption)||new NgZone({enableLongStackTrace:isDevMode(),shouldCoalesceEventChangeDetection:ngZoneEventCoalescing}),ngZone}(options?options.ngZone:void 0,options&&options.ngZoneEventCoalescing||!1),providers=[{provide:NgZone,useValue:ngZone}];return ngZone.run(()=>{const ngZoneInjector=Injector.create({providers:providers,parent:this.injector,name:moduleFactory.moduleType.name}),moduleRef=moduleFactory.create(ngZoneInjector),exceptionHandler=moduleRef.injector.get(ErrorHandler,null);if(!exceptionHandler)throw new Error(\"No ErrorHandler. Is platform module (BrowserModule) included?\");return moduleRef.onDestroy(()=>remove(this._modules,moduleRef)),ngZone.runOutsideAngular(()=>ngZone.onError.subscribe({next:error=>{exceptionHandler.handleError(error)}})),function(errorHandler,ngZone,callback){try{const result=callback();return core_isPromise(result)?result.catch(e=>{throw ngZone.runOutsideAngular(()=>errorHandler.handleError(e)),e}):result}catch(e){throw ngZone.runOutsideAngular(()=>errorHandler.handleError(e)),e}}(exceptionHandler,ngZone,()=>{const initStatus=moduleRef.injector.get(ApplicationInitStatus);return initStatus.runInitializers(),initStatus.donePromise.then(()=>(setLocaleId(moduleRef.injector.get(LOCALE_ID$1,\"en-US\")||\"en-US\"),this._moduleDoBootstrap(moduleRef),moduleRef))})})}bootstrapModule(moduleType,compilerOptions=[]){const options=optionsReducer({},compilerOptions);return compileNgModuleFactory(this.injector,options,moduleType).then(moduleFactory=>this.bootstrapModuleFactory(moduleFactory,options))}_moduleDoBootstrap(moduleRef){const appRef=moduleRef.injector.get(core_ApplicationRef);if(moduleRef._bootstrapComponents.length>0)moduleRef._bootstrapComponents.forEach(f=>appRef.bootstrap(f));else{if(!moduleRef.instance.ngDoBootstrap)throw new Error(`The module ${stringify(moduleRef.instance.constructor)} was bootstrapped, but it does not declare \"@NgModule.bootstrap\" components nor a \"ngDoBootstrap\" method. Please define one of these.`);moduleRef.instance.ngDoBootstrap(appRef)}this._modules.push(moduleRef)}onDestroy(callback){this._destroyListeners.push(callback)}get injector(){return this._injector}destroy(){if(this._destroyed)throw new Error(\"The platform has already been destroyed!\");this._modules.slice().forEach(module=>module.destroy()),this._destroyListeners.forEach(listener=>listener()),this._destroyed=!0}get destroyed(){return this._destroyed}}return PlatformRef.ɵfac=function(t){return new(t||PlatformRef)(ɵɵinject(Injector))},PlatformRef.ɵprov=ɵɵdefineInjectable({token:PlatformRef,factory:PlatformRef.ɵfac}),PlatformRef})();function optionsReducer(dst,objs){return Array.isArray(objs)?objs.reduce(optionsReducer,dst):Object.assign(Object.assign({},dst),objs)}let core_ApplicationRef=(()=>{class ApplicationRef{constructor(_zone,_console,_injector,_exceptionHandler,_componentFactoryResolver,_initStatus){this._zone=_zone,this._console=_console,this._injector=_injector,this._exceptionHandler=_exceptionHandler,this._componentFactoryResolver=_componentFactoryResolver,this._initStatus=_initStatus,this._bootstrapListeners=[],this._views=[],this._runningTick=!1,this._enforceNoNewChanges=!1,this._stable=!0,this.componentTypes=[],this.components=[],this._enforceNoNewChanges=isDevMode(),this._zone.onMicrotaskEmpty.subscribe({next:()=>{this._zone.run(()=>{this.tick()})}});const isCurrentlyStable=new Observable_Observable(observer=>{this._stable=this._zone.isStable&&!this._zone.hasPendingMacrotasks&&!this._zone.hasPendingMicrotasks,this._zone.runOutsideAngular(()=>{observer.next(this._stable),observer.complete()})}),isStable=new Observable_Observable(observer=>{let stableSub;this._zone.runOutsideAngular(()=>{stableSub=this._zone.onStable.subscribe(()=>{NgZone.assertNotInAngularZone(),scheduleMicroTask(()=>{this._stable||this._zone.hasPendingMacrotasks||this._zone.hasPendingMicrotasks||(this._stable=!0,observer.next(!0))})})});const unstableSub=this._zone.onUnstable.subscribe(()=>{NgZone.assertInAngularZone(),this._stable&&(this._stable=!1,this._zone.runOutsideAngular(()=>{observer.next(!1)}))});return()=>{stableSub.unsubscribe(),unstableSub.unsubscribe()}});this.isStable=merge(isCurrentlyStable,isStable.pipe(share()))}bootstrap(componentOrFactory,rootSelectorOrNode){if(!this._initStatus.done)throw new Error(\"Cannot bootstrap as there are still asynchronous initializers running. Bootstrap components in the `ngDoBootstrap` method of the root module.\");let componentFactory;componentFactory=componentOrFactory instanceof ComponentFactory?componentOrFactory:this._componentFactoryResolver.resolveComponentFactory(componentOrFactory),this.componentTypes.push(componentFactory.componentType);const ngModule=componentFactory.isBoundToModule?void 0:this._injector.get(NgModuleRef),compRef=componentFactory.create(Injector.NULL,[],rootSelectorOrNode||componentFactory.selector,ngModule);compRef.onDestroy(()=>{this._unloadComponent(compRef)});const testability=compRef.injector.get(Testability,null);return testability&&compRef.injector.get(TestabilityRegistry).registerApplication(compRef.location.nativeElement,testability),this._loadComponent(compRef),isDevMode()&&this._console.log(\"Angular is running in the development mode. Call enableProdMode() to enable the production mode.\"),compRef}tick(){if(this._runningTick)throw new Error(\"ApplicationRef.tick is called recursively\");try{this._runningTick=!0;for(let view of this._views)view.detectChanges();if(this._enforceNoNewChanges)for(let view of this._views)view.checkNoChanges()}catch(e){this._zone.runOutsideAngular(()=>this._exceptionHandler.handleError(e))}finally{this._runningTick=!1}}attachView(viewRef){const view=viewRef;this._views.push(view),view.attachToAppRef(this)}detachView(viewRef){const view=viewRef;remove(this._views,view),view.detachFromAppRef()}_loadComponent(componentRef){this.attachView(componentRef.hostView),this.tick(),this.components.push(componentRef),this._injector.get(APP_BOOTSTRAP_LISTENER,[]).concat(this._bootstrapListeners).forEach(listener=>listener(componentRef))}_unloadComponent(componentRef){this.detachView(componentRef.hostView),remove(this.components,componentRef)}ngOnDestroy(){this._views.slice().forEach(view=>view.destroy())}get viewCount(){return this._views.length}}return ApplicationRef.ɵfac=function(t){return new(t||ApplicationRef)(ɵɵinject(NgZone),ɵɵinject(Console),ɵɵinject(Injector),ɵɵinject(ErrorHandler),ɵɵinject(ComponentFactoryResolver),ɵɵinject(ApplicationInitStatus))},ApplicationRef.ɵprov=ɵɵdefineInjectable({token:ApplicationRef,factory:ApplicationRef.ɵfac}),ApplicationRef})();function remove(list,el){const index=list.indexOf(el);index>-1&&list.splice(index,1)}class NgModuleFactoryLoader{}class SystemJsNgModuleLoaderConfig{}const DEFAULT_CONFIG={factoryPathPrefix:\"\",factoryPathSuffix:\".ngfactory\"};let SystemJsNgModuleLoader=(()=>{class SystemJsNgModuleLoader{constructor(_compiler,config){this._compiler=_compiler,this._config=config||DEFAULT_CONFIG}load(path){return this.loadAndCompile(path)}loadAndCompile(path){let[module,exportName]=path.split(\"#\");return void 0===exportName&&(exportName=\"default\"),__webpack_require__(\"zn8P\")(module).then(module=>module[exportName]).then(type=>checkNotEmpty(type,module,exportName)).then(type=>this._compiler.compileModuleAsync(type))}loadFactory(path){let[module,exportName]=path.split(\"#\"),factoryClassSuffix=\"NgFactory\";return void 0===exportName&&(exportName=\"default\",factoryClassSuffix=\"\"),__webpack_require__(\"zn8P\")(this._config.factoryPathPrefix+module+this._config.factoryPathSuffix).then(module=>module[exportName+factoryClassSuffix]).then(factory=>checkNotEmpty(factory,module,exportName))}}return SystemJsNgModuleLoader.ɵfac=function(t){return new(t||SystemJsNgModuleLoader)(ɵɵinject(Compiler),ɵɵinject(SystemJsNgModuleLoaderConfig,8))},SystemJsNgModuleLoader.ɵprov=ɵɵdefineInjectable({token:SystemJsNgModuleLoader,factory:SystemJsNgModuleLoader.ɵfac}),SystemJsNgModuleLoader})();function checkNotEmpty(value,modulePath,exportName){if(!value)throw new Error(`Cannot find '${exportName}' in '${modulePath}'`);return value}const platformCore=createPlatformFactory(null,\"core\",[{provide:PLATFORM_ID,useValue:\"unknown\"},{provide:PlatformRef,deps:[Injector]},{provide:TestabilityRegistry,deps:[]},{provide:Console,deps:[]}]),APPLICATION_MODULE_PROVIDERS=[{provide:core_ApplicationRef,useClass:core_ApplicationRef,deps:[NgZone,Console,Injector,ErrorHandler,ComponentFactoryResolver,ApplicationInitStatus]},{provide:SCHEDULER,deps:[NgZone],useFactory:function(ngZone){let queue=[];return ngZone.onStable.subscribe(()=>{for(;queue.length;)queue.pop()()}),function(fn){queue.push(fn)}}},{provide:ApplicationInitStatus,useClass:ApplicationInitStatus,deps:[[new Optional,APP_INITIALIZER]]},{provide:Compiler,useClass:Compiler,deps:[]},APP_ID_RANDOM_PROVIDER,{provide:IterableDiffers,useFactory:function(){return defaultIterableDiffers},deps:[]},{provide:KeyValueDiffers,useFactory:function(){return defaultKeyValueDiffers},deps:[]},{provide:LOCALE_ID$1,useFactory:function(locale){return setLocaleId(locale=locale||\"undefined\"!=typeof $localize&&$localize.locale||\"en-US\"),locale},deps:[[new Inject(LOCALE_ID$1),new Optional,new SkipSelf]]},{provide:DEFAULT_CURRENCY_CODE,useValue:\"USD\"}];let ApplicationModule=(()=>{class ApplicationModule{constructor(appRef){}}return ApplicationModule.ɵmod=ɵɵdefineNgModule({type:ApplicationModule}),ApplicationModule.ɵinj=ɵɵdefineInjector({factory:function(t){return new(t||ApplicationModule)(ɵɵinject(core_ApplicationRef))},providers:APPLICATION_MODULE_PROVIDERS}),ApplicationModule})();const environment_firebase={apiKey:\"AIzaSyAdu7bO_MzslesalJrDdgYyK72STk8bwLE\",authDomain:\"parcial2-a8c56.firebaseapp.com\",databaseURL:\"https://parcial2-a8c56.firebaseio.com\",projectId:\"parcial2-a8c56\",storageBucket:\"parcial2-a8c56.appspot.com\",messagingSenderId:\"567308961882\",appId:\"1:567308961882:web:e5e7adf8f47ef3a0683063\",measurementId:\"G-5NSF5VY2E6\"};let _DOM=null;function getDOM(){return _DOM}const common_DOCUMENT=new InjectionToken(\"DocumentToken\");let common_PlatformLocation=(()=>{class PlatformLocation{}return PlatformLocation.ɵfac=function(t){return new(t||PlatformLocation)},PlatformLocation.ɵprov=ɵɵdefineInjectable({factory:useBrowserPlatformLocation,token:PlatformLocation,providedIn:\"platform\"}),PlatformLocation})();function useBrowserPlatformLocation(){return ɵɵinject(common_BrowserPlatformLocation)}const LOCATION_INITIALIZED=new InjectionToken(\"Location Initialized\");let common_BrowserPlatformLocation=(()=>{class BrowserPlatformLocation extends common_PlatformLocation{constructor(_doc){super(),this._doc=_doc,this._init()}_init(){this.location=getDOM().getLocation(),this._history=getDOM().getHistory()}getBaseHrefFromDOM(){return getDOM().getBaseHref(this._doc)}onPopState(fn){getDOM().getGlobalEventTarget(this._doc,\"window\").addEventListener(\"popstate\",fn,!1)}onHashChange(fn){getDOM().getGlobalEventTarget(this._doc,\"window\").addEventListener(\"hashchange\",fn,!1)}get href(){return this.location.href}get protocol(){return this.location.protocol}get hostname(){return this.location.hostname}get port(){return this.location.port}get pathname(){return this.location.pathname}get search(){return this.location.search}get hash(){return this.location.hash}set pathname(newPath){this.location.pathname=newPath}pushState(state,title,url){supportsState()?this._history.pushState(state,title,url):this.location.hash=url}replaceState(state,title,url){supportsState()?this._history.replaceState(state,title,url):this.location.hash=url}forward(){this._history.forward()}back(){this._history.back()}getState(){return this._history.state}}return BrowserPlatformLocation.ɵfac=function(t){return new(t||BrowserPlatformLocation)(ɵɵinject(common_DOCUMENT))},BrowserPlatformLocation.ɵprov=ɵɵdefineInjectable({factory:createBrowserPlatformLocation,token:BrowserPlatformLocation,providedIn:\"platform\"}),BrowserPlatformLocation})();function supportsState(){return!!window.history.pushState}function createBrowserPlatformLocation(){return new common_BrowserPlatformLocation(ɵɵinject(common_DOCUMENT))}function joinWithSlash(start,end){if(0==start.length)return end;if(0==end.length)return start;let slashes=0;return start.endsWith(\"/\")&&slashes++,end.startsWith(\"/\")&&slashes++,2==slashes?start+end.substring(1):1==slashes?start+end:start+\"/\"+end}function stripTrailingSlash(url){const match=url.match(/#|\\?|$/),pathEndIdx=match&&match.index||url.length;return url.slice(0,pathEndIdx-(\"/\"===url[pathEndIdx-1]?1:0))+url.slice(pathEndIdx)}function normalizeQueryParams(params){return params&&\"?\"!==params[0]?\"?\"+params:params}let common_LocationStrategy=(()=>{class LocationStrategy{}return LocationStrategy.ɵfac=function(t){return new(t||LocationStrategy)},LocationStrategy.ɵprov=ɵɵdefineInjectable({factory:provideLocationStrategy,token:LocationStrategy,providedIn:\"root\"}),LocationStrategy})();function provideLocationStrategy(platformLocation){const location=ɵɵinject(common_DOCUMENT).location;return new common_PathLocationStrategy(ɵɵinject(common_PlatformLocation),location&&location.origin||\"\")}const APP_BASE_HREF=new InjectionToken(\"appBaseHref\");let common_PathLocationStrategy=(()=>{class PathLocationStrategy extends common_LocationStrategy{constructor(_platformLocation,href){if(super(),this._platformLocation=_platformLocation,null==href&&(href=this._platformLocation.getBaseHrefFromDOM()),null==href)throw new Error(\"No base href set. Please provide a value for the APP_BASE_HREF token or add a base element to the document.\");this._baseHref=href}onPopState(fn){this._platformLocation.onPopState(fn),this._platformLocation.onHashChange(fn)}getBaseHref(){return this._baseHref}prepareExternalUrl(internal){return joinWithSlash(this._baseHref,internal)}path(includeHash=!1){const pathname=this._platformLocation.pathname+normalizeQueryParams(this._platformLocation.search),hash=this._platformLocation.hash;return hash&&includeHash?`${pathname}${hash}`:pathname}pushState(state,title,url,queryParams){const externalUrl=this.prepareExternalUrl(url+normalizeQueryParams(queryParams));this._platformLocation.pushState(state,title,externalUrl)}replaceState(state,title,url,queryParams){const externalUrl=this.prepareExternalUrl(url+normalizeQueryParams(queryParams));this._platformLocation.replaceState(state,title,externalUrl)}forward(){this._platformLocation.forward()}back(){this._platformLocation.back()}}return PathLocationStrategy.ɵfac=function(t){return new(t||PathLocationStrategy)(ɵɵinject(common_PlatformLocation),ɵɵinject(APP_BASE_HREF,8))},PathLocationStrategy.ɵprov=ɵɵdefineInjectable({token:PathLocationStrategy,factory:PathLocationStrategy.ɵfac}),PathLocationStrategy})(),common_HashLocationStrategy=(()=>{class HashLocationStrategy extends common_LocationStrategy{constructor(_platformLocation,_baseHref){super(),this._platformLocation=_platformLocation,this._baseHref=\"\",null!=_baseHref&&(this._baseHref=_baseHref)}onPopState(fn){this._platformLocation.onPopState(fn),this._platformLocation.onHashChange(fn)}getBaseHref(){return this._baseHref}path(includeHash=!1){let path=this._platformLocation.hash;return null==path&&(path=\"#\"),path.length>0?path.substring(1):path}prepareExternalUrl(internal){const url=joinWithSlash(this._baseHref,internal);return url.length>0?\"#\"+url:url}pushState(state,title,path,queryParams){let url=this.prepareExternalUrl(path+normalizeQueryParams(queryParams));0==url.length&&(url=this._platformLocation.pathname),this._platformLocation.pushState(state,title,url)}replaceState(state,title,path,queryParams){let url=this.prepareExternalUrl(path+normalizeQueryParams(queryParams));0==url.length&&(url=this._platformLocation.pathname),this._platformLocation.replaceState(state,title,url)}forward(){this._platformLocation.forward()}back(){this._platformLocation.back()}}return HashLocationStrategy.ɵfac=function(t){return new(t||HashLocationStrategy)(ɵɵinject(common_PlatformLocation),ɵɵinject(APP_BASE_HREF,8))},HashLocationStrategy.ɵprov=ɵɵdefineInjectable({token:HashLocationStrategy,factory:HashLocationStrategy.ɵfac}),HashLocationStrategy})(),common_Location=(()=>{class Location{constructor(platformStrategy,platformLocation){this._subject=new core_EventEmitter,this._urlChangeListeners=[],this._platformStrategy=platformStrategy;const browserBaseHref=this._platformStrategy.getBaseHref();this._platformLocation=platformLocation,this._baseHref=stripTrailingSlash(_stripIndexHtml(browserBaseHref)),this._platformStrategy.onPopState(ev=>{this._subject.emit({url:this.path(!0),pop:!0,state:ev.state,type:ev.type})})}path(includeHash=!1){return this.normalize(this._platformStrategy.path(includeHash))}getState(){return this._platformLocation.getState()}isCurrentPathEqualTo(path,query=\"\"){return this.path()==this.normalize(path+normalizeQueryParams(query))}normalize(url){return Location.stripTrailingSlash(function(baseHref,url){return baseHref&&url.startsWith(baseHref)?url.substring(baseHref.length):url}(this._baseHref,_stripIndexHtml(url)))}prepareExternalUrl(url){return url&&\"/\"!==url[0]&&(url=\"/\"+url),this._platformStrategy.prepareExternalUrl(url)}go(path,query=\"\",state=null){this._platformStrategy.pushState(state,\"\",path,query),this._notifyUrlChangeListeners(this.prepareExternalUrl(path+normalizeQueryParams(query)),state)}replaceState(path,query=\"\",state=null){this._platformStrategy.replaceState(state,\"\",path,query),this._notifyUrlChangeListeners(this.prepareExternalUrl(path+normalizeQueryParams(query)),state)}forward(){this._platformStrategy.forward()}back(){this._platformStrategy.back()}onUrlChange(fn){this._urlChangeListeners.push(fn),this.subscribe(v=>{this._notifyUrlChangeListeners(v.url,v.state)})}_notifyUrlChangeListeners(url=\"\",state){this._urlChangeListeners.forEach(fn=>fn(url,state))}subscribe(onNext,onThrow,onReturn){return this._subject.subscribe({next:onNext,error:onThrow,complete:onReturn})}}return Location.ɵfac=function(t){return new(t||Location)(ɵɵinject(common_LocationStrategy),ɵɵinject(common_PlatformLocation))},Location.normalizeQueryParams=normalizeQueryParams,Location.joinWithSlash=joinWithSlash,Location.stripTrailingSlash=stripTrailingSlash,Location.ɵprov=ɵɵdefineInjectable({factory:createLocation,token:Location,providedIn:\"root\"}),Location})();function createLocation(){return new common_Location(ɵɵinject(common_LocationStrategy),ɵɵinject(common_PlatformLocation))}function _stripIndexHtml(url){return url.replace(/\\/index.html$/,\"\")}const Plural=function(){var Plural={Zero:0,One:1,Two:2,Few:3,Many:4,Other:5};return Plural[Plural.Zero]=\"Zero\",Plural[Plural.One]=\"One\",Plural[Plural.Two]=\"Two\",Plural[Plural.Few]=\"Few\",Plural[Plural.Many]=\"Many\",Plural[Plural.Other]=\"Other\",Plural}();class NgLocalization{}let common_NgLocaleLocalization=(()=>{class NgLocaleLocalization extends NgLocalization{constructor(locale){super(),this.locale=locale}getPluralCategory(value,locale){switch(function(locale){return function(locale){const normalizedLocale=function(locale){return locale.toLowerCase().replace(/_/g,\"-\")}(locale);let match=getLocaleData(normalizedLocale);if(match)return match;const parentLocale=normalizedLocale.split(\"-\")[0];if(match=getLocaleData(parentLocale),match)return match;if(\"en\"===parentLocale)return localeEn;throw new Error(`Missing locale data for the locale \"${locale}\".`)}(locale)[LocaleDataIndex.PluralCase]}(locale||this.locale)(value)){case Plural.Zero:return\"zero\";case Plural.One:return\"one\";case Plural.Two:return\"two\";case Plural.Few:return\"few\";case Plural.Many:return\"many\";default:return\"other\"}}}return NgLocaleLocalization.ɵfac=function(t){return new(t||NgLocaleLocalization)(ɵɵinject(LOCALE_ID$1))},NgLocaleLocalization.ɵprov=ɵɵdefineInjectable({token:NgLocaleLocalization,factory:NgLocaleLocalization.ɵfac}),NgLocaleLocalization})();class NgForOfContext{constructor($implicit,ngForOf,index,count){this.$implicit=$implicit,this.ngForOf=ngForOf,this.index=index,this.count=count}get first(){return 0===this.index}get last(){return this.index===this.count-1}get even(){return this.index%2==0}get odd(){return!this.even}}let common_NgForOf=(()=>{class NgForOf{constructor(_viewContainer,_template,_differs){this._viewContainer=_viewContainer,this._template=_template,this._differs=_differs,this._ngForOf=null,this._ngForOfDirty=!0,this._differ=null}set ngForOf(ngForOf){this._ngForOf=ngForOf,this._ngForOfDirty=!0}set ngForTrackBy(fn){isDevMode()&&null!=fn&&\"function\"!=typeof fn&&console&&console.warn&&console.warn(`trackBy must be a function, but received ${JSON.stringify(fn)}. See https://angular.io/api/common/NgForOf#change-propagation for more information.`),this._trackByFn=fn}get ngForTrackBy(){return this._trackByFn}set ngForTemplate(value){value&&(this._template=value)}ngDoCheck(){if(this._ngForOfDirty){this._ngForOfDirty=!1;const value=this._ngForOf;if(!this._differ&&value)try{this._differ=this._differs.find(value).create(this.ngForTrackBy)}catch(_a){throw new Error(`Cannot find a differ supporting object '${value}' of type '${type=value,type.name||typeof type}'. NgFor only supports binding to Iterables such as Arrays.`)}}var type;if(this._differ){const changes=this._differ.diff(this._ngForOf);changes&&this._applyChanges(changes)}}_applyChanges(changes){const insertTuples=[];changes.forEachOperation((item,adjustedPreviousIndex,currentIndex)=>{if(null==item.previousIndex){const view=this._viewContainer.createEmbeddedView(this._template,new NgForOfContext(null,this._ngForOf,-1,-1),null===currentIndex?void 0:currentIndex),tuple=new RecordViewTuple(item,view);insertTuples.push(tuple)}else if(null==currentIndex)this._viewContainer.remove(null===adjustedPreviousIndex?void 0:adjustedPreviousIndex);else if(null!==adjustedPreviousIndex){const view=this._viewContainer.get(adjustedPreviousIndex);this._viewContainer.move(view,currentIndex);const tuple=new RecordViewTuple(item,view);insertTuples.push(tuple)}});for(let i=0;i<insertTuples.length;i++)this._perViewChange(insertTuples[i].view,insertTuples[i].record);for(let i=0,ilen=this._viewContainer.length;i<ilen;i++){const viewRef=this._viewContainer.get(i);viewRef.context.index=i,viewRef.context.count=ilen,viewRef.context.ngForOf=this._ngForOf}changes.forEachIdentityChange(record=>{this._viewContainer.get(record.currentIndex).context.$implicit=record.item})}_perViewChange(view,record){view.context.$implicit=record.item}static ngTemplateContextGuard(dir,ctx){return!0}}return NgForOf.ɵfac=function(t){return new(t||NgForOf)(ɵɵdirectiveInject(ViewContainerRef),ɵɵdirectiveInject(TemplateRef),ɵɵdirectiveInject(IterableDiffers))},NgForOf.ɵdir=ɵɵdefineDirective({type:NgForOf,selectors:[[\"\",\"ngFor\",\"\",\"ngForOf\",\"\"]],inputs:{ngForOf:\"ngForOf\",ngForTrackBy:\"ngForTrackBy\",ngForTemplate:\"ngForTemplate\"}}),NgForOf})();class RecordViewTuple{constructor(record,view){this.record=record,this.view=view}}let common_NgIf=(()=>{class NgIf{constructor(_viewContainer,templateRef){this._viewContainer=_viewContainer,this._context=new NgIfContext,this._thenTemplateRef=null,this._elseTemplateRef=null,this._thenViewRef=null,this._elseViewRef=null,this._thenTemplateRef=templateRef}set ngIf(condition){this._context.$implicit=this._context.ngIf=condition,this._updateView()}set ngIfThen(templateRef){assertTemplate(\"ngIfThen\",templateRef),this._thenTemplateRef=templateRef,this._thenViewRef=null,this._updateView()}set ngIfElse(templateRef){assertTemplate(\"ngIfElse\",templateRef),this._elseTemplateRef=templateRef,this._elseViewRef=null,this._updateView()}_updateView(){this._context.$implicit?this._thenViewRef||(this._viewContainer.clear(),this._elseViewRef=null,this._thenTemplateRef&&(this._thenViewRef=this._viewContainer.createEmbeddedView(this._thenTemplateRef,this._context))):this._elseViewRef||(this._viewContainer.clear(),this._thenViewRef=null,this._elseTemplateRef&&(this._elseViewRef=this._viewContainer.createEmbeddedView(this._elseTemplateRef,this._context)))}static ngTemplateContextGuard(dir,ctx){return!0}}return NgIf.ɵfac=function(t){return new(t||NgIf)(ɵɵdirectiveInject(ViewContainerRef),ɵɵdirectiveInject(TemplateRef))},NgIf.ɵdir=ɵɵdefineDirective({type:NgIf,selectors:[[\"\",\"ngIf\",\"\"]],inputs:{ngIf:\"ngIf\",ngIfThen:\"ngIfThen\",ngIfElse:\"ngIfElse\"}}),NgIf})();class NgIfContext{constructor(){this.$implicit=null,this.ngIf=null}}function assertTemplate(property,templateRef){if(templateRef&&!templateRef.createEmbeddedView)throw new Error(`${property} must be a TemplateRef, but received '${stringify(templateRef)}'.`)}let common_CommonModule=(()=>{class CommonModule{}return CommonModule.ɵmod=ɵɵdefineNgModule({type:CommonModule}),CommonModule.ɵinj=ɵɵdefineInjector({factory:function(t){return new(t||CommonModule)},providers:[{provide:NgLocalization,useClass:common_NgLocaleLocalization}]}),CommonModule})();function isPlatformServer(platformId){return\"server\"===platformId}let common_ViewportScroller=(()=>{class ViewportScroller{}return ViewportScroller.ɵprov=ɵɵdefineInjectable({token:ViewportScroller,providedIn:\"root\",factory:()=>new BrowserViewportScroller(ɵɵinject(common_DOCUMENT),window,ɵɵinject(ErrorHandler))}),ViewportScroller})();class BrowserViewportScroller{constructor(document,window,errorHandler){this.document=document,this.window=window,this.errorHandler=errorHandler,this.offset=()=>[0,0]}setOffset(offset){this.offset=Array.isArray(offset)?()=>offset:offset}getScrollPosition(){return this.supportScrollRestoration()?[this.window.scrollX,this.window.scrollY]:[0,0]}scrollToPosition(position){this.supportScrollRestoration()&&this.window.scrollTo(position[0],position[1])}scrollToAnchor(anchor){if(this.supportScrollRestoration()){anchor=this.window.CSS&&this.window.CSS.escape?this.window.CSS.escape(anchor):anchor.replace(/(\\\"|\\'\\ |:|\\.|\\[|\\]|,|=)/g,\"\\\\$1\");try{const elSelectedById=this.document.querySelector(\"#\"+anchor);if(elSelectedById)return void this.scrollToElement(elSelectedById);const elSelectedByName=this.document.querySelector(`[name='${anchor}']`);if(elSelectedByName)return void this.scrollToElement(elSelectedByName)}catch(e){this.errorHandler.handleError(e)}}}setHistoryScrollRestoration(scrollRestoration){if(this.supportScrollRestoration()){const history=this.window.history;history&&history.scrollRestoration&&(history.scrollRestoration=scrollRestoration)}}scrollToElement(el){const rect=el.getBoundingClientRect(),left=rect.left+this.window.pageXOffset,top=rect.top+this.window.pageYOffset,offset=this.offset();this.window.scrollTo(left-offset[0],top-offset[1])}supportScrollRestoration(){try{return!!this.window&&!!this.window.scrollTo}catch(_a){return!1}}}class platform_browser_BrowserDomAdapter extends class extends class{}{constructor(){super()}supportsDOMEvents(){return!0}}{static makeCurrent(){var adapter;adapter=new platform_browser_BrowserDomAdapter,_DOM||(_DOM=adapter)}getProperty(el,name){return el[name]}log(error){window.console&&window.console.log&&window.console.log(error)}logGroup(error){window.console&&window.console.group&&window.console.group(error)}logGroupEnd(){window.console&&window.console.groupEnd&&window.console.groupEnd()}onAndCancel(el,evt,listener){return el.addEventListener(evt,listener,!1),()=>{el.removeEventListener(evt,listener,!1)}}dispatchEvent(el,evt){el.dispatchEvent(evt)}remove(node){return node.parentNode&&node.parentNode.removeChild(node),node}getValue(el){return el.value}createElement(tagName,doc){return(doc=doc||this.getDefaultDocument()).createElement(tagName)}createHtmlDocument(){return document.implementation.createHTMLDocument(\"fakeTitle\")}getDefaultDocument(){return document}isElementNode(node){return node.nodeType===Node.ELEMENT_NODE}isShadowRoot(node){return node instanceof DocumentFragment}getGlobalEventTarget(doc,target){return\"window\"===target?window:\"document\"===target?doc:\"body\"===target?doc.body:null}getHistory(){return window.history}getLocation(){return window.location}getBaseHref(doc){const href=baseElement||(baseElement=document.querySelector(\"base\"),baseElement)?baseElement.getAttribute(\"href\"):null;return null==href?null:(url=href,urlParsingNode||(urlParsingNode=document.createElement(\"a\")),urlParsingNode.setAttribute(\"href\",url),\"/\"===urlParsingNode.pathname.charAt(0)?urlParsingNode.pathname:\"/\"+urlParsingNode.pathname);var url}resetBaseElement(){baseElement=null}getUserAgent(){return window.navigator.userAgent}performanceNow(){return window.performance&&window.performance.now?window.performance.now():(new Date).getTime()}supportsCookies(){return!0}getCookie(name){return function(cookieStr,name){name=encodeURIComponent(name);for(const cookie of cookieStr.split(\";\")){const eqIndex=cookie.indexOf(\"=\"),[cookieName,cookieValue]=-1==eqIndex?[cookie,\"\"]:[cookie.slice(0,eqIndex),cookie.slice(eqIndex+1)];if(cookieName.trim()===name)return decodeURIComponent(cookieValue)}return null}(document.cookie,name)}}let urlParsingNode,baseElement=null;const TRANSITION_ID=new InjectionToken(\"TRANSITION_ID\"),SERVER_TRANSITION_PROVIDERS=[{provide:APP_INITIALIZER,useFactory:function(transitionId,document,injector){return()=>{injector.get(ApplicationInitStatus).donePromise.then(()=>{const dom=getDOM();Array.prototype.slice.apply(document.querySelectorAll(\"style[ng-transition]\")).filter(el=>el.getAttribute(\"ng-transition\")===transitionId).forEach(el=>dom.remove(el))})}},deps:[TRANSITION_ID,common_DOCUMENT,Injector],multi:!0}];class platform_browser_BrowserGetTestability{static init(){var getter;getter=new platform_browser_BrowserGetTestability,_testabilityGetter=getter}addToWindow(registry){_global.getAngularTestability=(elem,findInAncestors=!0)=>{const testability=registry.findTestabilityInTree(elem,findInAncestors);if(null==testability)throw new Error(\"Could not find testability for element.\");return testability},_global.getAllAngularTestabilities=()=>registry.getAllTestabilities(),_global.getAllAngularRootElements=()=>registry.getAllRootElements(),_global.frameworkStabilizers||(_global.frameworkStabilizers=[]),_global.frameworkStabilizers.push(callback=>{const testabilities=_global.getAllAngularTestabilities();let count=testabilities.length,didWork=!1;const decrement=function(didWork_){didWork=didWork||didWork_,count--,0==count&&callback(didWork)};testabilities.forEach((function(testability){testability.whenStable(decrement)}))})}findTestabilityInTree(registry,elem,findInAncestors){if(null==elem)return null;const t=registry.getTestability(elem);return null!=t?t:findInAncestors?getDOM().isShadowRoot(elem)?this.findTestabilityInTree(registry,elem.host,!0):this.findTestabilityInTree(registry,elem.parentElement,!0):null}}const EVENT_MANAGER_PLUGINS=new InjectionToken(\"EventManagerPlugins\");let platform_browser_EventManager=(()=>{class EventManager{constructor(plugins,_zone){this._zone=_zone,this._eventNameToPlugin=new Map,plugins.forEach(p=>p.manager=this),this._plugins=plugins.slice().reverse()}addEventListener(element,eventName,handler){return this._findPluginFor(eventName).addEventListener(element,eventName,handler)}addGlobalEventListener(target,eventName,handler){return this._findPluginFor(eventName).addGlobalEventListener(target,eventName,handler)}getZone(){return this._zone}_findPluginFor(eventName){const plugin=this._eventNameToPlugin.get(eventName);if(plugin)return plugin;const plugins=this._plugins;for(let i=0;i<plugins.length;i++){const plugin=plugins[i];if(plugin.supports(eventName))return this._eventNameToPlugin.set(eventName,plugin),plugin}throw new Error(\"No event manager plugin found for event \"+eventName)}}return EventManager.ɵfac=function(t){return new(t||EventManager)(ɵɵinject(EVENT_MANAGER_PLUGINS),ɵɵinject(NgZone))},EventManager.ɵprov=ɵɵdefineInjectable({token:EventManager,factory:EventManager.ɵfac}),EventManager})();class platform_browser_EventManagerPlugin{constructor(_doc){this._doc=_doc}addGlobalEventListener(element,eventName,handler){const target=getDOM().getGlobalEventTarget(this._doc,element);if(!target)throw new Error(`Unsupported event target ${target} for event ${eventName}`);return this.addEventListener(target,eventName,handler)}}let platform_browser_SharedStylesHost=(()=>{class SharedStylesHost{constructor(){this._stylesSet=new Set}addStyles(styles){const additions=new Set;styles.forEach(style=>{this._stylesSet.has(style)||(this._stylesSet.add(style),additions.add(style))}),this.onStylesAdded(additions)}onStylesAdded(additions){}getAllStyles(){return Array.from(this._stylesSet)}}return SharedStylesHost.ɵfac=function(t){return new(t||SharedStylesHost)},SharedStylesHost.ɵprov=ɵɵdefineInjectable({token:SharedStylesHost,factory:SharedStylesHost.ɵfac}),SharedStylesHost})(),platform_browser_DomSharedStylesHost=(()=>{class DomSharedStylesHost extends platform_browser_SharedStylesHost{constructor(_doc){super(),this._doc=_doc,this._hostNodes=new Set,this._styleNodes=new Set,this._hostNodes.add(_doc.head)}_addStylesToHost(styles,host){styles.forEach(style=>{const styleEl=this._doc.createElement(\"style\");styleEl.textContent=style,this._styleNodes.add(host.appendChild(styleEl))})}addHost(hostNode){this._addStylesToHost(this._stylesSet,hostNode),this._hostNodes.add(hostNode)}removeHost(hostNode){this._hostNodes.delete(hostNode)}onStylesAdded(additions){this._hostNodes.forEach(hostNode=>this._addStylesToHost(additions,hostNode))}ngOnDestroy(){this._styleNodes.forEach(styleNode=>getDOM().remove(styleNode))}}return DomSharedStylesHost.ɵfac=function(t){return new(t||DomSharedStylesHost)(ɵɵinject(common_DOCUMENT))},DomSharedStylesHost.ɵprov=ɵɵdefineInjectable({token:DomSharedStylesHost,factory:DomSharedStylesHost.ɵfac}),DomSharedStylesHost})();const NAMESPACE_URIS={svg:\"http://www.w3.org/2000/svg\",xhtml:\"http://www.w3.org/1999/xhtml\",xlink:\"http://www.w3.org/1999/xlink\",xml:\"http://www.w3.org/XML/1998/namespace\",xmlns:\"http://www.w3.org/2000/xmlns/\"},COMPONENT_REGEX=/%COMP%/g;function flattenStyles(compId,styles,target){for(let i=0;i<styles.length;i++){let style=styles[i];Array.isArray(style)?flattenStyles(compId,style,target):(style=style.replace(COMPONENT_REGEX,compId),target.push(style))}return target}function decoratePreventDefault(eventHandler){return event=>{if(\"__ngUnwrap__\"===event)return eventHandler;!1===eventHandler(event)&&(event.preventDefault(),event.returnValue=!1)}}let platform_browser_DomRendererFactory2=(()=>{class DomRendererFactory2{constructor(eventManager,sharedStylesHost,appId){this.eventManager=eventManager,this.sharedStylesHost=sharedStylesHost,this.appId=appId,this.rendererByCompId=new Map,this.defaultRenderer=new platform_browser_DefaultDomRenderer2(eventManager)}createRenderer(element,type){if(!element||!type)return this.defaultRenderer;switch(type.encapsulation){case ViewEncapsulation$1.Emulated:{let renderer=this.rendererByCompId.get(type.id);return renderer||(renderer=new EmulatedEncapsulationDomRenderer2(this.eventManager,this.sharedStylesHost,type,this.appId),this.rendererByCompId.set(type.id,renderer)),renderer.applyToHost(element),renderer}case ViewEncapsulation$1.Native:case ViewEncapsulation$1.ShadowDom:return new platform_browser_ShadowDomRenderer(this.eventManager,this.sharedStylesHost,element,type);default:if(!this.rendererByCompId.has(type.id)){const styles=flattenStyles(type.id,type.styles,[]);this.sharedStylesHost.addStyles(styles),this.rendererByCompId.set(type.id,this.defaultRenderer)}return this.defaultRenderer}}begin(){}end(){}}return DomRendererFactory2.ɵfac=function(t){return new(t||DomRendererFactory2)(ɵɵinject(platform_browser_EventManager),ɵɵinject(platform_browser_DomSharedStylesHost),ɵɵinject(APP_ID))},DomRendererFactory2.ɵprov=ɵɵdefineInjectable({token:DomRendererFactory2,factory:DomRendererFactory2.ɵfac}),DomRendererFactory2})();class platform_browser_DefaultDomRenderer2{constructor(eventManager){this.eventManager=eventManager,this.data=Object.create(null)}destroy(){}createElement(name,namespace){return namespace?document.createElementNS(NAMESPACE_URIS[namespace]||namespace,name):document.createElement(name)}createComment(value){return document.createComment(value)}createText(value){return document.createTextNode(value)}appendChild(parent,newChild){parent.appendChild(newChild)}insertBefore(parent,newChild,refChild){parent&&parent.insertBefore(newChild,refChild)}removeChild(parent,oldChild){parent&&parent.removeChild(oldChild)}selectRootElement(selectorOrNode,preserveContent){let el=\"string\"==typeof selectorOrNode?document.querySelector(selectorOrNode):selectorOrNode;if(!el)throw new Error(`The selector \"${selectorOrNode}\" did not match any elements`);return preserveContent||(el.textContent=\"\"),el}parentNode(node){return node.parentNode}nextSibling(node){return node.nextSibling}setAttribute(el,name,value,namespace){if(namespace){name=namespace+\":\"+name;const namespaceUri=NAMESPACE_URIS[namespace];namespaceUri?el.setAttributeNS(namespaceUri,name,value):el.setAttribute(name,value)}else el.setAttribute(name,value)}removeAttribute(el,name,namespace){if(namespace){const namespaceUri=NAMESPACE_URIS[namespace];namespaceUri?el.removeAttributeNS(namespaceUri,name):el.removeAttribute(`${namespace}:${name}`)}else el.removeAttribute(name)}addClass(el,name){el.classList.add(name)}removeClass(el,name){el.classList.remove(name)}setStyle(el,style,value,flags){flags&RendererStyleFlags2.DashCase?el.style.setProperty(style,value,flags&RendererStyleFlags2.Important?\"important\":\"\"):el.style[style]=value}removeStyle(el,style,flags){flags&RendererStyleFlags2.DashCase?el.style.removeProperty(style):el.style[style]=\"\"}setProperty(el,name,value){el[name]=value}setValue(node,value){node.nodeValue=value}listen(target,event,callback){return\"string\"==typeof target?this.eventManager.addGlobalEventListener(target,event,decoratePreventDefault(callback)):this.eventManager.addEventListener(target,event,decoratePreventDefault(callback))}}class EmulatedEncapsulationDomRenderer2 extends platform_browser_DefaultDomRenderer2{constructor(eventManager,sharedStylesHost,component,appId){super(eventManager),this.component=component;const styles=flattenStyles(appId+\"-\"+component.id,component.styles,[]);sharedStylesHost.addStyles(styles),this.contentAttr=\"_ngcontent-%COMP%\".replace(COMPONENT_REGEX,appId+\"-\"+component.id),this.hostAttr=\"_nghost-%COMP%\".replace(COMPONENT_REGEX,appId+\"-\"+component.id)}applyToHost(element){super.setAttribute(element,this.hostAttr,\"\")}createElement(parent,name){const el=super.createElement(parent,name);return super.setAttribute(el,this.contentAttr,\"\"),el}}class platform_browser_ShadowDomRenderer extends platform_browser_DefaultDomRenderer2{constructor(eventManager,sharedStylesHost,hostEl,component){super(eventManager),this.sharedStylesHost=sharedStylesHost,this.hostEl=hostEl,this.component=component,this.shadowRoot=component.encapsulation===ViewEncapsulation$1.ShadowDom?hostEl.attachShadow({mode:\"open\"}):hostEl.createShadowRoot(),this.sharedStylesHost.addHost(this.shadowRoot);const styles=flattenStyles(component.id,component.styles,[]);for(let i=0;i<styles.length;i++){const styleEl=document.createElement(\"style\");styleEl.textContent=styles[i],this.shadowRoot.appendChild(styleEl)}}nodeOrShadowRoot(node){return node===this.hostEl?this.shadowRoot:node}destroy(){this.sharedStylesHost.removeHost(this.shadowRoot)}appendChild(parent,newChild){return super.appendChild(this.nodeOrShadowRoot(parent),newChild)}insertBefore(parent,newChild,refChild){return super.insertBefore(this.nodeOrShadowRoot(parent),newChild,refChild)}removeChild(parent,oldChild){return super.removeChild(this.nodeOrShadowRoot(parent),oldChild)}parentNode(node){return this.nodeOrShadowRoot(super.parentNode(this.nodeOrShadowRoot(node)))}}let platform_browser_DomEventsPlugin=(()=>{class DomEventsPlugin extends platform_browser_EventManagerPlugin{constructor(doc){super(doc)}supports(eventName){return!0}addEventListener(element,eventName,handler){return element.addEventListener(eventName,handler,!1),()=>this.removeEventListener(element,eventName,handler)}removeEventListener(target,eventName,callback){return target.removeEventListener(eventName,callback)}}return DomEventsPlugin.ɵfac=function(t){return new(t||DomEventsPlugin)(ɵɵinject(common_DOCUMENT))},DomEventsPlugin.ɵprov=ɵɵdefineInjectable({token:DomEventsPlugin,factory:DomEventsPlugin.ɵfac}),DomEventsPlugin})();const MODIFIER_KEYS=[\"alt\",\"control\",\"meta\",\"shift\"],_keyMap={\"\\b\":\"Backspace\",\"\\t\":\"Tab\",\"\":\"Delete\",\"\u001b\":\"Escape\",Del:\"Delete\",Esc:\"Escape\",Left:\"ArrowLeft\",Right:\"ArrowRight\",Up:\"ArrowUp\",Down:\"ArrowDown\",Menu:\"ContextMenu\",Scroll:\"ScrollLock\",Win:\"OS\"},_chromeNumKeyPadMap={A:\"1\",B:\"2\",C:\"3\",D:\"4\",E:\"5\",F:\"6\",G:\"7\",H:\"8\",I:\"9\",J:\"*\",K:\"+\",M:\"-\",N:\".\",O:\"/\",\"`\":\"0\",\"\":\"NumLock\"},MODIFIER_KEY_GETTERS={alt:event=>event.altKey,control:event=>event.ctrlKey,meta:event=>event.metaKey,shift:event=>event.shiftKey};let platform_browser_KeyEventsPlugin=(()=>{class KeyEventsPlugin extends platform_browser_EventManagerPlugin{constructor(doc){super(doc)}supports(eventName){return null!=KeyEventsPlugin.parseEventName(eventName)}addEventListener(element,eventName,handler){const parsedEvent=KeyEventsPlugin.parseEventName(eventName),outsideHandler=KeyEventsPlugin.eventCallback(parsedEvent.fullKey,handler,this.manager.getZone());return this.manager.getZone().runOutsideAngular(()=>getDOM().onAndCancel(element,parsedEvent.domEventName,outsideHandler))}static parseEventName(eventName){const parts=eventName.toLowerCase().split(\".\"),domEventName=parts.shift();if(0===parts.length||\"keydown\"!==domEventName&&\"keyup\"!==domEventName)return null;const key=KeyEventsPlugin._normalizeKey(parts.pop());let fullKey=\"\";if(MODIFIER_KEYS.forEach(modifierName=>{const index=parts.indexOf(modifierName);index>-1&&(parts.splice(index,1),fullKey+=modifierName+\".\")}),fullKey+=key,0!=parts.length||0===key.length)return null;const result={};return result.domEventName=domEventName,result.fullKey=fullKey,result}static getEventFullKey(event){let fullKey=\"\",key=function(event){let key=event.key;if(null==key){if(key=event.keyIdentifier,null==key)return\"Unidentified\";key.startsWith(\"U+\")&&(key=String.fromCharCode(parseInt(key.substring(2),16)),3===event.location&&_chromeNumKeyPadMap.hasOwnProperty(key)&&(key=_chromeNumKeyPadMap[key]))}return _keyMap[key]||key}(event);return key=key.toLowerCase(),\" \"===key?key=\"space\":\".\"===key&&(key=\"dot\"),MODIFIER_KEYS.forEach(modifierName=>{modifierName!=key&&(0,MODIFIER_KEY_GETTERS[modifierName])(event)&&(fullKey+=modifierName+\".\")}),fullKey+=key,fullKey}static eventCallback(fullKey,handler,zone){return event=>{KeyEventsPlugin.getEventFullKey(event)===fullKey&&zone.runGuarded(()=>handler(event))}}static _normalizeKey(keyName){switch(keyName){case\"esc\":return\"escape\";default:return keyName}}}return KeyEventsPlugin.ɵfac=function(t){return new(t||KeyEventsPlugin)(ɵɵinject(common_DOCUMENT))},KeyEventsPlugin.ɵprov=ɵɵdefineInjectable({token:KeyEventsPlugin,factory:KeyEventsPlugin.ɵfac}),KeyEventsPlugin})(),platform_browser_DomSanitizer=(()=>{class DomSanitizer{}return DomSanitizer.ɵfac=function(t){return new(t||DomSanitizer)},DomSanitizer.ɵprov=ɵɵdefineInjectable({factory:function(){return ɵɵinject(platform_browser_DomSanitizerImpl)},token:DomSanitizer,providedIn:\"root\"}),DomSanitizer})(),platform_browser_DomSanitizerImpl=(()=>{class DomSanitizerImpl extends platform_browser_DomSanitizer{constructor(_doc){super(),this._doc=_doc}sanitize(ctx,value){if(null==value)return null;switch(ctx){case SecurityContext.NONE:return value;case SecurityContext.HTML:return allowSanitizationBypassAndThrow(value,\"HTML\")?unwrapSafeValue(value):_sanitizeHtml(this._doc,String(value));case SecurityContext.STYLE:return allowSanitizationBypassAndThrow(value,\"Style\")?unwrapSafeValue(value):function(value){if(!(value=String(value).trim()))return\"\";const urlMatch=value.match(URL_RE);return urlMatch&&_sanitizeUrl(urlMatch[1])===urlMatch[1]||value.match(SAFE_STYLE_VALUE)&&function(value){let outsideSingle=!0,outsideDouble=!0;for(let i=0;i<value.length;i++){const c=value.charAt(i);\"'\"===c&&outsideDouble?outsideSingle=!outsideSingle:'\"'===c&&outsideSingle&&(outsideDouble=!outsideDouble)}return outsideSingle&&outsideDouble}(value)?value:(isDevMode()&&console.warn(`WARNING: sanitizing unsafe style value ${value} (see http://g.co/ng/security#xss).`),\"unsafe\")}(value);case SecurityContext.SCRIPT:if(allowSanitizationBypassAndThrow(value,\"Script\"))return unwrapSafeValue(value);throw new Error(\"unsafe value used in a script context\");case SecurityContext.URL:return getSanitizationBypassType(value),allowSanitizationBypassAndThrow(value,\"URL\")?unwrapSafeValue(value):_sanitizeUrl(String(value));case SecurityContext.RESOURCE_URL:if(allowSanitizationBypassAndThrow(value,\"ResourceURL\"))return unwrapSafeValue(value);throw new Error(\"unsafe value used in a resource URL context (see http://g.co/ng/security#xss)\");default:throw new Error(`Unexpected SecurityContext ${ctx} (see http://g.co/ng/security#xss)`)}}bypassSecurityTrustHtml(value){return new SafeHtmlImpl(value)}bypassSecurityTrustStyle(value){return new SafeStyleImpl(value)}bypassSecurityTrustScript(value){return new SafeScriptImpl(value)}bypassSecurityTrustUrl(value){return new SafeUrlImpl(value)}bypassSecurityTrustResourceUrl(value){return new SafeResourceUrlImpl(value)}}return DomSanitizerImpl.ɵfac=function(t){return new(t||DomSanitizerImpl)(ɵɵinject(common_DOCUMENT))},DomSanitizerImpl.ɵprov=ɵɵdefineInjectable({factory:function(){return injector=ɵɵinject(INJECTOR),new platform_browser_DomSanitizerImpl(injector.get(common_DOCUMENT));var injector},token:DomSanitizerImpl,providedIn:\"root\"}),DomSanitizerImpl})();const platformBrowser=createPlatformFactory(platformCore,\"browser\",[{provide:PLATFORM_ID,useValue:\"browser\"},{provide:PLATFORM_INITIALIZER,useValue:function(){platform_browser_BrowserDomAdapter.makeCurrent(),platform_browser_BrowserGetTestability.init()},multi:!0},{provide:common_DOCUMENT,useFactory:function(){return function(document){DOCUMENT=document}(document),document},deps:[]}]),BROWSER_MODULE_PROVIDERS=[[],{provide:INJECTOR_SCOPE,useValue:\"root\"},{provide:ErrorHandler,useFactory:function(){return new ErrorHandler},deps:[]},{provide:EVENT_MANAGER_PLUGINS,useClass:platform_browser_DomEventsPlugin,multi:!0,deps:[common_DOCUMENT,NgZone,PLATFORM_ID]},{provide:EVENT_MANAGER_PLUGINS,useClass:platform_browser_KeyEventsPlugin,multi:!0,deps:[common_DOCUMENT]},[],{provide:platform_browser_DomRendererFactory2,useClass:platform_browser_DomRendererFactory2,deps:[platform_browser_EventManager,platform_browser_DomSharedStylesHost,APP_ID]},{provide:RendererFactory2,useExisting:platform_browser_DomRendererFactory2},{provide:platform_browser_SharedStylesHost,useExisting:platform_browser_DomSharedStylesHost},{provide:platform_browser_DomSharedStylesHost,useClass:platform_browser_DomSharedStylesHost,deps:[common_DOCUMENT]},{provide:Testability,useClass:Testability,deps:[NgZone]},{provide:platform_browser_EventManager,useClass:platform_browser_EventManager,deps:[EVENT_MANAGER_PLUGINS,NgZone]},[]];let platform_browser_BrowserModule=(()=>{class BrowserModule{constructor(parentModule){if(parentModule)throw new Error(\"BrowserModule has already been loaded. If you need access to common directives such as NgIf and NgFor from a lazy loaded module, import CommonModule instead.\")}static withServerTransition(params){return{ngModule:BrowserModule,providers:[{provide:APP_ID,useValue:params.appId},{provide:TRANSITION_ID,useExisting:APP_ID},SERVER_TRANSITION_PROVIDERS]}}}return BrowserModule.ɵmod=ɵɵdefineNgModule({type:BrowserModule}),BrowserModule.ɵinj=ɵɵdefineInjector({factory:function(t){return new(t||BrowserModule)(ɵɵinject(BrowserModule,12))},providers:BROWSER_MODULE_PROVIDERS,imports:[common_CommonModule,ApplicationModule]}),BrowserModule})();function forkJoinInternal(sources,keys){return new Observable_Observable(subscriber=>{const len=sources.length;if(0===len)return void subscriber.complete();const values=new Array(len);let completed=0,emitted=0;for(let i=0;i<len;i++){const source=from(sources[i]);let hasValue=!1;subscriber.add(source.subscribe({next:value=>{hasValue||(hasValue=!0,emitted++),values[i]=value},error:err=>subscriber.error(err),complete:()=>{completed++,completed!==len&&hasValue||(emitted===len&&subscriber.next(keys?keys.reduce((result,key,i)=>(result[key]=values[i],result),{}):values),subscriber.complete())}}))}})}\"undefined\"!=typeof window&&window;const NG_VALUE_ACCESSOR=new InjectionToken(\"NgValueAccessor\"),CHECKBOX_VALUE_ACCESSOR={provide:NG_VALUE_ACCESSOR,useExisting:forwardRef(()=>forms_CheckboxControlValueAccessor),multi:!0};let forms_CheckboxControlValueAccessor=(()=>{class CheckboxControlValueAccessor{constructor(_renderer,_elementRef){this._renderer=_renderer,this._elementRef=_elementRef,this.onChange=_=>{},this.onTouched=()=>{}}writeValue(value){this._renderer.setProperty(this._elementRef.nativeElement,\"checked\",value)}registerOnChange(fn){this.onChange=fn}registerOnTouched(fn){this.onTouched=fn}setDisabledState(isDisabled){this._renderer.setProperty(this._elementRef.nativeElement,\"disabled\",isDisabled)}}return CheckboxControlValueAccessor.ɵfac=function(t){return new(t||CheckboxControlValueAccessor)(ɵɵdirectiveInject(Renderer2),ɵɵdirectiveInject(ElementRef))},CheckboxControlValueAccessor.ɵdir=ɵɵdefineDirective({type:CheckboxControlValueAccessor,selectors:[[\"input\",\"type\",\"checkbox\",\"formControlName\",\"\"],[\"input\",\"type\",\"checkbox\",\"formControl\",\"\"],[\"input\",\"type\",\"checkbox\",\"ngModel\",\"\"]],hostBindings:function(rf,ctx){1&rf&&ɵɵlistener(\"change\",(function($event){return ctx.onChange($event.target.checked)}))(\"blur\",(function(){return ctx.onTouched()}))},features:[ɵɵProvidersFeature([CHECKBOX_VALUE_ACCESSOR])]}),CheckboxControlValueAccessor})();const DEFAULT_VALUE_ACCESSOR={provide:NG_VALUE_ACCESSOR,useExisting:forwardRef(()=>forms_DefaultValueAccessor),multi:!0},COMPOSITION_BUFFER_MODE=new InjectionToken(\"CompositionEventMode\");let forms_DefaultValueAccessor=(()=>{class DefaultValueAccessor{constructor(_renderer,_elementRef,_compositionMode){this._renderer=_renderer,this._elementRef=_elementRef,this._compositionMode=_compositionMode,this.onChange=_=>{},this.onTouched=()=>{},this._composing=!1,null==this._compositionMode&&(this._compositionMode=!function(){const userAgent=getDOM()?getDOM().getUserAgent():\"\";return/android (\\d+)/.test(userAgent.toLowerCase())}())}writeValue(value){this._renderer.setProperty(this._elementRef.nativeElement,\"value\",null==value?\"\":value)}registerOnChange(fn){this.onChange=fn}registerOnTouched(fn){this.onTouched=fn}setDisabledState(isDisabled){this._renderer.setProperty(this._elementRef.nativeElement,\"disabled\",isDisabled)}_handleInput(value){(!this._compositionMode||this._compositionMode&&!this._composing)&&this.onChange(value)}_compositionStart(){this._composing=!0}_compositionEnd(value){this._composing=!1,this._compositionMode&&this.onChange(value)}}return DefaultValueAccessor.ɵfac=function(t){return new(t||DefaultValueAccessor)(ɵɵdirectiveInject(Renderer2),ɵɵdirectiveInject(ElementRef),ɵɵdirectiveInject(COMPOSITION_BUFFER_MODE,8))},DefaultValueAccessor.ɵdir=ɵɵdefineDirective({type:DefaultValueAccessor,selectors:[[\"input\",\"formControlName\",\"\",3,\"type\",\"checkbox\"],[\"textarea\",\"formControlName\",\"\"],[\"input\",\"formControl\",\"\",3,\"type\",\"checkbox\"],[\"textarea\",\"formControl\",\"\"],[\"input\",\"ngModel\",\"\",3,\"type\",\"checkbox\"],[\"textarea\",\"ngModel\",\"\"],[\"\",\"ngDefaultControl\",\"\"]],hostBindings:function(rf,ctx){1&rf&&ɵɵlistener(\"input\",(function($event){return ctx._handleInput($event.target.value)}))(\"blur\",(function(){return ctx.onTouched()}))(\"compositionstart\",(function(){return ctx._compositionStart()}))(\"compositionend\",(function($event){return ctx._compositionEnd($event.target.value)}))},features:[ɵɵProvidersFeature([DEFAULT_VALUE_ACCESSOR])]}),DefaultValueAccessor})(),forms_AbstractControlDirective=(()=>{class AbstractControlDirective{get value(){return this.control?this.control.value:null}get valid(){return this.control?this.control.valid:null}get invalid(){return this.control?this.control.invalid:null}get pending(){return this.control?this.control.pending:null}get disabled(){return this.control?this.control.disabled:null}get enabled(){return this.control?this.control.enabled:null}get errors(){return this.control?this.control.errors:null}get pristine(){return this.control?this.control.pristine:null}get dirty(){return this.control?this.control.dirty:null}get touched(){return this.control?this.control.touched:null}get status(){return this.control?this.control.status:null}get untouched(){return this.control?this.control.untouched:null}get statusChanges(){return this.control?this.control.statusChanges:null}get valueChanges(){return this.control?this.control.valueChanges:null}get path(){return null}reset(value){this.control&&this.control.reset(value)}hasError(errorCode,path){return!!this.control&&this.control.hasError(errorCode,path)}getError(errorCode,path){return this.control?this.control.getError(errorCode,path):null}}return AbstractControlDirective.ɵfac=function(t){return new(t||AbstractControlDirective)},AbstractControlDirective.ɵdir=ɵɵdefineDirective({type:AbstractControlDirective}),AbstractControlDirective})(),forms_ControlContainer=(()=>{class ControlContainer extends forms_AbstractControlDirective{get formDirective(){return null}get path(){return null}}return ControlContainer.ɵfac=function(t){return ɵControlContainer_BaseFactory(t||ControlContainer)},ControlContainer.ɵdir=ɵɵdefineDirective({type:ControlContainer,features:[ɵɵInheritDefinitionFeature]}),ControlContainer})();const ɵControlContainer_BaseFactory=ɵɵgetInheritedFactory(forms_ControlContainer);function unimplemented(){throw new Error(\"unimplemented\")}class NgControl extends forms_AbstractControlDirective{constructor(){super(...arguments),this._parent=null,this.name=null,this.valueAccessor=null,this._rawValidators=[],this._rawAsyncValidators=[]}get validator(){return unimplemented()}get asyncValidator(){return unimplemented()}}class AbstractControlStatus{constructor(cd){this._cd=cd}get ngClassUntouched(){return!!this._cd.control&&this._cd.control.untouched}get ngClassTouched(){return!!this._cd.control&&this._cd.control.touched}get ngClassPristine(){return!!this._cd.control&&this._cd.control.pristine}get ngClassDirty(){return!!this._cd.control&&this._cd.control.dirty}get ngClassValid(){return!!this._cd.control&&this._cd.control.valid}get ngClassInvalid(){return!!this._cd.control&&this._cd.control.invalid}get ngClassPending(){return!!this._cd.control&&this._cd.control.pending}}let forms_NgControlStatus=(()=>{class NgControlStatus extends AbstractControlStatus{constructor(cd){super(cd)}}return NgControlStatus.ɵfac=function(t){return new(t||NgControlStatus)(ɵɵdirectiveInject(NgControl,2))},NgControlStatus.ɵdir=ɵɵdefineDirective({type:NgControlStatus,selectors:[[\"\",\"formControlName\",\"\"],[\"\",\"ngModel\",\"\"],[\"\",\"formControl\",\"\"]],hostVars:14,hostBindings:function(rf,ctx){2&rf&&ɵɵclassProp(\"ng-untouched\",ctx.ngClassUntouched)(\"ng-touched\",ctx.ngClassTouched)(\"ng-pristine\",ctx.ngClassPristine)(\"ng-dirty\",ctx.ngClassDirty)(\"ng-valid\",ctx.ngClassValid)(\"ng-invalid\",ctx.ngClassInvalid)(\"ng-pending\",ctx.ngClassPending)},features:[ɵɵInheritDefinitionFeature]}),NgControlStatus})(),forms_NgControlStatusGroup=(()=>{class NgControlStatusGroup extends AbstractControlStatus{constructor(cd){super(cd)}}return NgControlStatusGroup.ɵfac=function(t){return new(t||NgControlStatusGroup)(ɵɵdirectiveInject(forms_ControlContainer,2))},NgControlStatusGroup.ɵdir=ɵɵdefineDirective({type:NgControlStatusGroup,selectors:[[\"\",\"formGroupName\",\"\"],[\"\",\"formArrayName\",\"\"],[\"\",\"ngModelGroup\",\"\"],[\"\",\"formGroup\",\"\"],[\"form\",3,\"ngNoForm\",\"\"],[\"\",\"ngForm\",\"\"]],hostVars:14,hostBindings:function(rf,ctx){2&rf&&ɵɵclassProp(\"ng-untouched\",ctx.ngClassUntouched)(\"ng-touched\",ctx.ngClassTouched)(\"ng-pristine\",ctx.ngClassPristine)(\"ng-dirty\",ctx.ngClassDirty)(\"ng-valid\",ctx.ngClassValid)(\"ng-invalid\",ctx.ngClassInvalid)(\"ng-pending\",ctx.ngClassPending)},features:[ɵɵInheritDefinitionFeature]}),NgControlStatusGroup})();function isEmptyInputValue(value){return null==value||0===value.length}const NG_VALIDATORS=new InjectionToken(\"NgValidators\"),NG_ASYNC_VALIDATORS=new InjectionToken(\"NgAsyncValidators\"),EMAIL_REGEXP=/^(?=.{1,254}$)(?=.{1,64}@)[a-zA-Z0-9!#$%&'*+/=?^_`{|}~-]+(?:\\.[a-zA-Z0-9!#$%&'*+/=?^_`{|}~-]+)*@[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?(?:\\.[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?)*$/;class forms_Validators{static min(min){return control=>{if(isEmptyInputValue(control.value)||isEmptyInputValue(min))return null;const value=parseFloat(control.value);return!isNaN(value)&&value<min?{min:{min:min,actual:control.value}}:null}}static max(max){return control=>{if(isEmptyInputValue(control.value)||isEmptyInputValue(max))return null;const value=parseFloat(control.value);return!isNaN(value)&&value>max?{max:{max:max,actual:control.value}}:null}}static required(control){return isEmptyInputValue(control.value)?{required:!0}:null}static requiredTrue(control){return!0===control.value?null:{required:!0}}static email(control){return isEmptyInputValue(control.value)||EMAIL_REGEXP.test(control.value)?null:{email:!0}}static minLength(minLength){return control=>{if(isEmptyInputValue(control.value))return null;const length=control.value?control.value.length:0;return length<minLength?{minlength:{requiredLength:minLength,actualLength:length}}:null}}static maxLength(maxLength){return control=>{const length=control.value?control.value.length:0;return length>maxLength?{maxlength:{requiredLength:maxLength,actualLength:length}}:null}}static pattern(pattern){if(!pattern)return forms_Validators.nullValidator;let regex,regexStr;return\"string\"==typeof pattern?(regexStr=\"\",\"^\"!==pattern.charAt(0)&&(regexStr+=\"^\"),regexStr+=pattern,\"$\"!==pattern.charAt(pattern.length-1)&&(regexStr+=\"$\"),regex=new RegExp(regexStr)):(regexStr=pattern.toString(),regex=pattern),control=>{if(isEmptyInputValue(control.value))return null;const value=control.value;return regex.test(value)?null:{pattern:{requiredPattern:regexStr,actualValue:value}}}}static nullValidator(control){return null}static compose(validators){if(!validators)return null;const presentValidators=validators.filter(isPresent);return 0==presentValidators.length?null:function(control){return _mergeErrors(function(control,validators){return validators.map(v=>v(control))}(control,presentValidators))}}static composeAsync(validators){if(!validators)return null;const presentValidators=validators.filter(isPresent);return 0==presentValidators.length?null:function(control){return function(...sources){if(1===sources.length){const first=sources[0];if(isArray(first))return forkJoinInternal(first,null);if(isObject(first)&&Object.getPrototypeOf(first)===Object.prototype){const keys=Object.keys(first);return forkJoinInternal(keys.map(key=>first[key]),keys)}}if(\"function\"==typeof sources[sources.length-1]){const resultSelector=sources.pop();return forkJoinInternal(sources=1===sources.length&&isArray(sources[0])?sources[0]:sources,null).pipe(map(args=>resultSelector(...args)))}return forkJoinInternal(sources,null)}(function(control,validators){return validators.map(v=>v(control))}(control,presentValidators).map(toObservable)).pipe(map(_mergeErrors))}}}function isPresent(o){return null!=o}function toObservable(r){const obs=core_isPromise(r)?from(r):r;if(!isObservable(obs))throw new Error(\"Expected validator to return Promise or Observable.\");return obs}function _mergeErrors(arrayOfErrors){let res={};return arrayOfErrors.forEach(errors=>{res=null!=errors?Object.assign(Object.assign({},res),errors):res}),0===Object.keys(res).length?null:res}function normalizeValidator(validator){return validator.validate?c=>validator.validate(c):validator}function normalizeAsyncValidator(validator){return validator.validate?c=>validator.validate(c):validator}const NUMBER_VALUE_ACCESSOR={provide:NG_VALUE_ACCESSOR,useExisting:forwardRef(()=>forms_NumberValueAccessor),multi:!0};let forms_NumberValueAccessor=(()=>{class NumberValueAccessor{constructor(_renderer,_elementRef){this._renderer=_renderer,this._elementRef=_elementRef,this.onChange=_=>{},this.onTouched=()=>{}}writeValue(value){this._renderer.setProperty(this._elementRef.nativeElement,\"value\",null==value?\"\":value)}registerOnChange(fn){this.onChange=value=>{fn(\"\"==value?null:parseFloat(value))}}registerOnTouched(fn){this.onTouched=fn}setDisabledState(isDisabled){this._renderer.setProperty(this._elementRef.nativeElement,\"disabled\",isDisabled)}}return NumberValueAccessor.ɵfac=function(t){return new(t||NumberValueAccessor)(ɵɵdirectiveInject(Renderer2),ɵɵdirectiveInject(ElementRef))},NumberValueAccessor.ɵdir=ɵɵdefineDirective({type:NumberValueAccessor,selectors:[[\"input\",\"type\",\"number\",\"formControlName\",\"\"],[\"input\",\"type\",\"number\",\"formControl\",\"\"],[\"input\",\"type\",\"number\",\"ngModel\",\"\"]],hostBindings:function(rf,ctx){1&rf&&ɵɵlistener(\"change\",(function($event){return ctx.onChange($event.target.value)}))(\"input\",(function($event){return ctx.onChange($event.target.value)}))(\"blur\",(function(){return ctx.onTouched()}))},features:[ɵɵProvidersFeature([NUMBER_VALUE_ACCESSOR])]}),NumberValueAccessor})();const RADIO_VALUE_ACCESSOR={provide:NG_VALUE_ACCESSOR,useExisting:forwardRef(()=>forms_RadioControlValueAccessor),multi:!0};let forms_RadioControlRegistry=(()=>{class RadioControlRegistry{constructor(){this._accessors=[]}add(control,accessor){this._accessors.push([control,accessor])}remove(accessor){for(let i=this._accessors.length-1;i>=0;--i)if(this._accessors[i][1]===accessor)return void this._accessors.splice(i,1)}select(accessor){this._accessors.forEach(c=>{this._isSameGroup(c,accessor)&&c[1]!==accessor&&c[1].fireUncheck(accessor.value)})}_isSameGroup(controlPair,accessor){return!!controlPair[0].control&&controlPair[0]._parent===accessor._control._parent&&controlPair[1].name===accessor.name}}return RadioControlRegistry.ɵfac=function(t){return new(t||RadioControlRegistry)},RadioControlRegistry.ɵprov=ɵɵdefineInjectable({token:RadioControlRegistry,factory:RadioControlRegistry.ɵfac}),RadioControlRegistry})(),forms_RadioControlValueAccessor=(()=>{class RadioControlValueAccessor{constructor(_renderer,_elementRef,_registry,_injector){this._renderer=_renderer,this._elementRef=_elementRef,this._registry=_registry,this._injector=_injector,this.onChange=()=>{},this.onTouched=()=>{}}ngOnInit(){this._control=this._injector.get(NgControl),this._checkName(),this._registry.add(this._control,this)}ngOnDestroy(){this._registry.remove(this)}writeValue(value){this._state=value===this.value,this._renderer.setProperty(this._elementRef.nativeElement,\"checked\",this._state)}registerOnChange(fn){this._fn=fn,this.onChange=()=>{fn(this.value),this._registry.select(this)}}fireUncheck(value){this.writeValue(value)}registerOnTouched(fn){this.onTouched=fn}setDisabledState(isDisabled){this._renderer.setProperty(this._elementRef.nativeElement,\"disabled\",isDisabled)}_checkName(){this.name&&this.formControlName&&this.name!==this.formControlName&&this._throwNameError(),!this.name&&this.formControlName&&(this.name=this.formControlName)}_throwNameError(){throw new Error('\\n      If you define both a name and a formControlName attribute on your radio button, their values\\n      must match. Ex: <input type=\"radio\" formControlName=\"food\" name=\"food\">\\n    ')}}return RadioControlValueAccessor.ɵfac=function(t){return new(t||RadioControlValueAccessor)(ɵɵdirectiveInject(Renderer2),ɵɵdirectiveInject(ElementRef),ɵɵdirectiveInject(forms_RadioControlRegistry),ɵɵdirectiveInject(Injector))},RadioControlValueAccessor.ɵdir=ɵɵdefineDirective({type:RadioControlValueAccessor,selectors:[[\"input\",\"type\",\"radio\",\"formControlName\",\"\"],[\"input\",\"type\",\"radio\",\"formControl\",\"\"],[\"input\",\"type\",\"radio\",\"ngModel\",\"\"]],hostBindings:function(rf,ctx){1&rf&&ɵɵlistener(\"change\",(function(){return ctx.onChange()}))(\"blur\",(function(){return ctx.onTouched()}))},inputs:{name:\"name\",formControlName:\"formControlName\",value:\"value\"},features:[ɵɵProvidersFeature([RADIO_VALUE_ACCESSOR])]}),RadioControlValueAccessor})();const RANGE_VALUE_ACCESSOR={provide:NG_VALUE_ACCESSOR,useExisting:forwardRef(()=>forms_RangeValueAccessor),multi:!0};let forms_RangeValueAccessor=(()=>{class RangeValueAccessor{constructor(_renderer,_elementRef){this._renderer=_renderer,this._elementRef=_elementRef,this.onChange=_=>{},this.onTouched=()=>{}}writeValue(value){this._renderer.setProperty(this._elementRef.nativeElement,\"value\",parseFloat(value))}registerOnChange(fn){this.onChange=value=>{fn(\"\"==value?null:parseFloat(value))}}registerOnTouched(fn){this.onTouched=fn}setDisabledState(isDisabled){this._renderer.setProperty(this._elementRef.nativeElement,\"disabled\",isDisabled)}}return RangeValueAccessor.ɵfac=function(t){return new(t||RangeValueAccessor)(ɵɵdirectiveInject(Renderer2),ɵɵdirectiveInject(ElementRef))},RangeValueAccessor.ɵdir=ɵɵdefineDirective({type:RangeValueAccessor,selectors:[[\"input\",\"type\",\"range\",\"formControlName\",\"\"],[\"input\",\"type\",\"range\",\"formControl\",\"\"],[\"input\",\"type\",\"range\",\"ngModel\",\"\"]],hostBindings:function(rf,ctx){1&rf&&ɵɵlistener(\"change\",(function($event){return ctx.onChange($event.target.value)}))(\"input\",(function($event){return ctx.onChange($event.target.value)}))(\"blur\",(function(){return ctx.onTouched()}))},features:[ɵɵProvidersFeature([RANGE_VALUE_ACCESSOR])]}),RangeValueAccessor})();const FormErrorExamples_formGroupName='\\n    <div [formGroup]=\"myGroup\">\\n       <div formGroupName=\"person\">\\n          <input formControlName=\"firstName\">\\n       </div>\\n    </div>\\n\\n    In your class:\\n\\n    this.myGroup = new FormGroup({\\n       person: new FormGroup({ firstName: new FormControl() })\\n    });',FormErrorExamples_ngModelGroup='\\n    <form>\\n       <div ngModelGroup=\"person\">\\n          <input [(ngModel)]=\"person.name\" name=\"firstName\">\\n       </div>\\n    </form>',SELECT_VALUE_ACCESSOR={provide:NG_VALUE_ACCESSOR,useExisting:forwardRef(()=>forms_SelectControlValueAccessor),multi:!0};let forms_SelectControlValueAccessor=(()=>{class SelectControlValueAccessor{constructor(_renderer,_elementRef){this._renderer=_renderer,this._elementRef=_elementRef,this._optionMap=new Map,this._idCounter=0,this.onChange=_=>{},this.onTouched=()=>{},this._compareWith=looseIdentical}set compareWith(fn){if(\"function\"!=typeof fn)throw new Error(\"compareWith must be a function, but received \"+JSON.stringify(fn));this._compareWith=fn}writeValue(value){this.value=value;const id=this._getOptionId(value);null==id&&this._renderer.setProperty(this._elementRef.nativeElement,\"selectedIndex\",-1);const valueString=function(id,value){return null==id?\"\"+value:(value&&\"object\"==typeof value&&(value=\"Object\"),`${id}: ${value}`.slice(0,50))}(id,value);this._renderer.setProperty(this._elementRef.nativeElement,\"value\",valueString)}registerOnChange(fn){this.onChange=valueString=>{this.value=this._getOptionValue(valueString),fn(this.value)}}registerOnTouched(fn){this.onTouched=fn}setDisabledState(isDisabled){this._renderer.setProperty(this._elementRef.nativeElement,\"disabled\",isDisabled)}_registerOption(){return(this._idCounter++).toString()}_getOptionId(value){for(const id of Array.from(this._optionMap.keys()))if(this._compareWith(this._optionMap.get(id),value))return id;return null}_getOptionValue(valueString){const id=function(valueString){return valueString.split(\":\")[0]}(valueString);return this._optionMap.has(id)?this._optionMap.get(id):valueString}}return SelectControlValueAccessor.ɵfac=function(t){return new(t||SelectControlValueAccessor)(ɵɵdirectiveInject(Renderer2),ɵɵdirectiveInject(ElementRef))},SelectControlValueAccessor.ɵdir=ɵɵdefineDirective({type:SelectControlValueAccessor,selectors:[[\"select\",\"formControlName\",\"\",3,\"multiple\",\"\"],[\"select\",\"formControl\",\"\",3,\"multiple\",\"\"],[\"select\",\"ngModel\",\"\",3,\"multiple\",\"\"]],hostBindings:function(rf,ctx){1&rf&&ɵɵlistener(\"change\",(function($event){return ctx.onChange($event.target.value)}))(\"blur\",(function(){return ctx.onTouched()}))},inputs:{compareWith:\"compareWith\"},features:[ɵɵProvidersFeature([SELECT_VALUE_ACCESSOR])]}),SelectControlValueAccessor})();const SELECT_MULTIPLE_VALUE_ACCESSOR={provide:NG_VALUE_ACCESSOR,useExisting:forwardRef(()=>forms_SelectMultipleControlValueAccessor),multi:!0};let forms_SelectMultipleControlValueAccessor=(()=>{class SelectMultipleControlValueAccessor{constructor(_renderer,_elementRef){this._renderer=_renderer,this._elementRef=_elementRef,this._optionMap=new Map,this._idCounter=0,this.onChange=_=>{},this.onTouched=()=>{},this._compareWith=looseIdentical}set compareWith(fn){if(\"function\"!=typeof fn)throw new Error(\"compareWith must be a function, but received \"+JSON.stringify(fn));this._compareWith=fn}writeValue(value){let optionSelectedStateSetter;if(this.value=value,Array.isArray(value)){const ids=value.map(v=>this._getOptionId(v));optionSelectedStateSetter=(opt,o)=>{opt._setSelected(ids.indexOf(o.toString())>-1)}}else optionSelectedStateSetter=(opt,o)=>{opt._setSelected(!1)};this._optionMap.forEach(optionSelectedStateSetter)}registerOnChange(fn){this.onChange=_=>{const selected=[];if(_.hasOwnProperty(\"selectedOptions\")){const options=_.selectedOptions;for(let i=0;i<options.length;i++){const opt=options.item(i),val=this._getOptionValue(opt.value);selected.push(val)}}else{const options=_.options;for(let i=0;i<options.length;i++){const opt=options.item(i);if(opt.selected){const val=this._getOptionValue(opt.value);selected.push(val)}}}this.value=selected,fn(selected)}}registerOnTouched(fn){this.onTouched=fn}setDisabledState(isDisabled){this._renderer.setProperty(this._elementRef.nativeElement,\"disabled\",isDisabled)}_registerOption(value){const id=(this._idCounter++).toString();return this._optionMap.set(id,value),id}_getOptionId(value){for(const id of Array.from(this._optionMap.keys()))if(this._compareWith(this._optionMap.get(id)._value,value))return id;return null}_getOptionValue(valueString){const id=function(valueString){return valueString.split(\":\")[0]}(valueString);return this._optionMap.has(id)?this._optionMap.get(id)._value:valueString}}return SelectMultipleControlValueAccessor.ɵfac=function(t){return new(t||SelectMultipleControlValueAccessor)(ɵɵdirectiveInject(Renderer2),ɵɵdirectiveInject(ElementRef))},SelectMultipleControlValueAccessor.ɵdir=ɵɵdefineDirective({type:SelectMultipleControlValueAccessor,selectors:[[\"select\",\"multiple\",\"\",\"formControlName\",\"\"],[\"select\",\"multiple\",\"\",\"formControl\",\"\"],[\"select\",\"multiple\",\"\",\"ngModel\",\"\"]],hostBindings:function(rf,ctx){1&rf&&ɵɵlistener(\"change\",(function($event){return ctx.onChange($event.target)}))(\"blur\",(function(){return ctx.onTouched()}))},inputs:{compareWith:\"compareWith\"},features:[ɵɵProvidersFeature([SELECT_MULTIPLE_VALUE_ACCESSOR])]}),SelectMultipleControlValueAccessor})();function controlPath(name,parent){return[...parent.path,name]}function setUpControl(control,dir){control||forms_throwError(dir,\"Cannot find control with\"),dir.valueAccessor||forms_throwError(dir,\"No value accessor for form control with\"),control.validator=forms_Validators.compose([control.validator,dir.validator]),control.asyncValidator=forms_Validators.composeAsync([control.asyncValidator,dir.asyncValidator]),dir.valueAccessor.writeValue(control.value),function(control,dir){dir.valueAccessor.registerOnChange(newValue=>{control._pendingValue=newValue,control._pendingChange=!0,control._pendingDirty=!0,\"change\"===control.updateOn&&updateControl(control,dir)})}(control,dir),function(control,dir){control.registerOnChange((newValue,emitModelEvent)=>{dir.valueAccessor.writeValue(newValue),emitModelEvent&&dir.viewToModelUpdate(newValue)})}(control,dir),function(control,dir){dir.valueAccessor.registerOnTouched(()=>{control._pendingTouched=!0,\"blur\"===control.updateOn&&control._pendingChange&&updateControl(control,dir),\"submit\"!==control.updateOn&&control.markAsTouched()})}(control,dir),dir.valueAccessor.setDisabledState&&control.registerOnDisabledChange(isDisabled=>{dir.valueAccessor.setDisabledState(isDisabled)}),dir._rawValidators.forEach(validator=>{validator.registerOnValidatorChange&&validator.registerOnValidatorChange(()=>control.updateValueAndValidity())}),dir._rawAsyncValidators.forEach(validator=>{validator.registerOnValidatorChange&&validator.registerOnValidatorChange(()=>control.updateValueAndValidity())})}function updateControl(control,dir){control._pendingDirty&&control.markAsDirty(),control.setValue(control._pendingValue,{emitModelToViewChange:!1}),dir.viewToModelUpdate(control._pendingValue),control._pendingChange=!1}function forms_throwError(dir,message){let messageEnd;throw messageEnd=dir.path.length>1?`path: '${dir.path.join(\" -> \")}'`:dir.path[0]?`name: '${dir.path}'`:\"unspecified name attribute\",new Error(`${message} ${messageEnd}`)}function composeValidators(validators){return null!=validators?forms_Validators.compose(validators.map(normalizeValidator)):null}function composeAsyncValidators(validators){return null!=validators?forms_Validators.composeAsync(validators.map(normalizeAsyncValidator)):null}const BUILTIN_ACCESSORS=[forms_CheckboxControlValueAccessor,forms_RangeValueAccessor,forms_NumberValueAccessor,forms_SelectControlValueAccessor,forms_SelectMultipleControlValueAccessor,forms_RadioControlValueAccessor];function coerceToValidator(validatorOrOpts){const validator=isOptionsObj(validatorOrOpts)?validatorOrOpts.validators:validatorOrOpts;return Array.isArray(validator)?composeValidators(validator):validator||null}function coerceToAsyncValidator(asyncValidator,validatorOrOpts){const origAsyncValidator=isOptionsObj(validatorOrOpts)?validatorOrOpts.asyncValidators:asyncValidator;return Array.isArray(origAsyncValidator)?composeAsyncValidators(origAsyncValidator):origAsyncValidator||null}function isOptionsObj(validatorOrOpts){return null!=validatorOrOpts&&!Array.isArray(validatorOrOpts)&&\"object\"==typeof validatorOrOpts}class forms_AbstractControl{constructor(validator,asyncValidator){this.validator=validator,this.asyncValidator=asyncValidator,this._onCollectionChange=()=>{},this.pristine=!0,this.touched=!1,this._onDisabledChange=[]}get parent(){return this._parent}get valid(){return\"VALID\"===this.status}get invalid(){return\"INVALID\"===this.status}get pending(){return\"PENDING\"==this.status}get disabled(){return\"DISABLED\"===this.status}get enabled(){return\"DISABLED\"!==this.status}get dirty(){return!this.pristine}get untouched(){return!this.touched}get updateOn(){return this._updateOn?this._updateOn:this.parent?this.parent.updateOn:\"change\"}setValidators(newValidator){this.validator=coerceToValidator(newValidator)}setAsyncValidators(newValidator){this.asyncValidator=coerceToAsyncValidator(newValidator)}clearValidators(){this.validator=null}clearAsyncValidators(){this.asyncValidator=null}markAsTouched(opts={}){this.touched=!0,this._parent&&!opts.onlySelf&&this._parent.markAsTouched(opts)}markAllAsTouched(){this.markAsTouched({onlySelf:!0}),this._forEachChild(control=>control.markAllAsTouched())}markAsUntouched(opts={}){this.touched=!1,this._pendingTouched=!1,this._forEachChild(control=>{control.markAsUntouched({onlySelf:!0})}),this._parent&&!opts.onlySelf&&this._parent._updateTouched(opts)}markAsDirty(opts={}){this.pristine=!1,this._parent&&!opts.onlySelf&&this._parent.markAsDirty(opts)}markAsPristine(opts={}){this.pristine=!0,this._pendingDirty=!1,this._forEachChild(control=>{control.markAsPristine({onlySelf:!0})}),this._parent&&!opts.onlySelf&&this._parent._updatePristine(opts)}markAsPending(opts={}){this.status=\"PENDING\",!1!==opts.emitEvent&&this.statusChanges.emit(this.status),this._parent&&!opts.onlySelf&&this._parent.markAsPending(opts)}disable(opts={}){const skipPristineCheck=this._parentMarkedDirty(opts.onlySelf);this.status=\"DISABLED\",this.errors=null,this._forEachChild(control=>{control.disable(Object.assign(Object.assign({},opts),{onlySelf:!0}))}),this._updateValue(),!1!==opts.emitEvent&&(this.valueChanges.emit(this.value),this.statusChanges.emit(this.status)),this._updateAncestors(Object.assign(Object.assign({},opts),{skipPristineCheck:skipPristineCheck})),this._onDisabledChange.forEach(changeFn=>changeFn(!0))}enable(opts={}){const skipPristineCheck=this._parentMarkedDirty(opts.onlySelf);this.status=\"VALID\",this._forEachChild(control=>{control.enable(Object.assign(Object.assign({},opts),{onlySelf:!0}))}),this.updateValueAndValidity({onlySelf:!0,emitEvent:opts.emitEvent}),this._updateAncestors(Object.assign(Object.assign({},opts),{skipPristineCheck:skipPristineCheck})),this._onDisabledChange.forEach(changeFn=>changeFn(!1))}_updateAncestors(opts){this._parent&&!opts.onlySelf&&(this._parent.updateValueAndValidity(opts),opts.skipPristineCheck||this._parent._updatePristine(),this._parent._updateTouched())}setParent(parent){this._parent=parent}updateValueAndValidity(opts={}){this._setInitialStatus(),this._updateValue(),this.enabled&&(this._cancelExistingSubscription(),this.errors=this._runValidator(),this.status=this._calculateStatus(),\"VALID\"!==this.status&&\"PENDING\"!==this.status||this._runAsyncValidator(opts.emitEvent)),!1!==opts.emitEvent&&(this.valueChanges.emit(this.value),this.statusChanges.emit(this.status)),this._parent&&!opts.onlySelf&&this._parent.updateValueAndValidity(opts)}_updateTreeValidity(opts={emitEvent:!0}){this._forEachChild(ctrl=>ctrl._updateTreeValidity(opts)),this.updateValueAndValidity({onlySelf:!0,emitEvent:opts.emitEvent})}_setInitialStatus(){this.status=this._allControlsDisabled()?\"DISABLED\":\"VALID\"}_runValidator(){return this.validator?this.validator(this):null}_runAsyncValidator(emitEvent){if(this.asyncValidator){this.status=\"PENDING\";const obs=toObservable(this.asyncValidator(this));this._asyncValidationSubscription=obs.subscribe(errors=>this.setErrors(errors,{emitEvent:emitEvent}))}}_cancelExistingSubscription(){this._asyncValidationSubscription&&this._asyncValidationSubscription.unsubscribe()}setErrors(errors,opts={}){this.errors=errors,this._updateControlsErrors(!1!==opts.emitEvent)}get(path){return function(control,path,delimiter){if(null==path)return null;if(Array.isArray(path)||(path=path.split(\".\")),Array.isArray(path)&&0===path.length)return null;let controlToFind=control;return path.forEach(name=>{controlToFind=controlToFind instanceof FormGroup?controlToFind.controls.hasOwnProperty(name)?controlToFind.controls[name]:null:controlToFind instanceof FormArray&&controlToFind.at(name)||null}),controlToFind}(this,path)}getError(errorCode,path){const control=path?this.get(path):this;return control&&control.errors?control.errors[errorCode]:null}hasError(errorCode,path){return!!this.getError(errorCode,path)}get root(){let x=this;for(;x._parent;)x=x._parent;return x}_updateControlsErrors(emitEvent){this.status=this._calculateStatus(),emitEvent&&this.statusChanges.emit(this.status),this._parent&&this._parent._updateControlsErrors(emitEvent)}_initObservables(){this.valueChanges=new core_EventEmitter,this.statusChanges=new core_EventEmitter}_calculateStatus(){return this._allControlsDisabled()?\"DISABLED\":this.errors?\"INVALID\":this._anyControlsHaveStatus(\"PENDING\")?\"PENDING\":this._anyControlsHaveStatus(\"INVALID\")?\"INVALID\":\"VALID\"}_anyControlsHaveStatus(status){return this._anyControls(control=>control.status===status)}_anyControlsDirty(){return this._anyControls(control=>control.dirty)}_anyControlsTouched(){return this._anyControls(control=>control.touched)}_updatePristine(opts={}){this.pristine=!this._anyControlsDirty(),this._parent&&!opts.onlySelf&&this._parent._updatePristine(opts)}_updateTouched(opts={}){this.touched=this._anyControlsTouched(),this._parent&&!opts.onlySelf&&this._parent._updateTouched(opts)}_isBoxedValue(formState){return\"object\"==typeof formState&&null!==formState&&2===Object.keys(formState).length&&\"value\"in formState&&\"disabled\"in formState}_registerOnCollectionChange(fn){this._onCollectionChange=fn}_setUpdateStrategy(opts){isOptionsObj(opts)&&null!=opts.updateOn&&(this._updateOn=opts.updateOn)}_parentMarkedDirty(onlySelf){return!onlySelf&&this._parent&&this._parent.dirty&&!this._parent._anyControlsDirty()}}class FormControl extends forms_AbstractControl{constructor(formState=null,validatorOrOpts,asyncValidator){super(coerceToValidator(validatorOrOpts),coerceToAsyncValidator(asyncValidator,validatorOrOpts)),this._onChange=[],this._applyFormState(formState),this._setUpdateStrategy(validatorOrOpts),this.updateValueAndValidity({onlySelf:!0,emitEvent:!1}),this._initObservables()}setValue(value,options={}){this.value=this._pendingValue=value,this._onChange.length&&!1!==options.emitModelToViewChange&&this._onChange.forEach(changeFn=>changeFn(this.value,!1!==options.emitViewToModelChange)),this.updateValueAndValidity(options)}patchValue(value,options={}){this.setValue(value,options)}reset(formState=null,options={}){this._applyFormState(formState),this.markAsPristine(options),this.markAsUntouched(options),this.setValue(this.value,options),this._pendingChange=!1}_updateValue(){}_anyControls(condition){return!1}_allControlsDisabled(){return this.disabled}registerOnChange(fn){this._onChange.push(fn)}_clearChangeFns(){this._onChange=[],this._onDisabledChange=[],this._onCollectionChange=()=>{}}registerOnDisabledChange(fn){this._onDisabledChange.push(fn)}_forEachChild(cb){}_syncPendingControls(){return!(\"submit\"!==this.updateOn||(this._pendingDirty&&this.markAsDirty(),this._pendingTouched&&this.markAsTouched(),!this._pendingChange)||(this.setValue(this._pendingValue,{onlySelf:!0,emitModelToViewChange:!1}),0))}_applyFormState(formState){this._isBoxedValue(formState)?(this.value=this._pendingValue=formState.value,formState.disabled?this.disable({onlySelf:!0,emitEvent:!1}):this.enable({onlySelf:!0,emitEvent:!1})):this.value=this._pendingValue=formState}}class FormGroup extends forms_AbstractControl{constructor(controls,validatorOrOpts,asyncValidator){super(coerceToValidator(validatorOrOpts),coerceToAsyncValidator(asyncValidator,validatorOrOpts)),this.controls=controls,this._initObservables(),this._setUpdateStrategy(validatorOrOpts),this._setUpControls(),this.updateValueAndValidity({onlySelf:!0,emitEvent:!1})}registerControl(name,control){return this.controls[name]?this.controls[name]:(this.controls[name]=control,control.setParent(this),control._registerOnCollectionChange(this._onCollectionChange),control)}addControl(name,control){this.registerControl(name,control),this.updateValueAndValidity(),this._onCollectionChange()}removeControl(name){this.controls[name]&&this.controls[name]._registerOnCollectionChange(()=>{}),delete this.controls[name],this.updateValueAndValidity(),this._onCollectionChange()}setControl(name,control){this.controls[name]&&this.controls[name]._registerOnCollectionChange(()=>{}),delete this.controls[name],control&&this.registerControl(name,control),this.updateValueAndValidity(),this._onCollectionChange()}contains(controlName){return this.controls.hasOwnProperty(controlName)&&this.controls[controlName].enabled}setValue(value,options={}){this._checkAllValuesPresent(value),Object.keys(value).forEach(name=>{this._throwIfControlMissing(name),this.controls[name].setValue(value[name],{onlySelf:!0,emitEvent:options.emitEvent})}),this.updateValueAndValidity(options)}patchValue(value,options={}){Object.keys(value).forEach(name=>{this.controls[name]&&this.controls[name].patchValue(value[name],{onlySelf:!0,emitEvent:options.emitEvent})}),this.updateValueAndValidity(options)}reset(value={},options={}){this._forEachChild((control,name)=>{control.reset(value[name],{onlySelf:!0,emitEvent:options.emitEvent})}),this._updatePristine(options),this._updateTouched(options),this.updateValueAndValidity(options)}getRawValue(){return this._reduceChildren({},(acc,control,name)=>(acc[name]=control instanceof FormControl?control.value:control.getRawValue(),acc))}_syncPendingControls(){let subtreeUpdated=this._reduceChildren(!1,(updated,child)=>!!child._syncPendingControls()||updated);return subtreeUpdated&&this.updateValueAndValidity({onlySelf:!0}),subtreeUpdated}_throwIfControlMissing(name){if(!Object.keys(this.controls).length)throw new Error(\"\\n        There are no form controls registered with this group yet.  If you're using ngModel,\\n        you may want to check next tick (e.g. use setTimeout).\\n      \");if(!this.controls[name])throw new Error(`Cannot find form control with name: ${name}.`)}_forEachChild(cb){Object.keys(this.controls).forEach(k=>cb(this.controls[k],k))}_setUpControls(){this._forEachChild(control=>{control.setParent(this),control._registerOnCollectionChange(this._onCollectionChange)})}_updateValue(){this.value=this._reduceValue()}_anyControls(condition){let res=!1;return this._forEachChild((control,name)=>{res=res||this.contains(name)&&condition(control)}),res}_reduceValue(){return this._reduceChildren({},(acc,control,name)=>((control.enabled||this.disabled)&&(acc[name]=control.value),acc))}_reduceChildren(initValue,fn){let res=initValue;return this._forEachChild((control,name)=>{res=fn(res,control,name)}),res}_allControlsDisabled(){for(const controlName of Object.keys(this.controls))if(this.controls[controlName].enabled)return!1;return Object.keys(this.controls).length>0||this.disabled}_checkAllValuesPresent(value){this._forEachChild((control,name)=>{if(void 0===value[name])throw new Error(`Must supply a value for form control with name: '${name}'.`)})}}class FormArray extends forms_AbstractControl{constructor(controls,validatorOrOpts,asyncValidator){super(coerceToValidator(validatorOrOpts),coerceToAsyncValidator(asyncValidator,validatorOrOpts)),this.controls=controls,this._initObservables(),this._setUpdateStrategy(validatorOrOpts),this._setUpControls(),this.updateValueAndValidity({onlySelf:!0,emitEvent:!1})}at(index){return this.controls[index]}push(control){this.controls.push(control),this._registerControl(control),this.updateValueAndValidity(),this._onCollectionChange()}insert(index,control){this.controls.splice(index,0,control),this._registerControl(control),this.updateValueAndValidity()}removeAt(index){this.controls[index]&&this.controls[index]._registerOnCollectionChange(()=>{}),this.controls.splice(index,1),this.updateValueAndValidity()}setControl(index,control){this.controls[index]&&this.controls[index]._registerOnCollectionChange(()=>{}),this.controls.splice(index,1),control&&(this.controls.splice(index,0,control),this._registerControl(control)),this.updateValueAndValidity(),this._onCollectionChange()}get length(){return this.controls.length}setValue(value,options={}){this._checkAllValuesPresent(value),value.forEach((newValue,index)=>{this._throwIfControlMissing(index),this.at(index).setValue(newValue,{onlySelf:!0,emitEvent:options.emitEvent})}),this.updateValueAndValidity(options)}patchValue(value,options={}){value.forEach((newValue,index)=>{this.at(index)&&this.at(index).patchValue(newValue,{onlySelf:!0,emitEvent:options.emitEvent})}),this.updateValueAndValidity(options)}reset(value=[],options={}){this._forEachChild((control,index)=>{control.reset(value[index],{onlySelf:!0,emitEvent:options.emitEvent})}),this._updatePristine(options),this._updateTouched(options),this.updateValueAndValidity(options)}getRawValue(){return this.controls.map(control=>control instanceof FormControl?control.value:control.getRawValue())}clear(){this.controls.length<1||(this._forEachChild(control=>control._registerOnCollectionChange(()=>{})),this.controls.splice(0),this.updateValueAndValidity())}_syncPendingControls(){let subtreeUpdated=this.controls.reduce((updated,child)=>!!child._syncPendingControls()||updated,!1);return subtreeUpdated&&this.updateValueAndValidity({onlySelf:!0}),subtreeUpdated}_throwIfControlMissing(index){if(!this.controls.length)throw new Error(\"\\n        There are no form controls registered with this array yet.  If you're using ngModel,\\n        you may want to check next tick (e.g. use setTimeout).\\n      \");if(!this.at(index))throw new Error(\"Cannot find form control at index \"+index)}_forEachChild(cb){this.controls.forEach((control,index)=>{cb(control,index)})}_updateValue(){this.value=this.controls.filter(control=>control.enabled||this.disabled).map(control=>control.value)}_anyControls(condition){return this.controls.some(control=>control.enabled&&condition(control))}_setUpControls(){this._forEachChild(control=>this._registerControl(control))}_checkAllValuesPresent(value){this._forEachChild((control,i)=>{if(void 0===value[i])throw new Error(`Must supply a value for form control at index: ${i}.`)})}_allControlsDisabled(){for(const control of this.controls)if(control.enabled)return!1;return this.controls.length>0||this.disabled}_registerControl(control){control.setParent(this),control._registerOnCollectionChange(this._onCollectionChange)}}const formDirectiveProvider={provide:forms_ControlContainer,useExisting:forwardRef(()=>forms_NgForm)},resolvedPromise=(()=>Promise.resolve(null))();let forms_NgForm=(()=>{class NgForm extends forms_ControlContainer{constructor(validators,asyncValidators){super(),this.submitted=!1,this._directives=[],this.ngSubmit=new core_EventEmitter,this.form=new FormGroup({},composeValidators(validators),composeAsyncValidators(asyncValidators))}ngAfterViewInit(){this._setUpdateStrategy()}get formDirective(){return this}get control(){return this.form}get path(){return[]}get controls(){return this.form.controls}addControl(dir){resolvedPromise.then(()=>{const container=this._findContainer(dir.path);dir.control=container.registerControl(dir.name,dir.control),setUpControl(dir.control,dir),dir.control.updateValueAndValidity({emitEvent:!1}),this._directives.push(dir)})}getControl(dir){return this.form.get(dir.path)}removeControl(dir){resolvedPromise.then(()=>{const container=this._findContainer(dir.path);container&&container.removeControl(dir.name),function(list,el){const index=list.indexOf(el);index>-1&&list.splice(index,1)}(this._directives,dir)})}addFormGroup(dir){resolvedPromise.then(()=>{const container=this._findContainer(dir.path),group=new FormGroup({});(function(control,dir){null==control&&forms_throwError(dir,\"Cannot find control with\"),control.validator=forms_Validators.compose([control.validator,dir.validator]),control.asyncValidator=forms_Validators.composeAsync([control.asyncValidator,dir.asyncValidator])})(group,dir),container.registerControl(dir.name,group),group.updateValueAndValidity({emitEvent:!1})})}removeFormGroup(dir){resolvedPromise.then(()=>{const container=this._findContainer(dir.path);container&&container.removeControl(dir.name)})}getFormGroup(dir){return this.form.get(dir.path)}updateModel(dir,value){resolvedPromise.then(()=>{this.form.get(dir.path).setValue(value)})}setValue(value){this.control.setValue(value)}onSubmit($event){return this.submitted=!0,directives=this._directives,this.form._syncPendingControls(),directives.forEach(dir=>{const control=dir.control;\"submit\"===control.updateOn&&control._pendingChange&&(dir.viewToModelUpdate(control._pendingValue),control._pendingChange=!1)}),this.ngSubmit.emit($event),!1;var directives}onReset(){this.resetForm()}resetForm(value){this.form.reset(value),this.submitted=!1}_setUpdateStrategy(){this.options&&null!=this.options.updateOn&&(this.form._updateOn=this.options.updateOn)}_findContainer(path){return path.pop(),path.length?this.form.get(path):this.form}}return NgForm.ɵfac=function(t){return new(t||NgForm)(ɵɵdirectiveInject(NG_VALIDATORS,10),ɵɵdirectiveInject(NG_ASYNC_VALIDATORS,10))},NgForm.ɵdir=ɵɵdefineDirective({type:NgForm,selectors:[[\"form\",3,\"ngNoForm\",\"\",3,\"formGroup\",\"\"],[\"ng-form\"],[\"\",\"ngForm\",\"\"]],hostBindings:function(rf,ctx){1&rf&&ɵɵlistener(\"submit\",(function($event){return ctx.onSubmit($event)}))(\"reset\",(function(){return ctx.onReset()}))},inputs:{options:[\"ngFormOptions\",\"options\"]},outputs:{ngSubmit:\"ngSubmit\"},exportAs:[\"ngForm\"],features:[ɵɵProvidersFeature([formDirectiveProvider]),ɵɵInheritDefinitionFeature]}),NgForm})(),forms_AbstractFormGroupDirective=(()=>{class AbstractFormGroupDirective extends forms_ControlContainer{ngOnInit(){this._checkParentType(),this.formDirective.addFormGroup(this)}ngOnDestroy(){this.formDirective&&this.formDirective.removeFormGroup(this)}get control(){return this.formDirective.getFormGroup(this)}get path(){return controlPath(null==this.name?this.name:this.name.toString(),this._parent)}get formDirective(){return this._parent?this._parent.formDirective:null}get validator(){return composeValidators(this._validators)}get asyncValidator(){return composeAsyncValidators(this._asyncValidators)}_checkParentType(){}}return AbstractFormGroupDirective.ɵfac=function(t){return ɵAbstractFormGroupDirective_BaseFactory(t||AbstractFormGroupDirective)},AbstractFormGroupDirective.ɵdir=ɵɵdefineDirective({type:AbstractFormGroupDirective,features:[ɵɵInheritDefinitionFeature]}),AbstractFormGroupDirective})();const ɵAbstractFormGroupDirective_BaseFactory=ɵɵgetInheritedFactory(forms_AbstractFormGroupDirective);class TemplateDrivenErrors{static modelParentException(){throw new Error('\\n      ngModel cannot be used to register form controls with a parent formGroup directive.  Try using\\n      formGroup\\'s partner directive \"formControlName\" instead.  Example:\\n\\n      \\n    <div [formGroup]=\"myGroup\">\\n      <input formControlName=\"firstName\">\\n    </div>\\n\\n    In your class:\\n\\n    this.myGroup = new FormGroup({\\n       firstName: new FormControl()\\n    });\\n\\n      Or, if you\\'d like to avoid registering this form control, indicate that it\\'s standalone in ngModelOptions:\\n\\n      Example:\\n\\n      \\n    <div [formGroup]=\"myGroup\">\\n       <input formControlName=\"firstName\">\\n       <input [(ngModel)]=\"showMoreControls\" [ngModelOptions]=\"{standalone: true}\">\\n    </div>\\n  ')}static formGroupNameException(){throw new Error(`\\n      ngModel cannot be used to register form controls with a parent formGroupName or formArrayName directive.\\n\\n      Option 1: Use formControlName instead of ngModel (reactive strategy):\\n\\n      ${FormErrorExamples_formGroupName}\\n\\n      Option 2:  Update ngModel's parent be ngModelGroup (template-driven strategy):\\n\\n      ${FormErrorExamples_ngModelGroup}`)}static missingNameException(){throw new Error('If ngModel is used within a form tag, either the name attribute must be set or the form\\n      control must be defined as \\'standalone\\' in ngModelOptions.\\n\\n      Example 1: <input [(ngModel)]=\"person.firstName\" name=\"first\">\\n      Example 2: <input [(ngModel)]=\"person.firstName\" [ngModelOptions]=\"{standalone: true}\">')}static modelGroupParentException(){throw new Error(`\\n      ngModelGroup cannot be used with a parent formGroup directive.\\n\\n      Option 1: Use formGroupName instead of ngModelGroup (reactive strategy):\\n\\n      ${FormErrorExamples_formGroupName}\\n\\n      Option 2:  Use a regular form tag instead of the formGroup directive (template-driven strategy):\\n\\n      ${FormErrorExamples_ngModelGroup}`)}}const modelGroupProvider={provide:forms_ControlContainer,useExisting:forwardRef(()=>forms_NgModelGroup)};let forms_NgModelGroup=(()=>{class NgModelGroup extends forms_AbstractFormGroupDirective{constructor(parent,validators,asyncValidators){super(),this._parent=parent,this._validators=validators,this._asyncValidators=asyncValidators}_checkParentType(){this._parent instanceof NgModelGroup||this._parent instanceof forms_NgForm||TemplateDrivenErrors.modelGroupParentException()}}return NgModelGroup.ɵfac=function(t){return new(t||NgModelGroup)(ɵɵdirectiveInject(forms_ControlContainer,5),ɵɵdirectiveInject(NG_VALIDATORS,10),ɵɵdirectiveInject(NG_ASYNC_VALIDATORS,10))},NgModelGroup.ɵdir=ɵɵdefineDirective({type:NgModelGroup,selectors:[[\"\",\"ngModelGroup\",\"\"]],inputs:{name:[\"ngModelGroup\",\"name\"]},exportAs:[\"ngModelGroup\"],features:[ɵɵProvidersFeature([modelGroupProvider]),ɵɵInheritDefinitionFeature]}),NgModelGroup})();const formControlBinding={provide:NgControl,useExisting:forwardRef(()=>forms_NgModel)},resolvedPromise$1=(()=>Promise.resolve(null))();let forms_NgModel=(()=>{class NgModel extends NgControl{constructor(parent,validators,asyncValidators,valueAccessors){super(),this.control=new FormControl,this._registered=!1,this.update=new core_EventEmitter,this._parent=parent,this._rawValidators=validators||[],this._rawAsyncValidators=asyncValidators||[],this.valueAccessor=function(dir,valueAccessors){if(!valueAccessors)return null;Array.isArray(valueAccessors)||forms_throwError(dir,\"Value accessor was not provided as an array for form control with\");let defaultAccessor=void 0,builtinAccessor=void 0,customAccessor=void 0;return valueAccessors.forEach(v=>{var valueAccessor;v.constructor===forms_DefaultValueAccessor?defaultAccessor=v:(valueAccessor=v,BUILTIN_ACCESSORS.some(a=>valueAccessor.constructor===a)?(builtinAccessor&&forms_throwError(dir,\"More than one built-in value accessor matches form control with\"),builtinAccessor=v):(customAccessor&&forms_throwError(dir,\"More than one custom value accessor matches form control with\"),customAccessor=v))}),customAccessor||builtinAccessor||defaultAccessor||(forms_throwError(dir,\"No valid value accessor for form control with\"),null)}(this,valueAccessors)}ngOnChanges(changes){this._checkForErrors(),this._registered||this._setUpControl(),\"isDisabled\"in changes&&this._updateDisabled(changes),function(changes,viewModel){if(!changes.hasOwnProperty(\"model\"))return!1;const change=changes.model;return!!change.isFirstChange()||!looseIdentical(viewModel,change.currentValue)}(changes,this.viewModel)&&(this._updateValue(this.model),this.viewModel=this.model)}ngOnDestroy(){this.formDirective&&this.formDirective.removeControl(this)}get path(){return this._parent?controlPath(this.name,this._parent):[this.name]}get formDirective(){return this._parent?this._parent.formDirective:null}get validator(){return composeValidators(this._rawValidators)}get asyncValidator(){return composeAsyncValidators(this._rawAsyncValidators)}viewToModelUpdate(newValue){this.viewModel=newValue,this.update.emit(newValue)}_setUpControl(){this._setUpdateStrategy(),this._isStandalone()?this._setUpStandalone():this.formDirective.addControl(this),this._registered=!0}_setUpdateStrategy(){this.options&&null!=this.options.updateOn&&(this.control._updateOn=this.options.updateOn)}_isStandalone(){return!this._parent||!(!this.options||!this.options.standalone)}_setUpStandalone(){setUpControl(this.control,this),this.control.updateValueAndValidity({emitEvent:!1})}_checkForErrors(){this._isStandalone()||this._checkParentType(),this._checkName()}_checkParentType(){!(this._parent instanceof forms_NgModelGroup)&&this._parent instanceof forms_AbstractFormGroupDirective?TemplateDrivenErrors.formGroupNameException():this._parent instanceof forms_NgModelGroup||this._parent instanceof forms_NgForm||TemplateDrivenErrors.modelParentException()}_checkName(){this.options&&this.options.name&&(this.name=this.options.name),this._isStandalone()||this.name||TemplateDrivenErrors.missingNameException()}_updateValue(value){resolvedPromise$1.then(()=>{this.control.setValue(value,{emitViewToModelChange:!1})})}_updateDisabled(changes){const disabledValue=changes.isDisabled.currentValue,isDisabled=\"\"===disabledValue||disabledValue&&\"false\"!==disabledValue;resolvedPromise$1.then(()=>{isDisabled&&!this.control.disabled?this.control.disable():!isDisabled&&this.control.disabled&&this.control.enable()})}}return NgModel.ɵfac=function(t){return new(t||NgModel)(ɵɵdirectiveInject(forms_ControlContainer,9),ɵɵdirectiveInject(NG_VALIDATORS,10),ɵɵdirectiveInject(NG_ASYNC_VALIDATORS,10),ɵɵdirectiveInject(NG_VALUE_ACCESSOR,10))},NgModel.ɵdir=ɵɵdefineDirective({type:NgModel,selectors:[[\"\",\"ngModel\",\"\",3,\"formControlName\",\"\",3,\"formControl\",\"\"]],inputs:{name:\"name\",isDisabled:[\"disabled\",\"isDisabled\"],model:[\"ngModel\",\"model\"],options:[\"ngModelOptions\",\"options\"]},outputs:{update:\"ngModelChange\"},exportAs:[\"ngModel\"],features:[ɵɵProvidersFeature([formControlBinding]),ɵɵInheritDefinitionFeature,ɵɵNgOnChangesFeature]}),NgModel})(),forms_NgNoValidate=(()=>{class ɵNgNoValidate{}return ɵNgNoValidate.ɵfac=function(t){return new(t||ɵNgNoValidate)},ɵNgNoValidate.ɵdir=ɵɵdefineDirective({type:ɵNgNoValidate,selectors:[[\"form\",3,\"ngNoForm\",\"\",3,\"ngNativeValidate\",\"\"]],hostAttrs:[\"novalidate\",\"\"]}),ɵNgNoValidate})(),forms_InternalFormsSharedModule=(()=>{class ɵInternalFormsSharedModule{}return ɵInternalFormsSharedModule.ɵmod=ɵɵdefineNgModule({type:ɵInternalFormsSharedModule}),ɵInternalFormsSharedModule.ɵinj=ɵɵdefineInjector({factory:function(t){return new(t||ɵInternalFormsSharedModule)}}),ɵInternalFormsSharedModule})(),forms_FormsModule=(()=>{class FormsModule{}return FormsModule.ɵmod=ɵɵdefineNgModule({type:FormsModule}),FormsModule.ɵinj=ɵɵdefineInjector({factory:function(t){return new(t||FormsModule)},providers:[forms_RadioControlRegistry],imports:[forms_InternalFormsSharedModule]}),FormsModule})();function of(...args){let scheduler=args[args.length-1];return isScheduler(scheduler)?(args.pop(),scheduleArray(args,scheduler)):fromArray(args)}class BehaviorSubject_BehaviorSubject extends Subject_Subject{constructor(_value){super(),this._value=_value}get value(){return this.getValue()}_subscribe(subscriber){const subscription=super._subscribe(subscriber);return subscription&&!subscription.closed&&subscriber.next(this._value),subscription}getValue(){if(this.hasError)throw this.thrownError;if(this.closed)throw new ObjectUnsubscribedError;return this._value}next(value){super.next(this._value=value)}}const EmptyError=(()=>{function EmptyErrorImpl(){return Error.call(this),this.message=\"no elements in sequence\",this.name=\"EmptyError\",this}return EmptyErrorImpl.prototype=Object.create(Error.prototype),EmptyErrorImpl})(),NONE={};class CombineLatestOperator{constructor(resultSelector){this.resultSelector=resultSelector}call(subscriber,source){return source.subscribe(new combineLatest_CombineLatestSubscriber(subscriber,this.resultSelector))}}class combineLatest_CombineLatestSubscriber extends OuterSubscriber_OuterSubscriber{constructor(destination,resultSelector){super(destination),this.resultSelector=resultSelector,this.active=0,this.values=[],this.observables=[]}_next(observable){this.values.push(NONE),this.observables.push(observable)}_complete(){const observables=this.observables,len=observables.length;if(0===len)this.destination.complete();else{this.active=len,this.toRespond=len;for(let i=0;i<len;i++){const observable=observables[i];this.add(subscribeToResult(this,observable,observable,i))}}}notifyComplete(unused){0==(this.active-=1)&&this.destination.complete()}notifyNext(outerValue,innerValue,outerIndex,innerIndex,innerSub){const values=this.values,toRespond=this.toRespond?values[outerIndex]===NONE?--this.toRespond:this.toRespond:0;values[outerIndex]=innerValue,0===toRespond&&(this.resultSelector?this._tryResultSelector(values):this.destination.next(values.slice()))}_tryResultSelector(values){let result;try{result=this.resultSelector.apply(this,values)}catch(err){return void this.destination.error(err)}this.destination.next(result)}}const empty_EMPTY=new Observable_Observable(subscriber=>subscriber.complete());function empty_empty(scheduler){return scheduler?function(scheduler){return new Observable_Observable(subscriber=>scheduler.schedule(()=>subscriber.complete()))}(scheduler):empty_EMPTY}function defer(observableFactory){return new Observable_Observable(subscriber=>{let input;try{input=observableFactory()}catch(err){return void subscriber.error(err)}return(input?from(input):empty_empty()).subscribe(subscriber)})}function concatAll(){return mergeAll(1)}function filter(predicate,thisArg){return function(source){return source.lift(new FilterOperator(predicate,thisArg))}}class FilterOperator{constructor(predicate,thisArg){this.predicate=predicate,this.thisArg=thisArg}call(subscriber,source){return source.subscribe(new filter_FilterSubscriber(subscriber,this.predicate,this.thisArg))}}class filter_FilterSubscriber extends Subscriber_Subscriber{constructor(destination,predicate,thisArg){super(destination),this.predicate=predicate,this.thisArg=thisArg,this.count=0}_next(value){let result;try{result=this.predicate.call(this.thisArg,value,this.count++)}catch(err){return void this.destination.error(err)}result&&this.destination.next(value)}}const ArgumentOutOfRangeError=(()=>{function ArgumentOutOfRangeErrorImpl(){return Error.call(this),this.message=\"argument out of range\",this.name=\"ArgumentOutOfRangeError\",this}return ArgumentOutOfRangeErrorImpl.prototype=Object.create(Error.prototype),ArgumentOutOfRangeErrorImpl})();function takeLast(count){return function(source){return 0===count?empty_empty():source.lift(new takeLast_TakeLastOperator(count))}}class takeLast_TakeLastOperator{constructor(total){if(this.total=total,this.total<0)throw new ArgumentOutOfRangeError}call(subscriber,source){return source.subscribe(new takeLast_TakeLastSubscriber(subscriber,this.total))}}class takeLast_TakeLastSubscriber extends Subscriber_Subscriber{constructor(destination,total){super(destination),this.total=total,this.ring=new Array,this.count=0}_next(value){const ring=this.ring,total=this.total,count=this.count++;ring.length<total?ring.push(value):ring[count%total]=value}_complete(){const destination=this.destination;let count=this.count;if(count>0){const total=this.count>=this.total?this.total:this.count,ring=this.ring;for(let i=0;i<total;i++){const idx=count++%total;destination.next(ring[idx])}}destination.complete()}}function throwIfEmpty(errorFactory=defaultErrorFactory){return source=>source.lift(new ThrowIfEmptyOperator(errorFactory))}class ThrowIfEmptyOperator{constructor(errorFactory){this.errorFactory=errorFactory}call(subscriber,source){return source.subscribe(new throwIfEmpty_ThrowIfEmptySubscriber(subscriber,this.errorFactory))}}class throwIfEmpty_ThrowIfEmptySubscriber extends Subscriber_Subscriber{constructor(destination,errorFactory){super(destination),this.errorFactory=errorFactory,this.hasValue=!1}_next(value){this.hasValue=!0,this.destination.next(value)}_complete(){if(this.hasValue)return this.destination.complete();{let err;try{err=this.errorFactory()}catch(e){err=e}this.destination.error(err)}}}function defaultErrorFactory(){return new EmptyError}function defaultIfEmpty(defaultValue=null){return source=>source.lift(new DefaultIfEmptyOperator(defaultValue))}class DefaultIfEmptyOperator{constructor(defaultValue){this.defaultValue=defaultValue}call(subscriber,source){return source.subscribe(new defaultIfEmpty_DefaultIfEmptySubscriber(subscriber,this.defaultValue))}}class defaultIfEmpty_DefaultIfEmptySubscriber extends Subscriber_Subscriber{constructor(destination,defaultValue){super(destination),this.defaultValue=defaultValue,this.isEmpty=!0}_next(value){this.isEmpty=!1,this.destination.next(value)}_complete(){this.isEmpty&&this.destination.next(this.defaultValue),this.destination.complete()}}function last_last(predicate,defaultValue){const hasDefaultValue=arguments.length>=2;return source=>source.pipe(predicate?filter((v,i)=>predicate(v,i,source)):identity,takeLast(1),hasDefaultValue?defaultIfEmpty(defaultValue):throwIfEmpty(()=>new EmptyError))}function catchError(selector){return function(source){const operator=new CatchOperator(selector),caught=source.lift(operator);return operator.caught=caught}}class CatchOperator{constructor(selector){this.selector=selector}call(subscriber,source){return source.subscribe(new catchError_CatchSubscriber(subscriber,this.selector,this.caught))}}class catchError_CatchSubscriber extends OuterSubscriber_OuterSubscriber{constructor(destination,selector,caught){super(destination),this.selector=selector,this.caught=caught}error(err){if(!this.isStopped){let result;try{result=this.selector(err,this.caught)}catch(err2){return void super.error(err2)}this._unsubscribeAndRecycle();const innerSubscriber=new InnerSubscriber_InnerSubscriber(this,void 0,void 0);this.add(innerSubscriber);const innerSubscription=subscribeToResult(this,result,void 0,void 0,innerSubscriber);innerSubscription!==innerSubscriber&&this.add(innerSubscription)}}}function take(count){return source=>0===count?empty_empty():source.lift(new take_TakeOperator(count))}class take_TakeOperator{constructor(total){if(this.total=total,this.total<0)throw new ArgumentOutOfRangeError}call(subscriber,source){return source.subscribe(new take_TakeSubscriber(subscriber,this.total))}}class take_TakeSubscriber extends Subscriber_Subscriber{constructor(destination,total){super(destination),this.total=total,this.count=0}_next(value){const total=this.total,count=++this.count;count<=total&&(this.destination.next(value),count===total&&(this.destination.complete(),this.unsubscribe()))}}function first_first(predicate,defaultValue){const hasDefaultValue=arguments.length>=2;return source=>source.pipe(predicate?filter((v,i)=>predicate(v,i,source)):identity,take(1),hasDefaultValue?defaultIfEmpty(defaultValue):throwIfEmpty(()=>new EmptyError))}class EveryOperator{constructor(predicate,thisArg,source){this.predicate=predicate,this.thisArg=thisArg,this.source=source}call(observer,source){return source.subscribe(new every_EverySubscriber(observer,this.predicate,this.thisArg,this.source))}}class every_EverySubscriber extends Subscriber_Subscriber{constructor(destination,predicate,thisArg,source){super(destination),this.predicate=predicate,this.thisArg=thisArg,this.source=source,this.index=0,this.thisArg=thisArg||this}notifyComplete(everyValueMatch){this.destination.next(everyValueMatch),this.destination.complete()}_next(value){let result=!1;try{result=this.predicate.call(this.thisArg,value,this.index++,this.source)}catch(err){return void this.destination.error(err)}result||this.notifyComplete(!1)}_complete(){this.notifyComplete(!0)}}function switchMap(project,resultSelector){return\"function\"==typeof resultSelector?source=>source.pipe(switchMap((a,i)=>from(project(a,i)).pipe(map((b,ii)=>resultSelector(a,b,i,ii))))):source=>source.lift(new SwitchMapOperator(project))}class SwitchMapOperator{constructor(project){this.project=project}call(subscriber,source){return source.subscribe(new switchMap_SwitchMapSubscriber(subscriber,this.project))}}class switchMap_SwitchMapSubscriber extends OuterSubscriber_OuterSubscriber{constructor(destination,project){super(destination),this.project=project,this.index=0}_next(value){let result;const index=this.index++;try{result=this.project(value,index)}catch(error){return void this.destination.error(error)}this._innerSub(result,value,index)}_innerSub(result,value,index){const innerSubscription=this.innerSubscription;innerSubscription&&innerSubscription.unsubscribe();const innerSubscriber=new InnerSubscriber_InnerSubscriber(this,value,index),destination=this.destination;destination.add(innerSubscriber),this.innerSubscription=subscribeToResult(this,result,void 0,void 0,innerSubscriber),this.innerSubscription!==innerSubscriber&&destination.add(this.innerSubscription)}_complete(){const{innerSubscription:innerSubscription}=this;innerSubscription&&!innerSubscription.closed||super._complete(),this.unsubscribe()}_unsubscribe(){this.innerSubscription=null}notifyComplete(innerSub){this.destination.remove(innerSub),this.innerSubscription=null,this.isStopped&&super._complete()}notifyNext(outerValue,innerValue,outerIndex,innerIndex,innerSub){this.destination.next(innerValue)}}function concat(...observables){return concatAll()(of(...observables))}function scan(accumulator,seed){let hasSeed=!1;return arguments.length>=2&&(hasSeed=!0),function(source){return source.lift(new ScanOperator(accumulator,seed,hasSeed))}}class ScanOperator{constructor(accumulator,seed,hasSeed=!1){this.accumulator=accumulator,this.seed=seed,this.hasSeed=hasSeed}call(subscriber,source){return source.subscribe(new scan_ScanSubscriber(subscriber,this.accumulator,this.seed,this.hasSeed))}}class scan_ScanSubscriber extends Subscriber_Subscriber{constructor(destination,accumulator,_seed,hasSeed){super(destination),this.accumulator=accumulator,this._seed=_seed,this.hasSeed=hasSeed,this.index=0}get seed(){return this._seed}set seed(value){this.hasSeed=!0,this._seed=value}_next(value){if(this.hasSeed)return this._tryNext(value);this.seed=value,this.destination.next(value)}_tryNext(value){const index=this.index++;let result;try{result=this.accumulator(this.seed,value,index)}catch(err){this.destination.error(err)}this.seed=result,this.destination.next(result)}}function concatMap(project,resultSelector){return mergeMap(project,resultSelector,1)}function noop_noop(){}function tap(nextOrObserver,error,complete){return function(source){return source.lift(new DoOperator(nextOrObserver,error,complete))}}class DoOperator{constructor(nextOrObserver,error,complete){this.nextOrObserver=nextOrObserver,this.error=error,this.complete=complete}call(subscriber,source){return source.subscribe(new tap_TapSubscriber(subscriber,this.nextOrObserver,this.error,this.complete))}}class tap_TapSubscriber extends Subscriber_Subscriber{constructor(destination,observerOrNext,error,complete){super(destination),this._tapNext=noop_noop,this._tapError=noop_noop,this._tapComplete=noop_noop,this._tapError=error||noop_noop,this._tapComplete=complete||noop_noop,isFunction(observerOrNext)?(this._context=this,this._tapNext=observerOrNext):observerOrNext&&(this._context=observerOrNext,this._tapNext=observerOrNext.next||noop_noop,this._tapError=observerOrNext.error||noop_noop,this._tapComplete=observerOrNext.complete||noop_noop)}_next(value){try{this._tapNext.call(this._context,value)}catch(err){return void this.destination.error(err)}this.destination.next(value)}_error(err){try{this._tapError.call(this._context,err)}catch(err){return void this.destination.error(err)}this.destination.error(err)}_complete(){try{this._tapComplete.call(this._context)}catch(err){return void this.destination.error(err)}return this.destination.complete()}}class FinallyOperator{constructor(callback){this.callback=callback}call(subscriber,source){return source.subscribe(new finalize_FinallySubscriber(subscriber,this.callback))}}class finalize_FinallySubscriber extends Subscriber_Subscriber{constructor(destination,callback){super(destination),this.add(new Subscription_Subscription(callback))}}class RouterEvent{constructor(id,url){this.id=id,this.url=url}}class NavigationStart extends RouterEvent{constructor(id,url,navigationTrigger=\"imperative\",restoredState=null){super(id,url),this.navigationTrigger=navigationTrigger,this.restoredState=restoredState}toString(){return`NavigationStart(id: ${this.id}, url: '${this.url}')`}}class NavigationEnd extends RouterEvent{constructor(id,url,urlAfterRedirects){super(id,url),this.urlAfterRedirects=urlAfterRedirects}toString(){return`NavigationEnd(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}')`}}class NavigationCancel extends RouterEvent{constructor(id,url,reason){super(id,url),this.reason=reason}toString(){return`NavigationCancel(id: ${this.id}, url: '${this.url}')`}}class NavigationError extends RouterEvent{constructor(id,url,error){super(id,url),this.error=error}toString(){return`NavigationError(id: ${this.id}, url: '${this.url}', error: ${this.error})`}}class RoutesRecognized extends RouterEvent{constructor(id,url,urlAfterRedirects,state){super(id,url),this.urlAfterRedirects=urlAfterRedirects,this.state=state}toString(){return`RoutesRecognized(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state})`}}class GuardsCheckStart extends RouterEvent{constructor(id,url,urlAfterRedirects,state){super(id,url),this.urlAfterRedirects=urlAfterRedirects,this.state=state}toString(){return`GuardsCheckStart(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state})`}}class GuardsCheckEnd extends RouterEvent{constructor(id,url,urlAfterRedirects,state,shouldActivate){super(id,url),this.urlAfterRedirects=urlAfterRedirects,this.state=state,this.shouldActivate=shouldActivate}toString(){return`GuardsCheckEnd(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state}, shouldActivate: ${this.shouldActivate})`}}class ResolveStart extends RouterEvent{constructor(id,url,urlAfterRedirects,state){super(id,url),this.urlAfterRedirects=urlAfterRedirects,this.state=state}toString(){return`ResolveStart(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state})`}}class ResolveEnd extends RouterEvent{constructor(id,url,urlAfterRedirects,state){super(id,url),this.urlAfterRedirects=urlAfterRedirects,this.state=state}toString(){return`ResolveEnd(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state})`}}class RouteConfigLoadStart{constructor(route){this.route=route}toString(){return`RouteConfigLoadStart(path: ${this.route.path})`}}class RouteConfigLoadEnd{constructor(route){this.route=route}toString(){return`RouteConfigLoadEnd(path: ${this.route.path})`}}class ChildActivationStart{constructor(snapshot){this.snapshot=snapshot}toString(){return`ChildActivationStart(path: '${this.snapshot.routeConfig&&this.snapshot.routeConfig.path||\"\"}')`}}class ChildActivationEnd{constructor(snapshot){this.snapshot=snapshot}toString(){return`ChildActivationEnd(path: '${this.snapshot.routeConfig&&this.snapshot.routeConfig.path||\"\"}')`}}class ActivationStart{constructor(snapshot){this.snapshot=snapshot}toString(){return`ActivationStart(path: '${this.snapshot.routeConfig&&this.snapshot.routeConfig.path||\"\"}')`}}class ActivationEnd{constructor(snapshot){this.snapshot=snapshot}toString(){return`ActivationEnd(path: '${this.snapshot.routeConfig&&this.snapshot.routeConfig.path||\"\"}')`}}class Scroll{constructor(routerEvent,position,anchor){this.routerEvent=routerEvent,this.position=position,this.anchor=anchor}toString(){return`Scroll(anchor: '${this.anchor}', position: '${this.position?`${this.position[0]}, ${this.position[1]}`:null}')`}}let router_EmptyOutletComponent=(()=>{class ɵEmptyOutletComponent{}return ɵEmptyOutletComponent.ɵfac=function(t){return new(t||ɵEmptyOutletComponent)},ɵEmptyOutletComponent.ɵcmp=ɵɵdefineComponent({type:ɵEmptyOutletComponent,selectors:[[\"ng-component\"]],decls:1,vars:0,template:function(rf,ctx){1&rf&&ɵɵelement(0,\"router-outlet\")},directives:function(){return[router_RouterOutlet]},encapsulation:2}),ɵEmptyOutletComponent})();class ParamsAsMap{constructor(params){this.params=params||{}}has(name){return this.params.hasOwnProperty(name)}get(name){if(this.has(name)){const v=this.params[name];return Array.isArray(v)?v[0]:v}return null}getAll(name){if(this.has(name)){const v=this.params[name];return Array.isArray(v)?v:[v]}return[]}get keys(){return Object.keys(this.params)}}function convertToParamMap(params){return new ParamsAsMap(params)}function navigationCancelingError(message){const error=Error(\"NavigationCancelingError: \"+message);return error.ngNavigationCancelingError=!0,error}function defaultUrlMatcher(segments,segmentGroup,route){const parts=route.path.split(\"/\");if(parts.length>segments.length)return null;if(\"full\"===route.pathMatch&&(segmentGroup.hasChildren()||parts.length<segments.length))return null;const posParams={};for(let index=0;index<parts.length;index++){const part=parts[index],segment=segments[index];if(part.startsWith(\":\"))posParams[part.substring(1)]=segment;else if(part!==segment.path)return null}return{consumed:segments.slice(0,parts.length),posParams:posParams}}class LoadedRouterConfig{constructor(routes,module){this.routes=routes,this.module=module}}function validateConfig(config,parentPath=\"\"){for(let i=0;i<config.length;i++){const route=config[i];router_validateNode(route,getFullPath(parentPath,route))}}function router_validateNode(route,fullPath){if(!route)throw new Error(`\\n      Invalid configuration of route '${fullPath}': Encountered undefined route.\\n      The reason might be an extra comma.\\n\\n      Example:\\n      const routes: Routes = [\\n        { path: '', redirectTo: '/dashboard', pathMatch: 'full' },\\n        { path: 'dashboard',  component: DashboardComponent },, << two commas\\n        { path: 'detail/:id', component: HeroDetailComponent }\\n      ];\\n    `);if(Array.isArray(route))throw new Error(`Invalid configuration of route '${fullPath}': Array cannot be specified`);if(!route.component&&!route.children&&!route.loadChildren&&route.outlet&&\"primary\"!==route.outlet)throw new Error(`Invalid configuration of route '${fullPath}': a componentless route without children or loadChildren cannot have a named outlet set`);if(route.redirectTo&&route.children)throw new Error(`Invalid configuration of route '${fullPath}': redirectTo and children cannot be used together`);if(route.redirectTo&&route.loadChildren)throw new Error(`Invalid configuration of route '${fullPath}': redirectTo and loadChildren cannot be used together`);if(route.children&&route.loadChildren)throw new Error(`Invalid configuration of route '${fullPath}': children and loadChildren cannot be used together`);if(route.redirectTo&&route.component)throw new Error(`Invalid configuration of route '${fullPath}': redirectTo and component cannot be used together`);if(route.path&&route.matcher)throw new Error(`Invalid configuration of route '${fullPath}': path and matcher cannot be used together`);if(void 0===route.redirectTo&&!route.component&&!route.children&&!route.loadChildren)throw new Error(`Invalid configuration of route '${fullPath}'. One of the following must be provided: component, redirectTo, children or loadChildren`);if(void 0===route.path&&void 0===route.matcher)throw new Error(`Invalid configuration of route '${fullPath}': routes must have either a path or a matcher specified`);if(\"string\"==typeof route.path&&\"/\"===route.path.charAt(0))throw new Error(`Invalid configuration of route '${fullPath}': path cannot start with a slash`);if(\"\"===route.path&&void 0!==route.redirectTo&&void 0===route.pathMatch)throw new Error(`Invalid configuration of route '{path: \"${fullPath}\", redirectTo: \"${route.redirectTo}\"}': please provide 'pathMatch'. The default value of 'pathMatch' is 'prefix', but often the intent is to use 'full'.`);if(void 0!==route.pathMatch&&\"full\"!==route.pathMatch&&\"prefix\"!==route.pathMatch)throw new Error(`Invalid configuration of route '${fullPath}': pathMatch can only be set to 'prefix' or 'full'`);route.children&&validateConfig(route.children,fullPath)}function getFullPath(parentPath,currentRoute){return currentRoute?parentPath||currentRoute.path?parentPath&&!currentRoute.path?parentPath+\"/\":!parentPath&&currentRoute.path?currentRoute.path:`${parentPath}/${currentRoute.path}`:\"\":parentPath}function standardizeConfig(r){const children=r.children&&r.children.map(standardizeConfig),c=children?Object.assign(Object.assign({},r),{children:children}):Object.assign({},r);return!c.component&&(children||c.loadChildren)&&c.outlet&&\"primary\"!==c.outlet&&(c.component=router_EmptyOutletComponent),c}function shallowEqual(a,b){const k1=Object.keys(a),k2=Object.keys(b);if(!k1||!k2||k1.length!=k2.length)return!1;let key;for(let i=0;i<k1.length;i++)if(key=k1[i],!equalArraysOrString(a[key],b[key]))return!1;return!0}function equalArraysOrString(a,b){return Array.isArray(a)&&Array.isArray(b)?a.length==b.length&&a.every(aItem=>b.indexOf(aItem)>-1):a===b}function router_flatten(arr){return Array.prototype.concat.apply([],arr)}function router_last(a){return a.length>0?a[a.length-1]:null}function forEach(map,callback){for(const prop in map)map.hasOwnProperty(prop)&&callback(map[prop],prop)}function wrapIntoObservable(value){return isObservable(value)?value:core_isPromise(value)?from(Promise.resolve(value)):of(value)}function containsTree(container,containee,exact){return exact?function(container,containee){return shallowEqual(container,containee)}(container.queryParams,containee.queryParams)&&function equalSegmentGroups(container,containee){if(!equalPath(container.segments,containee.segments))return!1;if(container.numberOfChildren!==containee.numberOfChildren)return!1;for(const c in containee.children){if(!container.children[c])return!1;if(!equalSegmentGroups(container.children[c],containee.children[c]))return!1}return!0}(container.root,containee.root):function(container,containee){return Object.keys(containee).length<=Object.keys(container).length&&Object.keys(containee).every(key=>equalArraysOrString(container[key],containee[key]))}(container.queryParams,containee.queryParams)&&function containsSegmentGroup(container,containee){return function containsSegmentGroupHelper(container,containee,containeePaths){if(container.segments.length>containeePaths.length)return!!equalPath(container.segments.slice(0,containeePaths.length),containeePaths)&&!containee.hasChildren();if(container.segments.length===containeePaths.length){if(!equalPath(container.segments,containeePaths))return!1;for(const c in containee.children){if(!container.children[c])return!1;if(!containsSegmentGroup(container.children[c],containee.children[c]))return!1}return!0}{const current=containeePaths.slice(0,container.segments.length),next=containeePaths.slice(container.segments.length);return!!equalPath(container.segments,current)&&!!container.children.primary&&containsSegmentGroupHelper(container.children.primary,containee,next)}}(container,containee,containee.segments)}(container.root,containee.root)}class UrlTree{constructor(root,queryParams,fragment){this.root=root,this.queryParams=queryParams,this.fragment=fragment}get queryParamMap(){return this._queryParamMap||(this._queryParamMap=convertToParamMap(this.queryParams)),this._queryParamMap}toString(){return DEFAULT_SERIALIZER.serialize(this)}}class UrlSegmentGroup{constructor(segments,children){this.segments=segments,this.children=children,this.parent=null,forEach(children,(v,k)=>v.parent=this)}hasChildren(){return this.numberOfChildren>0}get numberOfChildren(){return Object.keys(this.children).length}toString(){return serializePaths(this)}}class UrlSegment{constructor(path,parameters){this.path=path,this.parameters=parameters}get parameterMap(){return this._parameterMap||(this._parameterMap=convertToParamMap(this.parameters)),this._parameterMap}toString(){return serializePath(this)}}function equalPath(as,bs){return as.length===bs.length&&as.every((a,i)=>a.path===bs[i].path)}function mapChildrenIntoArray(segment,fn){let res=[];return forEach(segment.children,(child,childOutlet)=>{\"primary\"===childOutlet&&(res=res.concat(fn(child,childOutlet)))}),forEach(segment.children,(child,childOutlet)=>{\"primary\"!==childOutlet&&(res=res.concat(fn(child,childOutlet)))}),res}class UrlSerializer{}class DefaultUrlSerializer{parse(url){const p=new UrlParser(url);return new UrlTree(p.parseRootSegment(),p.parseQueryParams(),p.parseFragment())}serialize(tree){return`${\"/\"+function serializeSegment(segment,root){if(!segment.hasChildren())return serializePaths(segment);if(root){const primary=segment.children.primary?serializeSegment(segment.children.primary,!1):\"\",children=[];return forEach(segment.children,(v,k)=>{\"primary\"!==k&&children.push(`${k}:${serializeSegment(v,!1)}`)}),children.length>0?`${primary}(${children.join(\"//\")})`:primary}{const children=mapChildrenIntoArray(segment,(v,k)=>\"primary\"===k?[serializeSegment(segment.children.primary,!1)]:[`${k}:${serializeSegment(v,!1)}`]);return`${serializePaths(segment)}/(${children.join(\"//\")})`}}(tree.root,!0)}${function(params){const strParams=Object.keys(params).map(name=>{const value=params[name];return Array.isArray(value)?value.map(v=>`${encodeUriQuery(name)}=${encodeUriQuery(v)}`).join(\"&\"):`${encodeUriQuery(name)}=${encodeUriQuery(value)}`});return strParams.length?\"?\"+strParams.join(\"&\"):\"\"}(tree.queryParams)}${\"string\"==typeof tree.fragment?\"#\"+encodeURI(tree.fragment):\"\"}`}}const DEFAULT_SERIALIZER=new DefaultUrlSerializer;function serializePaths(segment){return segment.segments.map(p=>serializePath(p)).join(\"/\")}function encodeUriString(s){return encodeURIComponent(s).replace(/%40/g,\"@\").replace(/%3A/gi,\":\").replace(/%24/g,\"$\").replace(/%2C/gi,\",\")}function encodeUriQuery(s){return encodeUriString(s).replace(/%3B/gi,\";\")}function encodeUriSegment(s){return encodeUriString(s).replace(/\\(/g,\"%28\").replace(/\\)/g,\"%29\").replace(/%26/gi,\"&\")}function decode(s){return decodeURIComponent(s)}function decodeQuery(s){return decode(s.replace(/\\+/g,\"%20\"))}function serializePath(path){return`${encodeUriSegment(path.path)}${params=path.parameters,Object.keys(params).map(key=>`;${encodeUriSegment(key)}=${encodeUriSegment(params[key])}`).join(\"\")}`;var params}const SEGMENT_RE=/^[^\\/()?;=#]+/;function matchSegments(str){const match=str.match(SEGMENT_RE);return match?match[0]:\"\"}const QUERY_PARAM_RE=/^[^=?&#]+/,QUERY_PARAM_VALUE_RE=/^[^?&#]+/;class UrlParser{constructor(url){this.url=url,this.remaining=url}parseRootSegment(){return this.consumeOptional(\"/\"),\"\"===this.remaining||this.peekStartsWith(\"?\")||this.peekStartsWith(\"#\")?new UrlSegmentGroup([],{}):new UrlSegmentGroup([],this.parseChildren())}parseQueryParams(){const params={};if(this.consumeOptional(\"?\"))do{this.parseQueryParam(params)}while(this.consumeOptional(\"&\"));return params}parseFragment(){return this.consumeOptional(\"#\")?decodeURIComponent(this.remaining):null}parseChildren(){if(\"\"===this.remaining)return{};this.consumeOptional(\"/\");const segments=[];for(this.peekStartsWith(\"(\")||segments.push(this.parseSegment());this.peekStartsWith(\"/\")&&!this.peekStartsWith(\"//\")&&!this.peekStartsWith(\"/(\");)this.capture(\"/\"),segments.push(this.parseSegment());let children={};this.peekStartsWith(\"/(\")&&(this.capture(\"/\"),children=this.parseParens(!0));let res={};return this.peekStartsWith(\"(\")&&(res=this.parseParens(!1)),(segments.length>0||Object.keys(children).length>0)&&(res.primary=new UrlSegmentGroup(segments,children)),res}parseSegment(){const path=matchSegments(this.remaining);if(\"\"===path&&this.peekStartsWith(\";\"))throw new Error(`Empty path url segment cannot have parameters: '${this.remaining}'.`);return this.capture(path),new UrlSegment(decode(path),this.parseMatrixParams())}parseMatrixParams(){const params={};for(;this.consumeOptional(\";\");)this.parseParam(params);return params}parseParam(params){const key=matchSegments(this.remaining);if(!key)return;this.capture(key);let value=\"\";if(this.consumeOptional(\"=\")){const valueMatch=matchSegments(this.remaining);valueMatch&&(value=valueMatch,this.capture(value))}params[decode(key)]=decode(value)}parseQueryParam(params){const key=function(str){const match=str.match(QUERY_PARAM_RE);return match?match[0]:\"\"}(this.remaining);if(!key)return;this.capture(key);let value=\"\";if(this.consumeOptional(\"=\")){const valueMatch=function(str){const match=str.match(QUERY_PARAM_VALUE_RE);return match?match[0]:\"\"}(this.remaining);valueMatch&&(value=valueMatch,this.capture(value))}const decodedKey=decodeQuery(key),decodedVal=decodeQuery(value);if(params.hasOwnProperty(decodedKey)){let currentVal=params[decodedKey];Array.isArray(currentVal)||(currentVal=[currentVal],params[decodedKey]=currentVal),currentVal.push(decodedVal)}else params[decodedKey]=decodedVal}parseParens(allowPrimary){const segments={};for(this.capture(\"(\");!this.consumeOptional(\")\")&&this.remaining.length>0;){const path=matchSegments(this.remaining),next=this.remaining[path.length];if(\"/\"!==next&&\")\"!==next&&\";\"!==next)throw new Error(`Cannot parse url '${this.url}'`);let outletName=void 0;path.indexOf(\":\")>-1?(outletName=path.substr(0,path.indexOf(\":\")),this.capture(outletName),this.capture(\":\")):allowPrimary&&(outletName=\"primary\");const children=this.parseChildren();segments[outletName]=1===Object.keys(children).length?children.primary:new UrlSegmentGroup([],children),this.consumeOptional(\"//\")}return segments}peekStartsWith(str){return this.remaining.startsWith(str)}consumeOptional(str){return!!this.peekStartsWith(str)&&(this.remaining=this.remaining.substring(str.length),!0)}capture(str){if(!this.consumeOptional(str))throw new Error(`Expected \"${str}\".`)}}class Tree{constructor(root){this._root=root}get root(){return this._root.value}parent(t){const p=this.pathFromRoot(t);return p.length>1?p[p.length-2]:null}children(t){const n=findNode(t,this._root);return n?n.children.map(t=>t.value):[]}firstChild(t){const n=findNode(t,this._root);return n&&n.children.length>0?n.children[0].value:null}siblings(t){const p=findPath(t,this._root);return p.length<2?[]:p[p.length-2].children.map(c=>c.value).filter(cc=>cc!==t)}pathFromRoot(t){return findPath(t,this._root).map(s=>s.value)}}function findNode(value,node){if(value===node.value)return node;for(const child of node.children){const node=findNode(value,child);if(node)return node}return null}function findPath(value,node){if(value===node.value)return[node];for(const child of node.children){const path=findPath(value,child);if(path.length)return path.unshift(node),path}return[]}class TreeNode{constructor(value,children){this.value=value,this.children=children}toString(){return`TreeNode(${this.value})`}}function nodeChildrenAsMap(node){const map={};return node&&node.children.forEach(child=>map[child.value.outlet]=child),map}class RouterState extends Tree{constructor(root,snapshot){super(root),this.snapshot=snapshot,setRouterState(this,root)}toString(){return this.snapshot.toString()}}function createEmptyState(urlTree,rootComponent){const snapshot=function(urlTree,rootComponent){const activated=new ActivatedRouteSnapshot([],{},{},\"\",{},\"primary\",rootComponent,null,urlTree.root,-1,{});return new RouterStateSnapshot(\"\",new TreeNode(activated,[]))}(urlTree,rootComponent),emptyUrl=new BehaviorSubject_BehaviorSubject([new UrlSegment(\"\",{})]),emptyParams=new BehaviorSubject_BehaviorSubject({}),emptyData=new BehaviorSubject_BehaviorSubject({}),emptyQueryParams=new BehaviorSubject_BehaviorSubject({}),fragment=new BehaviorSubject_BehaviorSubject(\"\"),activated=new router_ActivatedRoute(emptyUrl,emptyParams,emptyQueryParams,fragment,emptyData,\"primary\",rootComponent,snapshot.root);return activated.snapshot=snapshot.root,new RouterState(new TreeNode(activated,[]),snapshot)}class router_ActivatedRoute{constructor(url,params,queryParams,fragment,data,outlet,component,futureSnapshot){this.url=url,this.params=params,this.queryParams=queryParams,this.fragment=fragment,this.data=data,this.outlet=outlet,this.component=component,this._futureSnapshot=futureSnapshot}get routeConfig(){return this._futureSnapshot.routeConfig}get root(){return this._routerState.root}get parent(){return this._routerState.parent(this)}get firstChild(){return this._routerState.firstChild(this)}get children(){return this._routerState.children(this)}get pathFromRoot(){return this._routerState.pathFromRoot(this)}get paramMap(){return this._paramMap||(this._paramMap=this.params.pipe(map(p=>convertToParamMap(p)))),this._paramMap}get queryParamMap(){return this._queryParamMap||(this._queryParamMap=this.queryParams.pipe(map(p=>convertToParamMap(p)))),this._queryParamMap}toString(){return this.snapshot?this.snapshot.toString():`Future(${this._futureSnapshot})`}}function inheritedParamsDataResolve(route,paramsInheritanceStrategy=\"emptyOnly\"){const pathFromRoot=route.pathFromRoot;let inheritingStartingFrom=0;if(\"always\"!==paramsInheritanceStrategy)for(inheritingStartingFrom=pathFromRoot.length-1;inheritingStartingFrom>=1;){const current=pathFromRoot[inheritingStartingFrom],parent=pathFromRoot[inheritingStartingFrom-1];if(current.routeConfig&&\"\"===current.routeConfig.path)inheritingStartingFrom--;else{if(parent.component)break;inheritingStartingFrom--}}return function(pathFromRoot){return pathFromRoot.reduce((res,curr)=>({params:Object.assign(Object.assign({},res.params),curr.params),data:Object.assign(Object.assign({},res.data),curr.data),resolve:Object.assign(Object.assign({},res.resolve),curr._resolvedData)}),{params:{},data:{},resolve:{}})}(pathFromRoot.slice(inheritingStartingFrom))}class ActivatedRouteSnapshot{constructor(url,params,queryParams,fragment,data,outlet,component,routeConfig,urlSegment,lastPathIndex,resolve){this.url=url,this.params=params,this.queryParams=queryParams,this.fragment=fragment,this.data=data,this.outlet=outlet,this.component=component,this.routeConfig=routeConfig,this._urlSegment=urlSegment,this._lastPathIndex=lastPathIndex,this._resolve=resolve}get root(){return this._routerState.root}get parent(){return this._routerState.parent(this)}get firstChild(){return this._routerState.firstChild(this)}get children(){return this._routerState.children(this)}get pathFromRoot(){return this._routerState.pathFromRoot(this)}get paramMap(){return this._paramMap||(this._paramMap=convertToParamMap(this.params)),this._paramMap}get queryParamMap(){return this._queryParamMap||(this._queryParamMap=convertToParamMap(this.queryParams)),this._queryParamMap}toString(){return`Route(url:'${this.url.map(segment=>segment.toString()).join(\"/\")}', path:'${this.routeConfig?this.routeConfig.path:\"\"}')`}}class RouterStateSnapshot extends Tree{constructor(url,root){super(root),this.url=url,setRouterState(this,root)}toString(){return serializeNode(this._root)}}function setRouterState(state,node){node.value._routerState=state,node.children.forEach(c=>setRouterState(state,c))}function serializeNode(node){const c=node.children.length>0?` { ${node.children.map(serializeNode).join(\", \")} } `:\"\";return`${node.value}${c}`}function advanceActivatedRoute(route){if(route.snapshot){const currentSnapshot=route.snapshot,nextSnapshot=route._futureSnapshot;route.snapshot=nextSnapshot,shallowEqual(currentSnapshot.queryParams,nextSnapshot.queryParams)||route.queryParams.next(nextSnapshot.queryParams),currentSnapshot.fragment!==nextSnapshot.fragment&&route.fragment.next(nextSnapshot.fragment),shallowEqual(currentSnapshot.params,nextSnapshot.params)||route.params.next(nextSnapshot.params),function(a,b){if(a.length!==b.length)return!1;for(let i=0;i<a.length;++i)if(!shallowEqual(a[i],b[i]))return!1;return!0}(currentSnapshot.url,nextSnapshot.url)||route.url.next(nextSnapshot.url),shallowEqual(currentSnapshot.data,nextSnapshot.data)||route.data.next(nextSnapshot.data)}else route.snapshot=route._futureSnapshot,route.data.next(route._futureSnapshot.data)}function equalParamsAndUrlSegments(a,b){var as,bs;return shallowEqual(a.params,b.params)&&equalPath(as=a.url,bs=b.url)&&as.every((a,i)=>shallowEqual(a.parameters,bs[i].parameters))&&!(!a.parent!=!b.parent)&&(!a.parent||equalParamsAndUrlSegments(a.parent,b.parent))}function isMatrixParams(command){return\"object\"==typeof command&&null!=command&&!command.outlets&&!command.segmentPath}function router_tree(oldSegmentGroup,newSegmentGroup,urlTree,queryParams,fragment){let qp={};return queryParams&&forEach(queryParams,(value,name)=>{qp[name]=Array.isArray(value)?value.map(v=>\"\"+v):\"\"+value}),new UrlTree(urlTree.root===oldSegmentGroup?newSegmentGroup:function replaceSegment(current,oldSegment,newSegment){const children={};return forEach(current.children,(c,outletName)=>{children[outletName]=c===oldSegment?newSegment:replaceSegment(c,oldSegment,newSegment)}),new UrlSegmentGroup(current.segments,children)}(urlTree.root,oldSegmentGroup,newSegmentGroup),qp,fragment)}class Navigation{constructor(isAbsolute,numberOfDoubleDots,commands){if(this.isAbsolute=isAbsolute,this.numberOfDoubleDots=numberOfDoubleDots,this.commands=commands,isAbsolute&&commands.length>0&&isMatrixParams(commands[0]))throw new Error(\"Root segment cannot have matrix parameters\");const cmdWithOutlet=commands.find(c=>\"object\"==typeof c&&null!=c&&c.outlets);if(cmdWithOutlet&&cmdWithOutlet!==router_last(commands))throw new Error(\"{outlets:{}} has to be the last command\")}toRoot(){return this.isAbsolute&&1===this.commands.length&&\"/\"==this.commands[0]}}class Position{constructor(segmentGroup,processChildren,index){this.segmentGroup=segmentGroup,this.processChildren=processChildren,this.index=index}}function getPath(command){return\"object\"==typeof command&&null!=command&&command.outlets?command.outlets.primary:\"\"+command}function updateSegmentGroup(segmentGroup,startIndex,commands){if(segmentGroup||(segmentGroup=new UrlSegmentGroup([],{})),0===segmentGroup.segments.length&&segmentGroup.hasChildren())return updateSegmentGroupChildren(segmentGroup,startIndex,commands);const m=function(segmentGroup,startIndex,commands){let currentCommandIndex=0,currentPathIndex=startIndex;const noMatch={match:!1,pathIndex:0,commandIndex:0};for(;currentPathIndex<segmentGroup.segments.length;){if(currentCommandIndex>=commands.length)return noMatch;const path=segmentGroup.segments[currentPathIndex],curr=getPath(commands[currentCommandIndex]),next=currentCommandIndex<commands.length-1?commands[currentCommandIndex+1]:null;if(currentPathIndex>0&&void 0===curr)break;if(curr&&next&&\"object\"==typeof next&&void 0===next.outlets){if(!compare(curr,next,path))return noMatch;currentCommandIndex+=2}else{if(!compare(curr,{},path))return noMatch;currentCommandIndex++}currentPathIndex++}return{match:!0,pathIndex:currentPathIndex,commandIndex:currentCommandIndex}}(segmentGroup,startIndex,commands),slicedCommands=commands.slice(m.commandIndex);if(m.match&&m.pathIndex<segmentGroup.segments.length){const g=new UrlSegmentGroup(segmentGroup.segments.slice(0,m.pathIndex),{});return g.children.primary=new UrlSegmentGroup(segmentGroup.segments.slice(m.pathIndex),segmentGroup.children),updateSegmentGroupChildren(g,0,slicedCommands)}return m.match&&0===slicedCommands.length?new UrlSegmentGroup(segmentGroup.segments,{}):m.match&&!segmentGroup.hasChildren()?createNewSegmentGroup(segmentGroup,startIndex,commands):m.match?updateSegmentGroupChildren(segmentGroup,0,slicedCommands):createNewSegmentGroup(segmentGroup,startIndex,commands)}function updateSegmentGroupChildren(segmentGroup,startIndex,commands){if(0===commands.length)return new UrlSegmentGroup(segmentGroup.segments,{});{const outlets=function(commands){return\"object\"!=typeof commands[0]||void 0===commands[0].outlets?{primary:commands}:commands[0].outlets}(commands),children={};return forEach(outlets,(commands,outlet)=>{null!==commands&&(children[outlet]=updateSegmentGroup(segmentGroup.children[outlet],startIndex,commands))}),forEach(segmentGroup.children,(child,childOutlet)=>{void 0===outlets[childOutlet]&&(children[childOutlet]=child)}),new UrlSegmentGroup(segmentGroup.segments,children)}}function createNewSegmentGroup(segmentGroup,startIndex,commands){const paths=segmentGroup.segments.slice(0,startIndex);let i=0;for(;i<commands.length;){if(\"object\"==typeof commands[i]&&void 0!==commands[i].outlets){const children=createNewSegmentChildren(commands[i].outlets);return new UrlSegmentGroup(paths,children)}if(0===i&&isMatrixParams(commands[0])){paths.push(new UrlSegment(segmentGroup.segments[startIndex].path,commands[0])),i++;continue}const curr=getPath(commands[i]),next=i<commands.length-1?commands[i+1]:null;curr&&next&&isMatrixParams(next)?(paths.push(new UrlSegment(curr,router_stringify(next))),i+=2):(paths.push(new UrlSegment(curr,{})),i++)}return new UrlSegmentGroup(paths,{})}function createNewSegmentChildren(outlets){const children={};return forEach(outlets,(commands,outlet)=>{null!==commands&&(children[outlet]=createNewSegmentGroup(new UrlSegmentGroup([],{}),0,commands))}),children}function router_stringify(params){const res={};return forEach(params,(v,k)=>res[k]=\"\"+v),res}function compare(path,params,segment){return path==segment.path&&shallowEqual(params,segment.parameters)}class ActivateRoutes{constructor(routeReuseStrategy,futureState,currState,forwardEvent){this.routeReuseStrategy=routeReuseStrategy,this.futureState=futureState,this.currState=currState,this.forwardEvent=forwardEvent}activate(parentContexts){const futureRoot=this.futureState._root,currRoot=this.currState?this.currState._root:null;this.deactivateChildRoutes(futureRoot,currRoot,parentContexts),advanceActivatedRoute(this.futureState.root),this.activateChildRoutes(futureRoot,currRoot,parentContexts)}deactivateChildRoutes(futureNode,currNode,contexts){const children=nodeChildrenAsMap(currNode);futureNode.children.forEach(futureChild=>{const childOutletName=futureChild.value.outlet;this.deactivateRoutes(futureChild,children[childOutletName],contexts),delete children[childOutletName]}),forEach(children,(v,childName)=>{this.deactivateRouteAndItsChildren(v,contexts)})}deactivateRoutes(futureNode,currNode,parentContext){const future=futureNode.value,curr=currNode?currNode.value:null;if(future===curr)if(future.component){const context=parentContext.getContext(future.outlet);context&&this.deactivateChildRoutes(futureNode,currNode,context.children)}else this.deactivateChildRoutes(futureNode,currNode,parentContext);else curr&&this.deactivateRouteAndItsChildren(currNode,parentContext)}deactivateRouteAndItsChildren(route,parentContexts){this.routeReuseStrategy.shouldDetach(route.value.snapshot)?this.detachAndStoreRouteSubtree(route,parentContexts):this.deactivateRouteAndOutlet(route,parentContexts)}detachAndStoreRouteSubtree(route,parentContexts){const context=parentContexts.getContext(route.value.outlet);if(context&&context.outlet){const componentRef=context.outlet.detach(),contexts=context.children.onOutletDeactivated();this.routeReuseStrategy.store(route.value.snapshot,{componentRef:componentRef,route:route,contexts:contexts})}}deactivateRouteAndOutlet(route,parentContexts){const context=parentContexts.getContext(route.value.outlet);if(context){const children=nodeChildrenAsMap(route),contexts=route.value.component?context.children:parentContexts;forEach(children,(v,k)=>this.deactivateRouteAndItsChildren(v,contexts)),context.outlet&&(context.outlet.deactivate(),context.children.onOutletDeactivated())}}activateChildRoutes(futureNode,currNode,contexts){const children=nodeChildrenAsMap(currNode);futureNode.children.forEach(c=>{this.activateRoutes(c,children[c.value.outlet],contexts),this.forwardEvent(new ActivationEnd(c.value.snapshot))}),futureNode.children.length&&this.forwardEvent(new ChildActivationEnd(futureNode.value.snapshot))}activateRoutes(futureNode,currNode,parentContexts){const future=futureNode.value,curr=currNode?currNode.value:null;if(advanceActivatedRoute(future),future===curr)if(future.component){const context=parentContexts.getOrCreateContext(future.outlet);this.activateChildRoutes(futureNode,currNode,context.children)}else this.activateChildRoutes(futureNode,currNode,parentContexts);else if(future.component){const context=parentContexts.getOrCreateContext(future.outlet);if(this.routeReuseStrategy.shouldAttach(future.snapshot)){const stored=this.routeReuseStrategy.retrieve(future.snapshot);this.routeReuseStrategy.store(future.snapshot,null),context.children.onOutletReAttached(stored.contexts),context.attachRef=stored.componentRef,context.route=stored.route.value,context.outlet&&context.outlet.attach(stored.componentRef,stored.route.value),advanceActivatedRouteNodeAndItsChildren(stored.route)}else{const config=function(snapshot){for(let s=snapshot.parent;s;s=s.parent){const route=s.routeConfig;if(route&&route._loadedConfig)return route._loadedConfig;if(route&&route.component)return null}return null}(future.snapshot),cmpFactoryResolver=config?config.module.componentFactoryResolver:null;context.attachRef=null,context.route=future,context.resolver=cmpFactoryResolver,context.outlet&&context.outlet.activateWith(future,cmpFactoryResolver),this.activateChildRoutes(futureNode,null,context.children)}}else this.activateChildRoutes(futureNode,null,parentContexts)}}function advanceActivatedRouteNodeAndItsChildren(node){advanceActivatedRoute(node.value),node.children.forEach(advanceActivatedRouteNodeAndItsChildren)}function router_isFunction(v){return\"function\"==typeof v}function isUrlTree(v){return v instanceof UrlTree}class NoMatch{constructor(segmentGroup){this.segmentGroup=segmentGroup||null}}class AbsoluteRedirect{constructor(urlTree){this.urlTree=urlTree}}function noMatch(segmentGroup){return new Observable_Observable(obs=>obs.error(new NoMatch(segmentGroup)))}function absoluteRedirect(newTree){return new Observable_Observable(obs=>obs.error(new AbsoluteRedirect(newTree)))}function namedOutletsRedirect(redirectTo){return new Observable_Observable(obs=>obs.error(new Error(`Only absolute redirects can have named outlets. redirectTo: '${redirectTo}'`)))}class router_ApplyRedirects{constructor(moduleInjector,configLoader,urlSerializer,urlTree,config){this.configLoader=configLoader,this.urlSerializer=urlSerializer,this.urlTree=urlTree,this.config=config,this.allowRedirects=!0,this.ngModule=moduleInjector.get(NgModuleRef)}apply(){return this.expandSegmentGroup(this.ngModule,this.config,this.urlTree.root,\"primary\").pipe(map(rootSegmentGroup=>this.createUrlTree(rootSegmentGroup,this.urlTree.queryParams,this.urlTree.fragment))).pipe(catchError(e=>{if(e instanceof AbsoluteRedirect)return this.allowRedirects=!1,this.match(e.urlTree);if(e instanceof NoMatch)throw this.noMatchError(e);throw e}))}match(tree){return this.expandSegmentGroup(this.ngModule,this.config,tree.root,\"primary\").pipe(map(rootSegmentGroup=>this.createUrlTree(rootSegmentGroup,tree.queryParams,tree.fragment))).pipe(catchError(e=>{if(e instanceof NoMatch)throw this.noMatchError(e);throw e}))}noMatchError(e){return new Error(`Cannot match any routes. URL Segment: '${e.segmentGroup}'`)}createUrlTree(rootCandidate,queryParams,fragment){const root=rootCandidate.segments.length>0?new UrlSegmentGroup([],{primary:rootCandidate}):rootCandidate;return new UrlTree(root,queryParams,fragment)}expandSegmentGroup(ngModule,routes,segmentGroup,outlet){return 0===segmentGroup.segments.length&&segmentGroup.hasChildren()?this.expandChildren(ngModule,routes,segmentGroup).pipe(map(children=>new UrlSegmentGroup([],children))):this.expandSegment(ngModule,segmentGroup,routes,segmentGroup.segments,outlet,!0)}expandChildren(ngModule,routes,segmentGroup){return function(obj,fn){if(0===Object.keys(obj).length)return of({});const waitHead=[],waitTail=[],res={};return forEach(obj,(a,k)=>{const mapped=fn(k,a).pipe(map(r=>res[k]=r));\"primary\"===k?waitHead.push(mapped):waitTail.push(mapped)}),of.apply(null,waitHead.concat(waitTail)).pipe(concatAll(),last_last(),map(()=>res))}(segmentGroup.children,(childOutlet,child)=>this.expandSegmentGroup(ngModule,routes,child,childOutlet))}expandSegment(ngModule,segmentGroup,routes,segments,outlet,allowRedirects){return of(...routes).pipe(map(r=>this.expandSegmentAgainstRoute(ngModule,segmentGroup,routes,r,segments,outlet,allowRedirects).pipe(catchError(e=>{if(e instanceof NoMatch)return of(null);throw e}))),concatAll(),first_first(s=>!!s),catchError((e,_)=>{if(e instanceof EmptyError||\"EmptyError\"===e.name){if(this.noLeftoversInUrl(segmentGroup,segments,outlet))return of(new UrlSegmentGroup([],{}));throw new NoMatch(segmentGroup)}throw e}))}noLeftoversInUrl(segmentGroup,segments,outlet){return 0===segments.length&&!segmentGroup.children[outlet]}expandSegmentAgainstRoute(ngModule,segmentGroup,routes,route,paths,outlet,allowRedirects){return getOutlet(route)!==outlet?noMatch(segmentGroup):void 0===route.redirectTo?this.matchSegmentAgainstRoute(ngModule,segmentGroup,route,paths):allowRedirects&&this.allowRedirects?this.expandSegmentAgainstRouteUsingRedirect(ngModule,segmentGroup,routes,route,paths,outlet):noMatch(segmentGroup)}expandSegmentAgainstRouteUsingRedirect(ngModule,segmentGroup,routes,route,segments,outlet){return\"**\"===route.path?this.expandWildCardWithParamsAgainstRouteUsingRedirect(ngModule,routes,route,outlet):this.expandRegularSegmentAgainstRouteUsingRedirect(ngModule,segmentGroup,routes,route,segments,outlet)}expandWildCardWithParamsAgainstRouteUsingRedirect(ngModule,routes,route,outlet){const newTree=this.applyRedirectCommands([],route.redirectTo,{});return route.redirectTo.startsWith(\"/\")?absoluteRedirect(newTree):this.lineralizeSegments(route,newTree).pipe(mergeMap(newSegments=>{const group=new UrlSegmentGroup(newSegments,{});return this.expandSegment(ngModule,group,routes,newSegments,outlet,!1)}))}expandRegularSegmentAgainstRouteUsingRedirect(ngModule,segmentGroup,routes,route,segments,outlet){const{matched:matched,consumedSegments:consumedSegments,lastChild:lastChild,positionalParamSegments:positionalParamSegments}=match(segmentGroup,route,segments);if(!matched)return noMatch(segmentGroup);const newTree=this.applyRedirectCommands(consumedSegments,route.redirectTo,positionalParamSegments);return route.redirectTo.startsWith(\"/\")?absoluteRedirect(newTree):this.lineralizeSegments(route,newTree).pipe(mergeMap(newSegments=>this.expandSegment(ngModule,segmentGroup,routes,newSegments.concat(segments.slice(lastChild)),outlet,!1)))}matchSegmentAgainstRoute(ngModule,rawSegmentGroup,route,segments){if(\"**\"===route.path)return route.loadChildren?this.configLoader.load(ngModule.injector,route).pipe(map(cfg=>(route._loadedConfig=cfg,new UrlSegmentGroup(segments,{})))):of(new UrlSegmentGroup(segments,{}));const{matched:matched,consumedSegments:consumedSegments,lastChild:lastChild}=match(rawSegmentGroup,route,segments);if(!matched)return noMatch(rawSegmentGroup);const rawSlicedSegments=segments.slice(lastChild);return this.getChildConfig(ngModule,route,segments).pipe(mergeMap(routerConfig=>{const childModule=routerConfig.module,childConfig=routerConfig.routes,{segmentGroup:segmentGroup,slicedSegments:slicedSegments}=function(segmentGroup,consumedSegments,slicedSegments,config){return slicedSegments.length>0&&function(segmentGroup,segments,routes){return routes.some(r=>isEmptyPathRedirect(segmentGroup,segments,r)&&\"primary\"!==getOutlet(r))}(segmentGroup,slicedSegments,config)?{segmentGroup:mergeTrivialChildren(new UrlSegmentGroup(consumedSegments,function(routes,primarySegmentGroup){const res={};res.primary=primarySegmentGroup;for(const r of routes)\"\"===r.path&&\"primary\"!==getOutlet(r)&&(res[getOutlet(r)]=new UrlSegmentGroup([],{}));return res}(config,new UrlSegmentGroup(slicedSegments,segmentGroup.children)))),slicedSegments:[]}:0===slicedSegments.length&&function(segmentGroup,segments,routes){return routes.some(r=>isEmptyPathRedirect(segmentGroup,segments,r))}(segmentGroup,slicedSegments,config)?{segmentGroup:mergeTrivialChildren(new UrlSegmentGroup(segmentGroup.segments,function(segmentGroup,slicedSegments,routes,children){const res={};for(const r of routes)isEmptyPathRedirect(segmentGroup,slicedSegments,r)&&!children[getOutlet(r)]&&(res[getOutlet(r)]=new UrlSegmentGroup([],{}));return Object.assign(Object.assign({},children),res)}(segmentGroup,slicedSegments,config,segmentGroup.children))),slicedSegments:slicedSegments}:{segmentGroup:segmentGroup,slicedSegments:slicedSegments}}(rawSegmentGroup,consumedSegments,rawSlicedSegments,childConfig);return 0===slicedSegments.length&&segmentGroup.hasChildren()?this.expandChildren(childModule,childConfig,segmentGroup).pipe(map(children=>new UrlSegmentGroup(consumedSegments,children))):0===childConfig.length&&0===slicedSegments.length?of(new UrlSegmentGroup(consumedSegments,{})):this.expandSegment(childModule,segmentGroup,childConfig,slicedSegments,\"primary\",!0).pipe(map(cs=>new UrlSegmentGroup(consumedSegments.concat(cs.segments),cs.children)))}))}getChildConfig(ngModule,route,segments){return route.children?of(new LoadedRouterConfig(route.children,ngModule)):route.loadChildren?void 0!==route._loadedConfig?of(route._loadedConfig):function(moduleInjector,route,segments){const canLoad=route.canLoad;return canLoad&&0!==canLoad.length?from(canLoad).pipe(map(injectionToken=>{const guard=moduleInjector.get(injectionToken);let guardVal;if(function(guard){return guard&&router_isFunction(guard.canLoad)}(guard))guardVal=guard.canLoad(route,segments);else{if(!router_isFunction(guard))throw new Error(\"Invalid CanLoad guard\");guardVal=guard(route,segments)}return wrapIntoObservable(guardVal)})).pipe(concatAll(),(predicate=result=>!0===result,source=>source.lift(new EveryOperator(predicate,void 0,source)))):of(!0);var predicate}(ngModule.injector,route,segments).pipe(mergeMap(shouldLoad=>shouldLoad?this.configLoader.load(ngModule.injector,route).pipe(map(cfg=>(route._loadedConfig=cfg,cfg))):function(route){return new Observable_Observable(obs=>obs.error(navigationCancelingError(`Cannot load children because the guard of the route \"path: '${route.path}'\" returned false`)))}(route))):of(new LoadedRouterConfig([],ngModule))}lineralizeSegments(route,urlTree){let res=[],c=urlTree.root;for(;;){if(res=res.concat(c.segments),0===c.numberOfChildren)return of(res);if(c.numberOfChildren>1||!c.children.primary)return namedOutletsRedirect(route.redirectTo);c=c.children.primary}}applyRedirectCommands(segments,redirectTo,posParams){return this.applyRedirectCreatreUrlTree(redirectTo,this.urlSerializer.parse(redirectTo),segments,posParams)}applyRedirectCreatreUrlTree(redirectTo,urlTree,segments,posParams){const newRoot=this.createSegmentGroup(redirectTo,urlTree.root,segments,posParams);return new UrlTree(newRoot,this.createQueryParams(urlTree.queryParams,this.urlTree.queryParams),urlTree.fragment)}createQueryParams(redirectToParams,actualParams){const res={};return forEach(redirectToParams,(v,k)=>{if(\"string\"==typeof v&&v.startsWith(\":\")){const sourceName=v.substring(1);res[k]=actualParams[sourceName]}else res[k]=v}),res}createSegmentGroup(redirectTo,group,segments,posParams){const updatedSegments=this.createSegments(redirectTo,group.segments,segments,posParams);let children={};return forEach(group.children,(child,name)=>{children[name]=this.createSegmentGroup(redirectTo,child,segments,posParams)}),new UrlSegmentGroup(updatedSegments,children)}createSegments(redirectTo,redirectToSegments,actualSegments,posParams){return redirectToSegments.map(s=>s.path.startsWith(\":\")?this.findPosParam(redirectTo,s,posParams):this.findOrReturn(s,actualSegments))}findPosParam(redirectTo,redirectToUrlSegment,posParams){const pos=posParams[redirectToUrlSegment.path.substring(1)];if(!pos)throw new Error(`Cannot redirect to '${redirectTo}'. Cannot find '${redirectToUrlSegment.path}'.`);return pos}findOrReturn(redirectToUrlSegment,actualSegments){let idx=0;for(const s of actualSegments){if(s.path===redirectToUrlSegment.path)return actualSegments.splice(idx),s;idx++}return redirectToUrlSegment}}function match(segmentGroup,route,segments){if(\"\"===route.path)return\"full\"===route.pathMatch&&(segmentGroup.hasChildren()||segments.length>0)?{matched:!1,consumedSegments:[],lastChild:0,positionalParamSegments:{}}:{matched:!0,consumedSegments:[],lastChild:0,positionalParamSegments:{}};const res=(route.matcher||defaultUrlMatcher)(segments,segmentGroup,route);return res?{matched:!0,consumedSegments:res.consumed,lastChild:res.consumed.length,positionalParamSegments:res.posParams}:{matched:!1,consumedSegments:[],lastChild:0,positionalParamSegments:{}}}function mergeTrivialChildren(s){if(1===s.numberOfChildren&&s.children.primary){const c=s.children.primary;return new UrlSegmentGroup(s.segments.concat(c.segments),c.children)}return s}function isEmptyPathRedirect(segmentGroup,segments,r){return(!(segmentGroup.hasChildren()||segments.length>0)||\"full\"!==r.pathMatch)&&\"\"===r.path&&void 0!==r.redirectTo}function getOutlet(route){return route.outlet||\"primary\"}class CanActivate{constructor(path){this.path=path,this.route=this.path[this.path.length-1]}}class CanDeactivate{constructor(component,route){this.component=component,this.route=route}}function getAllRouteGuards(future,curr,parentContexts){const futureRoot=future._root;return function getChildRouteGuards(futureNode,currNode,contexts,futurePath,checks={canDeactivateChecks:[],canActivateChecks:[]}){const prevChildren=nodeChildrenAsMap(currNode);return futureNode.children.forEach(c=>{!function(futureNode,currNode,parentContexts,futurePath,checks={canDeactivateChecks:[],canActivateChecks:[]}){const future=futureNode.value,curr=currNode?currNode.value:null,context=parentContexts?parentContexts.getContext(futureNode.value.outlet):null;if(curr&&future.routeConfig===curr.routeConfig){const shouldRun=function(curr,future,mode){if(\"function\"==typeof mode)return mode(curr,future);switch(mode){case\"pathParamsChange\":return!equalPath(curr.url,future.url);case\"pathParamsOrQueryParamsChange\":return!equalPath(curr.url,future.url)||!shallowEqual(curr.queryParams,future.queryParams);case\"always\":return!0;case\"paramsOrQueryParamsChange\":return!equalParamsAndUrlSegments(curr,future)||!shallowEqual(curr.queryParams,future.queryParams);case\"paramsChange\":default:return!equalParamsAndUrlSegments(curr,future)}}(curr,future,future.routeConfig.runGuardsAndResolvers);shouldRun?checks.canActivateChecks.push(new CanActivate(futurePath)):(future.data=curr.data,future._resolvedData=curr._resolvedData),getChildRouteGuards(futureNode,currNode,future.component?context?context.children:null:parentContexts,futurePath,checks),shouldRun&&checks.canDeactivateChecks.push(new CanDeactivate(context&&context.outlet&&context.outlet.component||null,curr))}else curr&&deactivateRouteAndItsChildren(currNode,context,checks),checks.canActivateChecks.push(new CanActivate(futurePath)),getChildRouteGuards(futureNode,null,future.component?context?context.children:null:parentContexts,futurePath,checks)}(c,prevChildren[c.value.outlet],contexts,futurePath.concat([c.value]),checks),delete prevChildren[c.value.outlet]}),forEach(prevChildren,(v,k)=>deactivateRouteAndItsChildren(v,contexts.getContext(k),checks)),checks}(futureRoot,curr?curr._root:null,parentContexts,[futureRoot.value])}function getToken(token,snapshot,moduleInjector){const config=function(snapshot){if(!snapshot)return null;for(let s=snapshot.parent;s;s=s.parent){const route=s.routeConfig;if(route&&route._loadedConfig)return route._loadedConfig}return null}(snapshot);return(config?config.module.injector:moduleInjector).get(token)}function deactivateRouteAndItsChildren(route,context,checks){const children=nodeChildrenAsMap(route),r=route.value;forEach(children,(node,childName)=>{deactivateRouteAndItsChildren(node,r.component?context?context.children.getContext(childName):null:context,checks)}),checks.canDeactivateChecks.push(new CanDeactivate(r.component&&context&&context.outlet&&context.outlet.isActivated?context.outlet.component:null,r))}const INITIAL_VALUE=Symbol(\"INITIAL_VALUE\");function prioritizedGuardValue(){return switchMap(obs=>function(...observables){let resultSelector=null,scheduler=null;return isScheduler(observables[observables.length-1])&&(scheduler=observables.pop()),\"function\"==typeof observables[observables.length-1]&&(resultSelector=observables.pop()),1===observables.length&&isArray(observables[0])&&(observables=observables[0]),fromArray(observables,scheduler).lift(new CombineLatestOperator(resultSelector))}(...obs.map(o=>o.pipe(take(1),function(...array){const scheduler=array[array.length-1];return isScheduler(scheduler)?(array.pop(),source=>concat(array,source,scheduler)):source=>concat(array,source)}(INITIAL_VALUE)))).pipe(scan((acc,list)=>{let isPending=!1;return list.reduce((innerAcc,val,i)=>{if(innerAcc!==INITIAL_VALUE)return innerAcc;if(val===INITIAL_VALUE&&(isPending=!0),!isPending){if(!1===val)return val;if(i===list.length-1||isUrlTree(val))return val}return innerAcc},acc)},INITIAL_VALUE),filter(item=>item!==INITIAL_VALUE),map(item=>isUrlTree(item)?item:!0===item),take(1)))}function fireActivationStart(snapshot,forwardEvent){return null!==snapshot&&forwardEvent&&forwardEvent(new ActivationStart(snapshot)),of(!0)}function fireChildActivationStart(snapshot,forwardEvent){return null!==snapshot&&forwardEvent&&forwardEvent(new ChildActivationStart(snapshot)),of(!0)}function runCanActivate(futureRSS,futureARS,moduleInjector){const canActivate=futureARS.routeConfig?futureARS.routeConfig.canActivate:null;return canActivate&&0!==canActivate.length?of(canActivate.map(c=>defer(()=>{const guard=getToken(c,futureARS,moduleInjector);let observable;if(function(guard){return guard&&router_isFunction(guard.canActivate)}(guard))observable=wrapIntoObservable(guard.canActivate(futureARS,futureRSS));else{if(!router_isFunction(guard))throw new Error(\"Invalid CanActivate guard\");observable=wrapIntoObservable(guard(futureARS,futureRSS))}return observable.pipe(first_first())}))).pipe(prioritizedGuardValue()):of(!0)}function runCanActivateChild(futureRSS,path,moduleInjector){const futureARS=path[path.length-1],canActivateChildGuardsMapped=path.slice(0,path.length-1).reverse().map(p=>function(p){const canActivateChild=p.routeConfig?p.routeConfig.canActivateChild:null;return canActivateChild&&0!==canActivateChild.length?{node:p,guards:canActivateChild}:null}(p)).filter(_=>null!==_).map(d=>defer(()=>of(d.guards.map(c=>{const guard=getToken(c,d.node,moduleInjector);let observable;if(function(guard){return guard&&router_isFunction(guard.canActivateChild)}(guard))observable=wrapIntoObservable(guard.canActivateChild(futureARS,futureRSS));else{if(!router_isFunction(guard))throw new Error(\"Invalid CanActivateChild guard\");observable=wrapIntoObservable(guard(futureARS,futureRSS))}return observable.pipe(first_first())})).pipe(prioritizedGuardValue())));return of(canActivateChildGuardsMapped).pipe(prioritizedGuardValue())}class NoMatch$1{}class router_Recognizer{constructor(rootComponentType,config,urlTree,url,paramsInheritanceStrategy,relativeLinkResolution){this.rootComponentType=rootComponentType,this.config=config,this.urlTree=urlTree,this.url=url,this.paramsInheritanceStrategy=paramsInheritanceStrategy,this.relativeLinkResolution=relativeLinkResolution}recognize(){try{const rootSegmentGroup=split$1(this.urlTree.root,[],[],this.config,this.relativeLinkResolution).segmentGroup,children=this.processSegmentGroup(this.config,rootSegmentGroup,\"primary\"),root=new ActivatedRouteSnapshot([],Object.freeze({}),Object.freeze(Object.assign({},this.urlTree.queryParams)),this.urlTree.fragment,{},\"primary\",this.rootComponentType,null,this.urlTree.root,-1,{}),rootNode=new TreeNode(root,children),routeState=new RouterStateSnapshot(this.url,rootNode);return this.inheritParamsAndData(routeState._root),of(routeState)}catch(e){return new Observable_Observable(obs=>obs.error(e))}}inheritParamsAndData(routeNode){const route=routeNode.value,i=inheritedParamsDataResolve(route,this.paramsInheritanceStrategy);route.params=Object.freeze(i.params),route.data=Object.freeze(i.data),routeNode.children.forEach(n=>this.inheritParamsAndData(n))}processSegmentGroup(config,segmentGroup,outlet){return 0===segmentGroup.segments.length&&segmentGroup.hasChildren()?this.processChildren(config,segmentGroup):this.processSegment(config,segmentGroup,segmentGroup.segments,outlet)}processChildren(config,segmentGroup){const children=mapChildrenIntoArray(segmentGroup,(child,childOutlet)=>this.processSegmentGroup(config,child,childOutlet));return function(nodes){const names={};nodes.forEach(n=>{const routeWithSameOutletName=names[n.value.outlet];if(routeWithSameOutletName){const p=routeWithSameOutletName.url.map(s=>s.toString()).join(\"/\"),c=n.value.url.map(s=>s.toString()).join(\"/\");throw new Error(`Two segments cannot have the same outlet name: '${p}' and '${c}'.`)}names[n.value.outlet]=n.value})}(children),children.sort((a,b)=>\"primary\"===a.value.outlet?-1:\"primary\"===b.value.outlet?1:a.value.outlet.localeCompare(b.value.outlet)),children}processSegment(config,segmentGroup,segments,outlet){for(const r of config)try{return this.processSegmentAgainstRoute(r,segmentGroup,segments,outlet)}catch(e){if(!(e instanceof NoMatch$1))throw e}if(this.noLeftoversInUrl(segmentGroup,segments,outlet))return[];throw new NoMatch$1}noLeftoversInUrl(segmentGroup,segments,outlet){return 0===segments.length&&!segmentGroup.children[outlet]}processSegmentAgainstRoute(route,rawSegment,segments,outlet){if(route.redirectTo)throw new NoMatch$1;if((route.outlet||\"primary\")!==outlet)throw new NoMatch$1;let snapshot,consumedSegments=[],rawSlicedSegments=[];if(\"**\"===route.path){const params=segments.length>0?router_last(segments).parameters:{};snapshot=new ActivatedRouteSnapshot(segments,params,Object.freeze(Object.assign({},this.urlTree.queryParams)),this.urlTree.fragment,getData(route),outlet,route.component,route,getSourceSegmentGroup(rawSegment),getPathIndexShift(rawSegment)+segments.length,getResolve(route))}else{const result=function(segmentGroup,route,segments){if(\"\"===route.path){if(\"full\"===route.pathMatch&&(segmentGroup.hasChildren()||segments.length>0))throw new NoMatch$1;return{consumedSegments:[],lastChild:0,parameters:{}}}const res=(route.matcher||defaultUrlMatcher)(segments,segmentGroup,route);if(!res)throw new NoMatch$1;const posParams={};forEach(res.posParams,(v,k)=>{posParams[k]=v.path});const parameters=res.consumed.length>0?Object.assign(Object.assign({},posParams),res.consumed[res.consumed.length-1].parameters):posParams;return{consumedSegments:res.consumed,lastChild:res.consumed.length,parameters:parameters}}(rawSegment,route,segments);consumedSegments=result.consumedSegments,rawSlicedSegments=segments.slice(result.lastChild),snapshot=new ActivatedRouteSnapshot(consumedSegments,result.parameters,Object.freeze(Object.assign({},this.urlTree.queryParams)),this.urlTree.fragment,getData(route),outlet,route.component,route,getSourceSegmentGroup(rawSegment),getPathIndexShift(rawSegment)+consumedSegments.length,getResolve(route))}const childConfig=function(route){return route.children?route.children:route.loadChildren?route._loadedConfig.routes:[]}(route),{segmentGroup:segmentGroup,slicedSegments:slicedSegments}=split$1(rawSegment,consumedSegments,rawSlicedSegments,childConfig,this.relativeLinkResolution);if(0===slicedSegments.length&&segmentGroup.hasChildren()){const children=this.processChildren(childConfig,segmentGroup);return[new TreeNode(snapshot,children)]}if(0===childConfig.length&&0===slicedSegments.length)return[new TreeNode(snapshot,[])];const children=this.processSegment(childConfig,segmentGroup,slicedSegments,\"primary\");return[new TreeNode(snapshot,children)]}}function getSourceSegmentGroup(segmentGroup){let s=segmentGroup;for(;s._sourceSegment;)s=s._sourceSegment;return s}function getPathIndexShift(segmentGroup){let s=segmentGroup,res=s._segmentIndexShift?s._segmentIndexShift:0;for(;s._sourceSegment;)s=s._sourceSegment,res+=s._segmentIndexShift?s._segmentIndexShift:0;return res-1}function split$1(segmentGroup,consumedSegments,slicedSegments,config,relativeLinkResolution){if(slicedSegments.length>0&&function(segmentGroup,slicedSegments,routes){return routes.some(r=>emptyPathMatch(segmentGroup,slicedSegments,r)&&\"primary\"!==getOutlet$1(r))}(segmentGroup,slicedSegments,config)){const s=new UrlSegmentGroup(consumedSegments,function(segmentGroup,consumedSegments,routes,primarySegment){const res={};res.primary=primarySegment,primarySegment._sourceSegment=segmentGroup,primarySegment._segmentIndexShift=consumedSegments.length;for(const r of routes)if(\"\"===r.path&&\"primary\"!==getOutlet$1(r)){const s=new UrlSegmentGroup([],{});s._sourceSegment=segmentGroup,s._segmentIndexShift=consumedSegments.length,res[getOutlet$1(r)]=s}return res}(segmentGroup,consumedSegments,config,new UrlSegmentGroup(slicedSegments,segmentGroup.children)));return s._sourceSegment=segmentGroup,s._segmentIndexShift=consumedSegments.length,{segmentGroup:s,slicedSegments:[]}}if(0===slicedSegments.length&&function(segmentGroup,slicedSegments,routes){return routes.some(r=>emptyPathMatch(segmentGroup,slicedSegments,r))}(segmentGroup,slicedSegments,config)){const s=new UrlSegmentGroup(segmentGroup.segments,function(segmentGroup,consumedSegments,slicedSegments,routes,children,relativeLinkResolution){const res={};for(const r of routes)if(emptyPathMatch(segmentGroup,slicedSegments,r)&&!children[getOutlet$1(r)]){const s=new UrlSegmentGroup([],{});s._sourceSegment=segmentGroup,s._segmentIndexShift=\"legacy\"===relativeLinkResolution?segmentGroup.segments.length:consumedSegments.length,res[getOutlet$1(r)]=s}return Object.assign(Object.assign({},children),res)}(segmentGroup,consumedSegments,slicedSegments,config,segmentGroup.children,relativeLinkResolution));return s._sourceSegment=segmentGroup,s._segmentIndexShift=consumedSegments.length,{segmentGroup:s,slicedSegments:slicedSegments}}const s=new UrlSegmentGroup(segmentGroup.segments,segmentGroup.children);return s._sourceSegment=segmentGroup,s._segmentIndexShift=consumedSegments.length,{segmentGroup:s,slicedSegments:slicedSegments}}function emptyPathMatch(segmentGroup,slicedSegments,r){return(!(segmentGroup.hasChildren()||slicedSegments.length>0)||\"full\"!==r.pathMatch)&&\"\"===r.path&&void 0===r.redirectTo}function getOutlet$1(route){return route.outlet||\"primary\"}function getData(route){return route.data||{}}function getResolve(route){return route.resolve||{}}function getResolver(injectionToken,futureARS,futureRSS,moduleInjector){const resolver=getToken(injectionToken,futureARS,moduleInjector);return wrapIntoObservable(resolver.resolve?resolver.resolve(futureARS,futureRSS):resolver(futureARS,futureRSS))}function switchTap(next){return function(source){return source.pipe(switchMap(v=>{const nextResult=next(v);return nextResult?from(nextResult).pipe(map(()=>v)):from([v])}))}}class DefaultRouteReuseStrategy{shouldDetach(route){return!1}store(route,detachedTree){}shouldAttach(route){return!1}retrieve(route){return null}shouldReuseRoute(future,curr){return future.routeConfig===curr.routeConfig}}const ROUTES=new InjectionToken(\"ROUTES\");class router_RouterConfigLoader{constructor(loader,compiler,onLoadStartListener,onLoadEndListener){this.loader=loader,this.compiler=compiler,this.onLoadStartListener=onLoadStartListener,this.onLoadEndListener=onLoadEndListener}load(parentInjector,route){return this.onLoadStartListener&&this.onLoadStartListener(route),this.loadModuleFactory(route.loadChildren).pipe(map(factory=>{this.onLoadEndListener&&this.onLoadEndListener(route);const module=factory.create(parentInjector);return new LoadedRouterConfig(router_flatten(module.injector.get(ROUTES)).map(standardizeConfig),module)}))}loadModuleFactory(loadChildren){return\"string\"==typeof loadChildren?from(this.loader.load(loadChildren)):wrapIntoObservable(loadChildren()).pipe(mergeMap(t=>t instanceof NgModuleFactory?of(t):from(this.compiler.compileModuleAsync(t))))}}class DefaultUrlHandlingStrategy{shouldProcessUrl(url){return!0}extract(url){return url}merge(newUrlPart,wholeUrl){return newUrlPart}}function defaultErrorHandler(error){throw error}function defaultMalformedUriErrorHandler(error,urlSerializer,url){return urlSerializer.parse(\"/\")}function defaultRouterHook(snapshot,runExtras){return of(null)}let router_Router=(()=>{class Router{constructor(rootComponentType,urlSerializer,rootContexts,location,injector,loader,compiler,config){this.rootComponentType=rootComponentType,this.urlSerializer=urlSerializer,this.rootContexts=rootContexts,this.location=location,this.config=config,this.lastSuccessfulNavigation=null,this.currentNavigation=null,this.navigationId=0,this.isNgZoneEnabled=!1,this.events=new Subject_Subject,this.errorHandler=defaultErrorHandler,this.malformedUriErrorHandler=defaultMalformedUriErrorHandler,this.navigated=!1,this.lastSuccessfulId=-1,this.hooks={beforePreactivation:defaultRouterHook,afterPreactivation:defaultRouterHook},this.urlHandlingStrategy=new DefaultUrlHandlingStrategy,this.routeReuseStrategy=new DefaultRouteReuseStrategy,this.onSameUrlNavigation=\"ignore\",this.paramsInheritanceStrategy=\"emptyOnly\",this.urlUpdateStrategy=\"deferred\",this.relativeLinkResolution=\"legacy\",this.ngModule=injector.get(NgModuleRef),this.console=injector.get(Console);const ngZone=injector.get(NgZone);this.isNgZoneEnabled=ngZone instanceof NgZone,this.resetConfig(config),this.currentUrlTree=new UrlTree(new UrlSegmentGroup([],{}),{},null),this.rawUrlTree=this.currentUrlTree,this.browserUrlTree=this.currentUrlTree,this.configLoader=new router_RouterConfigLoader(loader,compiler,r=>this.triggerEvent(new RouteConfigLoadStart(r)),r=>this.triggerEvent(new RouteConfigLoadEnd(r))),this.routerState=createEmptyState(this.currentUrlTree,this.rootComponentType),this.transitions=new BehaviorSubject_BehaviorSubject({id:0,currentUrlTree:this.currentUrlTree,currentRawUrl:this.currentUrlTree,extractedUrl:this.urlHandlingStrategy.extract(this.currentUrlTree),urlAfterRedirects:this.urlHandlingStrategy.extract(this.currentUrlTree),rawUrl:this.currentUrlTree,extras:{},resolve:null,reject:null,promise:Promise.resolve(!0),source:\"imperative\",restoredState:null,currentSnapshot:this.routerState.snapshot,targetSnapshot:null,currentRouterState:this.routerState,targetRouterState:null,guards:{canActivateChecks:[],canDeactivateChecks:[]},guardsResult:null}),this.navigations=this.setupNavigations(this.transitions),this.processNavigations()}setupNavigations(transitions){const eventsSubject=this.events;return transitions.pipe(filter(t=>0!==t.id),map(t=>Object.assign(Object.assign({},t),{extractedUrl:this.urlHandlingStrategy.extract(t.rawUrl)})),switchMap(t=>{let completed=!1,errored=!1;return of(t).pipe(tap(t=>{this.currentNavigation={id:t.id,initialUrl:t.currentRawUrl,extractedUrl:t.extractedUrl,trigger:t.source,extras:t.extras,previousNavigation:this.lastSuccessfulNavigation?Object.assign(Object.assign({},this.lastSuccessfulNavigation),{previousNavigation:null}):null}}),switchMap(t=>{const urlTransition=!this.navigated||t.extractedUrl.toString()!==this.browserUrlTree.toString();if((\"reload\"===this.onSameUrlNavigation||urlTransition)&&this.urlHandlingStrategy.shouldProcessUrl(t.rawUrl))return of(t).pipe(switchMap(t=>{const transition=this.transitions.getValue();return eventsSubject.next(new NavigationStart(t.id,this.serializeUrl(t.extractedUrl),t.source,t.restoredState)),transition!==this.transitions.getValue()?empty_EMPTY:[t]}),switchMap(t=>Promise.resolve(t)),(moduleInjector=this.ngModule.injector,configLoader=this.configLoader,urlSerializer=this.urlSerializer,config=this.config,function(source){return source.pipe(switchMap(t=>function(moduleInjector,configLoader,urlSerializer,urlTree,config){return new router_ApplyRedirects(moduleInjector,configLoader,urlSerializer,urlTree,config).apply()}(moduleInjector,configLoader,urlSerializer,t.extractedUrl,config).pipe(map(urlAfterRedirects=>Object.assign(Object.assign({},t),{urlAfterRedirects:urlAfterRedirects})))))}),tap(t=>{this.currentNavigation=Object.assign(Object.assign({},this.currentNavigation),{finalUrl:t.urlAfterRedirects})}),function(rootComponentType,config,serializer,paramsInheritanceStrategy,relativeLinkResolution){return function(source){return source.pipe(mergeMap(t=>function(rootComponentType,config,urlTree,url,paramsInheritanceStrategy=\"emptyOnly\",relativeLinkResolution=\"legacy\"){return new router_Recognizer(rootComponentType,config,urlTree,url,paramsInheritanceStrategy,relativeLinkResolution).recognize()}(rootComponentType,config,t.urlAfterRedirects,serializer(t.urlAfterRedirects),paramsInheritanceStrategy,relativeLinkResolution).pipe(map(targetSnapshot=>Object.assign(Object.assign({},t),{targetSnapshot:targetSnapshot})))))}}(this.rootComponentType,this.config,url=>this.serializeUrl(url),this.paramsInheritanceStrategy,this.relativeLinkResolution),tap(t=>{\"eager\"===this.urlUpdateStrategy&&(t.extras.skipLocationChange||this.setBrowserUrl(t.urlAfterRedirects,!!t.extras.replaceUrl,t.id,t.extras.state),this.browserUrlTree=t.urlAfterRedirects)}),tap(t=>{const routesRecognized=new RoutesRecognized(t.id,this.serializeUrl(t.extractedUrl),this.serializeUrl(t.urlAfterRedirects),t.targetSnapshot);eventsSubject.next(routesRecognized)}));var moduleInjector,configLoader,urlSerializer,config;if(urlTransition&&this.rawUrlTree&&this.urlHandlingStrategy.shouldProcessUrl(this.rawUrlTree)){const{id:id,extractedUrl:extractedUrl,source:source,restoredState:restoredState,extras:extras}=t,navStart=new NavigationStart(id,this.serializeUrl(extractedUrl),source,restoredState);eventsSubject.next(navStart);const targetSnapshot=createEmptyState(extractedUrl,this.rootComponentType).snapshot;return of(Object.assign(Object.assign({},t),{targetSnapshot:targetSnapshot,urlAfterRedirects:extractedUrl,extras:Object.assign(Object.assign({},extras),{skipLocationChange:!1,replaceUrl:!1})}))}return this.rawUrlTree=t.rawUrl,this.browserUrlTree=t.urlAfterRedirects,t.resolve(null),empty_EMPTY}),switchTap(t=>{const{targetSnapshot:targetSnapshot,id:navigationId,extractedUrl:appliedUrlTree,rawUrl:rawUrlTree,extras:{skipLocationChange:skipLocationChange,replaceUrl:replaceUrl}}=t;return this.hooks.beforePreactivation(targetSnapshot,{navigationId:navigationId,appliedUrlTree:appliedUrlTree,rawUrlTree:rawUrlTree,skipLocationChange:!!skipLocationChange,replaceUrl:!!replaceUrl})}),tap(t=>{const guardsStart=new GuardsCheckStart(t.id,this.serializeUrl(t.extractedUrl),this.serializeUrl(t.urlAfterRedirects),t.targetSnapshot);this.triggerEvent(guardsStart)}),map(t=>Object.assign(Object.assign({},t),{guards:getAllRouteGuards(t.targetSnapshot,t.currentSnapshot,this.rootContexts)})),function(moduleInjector,forwardEvent){return function(source){return source.pipe(mergeMap(t=>{const{targetSnapshot:targetSnapshot,currentSnapshot:currentSnapshot,guards:{canActivateChecks:canActivateChecks,canDeactivateChecks:canDeactivateChecks}}=t;return 0===canDeactivateChecks.length&&0===canActivateChecks.length?of(Object.assign(Object.assign({},t),{guardsResult:!0})):function(checks,futureRSS,currRSS,moduleInjector){return from(checks).pipe(mergeMap(check=>function(component,currARS,currRSS,futureRSS,moduleInjector){const canDeactivate=currARS&&currARS.routeConfig?currARS.routeConfig.canDeactivate:null;return canDeactivate&&0!==canDeactivate.length?of(canDeactivate.map(c=>{const guard=getToken(c,currARS,moduleInjector);let observable;if(function(guard){return guard&&router_isFunction(guard.canDeactivate)}(guard))observable=wrapIntoObservable(guard.canDeactivate(component,currARS,currRSS,futureRSS));else{if(!router_isFunction(guard))throw new Error(\"Invalid CanDeactivate guard\");observable=wrapIntoObservable(guard(component,currARS,currRSS,futureRSS))}return observable.pipe(first_first())})).pipe(prioritizedGuardValue()):of(!0)}(check.component,check.route,currRSS,futureRSS,moduleInjector)),first_first(result=>!0!==result,!0))}(canDeactivateChecks,targetSnapshot,currentSnapshot,moduleInjector).pipe(mergeMap(canDeactivate=>canDeactivate&&\"boolean\"==typeof canDeactivate?function(futureSnapshot,checks,moduleInjector,forwardEvent){return from(checks).pipe(concatMap(check=>from([fireChildActivationStart(check.route.parent,forwardEvent),fireActivationStart(check.route,forwardEvent),runCanActivateChild(futureSnapshot,check.path,moduleInjector),runCanActivate(futureSnapshot,check.route,moduleInjector)]).pipe(concatAll(),first_first(result=>!0!==result,!0))),first_first(result=>!0!==result,!0))}(targetSnapshot,canActivateChecks,moduleInjector,forwardEvent):of(canDeactivate)),map(guardsResult=>Object.assign(Object.assign({},t),{guardsResult:guardsResult})))}))}}(this.ngModule.injector,evt=>this.triggerEvent(evt)),tap(t=>{if(isUrlTree(t.guardsResult)){const error=navigationCancelingError(`Redirecting to \"${this.serializeUrl(t.guardsResult)}\"`);throw error.url=t.guardsResult,error}}),tap(t=>{const guardsEnd=new GuardsCheckEnd(t.id,this.serializeUrl(t.extractedUrl),this.serializeUrl(t.urlAfterRedirects),t.targetSnapshot,!!t.guardsResult);this.triggerEvent(guardsEnd)}),filter(t=>{if(!t.guardsResult){this.resetUrlToCurrentUrlTree();const navCancel=new NavigationCancel(t.id,this.serializeUrl(t.extractedUrl),\"\");return eventsSubject.next(navCancel),t.resolve(!1),!1}return!0}),switchTap(t=>{if(t.guards.canActivateChecks.length)return of(t).pipe(tap(t=>{const resolveStart=new ResolveStart(t.id,this.serializeUrl(t.extractedUrl),this.serializeUrl(t.urlAfterRedirects),t.targetSnapshot);this.triggerEvent(resolveStart)}),(paramsInheritanceStrategy=this.paramsInheritanceStrategy,moduleInjector=this.ngModule.injector,function(source){return source.pipe(mergeMap(t=>{const{targetSnapshot:targetSnapshot,guards:{canActivateChecks:canActivateChecks}}=t;return canActivateChecks.length?from(canActivateChecks).pipe(concatMap(check=>function(futureARS,futureRSS,paramsInheritanceStrategy,moduleInjector){return function(resolve,futureARS,futureRSS,moduleInjector){const keys=Object.keys(resolve);if(0===keys.length)return of({});if(1===keys.length){const key=keys[0];return getResolver(resolve[key],futureARS,futureRSS,moduleInjector).pipe(map(value=>({[key]:value})))}const data={};return from(keys).pipe(mergeMap(key=>getResolver(resolve[key],futureARS,futureRSS,moduleInjector).pipe(map(value=>(data[key]=value,value))))).pipe(last_last(),map(()=>data))}(futureARS._resolve,futureARS,futureRSS,moduleInjector).pipe(map(resolvedData=>(futureARS._resolvedData=resolvedData,futureARS.data=Object.assign(Object.assign({},futureARS.data),inheritedParamsDataResolve(futureARS,paramsInheritanceStrategy).resolve),null)))}(check.route,targetSnapshot,paramsInheritanceStrategy,moduleInjector)),function(accumulator,seed){return arguments.length>=2?function(source){return pipe(scan(accumulator,seed),takeLast(1),defaultIfEmpty(seed))(source)}:function(source){return pipe(scan((acc,value,index)=>accumulator(acc,value,index+1)),takeLast(1))(source)}}((_,__)=>_),map(_=>t)):of(t)}))}),tap(t=>{const resolveEnd=new ResolveEnd(t.id,this.serializeUrl(t.extractedUrl),this.serializeUrl(t.urlAfterRedirects),t.targetSnapshot);this.triggerEvent(resolveEnd)}));var paramsInheritanceStrategy,moduleInjector}),switchTap(t=>{const{targetSnapshot:targetSnapshot,id:navigationId,extractedUrl:appliedUrlTree,rawUrl:rawUrlTree,extras:{skipLocationChange:skipLocationChange,replaceUrl:replaceUrl}}=t;return this.hooks.afterPreactivation(targetSnapshot,{navigationId:navigationId,appliedUrlTree:appliedUrlTree,rawUrlTree:rawUrlTree,skipLocationChange:!!skipLocationChange,replaceUrl:!!replaceUrl})}),map(t=>{const targetRouterState=function(routeReuseStrategy,curr,prevState){const root=function createNode(routeReuseStrategy,curr,prevState){if(prevState&&routeReuseStrategy.shouldReuseRoute(curr.value,prevState.value.snapshot)){const value=prevState.value;value._futureSnapshot=curr.value;const children=function(routeReuseStrategy,curr,prevState){return curr.children.map(child=>{for(const p of prevState.children)if(routeReuseStrategy.shouldReuseRoute(p.value.snapshot,child.value))return createNode(routeReuseStrategy,child,p);return createNode(routeReuseStrategy,child)})}(routeReuseStrategy,curr,prevState);return new TreeNode(value,children)}{const detachedRouteHandle=routeReuseStrategy.retrieve(curr.value);if(detachedRouteHandle){const tree=detachedRouteHandle.route;return function setFutureSnapshotsOfActivatedRoutes(curr,result){if(curr.value.routeConfig!==result.value.routeConfig)throw new Error(\"Cannot reattach ActivatedRouteSnapshot created from a different route\");if(curr.children.length!==result.children.length)throw new Error(\"Cannot reattach ActivatedRouteSnapshot with a different number of children\");result.value._futureSnapshot=curr.value;for(let i=0;i<curr.children.length;++i)setFutureSnapshotsOfActivatedRoutes(curr.children[i],result.children[i])}(curr,tree),tree}{const value=new router_ActivatedRoute(new BehaviorSubject_BehaviorSubject((c=curr.value).url),new BehaviorSubject_BehaviorSubject(c.params),new BehaviorSubject_BehaviorSubject(c.queryParams),new BehaviorSubject_BehaviorSubject(c.fragment),new BehaviorSubject_BehaviorSubject(c.data),c.outlet,c.component,c),children=curr.children.map(c=>createNode(routeReuseStrategy,c));return new TreeNode(value,children)}}var c}(routeReuseStrategy,curr._root,prevState?prevState._root:void 0);return new RouterState(root,curr)}(this.routeReuseStrategy,t.targetSnapshot,t.currentRouterState);return Object.assign(Object.assign({},t),{targetRouterState:targetRouterState})}),tap(t=>{this.currentUrlTree=t.urlAfterRedirects,this.rawUrlTree=this.urlHandlingStrategy.merge(this.currentUrlTree,t.rawUrl),this.routerState=t.targetRouterState,\"deferred\"===this.urlUpdateStrategy&&(t.extras.skipLocationChange||this.setBrowserUrl(this.rawUrlTree,!!t.extras.replaceUrl,t.id,t.extras.state),this.browserUrlTree=t.urlAfterRedirects)}),(rootContexts=this.rootContexts,routeReuseStrategy=this.routeReuseStrategy,forwardEvent=evt=>this.triggerEvent(evt),map(t=>(new ActivateRoutes(routeReuseStrategy,t.targetRouterState,t.currentRouterState,forwardEvent).activate(rootContexts),t))),tap({next(){completed=!0},complete(){completed=!0}}),(callback=()=>{if(!completed&&!errored){this.resetUrlToCurrentUrlTree();const navCancel=new NavigationCancel(t.id,this.serializeUrl(t.extractedUrl),`Navigation ID ${t.id} is not equal to the current navigation id ${this.navigationId}`);eventsSubject.next(navCancel),t.resolve(!1)}this.currentNavigation=null},source=>source.lift(new FinallyOperator(callback))),catchError(e=>{if(errored=!0,(error=e)&&error.ngNavigationCancelingError){const redirecting=isUrlTree(e.url);redirecting||(this.navigated=!0,this.resetStateAndUrl(t.currentRouterState,t.currentUrlTree,t.rawUrl));const navCancel=new NavigationCancel(t.id,this.serializeUrl(t.extractedUrl),e.message);eventsSubject.next(navCancel),redirecting?setTimeout(()=>{const mergedTree=this.urlHandlingStrategy.merge(e.url,this.rawUrlTree);return this.scheduleNavigation(mergedTree,\"imperative\",null,{skipLocationChange:t.extras.skipLocationChange,replaceUrl:\"eager\"===this.urlUpdateStrategy},{resolve:t.resolve,reject:t.reject,promise:t.promise})},0):t.resolve(!1)}else{this.resetStateAndUrl(t.currentRouterState,t.currentUrlTree,t.rawUrl);const navError=new NavigationError(t.id,this.serializeUrl(t.extractedUrl),e);eventsSubject.next(navError);try{t.resolve(this.errorHandler(e))}catch(ee){t.reject(ee)}}var error;return empty_EMPTY}));var callback,rootContexts,routeReuseStrategy,forwardEvent}))}resetRootComponentType(rootComponentType){this.rootComponentType=rootComponentType,this.routerState.root.component=this.rootComponentType}getTransition(){const transition=this.transitions.value;return transition.urlAfterRedirects=this.browserUrlTree,transition}setTransition(t){this.transitions.next(Object.assign(Object.assign({},this.getTransition()),t))}initialNavigation(){this.setUpLocationChangeListener(),0===this.navigationId&&this.navigateByUrl(this.location.path(!0),{replaceUrl:!0})}setUpLocationChangeListener(){this.locationSubscription||(this.locationSubscription=this.location.subscribe(change=>{let rawUrlTree=this.parseUrl(change.url);const source=\"popstate\"===change.type?\"popstate\":\"hashchange\",state=change.state&&change.state.navigationId?change.state:null;setTimeout(()=>{this.scheduleNavigation(rawUrlTree,source,state,{replaceUrl:!0})},0)}))}get url(){return this.serializeUrl(this.currentUrlTree)}getCurrentNavigation(){return this.currentNavigation}triggerEvent(event){this.events.next(event)}resetConfig(config){validateConfig(config),this.config=config.map(standardizeConfig),this.navigated=!1,this.lastSuccessfulId=-1}ngOnDestroy(){this.dispose()}dispose(){this.locationSubscription&&(this.locationSubscription.unsubscribe(),this.locationSubscription=null)}createUrlTree(commands,navigationExtras={}){const{relativeTo:relativeTo,queryParams:queryParams,fragment:fragment,preserveQueryParams:preserveQueryParams,queryParamsHandling:queryParamsHandling,preserveFragment:preserveFragment}=navigationExtras;isDevMode()&&preserveQueryParams&&console&&console.warn&&console.warn(\"preserveQueryParams is deprecated, use queryParamsHandling instead.\");const a=relativeTo||this.routerState.root,f=preserveFragment?this.currentUrlTree.fragment:fragment;let q=null;if(queryParamsHandling)switch(queryParamsHandling){case\"merge\":q=Object.assign(Object.assign({},this.currentUrlTree.queryParams),queryParams);break;case\"preserve\":q=this.currentUrlTree.queryParams;break;default:q=queryParams||null}else q=preserveQueryParams?this.currentUrlTree.queryParams:queryParams||null;return null!==q&&(q=this.removeEmptyProps(q)),function(route,urlTree,commands,queryParams,fragment){if(0===commands.length)return router_tree(urlTree.root,urlTree.root,urlTree,queryParams,fragment);const nav=function(commands){if(\"string\"==typeof commands[0]&&1===commands.length&&\"/\"===commands[0])return new Navigation(!0,0,commands);let numberOfDoubleDots=0,isAbsolute=!1;const res=commands.reduce((res,cmd,cmdIdx)=>{if(\"object\"==typeof cmd&&null!=cmd){if(cmd.outlets){const outlets={};return forEach(cmd.outlets,(commands,name)=>{outlets[name]=\"string\"==typeof commands?commands.split(\"/\"):commands}),[...res,{outlets:outlets}]}if(cmd.segmentPath)return[...res,cmd.segmentPath]}return\"string\"!=typeof cmd?[...res,cmd]:0===cmdIdx?(cmd.split(\"/\").forEach((urlPart,partIndex)=>{0==partIndex&&\".\"===urlPart||(0==partIndex&&\"\"===urlPart?isAbsolute=!0:\"..\"===urlPart?numberOfDoubleDots++:\"\"!=urlPart&&res.push(urlPart))}),res):[...res,cmd]},[]);return new Navigation(isAbsolute,numberOfDoubleDots,res)}(commands);if(nav.toRoot())return router_tree(urlTree.root,new UrlSegmentGroup([],{}),urlTree,queryParams,fragment);const startingPosition=function(nav,tree,route){if(nav.isAbsolute)return new Position(tree.root,!0,0);if(-1===route.snapshot._lastPathIndex)return new Position(route.snapshot._urlSegment,!0,0);const modifier=isMatrixParams(nav.commands[0])?0:1;return function(group,index,numberOfDoubleDots){let g=group,ci=index,dd=numberOfDoubleDots;for(;dd>ci;){if(dd-=ci,g=g.parent,!g)throw new Error(\"Invalid number of '../'\");ci=g.segments.length}return new Position(g,!1,ci-dd)}(route.snapshot._urlSegment,route.snapshot._lastPathIndex+modifier,nav.numberOfDoubleDots)}(nav,urlTree,route),segmentGroup=startingPosition.processChildren?updateSegmentGroupChildren(startingPosition.segmentGroup,startingPosition.index,nav.commands):updateSegmentGroup(startingPosition.segmentGroup,startingPosition.index,nav.commands);return router_tree(startingPosition.segmentGroup,segmentGroup,urlTree,queryParams,fragment)}(a,this.currentUrlTree,commands,q,f)}navigateByUrl(url,extras={skipLocationChange:!1}){isDevMode()&&this.isNgZoneEnabled&&!NgZone.isInAngularZone()&&this.console.warn(\"Navigation triggered outside Angular zone, did you forget to call 'ngZone.run()'?\");const urlTree=isUrlTree(url)?url:this.parseUrl(url),mergedTree=this.urlHandlingStrategy.merge(urlTree,this.rawUrlTree);return this.scheduleNavigation(mergedTree,\"imperative\",null,extras)}navigate(commands,extras={skipLocationChange:!1}){return function(commands){for(let i=0;i<commands.length;i++){const cmd=commands[i];if(null==cmd)throw new Error(`The requested path contains ${cmd} segment at index ${i}`)}}(commands),this.navigateByUrl(this.createUrlTree(commands,extras),extras)}serializeUrl(url){return this.urlSerializer.serialize(url)}parseUrl(url){let urlTree;try{urlTree=this.urlSerializer.parse(url)}catch(e){urlTree=this.malformedUriErrorHandler(e,this.urlSerializer,url)}return urlTree}isActive(url,exact){if(isUrlTree(url))return containsTree(this.currentUrlTree,url,exact);const urlTree=this.parseUrl(url);return containsTree(this.currentUrlTree,urlTree,exact)}removeEmptyProps(params){return Object.keys(params).reduce((result,key)=>{const value=params[key];return null!=value&&(result[key]=value),result},{})}processNavigations(){this.navigations.subscribe(t=>{this.navigated=!0,this.lastSuccessfulId=t.id,this.events.next(new NavigationEnd(t.id,this.serializeUrl(t.extractedUrl),this.serializeUrl(this.currentUrlTree))),this.lastSuccessfulNavigation=this.currentNavigation,this.currentNavigation=null,t.resolve(!0)},e=>{this.console.warn(\"Unhandled Navigation Error: \")})}scheduleNavigation(rawUrl,source,restoredState,extras,priorPromise){const lastNavigation=this.getTransition();if(lastNavigation&&\"imperative\"!==source&&\"imperative\"===lastNavigation.source&&lastNavigation.rawUrl.toString()===rawUrl.toString())return Promise.resolve(!0);if(lastNavigation&&\"hashchange\"==source&&\"popstate\"===lastNavigation.source&&lastNavigation.rawUrl.toString()===rawUrl.toString())return Promise.resolve(!0);if(lastNavigation&&\"popstate\"==source&&\"hashchange\"===lastNavigation.source&&lastNavigation.rawUrl.toString()===rawUrl.toString())return Promise.resolve(!0);let resolve,reject,promise;priorPromise?(resolve=priorPromise.resolve,reject=priorPromise.reject,promise=priorPromise.promise):promise=new Promise((res,rej)=>{resolve=res,reject=rej});const id=++this.navigationId;return this.setTransition({id:id,source:source,restoredState:restoredState,currentUrlTree:this.currentUrlTree,currentRawUrl:this.rawUrlTree,rawUrl:rawUrl,extras:extras,resolve:resolve,reject:reject,promise:promise,currentSnapshot:this.routerState.snapshot,currentRouterState:this.routerState}),promise.catch(e=>Promise.reject(e))}setBrowserUrl(url,replaceUrl,id,state){const path=this.urlSerializer.serialize(url);state=state||{},this.location.isCurrentPathEqualTo(path)||replaceUrl?this.location.replaceState(path,\"\",Object.assign(Object.assign({},state),{navigationId:id})):this.location.go(path,\"\",Object.assign(Object.assign({},state),{navigationId:id}))}resetStateAndUrl(storedState,storedUrl,rawUrl){this.routerState=storedState,this.currentUrlTree=storedUrl,this.rawUrlTree=this.urlHandlingStrategy.merge(this.currentUrlTree,rawUrl),this.resetUrlToCurrentUrlTree()}resetUrlToCurrentUrlTree(){this.location.replaceState(this.urlSerializer.serialize(this.rawUrlTree),\"\",{navigationId:this.lastSuccessfulId})}}return Router.ɵfac=function(t){ɵɵinvalidFactory()},Router.ɵdir=ɵɵdefineDirective({type:Router}),Router})(),router_RouterLink=(()=>{class RouterLink{constructor(router,route,tabIndex,renderer,el){this.router=router,this.route=route,this.commands=[],null==tabIndex&&renderer.setAttribute(el.nativeElement,\"tabindex\",\"0\")}set routerLink(commands){this.commands=null!=commands?Array.isArray(commands)?commands:[commands]:[]}set preserveQueryParams(value){isDevMode()&&console&&console.warn&&console.warn(\"preserveQueryParams is deprecated!, use queryParamsHandling instead.\"),this.preserve=value}onClick(){const extras={skipLocationChange:attrBoolValue(this.skipLocationChange),replaceUrl:attrBoolValue(this.replaceUrl),state:this.state};return this.router.navigateByUrl(this.urlTree,extras),!0}get urlTree(){return this.router.createUrlTree(this.commands,{relativeTo:this.route,queryParams:this.queryParams,fragment:this.fragment,preserveQueryParams:attrBoolValue(this.preserve),queryParamsHandling:this.queryParamsHandling,preserveFragment:attrBoolValue(this.preserveFragment)})}}return RouterLink.ɵfac=function(t){return new(t||RouterLink)(ɵɵdirectiveInject(router_Router),ɵɵdirectiveInject(router_ActivatedRoute),ɵɵinjectAttribute(\"tabindex\"),ɵɵdirectiveInject(Renderer2),ɵɵdirectiveInject(ElementRef))},RouterLink.ɵdir=ɵɵdefineDirective({type:RouterLink,selectors:[[\"\",\"routerLink\",\"\",5,\"a\",5,\"area\"]],hostBindings:function(rf,ctx){1&rf&&ɵɵlistener(\"click\",(function(){return ctx.onClick()}))},inputs:{routerLink:\"routerLink\",preserveQueryParams:\"preserveQueryParams\",queryParams:\"queryParams\",fragment:\"fragment\",queryParamsHandling:\"queryParamsHandling\",preserveFragment:\"preserveFragment\",skipLocationChange:\"skipLocationChange\",replaceUrl:\"replaceUrl\",state:\"state\"}}),RouterLink})();function attrBoolValue(s){return\"\"===s||!!s}class OutletContext{constructor(){this.outlet=null,this.route=null,this.resolver=null,this.children=new ChildrenOutletContexts,this.attachRef=null}}class ChildrenOutletContexts{constructor(){this.contexts=new Map}onChildOutletCreated(childName,outlet){const context=this.getOrCreateContext(childName);context.outlet=outlet,this.contexts.set(childName,context)}onChildOutletDestroyed(childName){const context=this.getContext(childName);context&&(context.outlet=null)}onOutletDeactivated(){const contexts=this.contexts;return this.contexts=new Map,contexts}onOutletReAttached(contexts){this.contexts=contexts}getOrCreateContext(childName){let context=this.getContext(childName);return context||(context=new OutletContext,this.contexts.set(childName,context)),context}getContext(childName){return this.contexts.get(childName)||null}}let router_RouterOutlet=(()=>{class RouterOutlet{constructor(parentContexts,location,resolver,name,changeDetector){this.parentContexts=parentContexts,this.location=location,this.resolver=resolver,this.changeDetector=changeDetector,this.activated=null,this._activatedRoute=null,this.activateEvents=new core_EventEmitter,this.deactivateEvents=new core_EventEmitter,this.name=name||\"primary\",parentContexts.onChildOutletCreated(this.name,this)}ngOnDestroy(){this.parentContexts.onChildOutletDestroyed(this.name)}ngOnInit(){if(!this.activated){const context=this.parentContexts.getContext(this.name);context&&context.route&&(context.attachRef?this.attach(context.attachRef,context.route):this.activateWith(context.route,context.resolver||null))}}get isActivated(){return!!this.activated}get component(){if(!this.activated)throw new Error(\"Outlet is not activated\");return this.activated.instance}get activatedRoute(){if(!this.activated)throw new Error(\"Outlet is not activated\");return this._activatedRoute}get activatedRouteData(){return this._activatedRoute?this._activatedRoute.snapshot.data:{}}detach(){if(!this.activated)throw new Error(\"Outlet is not activated\");this.location.detach();const cmp=this.activated;return this.activated=null,this._activatedRoute=null,cmp}attach(ref,activatedRoute){this.activated=ref,this._activatedRoute=activatedRoute,this.location.insert(ref.hostView)}deactivate(){if(this.activated){const c=this.component;this.activated.destroy(),this.activated=null,this._activatedRoute=null,this.deactivateEvents.emit(c)}}activateWith(activatedRoute,resolver){if(this.isActivated)throw new Error(\"Cannot activate an already activated outlet\");this._activatedRoute=activatedRoute;const factory=(resolver=resolver||this.resolver).resolveComponentFactory(activatedRoute._futureSnapshot.routeConfig.component),childContexts=this.parentContexts.getOrCreateContext(this.name).children,injector=new OutletInjector(activatedRoute,childContexts,this.location.injector);this.activated=this.location.createComponent(factory,this.location.length,injector),this.changeDetector.markForCheck(),this.activateEvents.emit(this.activated.instance)}}return RouterOutlet.ɵfac=function(t){return new(t||RouterOutlet)(ɵɵdirectiveInject(ChildrenOutletContexts),ɵɵdirectiveInject(ViewContainerRef),ɵɵdirectiveInject(ComponentFactoryResolver),ɵɵinjectAttribute(\"name\"),ɵɵdirectiveInject(ChangeDetectorRef))},RouterOutlet.ɵdir=ɵɵdefineDirective({type:RouterOutlet,selectors:[[\"router-outlet\"]],outputs:{activateEvents:\"activate\",deactivateEvents:\"deactivate\"},exportAs:[\"outlet\"]}),RouterOutlet})();class OutletInjector{constructor(route,childContexts,parent){this.route=route,this.childContexts=childContexts,this.parent=parent}get(token,notFoundValue){return token===router_ActivatedRoute?this.route:token===ChildrenOutletContexts?this.childContexts:this.parent.get(token,notFoundValue)}}class PreloadingStrategy{}class router_NoPreloading{preload(route,fn){return of(null)}}let router_RouterPreloader=(()=>{class RouterPreloader{constructor(router,moduleLoader,compiler,injector,preloadingStrategy){this.router=router,this.injector=injector,this.preloadingStrategy=preloadingStrategy,this.loader=new router_RouterConfigLoader(moduleLoader,compiler,r=>router.triggerEvent(new RouteConfigLoadStart(r)),r=>router.triggerEvent(new RouteConfigLoadEnd(r)))}setUpPreloading(){this.subscription=this.router.events.pipe(filter(e=>e instanceof NavigationEnd),concatMap(()=>this.preload())).subscribe(()=>{})}preload(){const ngModule=this.injector.get(NgModuleRef);return this.processRoutes(ngModule,this.router.config)}ngOnDestroy(){this.subscription.unsubscribe()}processRoutes(ngModule,routes){const res=[];for(const route of routes)if(route.loadChildren&&!route.canLoad&&route._loadedConfig){const childConfig=route._loadedConfig;res.push(this.processRoutes(childConfig.module,childConfig.routes))}else route.loadChildren&&!route.canLoad?res.push(this.preloadConfig(ngModule,route)):route.children&&res.push(this.processRoutes(ngModule,route.children));return from(res).pipe(mergeAll(),map(_=>{}))}preloadConfig(ngModule,route){return this.preloadingStrategy.preload(route,()=>this.loader.load(ngModule.injector,route).pipe(mergeMap(config=>(route._loadedConfig=config,this.processRoutes(config.module,config.routes)))))}}return RouterPreloader.ɵfac=function(t){return new(t||RouterPreloader)(ɵɵinject(router_Router),ɵɵinject(NgModuleFactoryLoader),ɵɵinject(Compiler),ɵɵinject(Injector),ɵɵinject(PreloadingStrategy))},RouterPreloader.ɵprov=ɵɵdefineInjectable({token:RouterPreloader,factory:RouterPreloader.ɵfac}),RouterPreloader})(),router_RouterScroller=(()=>{class RouterScroller{constructor(router,viewportScroller,options={}){this.router=router,this.viewportScroller=viewportScroller,this.options=options,this.lastId=0,this.lastSource=\"imperative\",this.restoredId=0,this.store={},options.scrollPositionRestoration=options.scrollPositionRestoration||\"disabled\",options.anchorScrolling=options.anchorScrolling||\"disabled\"}init(){\"disabled\"!==this.options.scrollPositionRestoration&&this.viewportScroller.setHistoryScrollRestoration(\"manual\"),this.routerEventsSubscription=this.createScrollEvents(),this.scrollEventsSubscription=this.consumeScrollEvents()}createScrollEvents(){return this.router.events.subscribe(e=>{e instanceof NavigationStart?(this.store[this.lastId]=this.viewportScroller.getScrollPosition(),this.lastSource=e.navigationTrigger,this.restoredId=e.restoredState?e.restoredState.navigationId:0):e instanceof NavigationEnd&&(this.lastId=e.id,this.scheduleScrollEvent(e,this.router.parseUrl(e.urlAfterRedirects).fragment))})}consumeScrollEvents(){return this.router.events.subscribe(e=>{e instanceof Scroll&&(e.position?\"top\"===this.options.scrollPositionRestoration?this.viewportScroller.scrollToPosition([0,0]):\"enabled\"===this.options.scrollPositionRestoration&&this.viewportScroller.scrollToPosition(e.position):e.anchor&&\"enabled\"===this.options.anchorScrolling?this.viewportScroller.scrollToAnchor(e.anchor):\"disabled\"!==this.options.scrollPositionRestoration&&this.viewportScroller.scrollToPosition([0,0]))})}scheduleScrollEvent(routerEvent,anchor){this.router.triggerEvent(new Scroll(routerEvent,\"popstate\"===this.lastSource?this.store[this.restoredId]:null,anchor))}ngOnDestroy(){this.routerEventsSubscription&&this.routerEventsSubscription.unsubscribe(),this.scrollEventsSubscription&&this.scrollEventsSubscription.unsubscribe()}}return RouterScroller.ɵfac=function(t){ɵɵinvalidFactory()},RouterScroller.ɵdir=ɵɵdefineDirective({type:RouterScroller}),RouterScroller})();const ROUTER_CONFIGURATION=new InjectionToken(\"ROUTER_CONFIGURATION\"),ROUTER_FORROOT_GUARD=new InjectionToken(\"ROUTER_FORROOT_GUARD\"),ROUTER_PROVIDERS=[common_Location,{provide:UrlSerializer,useClass:DefaultUrlSerializer},{provide:router_Router,useFactory:function(urlSerializer,contexts,location,injector,loader,compiler,config,opts={},urlHandlingStrategy,routeReuseStrategy){const router=new router_Router(null,urlSerializer,contexts,location,injector,loader,compiler,router_flatten(config));if(urlHandlingStrategy&&(router.urlHandlingStrategy=urlHandlingStrategy),routeReuseStrategy&&(router.routeReuseStrategy=routeReuseStrategy),opts.errorHandler&&(router.errorHandler=opts.errorHandler),opts.malformedUriErrorHandler&&(router.malformedUriErrorHandler=opts.malformedUriErrorHandler),opts.enableTracing){const dom=getDOM();router.events.subscribe(e=>{dom.logGroup(\"Router Event: \"+e.constructor.name),dom.log(e.toString()),dom.log(e),dom.logGroupEnd()})}return opts.onSameUrlNavigation&&(router.onSameUrlNavigation=opts.onSameUrlNavigation),opts.paramsInheritanceStrategy&&(router.paramsInheritanceStrategy=opts.paramsInheritanceStrategy),opts.urlUpdateStrategy&&(router.urlUpdateStrategy=opts.urlUpdateStrategy),opts.relativeLinkResolution&&(router.relativeLinkResolution=opts.relativeLinkResolution),router},deps:[UrlSerializer,ChildrenOutletContexts,common_Location,Injector,NgModuleFactoryLoader,Compiler,ROUTES,ROUTER_CONFIGURATION,[class{},new Optional],[class{},new Optional]]},ChildrenOutletContexts,{provide:router_ActivatedRoute,useFactory:function(router){return router.routerState.root},deps:[router_Router]},{provide:NgModuleFactoryLoader,useClass:SystemJsNgModuleLoader},router_RouterPreloader,router_NoPreloading,class{preload(route,fn){return fn().pipe(catchError(()=>of(null)))}},{provide:ROUTER_CONFIGURATION,useValue:{enableTracing:!1}}];function routerNgProbeToken(){return new NgProbeToken(\"Router\",router_Router)}let router_RouterModule=(()=>{class RouterModule{constructor(guard,router){}static forRoot(routes,config){return{ngModule:RouterModule,providers:[ROUTER_PROVIDERS,provideRoutes(routes),{provide:ROUTER_FORROOT_GUARD,useFactory:provideForRootGuard,deps:[[router_Router,new Optional,new SkipSelf]]},{provide:ROUTER_CONFIGURATION,useValue:config||{}},{provide:common_LocationStrategy,useFactory:router_provideLocationStrategy,deps:[common_PlatformLocation,[new Inject(APP_BASE_HREF),new Optional],ROUTER_CONFIGURATION]},{provide:router_RouterScroller,useFactory:createRouterScroller,deps:[router_Router,common_ViewportScroller,ROUTER_CONFIGURATION]},{provide:PreloadingStrategy,useExisting:config&&config.preloadingStrategy?config.preloadingStrategy:router_NoPreloading},{provide:NgProbeToken,multi:!0,useFactory:routerNgProbeToken},[router_RouterInitializer,{provide:APP_INITIALIZER,multi:!0,useFactory:getAppInitializer,deps:[router_RouterInitializer]},{provide:ROUTER_INITIALIZER,useFactory:getBootstrapListener,deps:[router_RouterInitializer]},{provide:APP_BOOTSTRAP_LISTENER,multi:!0,useExisting:ROUTER_INITIALIZER}]]}}static forChild(routes){return{ngModule:RouterModule,providers:[provideRoutes(routes)]}}}return RouterModule.ɵmod=ɵɵdefineNgModule({type:RouterModule}),RouterModule.ɵinj=ɵɵdefineInjector({factory:function(t){return new(t||RouterModule)(ɵɵinject(ROUTER_FORROOT_GUARD,8),ɵɵinject(router_Router,8))}}),RouterModule})();function createRouterScroller(router,viewportScroller,config){return config.scrollOffset&&viewportScroller.setOffset(config.scrollOffset),new router_RouterScroller(router,viewportScroller,config)}function router_provideLocationStrategy(platformLocationStrategy,baseHref,options={}){return options.useHash?new common_HashLocationStrategy(platformLocationStrategy,baseHref):new common_PathLocationStrategy(platformLocationStrategy,baseHref)}function provideForRootGuard(router){if(router)throw new Error(\"RouterModule.forRoot() called twice. Lazy loaded modules should use RouterModule.forChild() instead.\");return\"guarded\"}function provideRoutes(routes){return[{provide:ANALYZE_FOR_ENTRY_COMPONENTS,multi:!0,useValue:routes},{provide:ROUTES,multi:!0,useValue:routes}]}let router_RouterInitializer=(()=>{class RouterInitializer{constructor(injector){this.injector=injector,this.initNavigation=!1,this.resultOfPreactivationDone=new Subject_Subject}appInitializer(){return this.injector.get(LOCATION_INITIALIZED,Promise.resolve(null)).then(()=>{let resolve=null;const res=new Promise(r=>resolve=r),router=this.injector.get(router_Router),opts=this.injector.get(ROUTER_CONFIGURATION);if(this.isLegacyDisabled(opts)||this.isLegacyEnabled(opts))resolve(!0);else if(\"disabled\"===opts.initialNavigation)router.setUpLocationChangeListener(),resolve(!0);else{if(\"enabled\"!==opts.initialNavigation)throw new Error(`Invalid initialNavigation options: '${opts.initialNavigation}'`);router.hooks.afterPreactivation=()=>this.initNavigation?of(null):(this.initNavigation=!0,resolve(!0),this.resultOfPreactivationDone),router.initialNavigation()}return res})}bootstrapListener(bootstrappedComponentRef){const opts=this.injector.get(ROUTER_CONFIGURATION),preloader=this.injector.get(router_RouterPreloader),routerScroller=this.injector.get(router_RouterScroller),router=this.injector.get(router_Router),ref=this.injector.get(core_ApplicationRef);bootstrappedComponentRef===ref.components[0]&&(this.isLegacyEnabled(opts)?router.initialNavigation():this.isLegacyDisabled(opts)&&router.setUpLocationChangeListener(),preloader.setUpPreloading(),routerScroller.init(),router.resetRootComponentType(ref.componentTypes[0]),this.resultOfPreactivationDone.next(null),this.resultOfPreactivationDone.complete())}isLegacyEnabled(opts){return\"legacy_enabled\"===opts.initialNavigation||!0===opts.initialNavigation||void 0===opts.initialNavigation}isLegacyDisabled(opts){return\"legacy_disabled\"===opts.initialNavigation||!1===opts.initialNavigation}}return RouterInitializer.ɵfac=function(t){return new(t||RouterInitializer)(ɵɵinject(Injector))},RouterInitializer.ɵprov=ɵɵdefineInjectable({token:RouterInitializer,factory:RouterInitializer.ɵfac}),RouterInitializer})();function getAppInitializer(r){return r.appInitializer.bind(r)}function getBootstrapListener(r){return r.bootstrapListener.bind(r)}const ROUTER_INITIALIZER=new InjectionToken(\"Router Initializer\");var index_cjs=__webpack_require__(\"Wcq6\"),index_cjs_default=__webpack_require__.n(index_cjs);class Action_Action extends Subscription_Subscription{constructor(scheduler,work){super()}schedule(state,delay=0){return this}}class AsyncAction_AsyncAction extends Action_Action{constructor(scheduler,work){super(scheduler,work),this.scheduler=scheduler,this.work=work,this.pending=!1}schedule(state,delay=0){if(this.closed)return this;this.state=state;const id=this.id,scheduler=this.scheduler;return null!=id&&(this.id=this.recycleAsyncId(scheduler,id,delay)),this.pending=!0,this.delay=delay,this.id=this.id||this.requestAsyncId(scheduler,this.id,delay),this}requestAsyncId(scheduler,id,delay=0){return setInterval(scheduler.flush.bind(scheduler,this),delay)}recycleAsyncId(scheduler,id,delay=0){if(null!==delay&&this.delay===delay&&!1===this.pending)return id;clearInterval(id)}execute(state,delay){if(this.closed)return new Error(\"executing a cancelled action\");this.pending=!1;const error=this._execute(state,delay);if(error)return error;!1===this.pending&&null!=this.id&&(this.id=this.recycleAsyncId(this.scheduler,this.id,null))}_execute(state,delay){let errored=!1,errorValue=void 0;try{this.work(state)}catch(e){errored=!0,errorValue=!!e&&e||new Error(e)}if(errored)return this.unsubscribe(),errorValue}_unsubscribe(){const id=this.id,scheduler=this.scheduler,actions=scheduler.actions,index=actions.indexOf(this);this.work=null,this.state=null,this.pending=!1,this.scheduler=null,-1!==index&&actions.splice(index,1),null!=id&&(this.id=this.recycleAsyncId(scheduler,id,null)),this.delay=null}}let Scheduler=(()=>{class Scheduler{constructor(SchedulerAction,now=Scheduler.now){this.SchedulerAction=SchedulerAction,this.now=now}schedule(work,delay=0,state){return new this.SchedulerAction(this,work).schedule(state,delay)}}return Scheduler.now=()=>Date.now(),Scheduler})();class AsyncScheduler_AsyncScheduler extends Scheduler{constructor(SchedulerAction,now=Scheduler.now){super(SchedulerAction,()=>AsyncScheduler_AsyncScheduler.delegate&&AsyncScheduler_AsyncScheduler.delegate!==this?AsyncScheduler_AsyncScheduler.delegate.now():now()),this.actions=[],this.active=!1,this.scheduled=void 0}schedule(work,delay=0,state){return AsyncScheduler_AsyncScheduler.delegate&&AsyncScheduler_AsyncScheduler.delegate!==this?AsyncScheduler_AsyncScheduler.delegate.schedule(work,delay,state):super.schedule(work,delay,state)}flush(action){const{actions:actions}=this;if(this.active)return void actions.push(action);let error;this.active=!0;do{if(error=action.execute(action.state,action.delay))break}while(action=actions.shift());if(this.active=!1,error){for(;action=actions.shift();)action.unsubscribe();throw error}}}const async_async=new AsyncScheduler_AsyncScheduler(AsyncAction_AsyncAction);let Notification_Notification=(()=>{class Notification{constructor(kind,value,error){this.kind=kind,this.value=value,this.error=error,this.hasValue=\"N\"===kind}observe(observer){switch(this.kind){case\"N\":return observer.next&&observer.next(this.value);case\"E\":return observer.error&&observer.error(this.error);case\"C\":return observer.complete&&observer.complete()}}do(next,error,complete){switch(this.kind){case\"N\":return next&&next(this.value);case\"E\":return error&&error(this.error);case\"C\":return complete&&complete()}}accept(nextOrObserver,error,complete){return nextOrObserver&&\"function\"==typeof nextOrObserver.next?this.observe(nextOrObserver):this.do(nextOrObserver,error,complete)}toObservable(){switch(this.kind){case\"N\":return of(this.value);case\"E\":return error=this.error,new Observable_Observable(subscriber=>subscriber.error(error));case\"C\":return empty_empty()}var error;throw new Error(\"unexpected notification kind value\")}static createNext(value){return void 0!==value?new Notification(\"N\",value):Notification.undefinedValueNotification}static createError(err){return new Notification(\"E\",void 0,err)}static createComplete(){return Notification.completeNotification}}return Notification.completeNotification=new Notification(\"C\"),Notification.undefinedValueNotification=new Notification(\"N\",void 0),Notification})();function observeOn(scheduler,delay=0){return function(source){return source.lift(new ObserveOnOperator(scheduler,delay))}}class ObserveOnOperator{constructor(scheduler,delay=0){this.scheduler=scheduler,this.delay=delay}call(subscriber,source){return source.subscribe(new observeOn_ObserveOnSubscriber(subscriber,this.scheduler,this.delay))}}class observeOn_ObserveOnSubscriber extends Subscriber_Subscriber{constructor(destination,scheduler,delay=0){super(destination),this.scheduler=scheduler,this.delay=delay}static dispatch(arg){const{notification:notification,destination:destination}=arg;notification.observe(destination),this.unsubscribe()}scheduleMessage(notification){this.destination.add(this.scheduler.schedule(observeOn_ObserveOnSubscriber.dispatch,this.delay,new ObserveOnMessage(notification,this.destination)))}_next(value){this.scheduleMessage(Notification_Notification.createNext(value))}_error(err){this.scheduleMessage(Notification_Notification.createError(err)),this.unsubscribe()}_complete(){this.scheduleMessage(Notification_Notification.createComplete()),this.unsubscribe()}}class ObserveOnMessage{constructor(notification,destination){this.notification=notification,this.destination=destination}}class QueueAction_QueueAction extends AsyncAction_AsyncAction{constructor(scheduler,work){super(scheduler,work),this.scheduler=scheduler,this.work=work}schedule(state,delay=0){return delay>0?super.schedule(state,delay):(this.delay=delay,this.state=state,this.scheduler.flush(this),this)}execute(state,delay){return delay>0||this.closed?super.execute(state,delay):this._execute(state,delay)}requestAsyncId(scheduler,id,delay=0){return null!==delay&&delay>0||null===delay&&this.delay>0?super.requestAsyncId(scheduler,id,delay):scheduler.flush(this)}}class QueueScheduler_QueueScheduler extends AsyncScheduler_AsyncScheduler{}const queue=new QueueScheduler_QueueScheduler(QueueAction_QueueAction);let nextHandle=1;const RESOLVED=(()=>Promise.resolve())(),activeHandles={};function findAndClearHandle(handle){return handle in activeHandles&&(delete activeHandles[handle],!0)}const Immediate={setImmediate(cb){const handle=nextHandle++;return activeHandles[handle]=!0,RESOLVED.then(()=>findAndClearHandle(handle)&&cb()),handle},clearImmediate(handle){findAndClearHandle(handle)}};class AsapAction_AsapAction extends AsyncAction_AsyncAction{constructor(scheduler,work){super(scheduler,work),this.scheduler=scheduler,this.work=work}requestAsyncId(scheduler,id,delay=0){return null!==delay&&delay>0?super.requestAsyncId(scheduler,id,delay):(scheduler.actions.push(this),scheduler.scheduled||(scheduler.scheduled=Immediate.setImmediate(scheduler.flush.bind(scheduler,null))))}recycleAsyncId(scheduler,id,delay=0){if(null!==delay&&delay>0||null===delay&&this.delay>0)return super.recycleAsyncId(scheduler,id,delay);0===scheduler.actions.length&&(Immediate.clearImmediate(id),scheduler.scheduled=void 0)}}class AsapScheduler_AsapScheduler extends AsyncScheduler_AsyncScheduler{flush(action){this.active=!0,this.scheduled=void 0;const{actions:actions}=this;let error,index=-1,count=actions.length;action=action||actions.shift();do{if(error=action.execute(action.state,action.delay))break}while(++index<count&&(action=actions.shift()));if(this.active=!1,error){for(;++index<count&&(action=actions.shift());)action.unsubscribe();throw error}}}const asap=new AsapScheduler_AsapScheduler(AsapAction_AsapAction);class SubscribeOnObservable_SubscribeOnObservable extends Observable_Observable{constructor(source,delayTime=0,scheduler=asap){var val;super(),this.source=source,this.delayTime=delayTime,this.scheduler=scheduler,(isArray(val=delayTime)||!(val-parseFloat(val)+1>=0)||delayTime<0)&&(this.delayTime=0),scheduler&&\"function\"==typeof scheduler.schedule||(this.scheduler=asap)}static create(source,delay=0,scheduler=asap){return new SubscribeOnObservable_SubscribeOnObservable(source,delay,scheduler)}static dispatch(arg){const{source:source,subscriber:subscriber}=arg;return this.add(source.subscribe(subscriber))}_subscribe(subscriber){return this.scheduler.schedule(SubscribeOnObservable_SubscribeOnObservable.dispatch,this.delayTime,{source:this.source,subscriber:subscriber})}}class subscribeOn_SubscribeOnOperator{constructor(scheduler,delay){this.scheduler=scheduler,this.delay=delay}call(subscriber,source){return new SubscribeOnObservable_SubscribeOnObservable(source,this.delay,this.scheduler).subscribe(subscriber)}}function angular_fire_noop(){}class angular_fire_ZoneScheduler{constructor(zone,delegate=queue){this.zone=zone,this.delegate=delegate}now(){return this.delegate.now()}schedule(work,delay,state){const targetZone=this.zone;return this.delegate.schedule((function(state){targetZone.runGuarded(()=>{work.apply(this,[state])})}),delay,state)}}class angular_fire_BlockUntilFirstOperator{constructor(zone){this.zone=zone,this.task=null}call(subscriber,source){const unscheduleTask=this.unscheduleTask.bind(this);return this.task=this.zone.run(()=>Zone.current.scheduleMacroTask(\"firebaseZoneBlock\",angular_fire_noop,{},angular_fire_noop,angular_fire_noop)),source.pipe(tap({next:unscheduleTask,complete:unscheduleTask,error:unscheduleTask})).subscribe(subscriber).add(unscheduleTask)}unscheduleTask(){setTimeout(()=>{null!=this.task&&\"scheduled\"===this.task.state&&(this.task.invoke(),this.task=null)},10)}}class angular_fire_AngularFireSchedulers{constructor(ngZone){this.ngZone=ngZone,this.outsideAngular=ngZone.runOutsideAngular(()=>new angular_fire_ZoneScheduler(Zone.current)),this.insideAngular=ngZone.run(()=>new angular_fire_ZoneScheduler(Zone.current,async_async))}}function ɵkeepUnstableUntilFirstFactory(schedulers){return function(obs$){return(obs$=obs$.lift(new angular_fire_BlockUntilFirstOperator(schedulers.ngZone))).pipe(function(scheduler,delay=0){return function(source){return source.lift(new subscribeOn_SubscribeOnOperator(scheduler,delay))}}(schedulers.outsideAngular),observeOn(schedulers.insideAngular))}}const noopFunctions=[\"ngOnDestroy\"],FIREBASE_OPTIONS=new InjectionToken(\"angularfire2.app.options\"),FIREBASE_APP_NAME=new InjectionToken(\"angularfire2.app.nameOrConfig\"),angular_fire_VERSION=new Version(\"6.0.3\");function ɵfirebaseAppFactory(options,zone,nameOrConfig){const config=\"object\"==typeof nameOrConfig&&nameOrConfig||{};return config.name=config.name||\"string\"==typeof nameOrConfig&&nameOrConfig||\"[DEFAULT]\",index_cjs_default.a.apps.filter(app=>app&&app.name===config.name)[0]||zone.runOutsideAngular(()=>index_cjs_default.a.initializeApp(options,config))}const FIREBASE_APP_PROVIDER={provide:class{},useFactory:ɵfirebaseAppFactory,deps:[FIREBASE_OPTIONS,NgZone,[new Optional,FIREBASE_APP_NAME]]};let angular_fire_AngularFireModule=(()=>{class AngularFireModule{constructor(platformId){index_cjs_default.a.registerVersion(\"angularfire\",angular_fire_VERSION.full,platformId.toString()),index_cjs_default.a.registerVersion(\"angular\",VERSION.full)}static initializeApp(options,nameOrConfig){return{ngModule:AngularFireModule,providers:[{provide:FIREBASE_OPTIONS,useValue:options},{provide:FIREBASE_APP_NAME,useValue:nameOrConfig}]}}}return AngularFireModule.ɵmod=ɵɵdefineNgModule({type:AngularFireModule}),AngularFireModule.ɵinj=ɵɵdefineInjector({factory:function(t){return new(t||AngularFireModule)(ɵɵinject(PLATFORM_ID))},providers:[FIREBASE_APP_PROVIDER]}),AngularFireModule})();function fromRef(ref,scheduler){return function(ref,scheduler=async_async){return new Observable_Observable(subscriber=>{let unsubscribe;return null!=scheduler?scheduler.schedule(()=>{unsubscribe=ref.onSnapshot(subscriber)}):unsubscribe=ref.onSnapshot(subscriber),()=>{null!=unsubscribe&&unsubscribe()}})}(ref,scheduler)}function fromCollectionRef(ref,scheduler){return fromRef(ref,scheduler).pipe(map(payload=>({payload:payload,type:\"query\"})))}function docChanges(query,scheduler){return fromCollectionRef(query,scheduler).pipe(map(action=>action.payload.docChanges().map(change=>({type:change.type,payload:change}))))}function sortedChanges(query,events,scheduler){return fromCollectionRef(query,scheduler).pipe(map(changes=>changes.payload.docChanges()),scan((current,changes)=>function(current,changes,events){return changes.forEach(change=>{events.indexOf(change.type)>-1&&(current=function(combined,change){switch(change.type){case\"added\":combined[change.newIndex]&&combined[change.newIndex].doc.ref.isEqual(change.doc.ref)||combined.splice(change.newIndex,0,change);break;case\"modified\":(null==combined[change.oldIndex]||combined[change.oldIndex].doc.ref.isEqual(change.doc.ref))&&(change.oldIndex!==change.newIndex?(combined.splice(change.oldIndex,1),combined.splice(change.newIndex,0,change)):combined.splice(change.newIndex,1,change));break;case\"removed\":combined[change.oldIndex]&&combined[change.oldIndex].doc.ref.isEqual(change.doc.ref)&&combined.splice(change.oldIndex,1)}return combined}(current,change))}),current}(current,changes,events),[]),map(changes=>changes.map(c=>({type:c.type,payload:c}))))}function validateEventsArray(events){return events&&0!==events.length||(events=[\"added\",\"removed\",\"modified\"]),events}__webpack_require__(\"6Joi\");class angular_fire_firestore_AngularFirestoreCollection{constructor(ref,query,afs){this.ref=ref,this.query=query,this.afs=afs}stateChanges(events){return events&&0!==events.length?docChanges(this.query,this.afs.schedulers.outsideAngular).pipe(map(actions=>actions.filter(change=>events.indexOf(change.type)>-1)),filter(changes=>changes.length>0),this.afs.keepUnstableUntilFirst):docChanges(this.query,this.afs.schedulers.outsideAngular).pipe(this.afs.keepUnstableUntilFirst)}auditTrail(events){return this.stateChanges(events).pipe(scan((current,action)=>[...current,...action],[]))}snapshotChanges(events){const validatedEvents=validateEventsArray(events);return sortedChanges(this.query,validatedEvents,this.afs.schedulers.outsideAngular).pipe(this.afs.keepUnstableUntilFirst)}valueChanges(options={}){return fromCollectionRef(this.query,this.afs.schedulers.outsideAngular).pipe(map(actions=>actions.payload.docs.map(a=>options.idField?Object.assign(Object.assign({},a.data()),{[options.idField]:a.id}):a.data())),this.afs.keepUnstableUntilFirst)}get(options){return from(this.query.get(options)).pipe(observeOn(this.afs.schedulers.insideAngular))}add(data){return this.ref.add(data)}doc(path){return new angular_fire_firestore_AngularFirestoreDocument(this.ref.doc(path),this.afs)}}class angular_fire_firestore_AngularFirestoreDocument{constructor(ref,afs){this.ref=ref,this.afs=afs}set(data,options){return this.ref.set(data,options)}update(data){return this.ref.update(data)}delete(){return this.ref.delete()}collection(path,queryFn){const collectionRef=this.ref.collection(path),{ref:ref,query:query}=associateQuery(collectionRef,queryFn);return new angular_fire_firestore_AngularFirestoreCollection(ref,query,this.afs)}snapshotChanges(){return fromRef(this.ref,this.afs.schedulers.outsideAngular).pipe(map(payload=>({payload:payload,type:\"value\"}))).pipe(this.afs.keepUnstableUntilFirst)}valueChanges(){return this.snapshotChanges().pipe(map(action=>action.payload.data()))}get(options){return from(this.ref.get(options)).pipe(observeOn(this.afs.schedulers.insideAngular))}}class angular_fire_firestore_AngularFirestoreCollectionGroup{constructor(query,afs){this.query=query,this.afs=afs}stateChanges(events){return events&&0!==events.length?docChanges(this.query,this.afs.schedulers.outsideAngular).pipe(map(actions=>actions.filter(change=>events.indexOf(change.type)>-1)),filter(changes=>changes.length>0),this.afs.keepUnstableUntilFirst):docChanges(this.query,this.afs.schedulers.outsideAngular).pipe(this.afs.keepUnstableUntilFirst)}auditTrail(events){return this.stateChanges(events).pipe(scan((current,action)=>[...current,...action],[]))}snapshotChanges(events){const validatedEvents=validateEventsArray(events);return sortedChanges(this.query,validatedEvents,this.afs.schedulers.outsideAngular).pipe(this.afs.keepUnstableUntilFirst)}valueChanges(){return fromCollectionRef(this.query,this.afs.schedulers.outsideAngular).pipe(map(actions=>actions.payload.docs.map(a=>a.data())),this.afs.keepUnstableUntilFirst)}get(options){return from(this.query.get(options)).pipe(observeOn(this.afs.schedulers.insideAngular))}}const atFirestore=__webpack_require__(\"6Joi\"),ENABLE_PERSISTENCE=new InjectionToken(\"angularfire2.enableFirestorePersistence\"),PERSISTENCE_SETTINGS=new InjectionToken(\"angularfire2.firestore.persistenceSettings\"),SETTINGS=new InjectionToken(\"angularfire2.firestore.settings\");function associateQuery(collectionRef,queryFn=(ref=>ref)){return{query:queryFn(collectionRef),ref:collectionRef}}let angular_fire_firestore_AngularFirestore=(()=>{class AngularFirestore{constructor(options,nameOrConfig,shouldEnablePersistence,settings,platformId,zone,persistenceSettings){this.schedulers=new angular_fire_AngularFireSchedulers(zone),this.keepUnstableUntilFirst=ɵkeepUnstableUntilFirstFactory(this.schedulers),this.firestore=zone.runOutsideAngular(()=>{const app=ɵfirebaseAppFactory(options,zone,nameOrConfig);\"registerFirestore\"in atFirestore&&atFirestore.registerFirestore(index_cjs_default.a);const firestore=app.firestore();return settings&&firestore.settings(settings),firestore}),this.persistenceEnabled$=shouldEnablePersistence&&!isPlatformServer(platformId)?zone.runOutsideAngular(()=>{try{return from(this.firestore.enablePersistence(persistenceSettings||void 0).then(()=>!0,()=>!1))}catch(e){return of(!1)}}):of(!1)}collection(pathOrRef,queryFn){let collectionRef;collectionRef=\"string\"==typeof pathOrRef?this.firestore.collection(pathOrRef):pathOrRef;const{ref:ref,query:query}=associateQuery(collectionRef,queryFn),refInZone=this.schedulers.ngZone.run(()=>ref);return new angular_fire_firestore_AngularFirestoreCollection(refInZone,query,this)}collectionGroup(collectionId,queryGroupFn){const queryFn=queryGroupFn||(ref=>ref),collectionGroup=this.firestore.collectionGroup(collectionId);return new angular_fire_firestore_AngularFirestoreCollectionGroup(queryFn(collectionGroup),this)}doc(pathOrRef){let ref;ref=\"string\"==typeof pathOrRef?this.firestore.doc(pathOrRef):pathOrRef;const refInZone=this.schedulers.ngZone.run(()=>ref);return new angular_fire_firestore_AngularFirestoreDocument(refInZone,this)}createId(){return this.firestore.collection(\"_\").doc().id}}return AngularFirestore.ɵfac=function(t){return new(t||AngularFirestore)(ɵɵinject(FIREBASE_OPTIONS),ɵɵinject(FIREBASE_APP_NAME,8),ɵɵinject(ENABLE_PERSISTENCE,8),ɵɵinject(SETTINGS,8),ɵɵinject(PLATFORM_ID),ɵɵinject(NgZone),ɵɵinject(PERSISTENCE_SETTINGS,8))},AngularFirestore.ɵprov=ɵɵdefineInjectable({factory:function(){return new AngularFirestore(ɵɵinject(FIREBASE_OPTIONS),ɵɵinject(FIREBASE_APP_NAME,8),ɵɵinject(ENABLE_PERSISTENCE,8),ɵɵinject(SETTINGS,8),ɵɵinject(PLATFORM_ID),ɵɵinject(NgZone),ɵɵinject(PERSISTENCE_SETTINGS,8))},token:AngularFirestore,providedIn:\"any\"}),AngularFirestore})(),angular_fire_firestore_AngularFirestoreModule=(()=>{class AngularFirestoreModule{static enablePersistence(persistenceSettings){return{ngModule:AngularFirestoreModule,providers:[{provide:ENABLE_PERSISTENCE,useValue:!0},{provide:PERSISTENCE_SETTINGS,useValue:persistenceSettings}]}}}return AngularFirestoreModule.ɵmod=ɵɵdefineNgModule({type:AngularFirestoreModule}),AngularFirestoreModule.ɵinj=ɵɵdefineInjector({factory:function(t){return new(t||AngularFirestoreModule)},providers:[angular_fire_firestore_AngularFirestore]}),AngularFirestoreModule})();class ReplaySubject_ReplaySubject extends Subject_Subject{constructor(bufferSize=Number.POSITIVE_INFINITY,windowTime=Number.POSITIVE_INFINITY,scheduler){super(),this.scheduler=scheduler,this._events=[],this._infiniteTimeWindow=!1,this._bufferSize=bufferSize<1?1:bufferSize,this._windowTime=windowTime<1?1:windowTime,windowTime===Number.POSITIVE_INFINITY?(this._infiniteTimeWindow=!0,this.next=this.nextInfiniteTimeWindow):this.next=this.nextTimeWindow}nextInfiniteTimeWindow(value){const _events=this._events;_events.push(value),_events.length>this._bufferSize&&_events.shift(),super.next(value)}nextTimeWindow(value){this._events.push(new ReplayEvent(this._getNow(),value)),this._trimBufferThenGetEvents(),super.next(value)}_subscribe(subscriber){const _infiniteTimeWindow=this._infiniteTimeWindow,_events=_infiniteTimeWindow?this._events:this._trimBufferThenGetEvents(),scheduler=this.scheduler,len=_events.length;let subscription;if(this.closed)throw new ObjectUnsubscribedError;if(this.isStopped||this.hasError?subscription=Subscription_Subscription.EMPTY:(this.observers.push(subscriber),subscription=new SubjectSubscription_SubjectSubscription(this,subscriber)),scheduler&&subscriber.add(subscriber=new observeOn_ObserveOnSubscriber(subscriber,scheduler)),_infiniteTimeWindow)for(let i=0;i<len&&!subscriber.closed;i++)subscriber.next(_events[i]);else for(let i=0;i<len&&!subscriber.closed;i++)subscriber.next(_events[i].value);return this.hasError?subscriber.error(this.thrownError):this.isStopped&&subscriber.complete(),subscription}_getNow(){return(this.scheduler||queue).now()}_trimBufferThenGetEvents(){const now=this._getNow(),_bufferSize=this._bufferSize,_windowTime=this._windowTime,_events=this._events,eventsCount=_events.length;let spliceCount=0;for(;spliceCount<eventsCount&&!(now-_events[spliceCount].time<_windowTime);)spliceCount++;return eventsCount>_bufferSize&&(spliceCount=Math.max(spliceCount,eventsCount-_bufferSize)),spliceCount>0&&_events.splice(0,spliceCount),_events}}class ReplayEvent{constructor(time,value){this.time=time,this.value=value}}let angular_fire_auth_AngularFireAuth=(()=>{class AngularFireAuth{constructor(options,nameOrConfig,platformId,zone){const schedulers=new angular_fire_AngularFireSchedulers(zone),keepUnstableUntilFirst=ɵkeepUnstableUntilFirstFactory(schedulers),auth=of(void 0).pipe(observeOn(schedulers.outsideAngular),switchMap(()=>zone.runOutsideAngular(()=>__webpack_require__.e(5).then(__webpack_require__.bind(null,\"6nsN\")))),map(()=>ɵfirebaseAppFactory(options,zone,nameOrConfig)),map(app=>zone.runOutsideAngular(()=>app.auth())),function(configOrBufferSize,windowTime,scheduler){let config;return config=configOrBufferSize&&\"object\"==typeof configOrBufferSize?configOrBufferSize:{bufferSize:configOrBufferSize,windowTime:void 0,refCount:!1,scheduler:void 0},source=>source.lift(function({bufferSize:bufferSize=Number.POSITIVE_INFINITY,windowTime:windowTime=Number.POSITIVE_INFINITY,refCount:useRefCount,scheduler:scheduler}){let subject,subscription,refCount=0,hasError=!1,isComplete=!1;return function(source){refCount++,subject&&!hasError||(hasError=!1,subject=new ReplaySubject_ReplaySubject(bufferSize,windowTime,scheduler),subscription=source.subscribe({next(value){subject.next(value)},error(err){hasError=!0,subject.error(err)},complete(){isComplete=!0,subscription=void 0,subject.complete()}}));const innerSub=subject.subscribe(this);this.add(()=>{refCount--,innerSub.unsubscribe(),subscription&&!isComplete&&useRefCount&&0===refCount&&(subscription.unsubscribe(),subscription=void 0,subject=void 0)})}}(config))}({bufferSize:1,refCount:!1}));return isPlatformServer(platformId)?this.authState=this.user=this.idToken=this.idTokenResult=of(null):(auth.pipe(first_first()).subscribe(),this.authState=auth.pipe(switchMap(auth=>auth.getRedirectResult().then(()=>auth)),switchMap(auth=>zone.runOutsideAngular(()=>new Observable_Observable(auth.onAuthStateChanged.bind(auth)))),keepUnstableUntilFirst),this.user=auth.pipe(switchMap(auth=>auth.getRedirectResult().then(()=>auth)),switchMap(auth=>zone.runOutsideAngular(()=>new Observable_Observable(auth.onIdTokenChanged.bind(auth)))),keepUnstableUntilFirst),this.idToken=this.user.pipe(switchMap(user=>user?from(user.getIdToken()):of(null))),this.idTokenResult=this.user.pipe(switchMap(user=>user?from(user.getIdTokenResult()):of(null)))),((klass,observable,zone)=>new Proxy(klass,{get:(_,name)=>zone.runOutsideAngular(()=>{if(klass[name])return klass[name];if(noopFunctions.includes(name))return()=>{};const promise=observable.toPromise().then(mod=>{const ret=mod&&mod[name];return\"function\"==typeof ret?ret.bind(mod):ret&&ret.then?ret.then(res=>zone.run(()=>res)):zone.run(()=>ret)});return new Proxy(()=>{},{get:(_,name)=>promise[name],apply:(self,_,args)=>promise.then(it=>it&&it(...args))})})}))(this,auth,zone)}}return AngularFireAuth.ɵfac=function(t){return new(t||AngularFireAuth)(ɵɵinject(FIREBASE_OPTIONS),ɵɵinject(FIREBASE_APP_NAME,8),ɵɵinject(PLATFORM_ID),ɵɵinject(NgZone))},AngularFireAuth.ɵprov=ɵɵdefineInjectable({factory:function(){return new AngularFireAuth(ɵɵinject(FIREBASE_OPTIONS),ɵɵinject(FIREBASE_APP_NAME,8),ɵɵinject(PLATFORM_ID),ɵɵinject(NgZone))},token:AngularFireAuth,providedIn:\"any\"}),AngularFireAuth})(),angular_fire_auth_AngularFireAuthModule=(()=>{class AngularFireAuthModule{}return AngularFireAuthModule.ɵmod=ɵɵdefineNgModule({type:AngularFireAuthModule}),AngularFireAuthModule.ɵinj=ɵɵdefineInjector({factory:function(t){return new(t||AngularFireAuthModule)},providers:[angular_fire_auth_AngularFireAuth]}),AngularFireAuthModule})(),auth_service_AuthService=(()=>{class AuthService{constructor(afs,afAuth,router,ngZone){this.afs=afs,this.afAuth=afAuth,this.router=router,this.ngZone=ngZone,this.afAuth.authState.subscribe(user=>{user?(this.userData=user,localStorage.setItem(\"user\",JSON.stringify(this.userData)),JSON.parse(localStorage.getItem(\"user\"))):(localStorage.setItem(\"user\",null),JSON.parse(localStorage.getItem(\"user\")))})}SignIn(email,password){return this.afAuth.signInWithEmailAndPassword(email,password).then(result=>{this.ngZone.run(()=>{this.router.navigate([\"dashboard\"])}),this.SetUserData(result.user)}).catch(error=>{window.alert(error.message)})}SignUp(email,password){return this.afAuth.createUserWithEmailAndPassword(email,password).then(result=>{this.SendVerificationMail(),this.SetUserData(result.user)}).catch(error=>{window.alert(error.message)})}SendVerificationMail(){return this.afAuth.currentUser.then(u=>u.sendEmailVerification()).then(()=>{this.router.navigate([\"verify-email-address\"])})}ForgotPassword(passwordResetEmail){return this.afAuth.sendPasswordResetEmail(passwordResetEmail).then(()=>{window.alert(\"Password reset email sent, check your inbox.\")}).catch(error=>{window.alert(error)})}get isLoggedIn(){return JSON.parse(localStorage.getItem(\"user\")),!0}FacebookAuth(){return this.AuthLogin(new index_cjs.auth.FacebookAuthProvider)}TwitterAuth(){return this.AuthLogin(new index_cjs.auth.TwitterAuthProvider)}GoogleAuth(){return this.AuthLogin(new index_cjs.auth.GoogleAuthProvider)}AuthLogin(provider){return this.afAuth.signInWithPopup(provider).then(result=>{this.ngZone.run(()=>{this.router.navigate([\"dashboard\"])}),this.SetUserData(result.user)}).catch(error=>{window.alert(error)})}SetUserData(user){return this.afs.doc(\"users/\"+user.uid).set({uid:user.uid,email:user.email,displayName:user.displayName,photoURL:user.photoURL,emailVerified:user.emailVerified},{merge:!0})}SignOut(){return this.afAuth.signOut().then(()=>{localStorage.setItem(\"user\",null),localStorage.removeItem(\"user\"),this.router.navigate([\"sign-in\"])})}}return AuthService.ɵfac=function(t){return new(t||AuthService)(ɵɵinject(angular_fire_firestore_AngularFirestore),ɵɵinject(angular_fire_auth_AngularFireAuth),ɵɵinject(router_Router),ɵɵinject(NgZone))},AuthService.ɵprov=ɵɵdefineInjectable({token:AuthService,factory:AuthService.ɵfac,providedIn:\"root\"}),AuthService})(),sign_in_component_SignInComponent=(()=>{class SignInComponent{constructor(authService){this.authService=authService}ngOnInit(){}}return SignInComponent.ɵfac=function(t){return new(t||SignInComponent)(ɵɵdirectiveInject(auth_service_AuthService))},SignInComponent.ɵcmp=ɵɵdefineComponent({type:SignInComponent,selectors:[[\"app-sign-in\"]],decls:42,vars:0,consts:[[1,\"container\",\"py-5\"],[1,\"row\"],[1,\"col-md-12\"],[1,\"col-md-6\",\"mx-auto\"],[1,\"card\",\"rounded-0\"],[1,\"card-header\"],[1,\"mb-0\"],[1,\"displayTable\"],[1,\"displayTableCell\"],[1,\"authBlock\"],[1,\"form-group\"],[\"type\",\"text\",\"placeholder\",\"Username\",\"required\",\"\",1,\"form-control\"],[\"userName\",\"\"],[\"type\",\"password\",\"placeholder\",\"Password\",\"required\",\"\",1,\"form-control\"],[\"userPassword\",\"\"],[1,\"forgotPassword\"],[\"routerLink\",\"/forgot-password\"],[\"type\",\"button\",\"value\",\"Log in\",1,\"btn\",\"btn-success\",\"btn-lg\",\"float-left\",3,\"click\"],[1,\"or\"],[1,\"orInner\",\"left\"],[\"type\",\"button\",1,\"btn\",\"btn-primary\",\"btn-lg\",\"float-left\",3,\"click\"],[1,\"fab\",\"fa-google-plus-g\"],[1,\"redirectToLogin\"],[\"routerLink\",\"/register-user\",1,\"redirect\"]],template:function(rf,ctx){if(1&rf){const _r2=ɵɵgetCurrentView();ɵɵelementStart(0,\"div\",0),ɵɵelementStart(1,\"div\",1),ɵɵelementStart(2,\"div\",2),ɵɵelementStart(3,\"div\",1),ɵɵelementStart(4,\"div\",3),ɵɵelementStart(5,\"div\",4),ɵɵelementStart(6,\"div\",5),ɵɵelementStart(7,\"h3\",6),ɵɵtext(8,\"Sign In\"),ɵɵelementEnd(),ɵɵelementEnd(),ɵɵelementStart(9,\"div\",7),ɵɵelementStart(10,\"div\",8),ɵɵelementStart(11,\"div\",9),ɵɵelementStart(12,\"div\",10),ɵɵelement(13,\"input\",11,12),ɵɵelementEnd(),ɵɵelementStart(15,\"div\",10),ɵɵelement(16,\"input\",13,14),ɵɵelementEnd(),ɵɵelementStart(18,\"div\",15),ɵɵelementStart(19,\"span\",16),ɵɵtext(20,\"Forgot Password?\"),ɵɵelementEnd(),ɵɵelementEnd(),ɵɵelement(21,\"br\"),ɵɵelementStart(22,\"div\",10),ɵɵelementStart(23,\"input\",17),ɵɵlistener(\"click\",(function(){ɵɵrestoreView(_r2);const _r0=ɵɵreference(14),_r1=ɵɵreference(17);return ctx.authService.SignIn(_r0.value,_r1.value)})),ɵɵelementEnd(),ɵɵelementEnd(),ɵɵelement(24,\"br\"),ɵɵelementStart(25,\"div\",10),ɵɵelementStart(26,\"span\",18),ɵɵelementStart(27,\"span\",19),ɵɵtext(28,\"Or\"),ɵɵelementEnd(),ɵɵelementEnd(),ɵɵelementEnd(),ɵɵelementStart(29,\"div\",10),ɵɵelementStart(30,\"button\",20),ɵɵlistener(\"click\",(function(){return ctx.authService.GoogleAuth()})),ɵɵelement(31,\"i\",21),ɵɵtext(32,\" Log in with Google \"),ɵɵelementEnd(),ɵɵelement(33,\"br\"),ɵɵelement(34,\"br\"),ɵɵelement(35,\"br\"),ɵɵelementEnd(),ɵɵelement(36,\"br\"),ɵɵelementStart(37,\"div\",22),ɵɵelementStart(38,\"span\"),ɵɵtext(39,\"Don't have an account?\"),ɵɵelementStart(40,\"span\",23),ɵɵtext(41,\" Sign Up\"),ɵɵelementEnd(),ɵɵelementEnd(),ɵɵelementEnd(),ɵɵelementEnd(),ɵɵelementEnd(),ɵɵelementEnd(),ɵɵelementEnd(),ɵɵelementEnd(),ɵɵelementEnd(),ɵɵelementEnd(),ɵɵelementEnd(),ɵɵelementEnd()}},directives:[router_RouterLink],styles:[\"\"]}),SignInComponent})(),sign_up_component_SignUpComponent=(()=>{class SignUpComponent{constructor(authService){this.authService=authService}ngOnInit(){}}return SignUpComponent.ɵfac=function(t){return new(t||SignUpComponent)(ɵɵdirectiveInject(auth_service_AuthService))},SignUpComponent.ɵcmp=ɵɵdefineComponent({type:SignUpComponent,selectors:[[\"app-sign-up\"]],decls:36,vars:0,consts:[[1,\"displayTable\"],[1,\"displayTableCell\"],[1,\"authBlock\"],[1,\"formGroup\"],[\"type\",\"email\",\"placeholder\",\"Email Address\",\"required\",\"\",1,\"formControl\"],[\"userEmail\",\"\"],[\"type\",\"password\",\"placeholder\",\"Password\",\"required\",\"\",1,\"formControl\"],[\"userPwd\",\"\"],[\"type\",\"button\",\"value\",\"Sign Up\",1,\"btn\",\"btnPrimary\",3,\"click\"],[1,\"or\"],[1,\"orInner\"],[\"type\",\"button\",1,\"btn\",\"googleBtn\",3,\"click\"],[1,\"fab\",\"fa-google-plus-g\"],[\"type\",\"button\",1,\"btn\",\"facebookBtn\",3,\"click\"],[1,\"fab\",\"fa-facebook\"],[1,\"fab\",\"fa-twitter\"],[1,\"redirectToLogin\"],[\"routerLink\",\"/sign-in\",1,\"redirect\"]],template:function(rf,ctx){if(1&rf){const _r5=ɵɵgetCurrentView();ɵɵelementStart(0,\"p\"),ɵɵtext(1,\"sign-up works!\"),ɵɵelementEnd(),ɵɵelementStart(2,\"div\",0),ɵɵelementStart(3,\"div\",1),ɵɵelementStart(4,\"div\",2),ɵɵelementStart(5,\"h3\"),ɵɵtext(6,\"Sign Up\"),ɵɵelementEnd(),ɵɵelementStart(7,\"div\",3),ɵɵelement(8,\"input\",4,5),ɵɵelementEnd(),ɵɵelementStart(10,\"div\",3),ɵɵelement(11,\"input\",6,7),ɵɵelementEnd(),ɵɵelementStart(13,\"div\",3),ɵɵelementStart(14,\"input\",8),ɵɵlistener(\"click\",(function(){ɵɵrestoreView(_r5);const _r3=ɵɵreference(9),_r4=ɵɵreference(12);return ctx.authService.SignUp(_r3.value,_r4.value)})),ɵɵelementEnd(),ɵɵelementEnd(),ɵɵelementStart(15,\"div\",3),ɵɵelementStart(16,\"span\",9),ɵɵelementStart(17,\"span\",10),ɵɵtext(18,\"Or\"),ɵɵelementEnd(),ɵɵelementEnd(),ɵɵelementEnd(),ɵɵelementStart(19,\"div\",3),ɵɵelementStart(20,\"button\",11),ɵɵlistener(\"click\",(function(){return ctx.authService.GoogleAuth()})),ɵɵelement(21,\"i\",12),ɵɵtext(22,\" Continue with Google \"),ɵɵelementEnd(),ɵɵelementEnd(),ɵɵelementStart(23,\"div\",3),ɵɵelementStart(24,\"button\",13),ɵɵlistener(\"click\",(function(){return ctx.authService.FacebookAuth()})),ɵɵelement(25,\"i\",14),ɵɵtext(26,\" Continue with Facebook \"),ɵɵelementEnd(),ɵɵelementEnd(),ɵɵelementStart(27,\"div\",3),ɵɵelementStart(28,\"button\",13),ɵɵlistener(\"click\",(function(){return ctx.authService.TwitterAuth()})),ɵɵelement(29,\"i\",15),ɵɵtext(30,\" Continue with Twitter \"),ɵɵelementEnd(),ɵɵelementEnd(),ɵɵelementEnd(),ɵɵelementStart(31,\"div\",16),ɵɵelementStart(32,\"span\"),ɵɵtext(33,\"Already have an account? \"),ɵɵelementStart(34,\"span\",17),ɵɵtext(35,\"Log In\"),ɵɵelementEnd(),ɵɵelementEnd(),ɵɵelementEnd(),ɵɵelementEnd(),ɵɵelementEnd()}},directives:[router_RouterLink],styles:[\"\"]}),SignUpComponent})();class Product{}class DistinctUntilChangedOperator{constructor(compare,keySelector){this.compare=compare,this.keySelector=keySelector}call(subscriber,source){return source.subscribe(new distinctUntilChanged_DistinctUntilChangedSubscriber(subscriber,this.compare,this.keySelector))}}class distinctUntilChanged_DistinctUntilChangedSubscriber extends Subscriber_Subscriber{constructor(destination,compare,keySelector){super(destination),this.keySelector=keySelector,this.hasKey=!1,\"function\"==typeof compare&&(this.compare=compare)}compare(x,y){return x===y}_next(value){let key;try{const{keySelector:keySelector}=this;key=keySelector?keySelector(value):value}catch(err){return this.destination.error(err)}let result=!1;if(this.hasKey)try{const{compare:compare}=this;result=compare(this.key,key)}catch(err){return this.destination.error(err)}else this.hasKey=!0;result||(this.key=key,this.destination.next(value))}}class WithLatestFromOperator{constructor(observables,project){this.observables=observables,this.project=project}call(subscriber,source){return source.subscribe(new withLatestFrom_WithLatestFromSubscriber(subscriber,this.observables,this.project))}}class withLatestFrom_WithLatestFromSubscriber extends OuterSubscriber_OuterSubscriber{constructor(destination,observables,project){super(destination),this.observables=observables,this.project=project,this.toRespond=[];const len=observables.length;this.values=new Array(len);for(let i=0;i<len;i++)this.toRespond.push(i);for(let i=0;i<len;i++){let observable=observables[i];this.add(subscribeToResult(this,observable,observable,i))}}notifyNext(outerValue,innerValue,outerIndex,innerIndex,innerSub){this.values[outerIndex]=innerValue;const toRespond=this.toRespond;if(toRespond.length>0){const found=toRespond.indexOf(outerIndex);-1!==found&&toRespond.splice(found,1)}}notifyComplete(){}_next(value){if(0===this.toRespond.length){const args=[value,...this.values];this.project?this._tryProject(args):this.destination.next(args)}}_tryProject(args){let result;try{result=this.project.apply(this,args)}catch(err){return void this.destination.error(err)}this.destination.next(result)}}class SkipWhileOperator{constructor(predicate){this.predicate=predicate}call(subscriber,source){return source.subscribe(new skipWhile_SkipWhileSubscriber(subscriber,this.predicate))}}class skipWhile_SkipWhileSubscriber extends Subscriber_Subscriber{constructor(destination,predicate){super(destination),this.predicate=predicate,this.skipping=!0,this.index=0}_next(value){const destination=this.destination;this.skipping&&this.tryCallPredicate(value),this.skipping||destination.next(value)}tryCallPredicate(value){try{const result=this.predicate(value,this.index++);this.skipping=Boolean(result)}catch(err){this.destination.error(err)}}}var database_dist_index_cjs=__webpack_require__(\"NSPt\");function isNil(obj){return null==obj}function isFirebaseRef(value){return\"function\"==typeof value.set}function getRef(database,pathRef){return isFirebaseRef(pathRef)?pathRef:database.ref(pathRef)}function checkOperationCases(item,cases){if(\"string\"==typeof item)return cases.stringCase();if(isFirebaseRef(item))return cases.firebaseCase();if(\"function\"==typeof item.exportVal)return cases.snapshotCase();throw new Error(\"Expects a string, snapshot, or reference. Got: \"+typeof item)}function angular_fire_database_fromRef(ref,event,listenType=\"on\",scheduler=async_async){return new Observable_Observable(subscriber=>{let fn=null;return fn=ref[listenType](event,(snapshot,prevKey)=>{scheduler.schedule(()=>{subscriber.next({snapshot:snapshot,prevKey:prevKey})}),\"once\"===listenType&&scheduler.schedule(()=>subscriber.complete())},err=>{scheduler.schedule(()=>subscriber.error(err))}),\"on\"===listenType?{unsubscribe(){null!=fn&&ref.off(event,fn)}}:{unsubscribe(){}}}).pipe(map(payload=>{const{snapshot:snapshot,prevKey:prevKey}=payload;let key=null;return snapshot.exists()&&(key=snapshot.key),{type:event,payload:snapshot,prevKey:prevKey,key:key}}),share())}function positionFor(changes,key){const len=changes.length;for(let i=0;i<len;i++)if(changes[i].payload.key===key)return i;return-1}function buildView(current,action){const{payload:payload,prevKey:prevKey,key:key}=action,currentKeyPosition=positionFor(current,key),afterPreviousKeyPosition=function(changes,prevKey){if(isNil(prevKey))return 0;{const i=positionFor(changes,prevKey);return-1===i?changes.length:i+1}}(current,prevKey);switch(action.type){case\"value\":if(action.payload&&action.payload.exists()){let prevKey=null;action.payload.forEach(payload=>{const action={payload:payload,type:\"value\",prevKey:prevKey,key:payload.key};return prevKey=payload.key,current=[...current,action],!1})}return current;case\"child_added\":if(currentKeyPosition>-1){const previous=current[currentKeyPosition-1];(previous&&previous.key||null)!==prevKey&&(current=current.filter(x=>x.payload.key!==payload.key)).splice(afterPreviousKeyPosition,0,action)}else{if(null==prevKey)return[action,...current];(current=current.slice()).splice(afterPreviousKeyPosition,0,action)}return current;case\"child_removed\":return current.filter(x=>x.payload.key!==payload.key);case\"child_changed\":return current.map(x=>x.payload.key===key?action:x);case\"child_moved\":if(currentKeyPosition>-1){const data=current.splice(currentKeyPosition,1)[0];return(current=current.slice()).splice(afterPreviousKeyPosition,0,data),current}return current;default:return current}}function angular_fire_database_validateEventsArray(events){return(isNil(events)||0===events.length)&&(events=[\"child_added\",\"child_removed\",\"child_changed\",\"child_moved\"]),events}function snapshotChanges(query,events,scheduler){return function(ref,events,scheduler){return angular_fire_database_fromRef(ref,\"value\",\"once\",scheduler).pipe(switchMap(snapshotAction=>{const childEvent$=[of(snapshotAction)];return events.forEach(event=>childEvent$.push(angular_fire_database_fromRef(ref,event,\"on\",scheduler))),merge(...childEvent$).pipe(scan(buildView,[]))}),source=>source.lift(new DistinctUntilChangedOperator(void 0,void 0)))}(query,events=angular_fire_database_validateEventsArray(events),scheduler)}function stateChanges(query,events,scheduler){return merge(...(events=angular_fire_database_validateEventsArray(events)).map(event=>angular_fire_database_fromRef(query,event,\"on\",scheduler)))}function createDataOperationMethod(ref,operation){return function(item,value){return checkOperationCases(item,{stringCase:()=>ref.child(item)[operation](value),firebaseCase:()=>item[operation](value),snapshotCase:()=>item.ref[operation](value)})}}function createObjectSnapshotChanges(query,scheduler){return function(){return angular_fire_database_fromRef(query,\"value\",\"on\",scheduler)}}const URL=new InjectionToken(\"angularfire2.realtimeDatabaseURL\");let angular_fire_database_AngularFireDatabase=(()=>{class AngularFireDatabase{constructor(options,nameOrConfig,databaseURL,platformId,zone){this.schedulers=new angular_fire_AngularFireSchedulers(zone),this.keepUnstableUntilFirst=ɵkeepUnstableUntilFirstFactory(this.schedulers),this.database=zone.runOutsideAngular(()=>{const app=ɵfirebaseAppFactory(options,zone,nameOrConfig);return database_dist_index_cjs.registerDatabase&&Object(database_dist_index_cjs.registerDatabase)(index_cjs_default.a),app.database(databaseURL||void 0)})}list(pathOrRef,queryFn){const ref=getRef(this.database,pathOrRef);let query=ref;return queryFn&&(query=queryFn(ref)),function(query,afDatabase){const outsideAngularScheduler=afDatabase.schedulers.outsideAngular,refInZone=afDatabase.schedulers.ngZone.run(()=>query.ref);return{query:query,update:createDataOperationMethod(refInZone,\"update\"),set:createDataOperationMethod(refInZone,\"set\"),push:data=>refInZone.push(data),remove:(ref=refInZone,function(item){return item?checkOperationCases(item,{stringCase:()=>ref.child(item).remove(),firebaseCase:()=>item.remove(),snapshotCase:()=>item.ref.remove()}):ref.remove()}),snapshotChanges:events=>snapshotChanges(query,events,outsideAngularScheduler).pipe(afDatabase.keepUnstableUntilFirst),stateChanges:events=>stateChanges(query,events,outsideAngularScheduler).pipe(afDatabase.keepUnstableUntilFirst),auditTrail:events=>function(query,events,scheduler){return function(query,action$,scheduler){return function(query,scheduler){return angular_fire_database_fromRef(query,\"value\",\"on\",scheduler).pipe(map(data=>{let lastKeyToLoad;return data.payload.forEach(child=>(lastKeyToLoad=child.key,!1)),{data:data,lastKeyToLoad:lastKeyToLoad}}))}(query,scheduler).pipe(function(...args){return source=>{let project;return\"function\"==typeof args[args.length-1]&&(project=args.pop()),source.lift(new WithLatestFromOperator(args,project))}}(action$),map(([loaded,actions])=>{const lastKeyToLoad=loaded.lastKeyToLoad,loadedKeys=actions.map(snap=>snap.key);return{actions:actions,lastKeyToLoad:lastKeyToLoad,loadedKeys:loadedKeys}}),(predicate=meta=>-1===meta.loadedKeys.indexOf(meta.lastKeyToLoad),source=>source.lift(new SkipWhileOperator(predicate))),map(meta=>meta.actions));var predicate}(query,stateChanges(query,events).pipe(scan((current,action)=>[...current,action],[])),scheduler)}(query,events,outsideAngularScheduler).pipe(afDatabase.keepUnstableUntilFirst),valueChanges:events=>snapshotChanges(query,events,outsideAngularScheduler).pipe(map(actions=>actions.map(a=>a.payload.val())),afDatabase.keepUnstableUntilFirst)};var ref}(query,this)}object(pathOrRef){const ref=getRef(this.database,pathOrRef);return afDatabase=this,{query:query=ref,snapshotChanges:()=>createObjectSnapshotChanges(query,afDatabase.schedulers.outsideAngular)().pipe(afDatabase.keepUnstableUntilFirst),update:data=>query.ref.update(data),set:data=>query.ref.set(data),remove:()=>query.ref.remove(),valueChanges:()=>createObjectSnapshotChanges(query,afDatabase.schedulers.outsideAngular)().pipe(afDatabase.keepUnstableUntilFirst,map(action=>action.payload.exists()?action.payload.val():null))};var query,afDatabase}createPushId(){return this.database.ref().push().key}}return AngularFireDatabase.ɵfac=function(t){return new(t||AngularFireDatabase)(ɵɵinject(FIREBASE_OPTIONS),ɵɵinject(FIREBASE_APP_NAME,8),ɵɵinject(URL,8),ɵɵinject(PLATFORM_ID),ɵɵinject(NgZone))},AngularFireDatabase.ɵprov=ɵɵdefineInjectable({factory:function(){return new AngularFireDatabase(ɵɵinject(FIREBASE_OPTIONS),ɵɵinject(FIREBASE_APP_NAME,8),ɵɵinject(URL,8),ɵɵinject(PLATFORM_ID),ɵɵinject(NgZone))},token:AngularFireDatabase,providedIn:\"any\"}),AngularFireDatabase})(),angular_fire_database_AngularFireDatabaseModule=(()=>{class AngularFireDatabaseModule{}return AngularFireDatabaseModule.ɵmod=ɵɵdefineNgModule({type:AngularFireDatabaseModule}),AngularFireDatabaseModule.ɵinj=ɵɵdefineInjector({factory:function(t){return new(t||AngularFireDatabaseModule)},providers:[angular_fire_database_AngularFireDatabase]}),AngularFireDatabaseModule})(),product_service_ProductService=(()=>{class ProductService{constructor(firebase){this.firebase=firebase,this.conta=0,this.j=0,this.selectedProduct=new Product}getProducts(){return this.productList=this.firebase.list(\"products\")}insertProduct(product){let dat,conta=0;if(this.firebase.database.ref(\"products\").orderByChild(\"dui\").equalTo(product.dui).on(\"child_added\",(function(snapshotChanges){dat=snapshotChanges.child(\"vistas\").val(),null!=dat&&(conta+=1)})),console.log(conta),0==conta){let discount=0,tamount=product.amount;product.vistas=1,this.productList.push({name:product.name,dui:product.dui,vehicle:product.vehicle,amount:product.amount,discount:discount,tamount:tamount,vistas:product.vistas})}else if(2==conta){let discount=.05,tamount=product.amount-.05*product.amount;product.vistas=product.vistas+1,this.productList.push({name:product.name,dui:product.dui,vehicle:product.vehicle,amount:product.amount,discount:discount,tamount:tamount,vistas:conta})}else if(conta>5){let discount=.08,tamount=product.amount-.08*product.amount;product.vistas=product.vistas+1,this.productList.push({name:product.name,dui:product.dui,vehicle:product.vehicle,amount:product.amount,discount:discount,tamount:tamount,vistas:conta})}else if(0!=conta||conta>=1||conta<=5){let discount=0,tamount=product.amount;product.vistas=product.vistas+1,this.productList.push({name:product.name,dui:product.dui,vehicle:product.vehicle,amount:product.amount,discount:discount,tamount:tamount,vistas:conta}),console.log(NaN)}}updateProduct(product){this.productList.update(product.$key,{name:product.name,dui:product.dui,vehicle:product.vehicle,amount:product.amount})}deleteProduct($key){this.productList.remove($key)}}return ProductService.ɵfac=function(t){return new(t||ProductService)(ɵɵinject(angular_fire_database_AngularFireDatabase))},ProductService.ɵprov=ɵɵdefineInjectable({token:ProductService,factory:ProductService.ɵfac,providedIn:\"root\"}),ProductService})();class AnimationBuilder{}function trigger(name,definitions){return{type:7,name:name,definitions:definitions,options:{}}}function animate(timings,styles=null){return{type:4,styles:styles,timings:timings}}function sequence(steps,options=null){return{type:2,steps:steps,options:options}}function animations_style(tokens){return{type:6,styles:tokens,offset:null}}function state(name,styles,options){return{type:0,name:name,styles:styles,options:options}}function animations_transition(stateChangeExpr,steps,options=null){return{type:1,expr:stateChangeExpr,animation:steps,options:options}}function animations_scheduleMicroTask(cb){Promise.resolve(null).then(cb)}class NoopAnimationPlayer{constructor(duration=0,delay=0){this._onDoneFns=[],this._onStartFns=[],this._onDestroyFns=[],this._started=!1,this._destroyed=!1,this._finished=!1,this.parentPlayer=null,this.totalTime=duration+delay}_onFinish(){this._finished||(this._finished=!0,this._onDoneFns.forEach(fn=>fn()),this._onDoneFns=[])}onStart(fn){this._onStartFns.push(fn)}onDone(fn){this._onDoneFns.push(fn)}onDestroy(fn){this._onDestroyFns.push(fn)}hasStarted(){return this._started}init(){}play(){this.hasStarted()||(this._onStart(),this.triggerMicrotask()),this._started=!0}triggerMicrotask(){animations_scheduleMicroTask(()=>this._onFinish())}_onStart(){this._onStartFns.forEach(fn=>fn()),this._onStartFns=[]}pause(){}restart(){}finish(){this._onFinish()}destroy(){this._destroyed||(this._destroyed=!0,this.hasStarted()||this._onStart(),this.finish(),this._onDestroyFns.forEach(fn=>fn()),this._onDestroyFns=[])}reset(){}setPosition(position){}getPosition(){return 0}triggerCallback(phaseName){const methods=\"start\"==phaseName?this._onStartFns:this._onDoneFns;methods.forEach(fn=>fn()),methods.length=0}}class AnimationGroupPlayer{constructor(_players){this._onDoneFns=[],this._onStartFns=[],this._finished=!1,this._started=!1,this._destroyed=!1,this._onDestroyFns=[],this.parentPlayer=null,this.totalTime=0,this.players=_players;let doneCount=0,destroyCount=0,startCount=0;const total=this.players.length;0==total?animations_scheduleMicroTask(()=>this._onFinish()):this.players.forEach(player=>{player.onDone(()=>{++doneCount==total&&this._onFinish()}),player.onDestroy(()=>{++destroyCount==total&&this._onDestroy()}),player.onStart(()=>{++startCount==total&&this._onStart()})}),this.totalTime=this.players.reduce((time,player)=>Math.max(time,player.totalTime),0)}_onFinish(){this._finished||(this._finished=!0,this._onDoneFns.forEach(fn=>fn()),this._onDoneFns=[])}init(){this.players.forEach(player=>player.init())}onStart(fn){this._onStartFns.push(fn)}_onStart(){this.hasStarted()||(this._started=!0,this._onStartFns.forEach(fn=>fn()),this._onStartFns=[])}onDone(fn){this._onDoneFns.push(fn)}onDestroy(fn){this._onDestroyFns.push(fn)}hasStarted(){return this._started}play(){this.parentPlayer||this.init(),this._onStart(),this.players.forEach(player=>player.play())}pause(){this.players.forEach(player=>player.pause())}restart(){this.players.forEach(player=>player.restart())}finish(){this._onFinish(),this.players.forEach(player=>player.finish())}destroy(){this._onDestroy()}_onDestroy(){this._destroyed||(this._destroyed=!0,this._onFinish(),this.players.forEach(player=>player.destroy()),this._onDestroyFns.forEach(fn=>fn()),this._onDestroyFns=[])}reset(){this.players.forEach(player=>player.reset()),this._destroyed=!1,this._finished=!1,this._started=!1}setPosition(p){const timeAtPosition=p*this.totalTime;this.players.forEach(player=>{const position=player.totalTime?Math.min(1,timeAtPosition/player.totalTime):1;player.setPosition(position)})}getPosition(){let min=0;return this.players.forEach(player=>{const p=player.getPosition();min=Math.min(p,min)}),min}beforeDestroy(){this.players.forEach(player=>{player.beforeDestroy&&player.beforeDestroy()})}triggerCallback(phaseName){const methods=\"start\"==phaseName?this._onStartFns:this._onDoneFns;methods.forEach(fn=>fn()),methods.length=0}}const _c0=[\"toast-component\",\"\"];function Toast_button_0_Template(rf,ctx){if(1&rf){const _r6=ɵɵgetCurrentView();ɵɵelementStart(0,\"button\",5),ɵɵlistener(\"click\",(function(){return ɵɵrestoreView(_r6),ɵɵnextContext().remove()})),ɵɵelementStart(1,\"span\",6),ɵɵtext(2,\"×\"),ɵɵelementEnd(),ɵɵelementEnd()}}function Toast_div_1_ng_container_2_Template(rf,ctx){if(1&rf&&(function(index,attrsIndex,localRefsIndex){const lView=getLView(),tView=getTView(),tNode=tView.firstCreatePass?function(index,tView,lView,attrsIndex,localRefsIndex){const tViewConsts=tView.consts,attrs=getConstant(tViewConsts,undefined),tNode=getOrCreateTNode(tView,lView[6],0,4,\"ng-container\",attrs);return null!==attrs&&computeStaticStyling(tNode,attrs),resolveDirectives(tView,lView,tNode,getConstant(tViewConsts,undefined)),null!==tView.queries&&tView.queries.elementStart(tView,tNode),tNode}(0,tView,lView):tView.data[19];setPreviousOrParentTNode(tNode,!0);const native=lView[19]=lView[11].createComment(\"\");appendChild(tView,lView,native,tNode),attachPatchData(native,lView),isDirectiveHost(tNode)&&(createDirectivesInstances(tView,lView,tNode),executeContentQueries(tView,tNode,lView))}(),ɵɵtext(1),function(){let previousOrParentTNode=getPreviousOrParentTNode();const tView=getTView();getIsParent()?setIsNotParent():(previousOrParentTNode=previousOrParentTNode.parent,setPreviousOrParentTNode(previousOrParentTNode,!1)),tView.firstCreatePass&&(registerPostOrderHooks(tView,previousOrParentTNode),isContentQueryHost(previousOrParentTNode)&&tView.queries.elementEnd(previousOrParentTNode))}()),2&rf){const ctx_r7=ɵɵnextContext(2);ɵɵadvance(1),ɵɵtextInterpolate1(\"[\",ctx_r7.duplicatesCount+1,\"]\")}}function Toast_div_1_Template(rf,ctx){if(1&rf&&(ɵɵelementStart(0,\"div\"),ɵɵtext(1),ɵɵtemplate(2,Toast_div_1_ng_container_2_Template,2,1,\"ng-container\",4),ɵɵelementEnd()),2&rf){const ctx_r1=ɵɵnextContext();ɵɵclassMap(ctx_r1.options.titleClass),ɵɵattribute(\"aria-label\",ctx_r1.title),ɵɵadvance(1),ɵɵtextInterpolate1(\" \",ctx_r1.title,\" \"),ɵɵadvance(1),ɵɵproperty(\"ngIf\",ctx_r1.duplicatesCount)}}function Toast_div_2_Template(rf,ctx){if(1&rf&&ɵɵelement(0,\"div\",7),2&rf){const ctx_r2=ɵɵnextContext();ɵɵclassMap(ctx_r2.options.messageClass),ɵɵproperty(\"innerHTML\",ctx_r2.message,ɵɵsanitizeHtml)}}function Toast_div_3_Template(rf,ctx){if(1&rf&&(ɵɵelementStart(0,\"div\",8),ɵɵtext(1),ɵɵelementEnd()),2&rf){const ctx_r3=ɵɵnextContext();ɵɵclassMap(ctx_r3.options.messageClass),ɵɵattribute(\"aria-label\",ctx_r3.message),ɵɵadvance(1),ɵɵtextInterpolate1(\" \",ctx_r3.message,\" \")}}function Toast_div_4_Template(rf,ctx){if(1&rf&&(ɵɵelementStart(0,\"div\"),ɵɵelement(1,\"div\",9),ɵɵelementEnd()),2&rf){const ctx_r4=ɵɵnextContext();ɵɵadvance(1),ɵɵstyleProp(\"width\",ctx_r4.width+\"%\")}}class ngx_toastr_ToastPackage{constructor(toastId,config,message,title,toastType,toastRef){this.toastId=toastId,this.config=config,this.message=message,this.title=title,this.toastType=toastType,this.toastRef=toastRef,this._onTap=new Subject_Subject,this._onAction=new Subject_Subject,this.toastRef.afterClosed().subscribe(()=>{this._onAction.complete(),this._onTap.complete()})}triggerTap(){this._onTap.next(),this.config.tapToDismiss&&this._onTap.complete()}onTap(){return this._onTap.asObservable()}triggerAction(action){this._onAction.next(action)}onAction(){return this._onAction.asObservable()}}const DefaultNoComponentGlobalConfig={maxOpened:0,autoDismiss:!1,newestOnTop:!0,preventDuplicates:!1,countDuplicates:!1,resetTimeoutOnDuplicate:!1,iconClasses:{error:\"toast-error\",info:\"toast-info\",success:\"toast-success\",warning:\"toast-warning\"},closeButton:!1,disableTimeOut:!1,timeOut:5e3,extendedTimeOut:1e3,enableHtml:!1,progressBar:!1,toastClass:\"ngx-toastr\",positionClass:\"toast-top-right\",titleClass:\"toast-title\",messageClass:\"toast-message\",easing:\"ease-in\",easeTime:300,tapToDismiss:!0,onActivateTick:!1,progressAnimation:\"decreasing\"},TOAST_CONFIG=new InjectionToken(\"ToastConfig\");class ComponentPortal{constructor(component,injector){this.component=component,this.injector=injector}attach(host,newestOnTop){return this._attachedHost=host,host.attach(this,newestOnTop)}detach(){const host=this._attachedHost;if(host)return this._attachedHost=void 0,host.detach()}get isAttached(){return null!=this._attachedHost}setAttachedHost(host){this._attachedHost=host}}class DomPortalHost extends class{attach(portal,newestOnTop){return this._attachedPortal=portal,this.attachComponentPortal(portal,newestOnTop)}detach(){this._attachedPortal&&this._attachedPortal.setAttachedHost(),this._attachedPortal=void 0,this._disposeFn&&(this._disposeFn(),this._disposeFn=void 0)}setDisposeFn(fn){this._disposeFn=fn}}{constructor(_hostDomElement,_componentFactoryResolver,_appRef){super(),this._hostDomElement=_hostDomElement,this._componentFactoryResolver=_componentFactoryResolver,this._appRef=_appRef}attachComponentPortal(portal,newestOnTop){const componentFactory=this._componentFactoryResolver.resolveComponentFactory(portal.component);let componentRef;return componentRef=componentFactory.create(portal.injector),this._appRef.attachView(componentRef.hostView),this.setDisposeFn(()=>{this._appRef.detachView(componentRef.hostView),componentRef.destroy()}),newestOnTop?this._hostDomElement.insertBefore(this._getComponentRootNode(componentRef),this._hostDomElement.firstChild):this._hostDomElement.appendChild(this._getComponentRootNode(componentRef)),componentRef}_getComponentRootNode(componentRef){return componentRef.hostView.rootNodes[0]}}let ngx_toastr_OverlayContainer=(()=>{class OverlayContainer{constructor(_document){this._document=_document}ngOnDestroy(){this._containerElement&&this._containerElement.parentNode&&this._containerElement.parentNode.removeChild(this._containerElement)}getContainerElement(){return this._containerElement||this._createContainer(),this._containerElement}_createContainer(){const container=this._document.createElement(\"div\");container.classList.add(\"overlay-container\"),this._document.body.appendChild(container),this._containerElement=container}}return OverlayContainer.ɵfac=function(t){return new(t||OverlayContainer)(ɵɵinject(common_DOCUMENT))},OverlayContainer.ɵprov=ɵɵdefineInjectable({factory:function(){return new OverlayContainer(ɵɵinject(common_DOCUMENT))},token:OverlayContainer,providedIn:\"root\"}),OverlayContainer})();class OverlayRef{constructor(_portalHost){this._portalHost=_portalHost}attach(portal,newestOnTop=!0){return this._portalHost.attach(portal,newestOnTop)}detach(){return this._portalHost.detach()}}let ngx_toastr_Overlay=(()=>{class Overlay{constructor(_overlayContainer,_componentFactoryResolver,_appRef,_document){this._overlayContainer=_overlayContainer,this._componentFactoryResolver=_componentFactoryResolver,this._appRef=_appRef,this._document=_document,this._paneElements=new Map}create(positionClass,overlayContainer){return this._createOverlayRef(this.getPaneElement(positionClass,overlayContainer))}getPaneElement(positionClass=\"\",overlayContainer){return this._paneElements.get(overlayContainer)||this._paneElements.set(overlayContainer,{}),this._paneElements.get(overlayContainer)[positionClass]||(this._paneElements.get(overlayContainer)[positionClass]=this._createPaneElement(positionClass,overlayContainer)),this._paneElements.get(overlayContainer)[positionClass]}_createPaneElement(positionClass,overlayContainer){const pane=this._document.createElement(\"div\");return pane.id=\"toast-container\",pane.classList.add(positionClass),pane.classList.add(\"toast-container\"),overlayContainer?overlayContainer.getContainerElement().appendChild(pane):this._overlayContainer.getContainerElement().appendChild(pane),pane}_createPortalHost(pane){return new DomPortalHost(pane,this._componentFactoryResolver,this._appRef)}_createOverlayRef(pane){return new OverlayRef(this._createPortalHost(pane))}}return Overlay.ɵfac=function(t){return new(t||Overlay)(ɵɵinject(ngx_toastr_OverlayContainer),ɵɵinject(ComponentFactoryResolver),ɵɵinject(core_ApplicationRef),ɵɵinject(common_DOCUMENT))},Overlay.ɵprov=ɵɵdefineInjectable({factory:function(){return new Overlay(ɵɵinject(ngx_toastr_OverlayContainer),ɵɵinject(ComponentFactoryResolver),ɵɵinject(core_ApplicationRef),ɵɵinject(common_DOCUMENT))},token:Overlay,providedIn:\"root\"}),Overlay})();class ngx_toastr_ToastRef{constructor(_overlayRef){this._overlayRef=_overlayRef,this.duplicatesCount=0,this._afterClosed=new Subject_Subject,this._activate=new Subject_Subject,this._manualClose=new Subject_Subject,this._resetTimeout=new Subject_Subject,this._countDuplicate=new Subject_Subject}manualClose(){this._manualClose.next(),this._manualClose.complete()}manualClosed(){return this._manualClose.asObservable()}timeoutReset(){return this._resetTimeout.asObservable()}countDuplicate(){return this._countDuplicate.asObservable()}close(){this._overlayRef.detach(),this._afterClosed.next(),this._manualClose.next(),this._afterClosed.complete(),this._manualClose.complete(),this._activate.complete(),this._resetTimeout.complete(),this._countDuplicate.complete()}afterClosed(){return this._afterClosed.asObservable()}isInactive(){return this._activate.isStopped}activate(){this._activate.next(),this._activate.complete()}afterActivate(){return this._activate.asObservable()}onDuplicate(resetTimeout,countDuplicate){resetTimeout&&this._resetTimeout.next(),countDuplicate&&this._countDuplicate.next(++this.duplicatesCount)}}class ToastInjector{constructor(_toastPackage,_parentInjector){this._toastPackage=_toastPackage,this._parentInjector=_parentInjector}get(token,notFoundValue,flags){return token===ngx_toastr_ToastPackage?this._toastPackage:this._parentInjector.get(token,notFoundValue,flags)}}let ngx_toastr_ToastrService=(()=>{class ToastrService{constructor(token,overlay,_injector,sanitizer,ngZone){this.overlay=overlay,this._injector=_injector,this.sanitizer=sanitizer,this.ngZone=ngZone,this.currentlyActive=0,this.toasts=[],this.index=0,this.toastrConfig=Object.assign(Object.assign({},token.default),token.config),token.config.iconClasses&&(this.toastrConfig.iconClasses=Object.assign(Object.assign({},token.default.iconClasses),token.config.iconClasses))}show(message,title,override={},type=\"\"){return this._preBuildNotification(type,message,title,this.applyConfig(override))}success(message,title,override={}){return this._preBuildNotification(this.toastrConfig.iconClasses.success||\"\",message,title,this.applyConfig(override))}error(message,title,override={}){return this._preBuildNotification(this.toastrConfig.iconClasses.error||\"\",message,title,this.applyConfig(override))}info(message,title,override={}){return this._preBuildNotification(this.toastrConfig.iconClasses.info||\"\",message,title,this.applyConfig(override))}warning(message,title,override={}){return this._preBuildNotification(this.toastrConfig.iconClasses.warning||\"\",message,title,this.applyConfig(override))}clear(toastId){for(const toast of this.toasts)if(void 0!==toastId){if(toast.toastId===toastId)return void toast.toastRef.manualClose()}else toast.toastRef.manualClose()}remove(toastId){const found=this._findToast(toastId);if(!found)return!1;if(found.activeToast.toastRef.close(),this.toasts.splice(found.index,1),this.currentlyActive=this.currentlyActive-1,!this.toastrConfig.maxOpened||!this.toasts.length)return!1;if(this.currentlyActive<this.toastrConfig.maxOpened&&this.toasts[this.currentlyActive]){const p=this.toasts[this.currentlyActive].toastRef;p.isInactive()||(this.currentlyActive=this.currentlyActive+1,p.activate())}return!0}findDuplicate(message=\"\",resetOnDuplicate=!1,countDuplicates=!1){for(const toast of this.toasts)if(toast.message===message)return toast.toastRef.onDuplicate(resetOnDuplicate,countDuplicates),toast;return null}applyConfig(override={}){return Object.assign(Object.assign({},this.toastrConfig),override)}_findToast(toastId){for(let i=0;i<this.toasts.length;i++)if(this.toasts[i].toastId===toastId)return{index:i,activeToast:this.toasts[i]};return null}_preBuildNotification(toastType,message,title,config){return config.onActivateTick?this.ngZone.run(()=>this._buildNotification(toastType,message,title,config)):this._buildNotification(toastType,message,title,config)}_buildNotification(toastType,message,title,config){if(!config.toastComponent)throw new Error(\"toastComponent required\");const duplicate=this.findDuplicate(message,this.toastrConfig.resetTimeoutOnDuplicate&&config.timeOut>0,this.toastrConfig.countDuplicates);if(message&&this.toastrConfig.preventDuplicates&&null!==duplicate)return duplicate;this.previousToastMessage=message;let keepInactive=!1;this.toastrConfig.maxOpened&&this.currentlyActive>=this.toastrConfig.maxOpened&&(keepInactive=!0,this.toastrConfig.autoDismiss&&this.clear(this.toasts[0].toastId));const overlayRef=this.overlay.create(config.positionClass,this.overlayContainer);this.index=this.index+1;let sanitizedMessage=message;message&&config.enableHtml&&(sanitizedMessage=this.sanitizer.sanitize(SecurityContext.HTML,message));const toastRef=new ngx_toastr_ToastRef(overlayRef),toastPackage=new ngx_toastr_ToastPackage(this.index,config,sanitizedMessage,title,toastType,toastRef),toastInjector=new ToastInjector(toastPackage,this._injector),component=new ComponentPortal(config.toastComponent,toastInjector),portal=overlayRef.attach(component,this.toastrConfig.newestOnTop);toastRef.componentInstance=portal.instance;const ins={toastId:this.index,message:message||\"\",toastRef:toastRef,onShown:toastRef.afterActivate(),onHidden:toastRef.afterClosed(),onTap:toastPackage.onTap(),onAction:toastPackage.onAction(),portal:portal};return keepInactive||(this.currentlyActive=this.currentlyActive+1,setTimeout(()=>{ins.toastRef.activate()})),this.toasts.push(ins),ins}}return ToastrService.ɵfac=function(t){return new(t||ToastrService)(ɵɵinject(TOAST_CONFIG),ɵɵinject(ngx_toastr_Overlay),ɵɵinject(Injector),ɵɵinject(platform_browser_DomSanitizer),ɵɵinject(NgZone))},ToastrService.ɵprov=ɵɵdefineInjectable({factory:function(){return new ToastrService(ɵɵinject(TOAST_CONFIG),ɵɵinject(ngx_toastr_Overlay),ɵɵinject(INJECTOR),ɵɵinject(platform_browser_DomSanitizer),ɵɵinject(NgZone))},token:ToastrService,providedIn:\"root\"}),ToastrService})(),ngx_toastr_Toast=(()=>{class Toast{constructor(toastrService,toastPackage,ngZone){this.toastrService=toastrService,this.toastPackage=toastPackage,this.ngZone=ngZone,this.width=-1,this.toastClasses=\"\",this.state={value:\"inactive\",params:{easeTime:this.toastPackage.config.easeTime,easing:\"ease-in\"}},this.message=toastPackage.message,this.title=toastPackage.title,this.options=toastPackage.config,this.originalTimeout=toastPackage.config.timeOut,this.toastClasses=`${toastPackage.toastType} ${toastPackage.config.toastClass}`,this.sub=toastPackage.toastRef.afterActivate().subscribe(()=>{this.activateToast()}),this.sub1=toastPackage.toastRef.manualClosed().subscribe(()=>{this.remove()}),this.sub2=toastPackage.toastRef.timeoutReset().subscribe(()=>{this.resetTimeout()}),this.sub3=toastPackage.toastRef.countDuplicate().subscribe(count=>{this.duplicatesCount=count})}get displayStyle(){if(\"inactive\"===this.state.value)return\"none\"}ngOnDestroy(){this.sub.unsubscribe(),this.sub1.unsubscribe(),this.sub2.unsubscribe(),this.sub3.unsubscribe(),clearInterval(this.intervalId),clearTimeout(this.timeout)}activateToast(){this.state=Object.assign(Object.assign({},this.state),{value:\"active\"}),!0!==this.options.disableTimeOut&&\"timeOut\"!==this.options.disableTimeOut&&this.options.timeOut&&(this.outsideTimeout(()=>this.remove(),this.options.timeOut),this.hideTime=(new Date).getTime()+this.options.timeOut,this.options.progressBar&&this.outsideInterval(()=>this.updateProgress(),10))}updateProgress(){if(0===this.width||100===this.width||!this.options.timeOut)return;const now=(new Date).getTime();this.width=(this.hideTime-now)/this.options.timeOut*100,\"increasing\"===this.options.progressAnimation&&(this.width=100-this.width),this.width<=0&&(this.width=0),this.width>=100&&(this.width=100)}resetTimeout(){clearTimeout(this.timeout),clearInterval(this.intervalId),this.state=Object.assign(Object.assign({},this.state),{value:\"active\"}),this.outsideTimeout(()=>this.remove(),this.originalTimeout),this.options.timeOut=this.originalTimeout,this.hideTime=(new Date).getTime()+(this.options.timeOut||0),this.width=-1,this.options.progressBar&&this.outsideInterval(()=>this.updateProgress(),10)}remove(){\"removed\"!==this.state.value&&(clearTimeout(this.timeout),this.state=Object.assign(Object.assign({},this.state),{value:\"removed\"}),this.outsideTimeout(()=>this.toastrService.remove(this.toastPackage.toastId),+this.toastPackage.config.easeTime))}tapToast(){\"removed\"!==this.state.value&&(this.toastPackage.triggerTap(),this.options.tapToDismiss&&this.remove())}stickAround(){\"removed\"!==this.state.value&&(clearTimeout(this.timeout),this.options.timeOut=0,this.hideTime=0,clearInterval(this.intervalId),this.width=0)}delayedHideToast(){!0!==this.options.disableTimeOut&&\"extendedTimeOut\"!==this.options.disableTimeOut&&0!==this.options.extendedTimeOut&&\"removed\"!==this.state.value&&(this.outsideTimeout(()=>this.remove(),this.options.extendedTimeOut),this.options.timeOut=this.options.extendedTimeOut,this.hideTime=(new Date).getTime()+(this.options.timeOut||0),this.width=-1,this.options.progressBar&&this.outsideInterval(()=>this.updateProgress(),10))}outsideTimeout(func,timeout){this.ngZone?this.ngZone.runOutsideAngular(()=>this.timeout=setTimeout(()=>this.runInsideAngular(func),timeout)):this.timeout=setTimeout(()=>func(),timeout)}outsideInterval(func,timeout){this.ngZone?this.ngZone.runOutsideAngular(()=>this.intervalId=setInterval(()=>this.runInsideAngular(func),timeout)):this.intervalId=setInterval(()=>func(),timeout)}runInsideAngular(func){this.ngZone?this.ngZone.run(()=>func()):func()}}return Toast.ɵfac=function(t){return new(t||Toast)(ɵɵdirectiveInject(ngx_toastr_ToastrService),ɵɵdirectiveInject(ngx_toastr_ToastPackage),ɵɵdirectiveInject(NgZone))},Toast.ɵcmp=ɵɵdefineComponent({type:Toast,selectors:[[\"\",\"toast-component\",\"\"]],hostVars:5,hostBindings:function(rf,ctx){1&rf&&ɵɵlistener(\"click\",(function(){return ctx.tapToast()}))(\"mouseenter\",(function(){return ctx.stickAround()}))(\"mouseleave\",(function(){return ctx.delayedHideToast()})),2&rf&&(ɵɵupdateSyntheticHostBinding(\"@flyInOut\",ctx.state),ɵɵclassMap(ctx.toastClasses),ɵɵstyleProp(\"display\",ctx.displayStyle))},attrs:_c0,decls:5,vars:5,consts:[[\"class\",\"toast-close-button\",\"aria-label\",\"Close\",3,\"click\",4,\"ngIf\"],[3,\"class\",4,\"ngIf\"],[\"role\",\"alertdialog\",\"aria-live\",\"polite\",3,\"class\",\"innerHTML\",4,\"ngIf\"],[\"role\",\"alertdialog\",\"aria-live\",\"polite\",3,\"class\",4,\"ngIf\"],[4,\"ngIf\"],[\"aria-label\",\"Close\",1,\"toast-close-button\",3,\"click\"],[\"aria-hidden\",\"true\"],[\"role\",\"alertdialog\",\"aria-live\",\"polite\",3,\"innerHTML\"],[\"role\",\"alertdialog\",\"aria-live\",\"polite\"],[1,\"toast-progress\"]],template:function(rf,ctx){1&rf&&(ɵɵtemplate(0,Toast_button_0_Template,3,0,\"button\",0),ɵɵtemplate(1,Toast_div_1_Template,3,5,\"div\",1),ɵɵtemplate(2,Toast_div_2_Template,1,3,\"div\",2),ɵɵtemplate(3,Toast_div_3_Template,2,4,\"div\",3),ɵɵtemplate(4,Toast_div_4_Template,2,2,\"div\",4)),2&rf&&(ɵɵproperty(\"ngIf\",ctx.options.closeButton),ɵɵadvance(1),ɵɵproperty(\"ngIf\",ctx.title),ɵɵadvance(1),ɵɵproperty(\"ngIf\",ctx.message&&ctx.options.enableHtml),ɵɵadvance(1),ɵɵproperty(\"ngIf\",ctx.message&&!ctx.options.enableHtml),ɵɵadvance(1),ɵɵproperty(\"ngIf\",ctx.options.progressBar))},directives:[common_NgIf],encapsulation:2,data:{animation:[trigger(\"flyInOut\",[state(\"inactive\",animations_style({opacity:0})),state(\"active\",animations_style({opacity:1})),state(\"removed\",animations_style({opacity:0})),animations_transition(\"inactive => active\",animate(\"{{ easeTime }}ms {{ easing }}\")),animations_transition(\"active => removed\",animate(\"{{ easeTime }}ms {{ easing }}\"))])]}}),Toast})();const DefaultGlobalConfig=Object.assign(Object.assign({},DefaultNoComponentGlobalConfig),{toastComponent:ngx_toastr_Toast});let ngx_toastr_ToastrModule=(()=>{class ToastrModule{static forRoot(config={}){return{ngModule:ToastrModule,providers:[{provide:TOAST_CONFIG,useValue:{default:DefaultGlobalConfig,config:config}}]}}}return ToastrModule.ɵmod=ɵɵdefineNgModule({type:ToastrModule}),ToastrModule.ɵinj=ɵɵdefineInjector({factory:function(t){return new(t||ToastrModule)},imports:[[common_CommonModule]]}),ToastrModule})(),product_component_ProductComponent=(()=>{class ProductComponent{constructor(productService,toastr,db){this.productService=productService,this.toastr=toastr,this.db=db,this.dui_validation=\"^[0-9]{7}-[0-9]{1}$\",this.dui=[]}showToaster(){this.toastr.success(\"Error,formato de DUI incorrecto.\")}ngOnInit(){this.productService.getProducts(),this.resetForm()}onSubmit(productForm){\"\"==productForm.value.name||\"\"==productForm.value.vehicle||\"\"==productForm.value.dui||productForm.value.amount<=0?this.toastr.error(\"Error\",\"You should fill in all the fields\"):productForm.value.dui.match(this.dui_validation)?(null==productForm.value.$key?(this.discount=.05,this.tamount=100,this.productService.insertProduct(productForm.value)):this.productService.updateProduct(productForm.value),this.resetForm(productForm),this.toastr.success(\"Sucessful Operation\",\"Data Registered\")):this.toastr.error(\"Error\",\"You must follow the dui format\")}resetForm(productForm){null!=productForm&&productForm.reset(),this.productService.selectedProduct=new Product}}return ProductComponent.ɵfac=function(t){return new(t||ProductComponent)(ɵɵdirectiveInject(product_service_ProductService),ɵɵdirectiveInject(ngx_toastr_ToastrService),ɵɵdirectiveInject(angular_fire_database_AngularFireDatabase))},ProductComponent.ɵcmp=ɵɵdefineComponent({type:ProductComponent,selectors:[[\"app-product\"]],decls:27,vars:5,consts:[[1,\"card\",\"mt-5\"],[1,\"card-body\"],[3,\"ngSubmit\"],[\"productForm\",\"ngForm\"],[\"type\",\"hidden\",\"name\",\"$key\",3,\"ngModel\",\"ngModelChange\"],[\"$key\",\"ngModel\"],[1,\"form-group\"],[\"type\",\"text\",\"name\",\"name\",\"placeholder\",\"name\",1,\"form-control\",3,\"ngModel\",\"ngModelChange\"],[\"name\",\"ngModel\"],[\"type\",\"text\",\"name\",\"dui\",\"placeholder\",\"DUI (0000000-0)\",1,\"form-control\",3,\"ngModel\",\"ngModelChange\"],[\"category\",\"ngModel\"],[\"type\",\"text\",\"name\",\"vehicle\",\"placeholder\",\"Vehicle\",1,\"form-control\",3,\"ngModel\",\"ngModelChange\"],[\"location\",\"ngModel\"],[\"type\",\"number\",\"name\",\"amount\",\"placeholder\",\"Amount\",1,\"form-control\",3,\"ngModel\",\"ngModelChange\"],[\"type\",\"submit\",1,\"btn\",\"btn-primary\"],[1,\"fas\",\"fa-plus-circle\"],[\"type\",\"reset\",1,\"btn\",\"btn-secondary\",3,\"click\"],[1,\"fas\",\"fa-sync-alt\"]],template:function(rf,ctx){if(1&rf){const _r29=ɵɵgetCurrentView();ɵɵelementStart(0,\"div\",0),ɵɵelementStart(1,\"div\",1),ɵɵelementStart(2,\"h3\"),ɵɵtext(3,\"Repairs manager\"),ɵɵelementEnd(),ɵɵelementStart(4,\"form\",2,3),ɵɵlistener(\"ngSubmit\",(function(){ɵɵrestoreView(_r29);const _r23=ɵɵreference(5);return ctx.onSubmit(_r23)})),ɵɵelementStart(6,\"input\",4,5),ɵɵlistener(\"ngModelChange\",(function($event){return ctx.productService.selectedProduct.$key=$event})),ɵɵelementEnd(),ɵɵelementStart(8,\"div\",6),ɵɵelementStart(9,\"input\",7,8),ɵɵlistener(\"ngModelChange\",(function($event){return ctx.productService.selectedProduct.name=$event})),ɵɵelementEnd(),ɵɵelementEnd(),ɵɵelementStart(11,\"div\",6),ɵɵelementStart(12,\"input\",9,10),ɵɵlistener(\"ngModelChange\",(function($event){return ctx.productService.selectedProduct.dui=$event})),ɵɵelementEnd(),ɵɵelementEnd(),ɵɵelementStart(14,\"div\",6),ɵɵelementStart(15,\"input\",11,12),ɵɵlistener(\"ngModelChange\",(function($event){return ctx.productService.selectedProduct.vehicle=$event})),ɵɵelementEnd(),ɵɵelementEnd(),ɵɵelementStart(17,\"div\",6),ɵɵelementStart(18,\"input\",13,12),ɵɵlistener(\"ngModelChange\",(function($event){return ctx.productService.selectedProduct.amount=$event})),ɵɵelementEnd(),ɵɵelementEnd(),ɵɵelementStart(20,\"div\",6),ɵɵelementStart(21,\"button\",14),ɵɵelement(22,\"i\",15),ɵɵtext(23,\" Save \"),ɵɵelementEnd(),ɵɵelementStart(24,\"button\",16),ɵɵlistener(\"click\",(function(){ɵɵrestoreView(_r29);const _r23=ɵɵreference(5);return ctx.resetForm(_r23)})),ɵɵelement(25,\"i\",17),ɵɵtext(26,\" Reset \"),ɵɵelementEnd(),ɵɵelementEnd(),ɵɵelementEnd(),ɵɵelementEnd(),ɵɵelementEnd()}2&rf&&(ɵɵadvance(6),ɵɵproperty(\"ngModel\",ctx.productService.selectedProduct.$key),ɵɵadvance(3),ɵɵproperty(\"ngModel\",ctx.productService.selectedProduct.name),ɵɵadvance(3),ɵɵproperty(\"ngModel\",ctx.productService.selectedProduct.dui),ɵɵadvance(3),ɵɵproperty(\"ngModel\",ctx.productService.selectedProduct.vehicle),ɵɵadvance(3),ɵɵproperty(\"ngModel\",ctx.productService.selectedProduct.amount))},directives:[forms_NgNoValidate,forms_NgControlStatusGroup,forms_NgForm,forms_DefaultValueAccessor,forms_NgControlStatus,forms_NgModel,forms_NumberValueAccessor],styles:[\"\"]}),ProductComponent})();function ProductListComponent_tr_21_Template(rf,ctx){if(1&rf){const _r20=ɵɵgetCurrentView();ɵɵelementStart(0,\"tr\"),ɵɵelementStart(1,\"td\"),ɵɵtext(2),ɵɵelementEnd(),ɵɵelementStart(3,\"td\"),ɵɵtext(4),ɵɵelementEnd(),ɵɵelementStart(5,\"td\"),ɵɵtext(6),ɵɵelementEnd(),ɵɵelementStart(7,\"td\"),ɵɵtext(8),ɵɵelementEnd(),ɵɵelementStart(9,\"td\"),ɵɵtext(10),ɵɵelementEnd(),ɵɵelementStart(11,\"td\"),ɵɵtext(12),ɵɵelementEnd(),ɵɵelementStart(13,\"td\"),ɵɵtext(14),ɵɵelementEnd(),ɵɵelementStart(15,\"td\"),ɵɵelementStart(16,\"a\",23),ɵɵlistener(\"click\",(function(){ɵɵrestoreView(_r20);const product_r18=ctx.$implicit;return ɵɵnextContext().onEdit(product_r18)})),ɵɵelement(17,\"i\",24),ɵɵelementEnd(),ɵɵelementStart(18,\"a\",25),ɵɵlistener(\"click\",(function(){ɵɵrestoreView(_r20);const product_r18=ctx.$implicit;return ɵɵnextContext().onDelete(product_r18.$key)})),ɵɵelement(19,\"i\",26),ɵɵelementEnd(),ɵɵelementStart(20,\"a\",27),ɵɵlistener(\"click\",(function(){ɵɵrestoreView(_r20);const product_r18=ctx.$implicit;return ɵɵnextContext().dynamicDownloadTxt(product_r18)})),ɵɵelement(21,\"i\",28),ɵɵelementEnd(),ɵɵelementEnd(),ɵɵelementEnd()}if(2&rf){const product_r18=ctx.$implicit;ɵɵadvance(2),ɵɵtextInterpolate(product_r18.$key),ɵɵadvance(2),ɵɵtextInterpolate(product_r18.name),ɵɵadvance(2),ɵɵtextInterpolate(product_r18.dui),ɵɵadvance(2),ɵɵtextInterpolate(product_r18.vehicle),ɵɵadvance(2),ɵɵtextInterpolate1(\"$\",product_r18.amount,\"\"),ɵɵadvance(2),ɵɵtextInterpolate(product_r18.discount),ɵɵadvance(2),ɵɵtextInterpolate1(\"$\",product_r18.tamount,\"\")}}let product_list_component_ProductListComponent=(()=>{class ProductListComponent{constructor(productService,toastr){this.productService=productService,this.toastr=toastr,this.setting={element:{dynamicDownload:null}}}fakeValidateUserData(){return of({userDate1:1,userData2:2})}dynamicDownloadTxt(product){this.productService.selectedProduct=Object.assign({},product),this.dyanmicDownloadByHtmlTag({fileName:\" Ticket: \"+this.productService.selectedProduct.dui,text:\"\\nDui: \"+this.productService.selectedProduct.dui+\"\\nName: \"+this.productService.selectedProduct.name+\"\\nVehicle: \"+this.productService.selectedProduct.vehicle+\"\\nTotal Amount: $\"+this.productService.selectedProduct.tamount})}dyanmicDownloadByHtmlTag(arg){this.setting.element.dynamicDownload||(this.setting.element.dynamicDownload=document.createElement(\"a\"));const element=this.setting.element.dynamicDownload;element.setAttribute(\"href\",\"data:text/plain;charset=utf-8,\"+encodeURIComponent(arg.text)),element.setAttribute(\"download\",arg.fileName);var event=new MouseEvent(\"click\");element.dispatchEvent(event)}ngOnInit(){return this.productService.getProducts().snapshotChanges().subscribe(item=>{this.productList=[],item.forEach(element=>{let x=element.payload.toJSON();x.$key=element.key,this.productList.push(x)})})}onEdit(product){this.productService.selectedProduct=Object.assign({},product)}onDelete($key){confirm(\"Are you sure you want to delete it?\")&&(this.productService.deleteProduct($key),this.toastr.warning(\"Deleted Successfully\",\"Product Removed\"))}}return ProductListComponent.ɵfac=function(t){return new(t||ProductListComponent)(ɵɵdirectiveInject(product_service_ProductService),ɵɵdirectiveInject(ngx_toastr_ToastrService))},ProductListComponent.ɵcmp=ɵɵdefineComponent({type:ProductListComponent,selectors:[[\"app-product-list\"]],decls:54,vars:6,consts:[[1,\"card\"],[1,\"card-body\"],[1,\"text-center\"],[1,\"table\",\"table-lg\",\"table-hover\"],[4,\"ngFor\",\"ngForOf\"],[\"id\",\"exampleModal\",\"tabindex\",\"-1\",\"role\",\"dialog\",\"aria-labelledby\",\"exampleModalLabel\",\"aria-hidden\",\"true\",1,\"modal\",\"fade\"],[\"role\",\"document\",1,\"modal-dialog\",\"modal-sm\"],[1,\"modal-content\"],[1,\"modal-header\"],[\"id\",\"exampleModalLabel\",1,\"modal-title\"],[\"type\",\"button\",\"data-dismiss\",\"modal\",\"aria-label\",\"Close\",1,\"close\"],[\"aria-hidden\",\"true\"],[1,\"modal-body\"],[\"type\",\"hidden\",\"name\",\"$key\",3,\"ngModel\",\"ngModelChange\"],[\"$key\",\"ngModel\"],[1,\"form-group\"],[\"type\",\"text\",\"name\",\"name\",\"placeholder\",\"name\",\"readonly\",\"\",1,\"form-control\",3,\"ngModel\",\"ngModelChange\"],[\"name\",\"ngModel\"],[\"type\",\"text\",\"name\",\"dui\",\"placeholder\",\"DUI (0000000-0)\",\"readonly\",\"\",1,\"form-control\",3,\"ngModel\",\"ngModelChange\"],[\"category\",\"ngModel\"],[\"type\",\"text\",\"name\",\"vehicle\",\"placeholder\",\"Vehicle\",\"readonly\",\"\",1,\"form-control\",3,\"ngModel\",\"ngModelChange\"],[\"location\",\"ngModel\"],[\"type\",\"number\",\"name\",\"amount\",\"placeholder\",\"Amount\",\"readonly\",\"\",1,\"form-control\",3,\"ngModel\",\"ngModelChange\"],[\"data-toggle\",\"modal\",\"data-target\",\"#exampleModal\",1,\"btn\",\"btn-secondary\",\"text-white\",3,\"click\"],[1,\"far\",\"fa-edit\"],[1,\"btn\",\"btn-danger\",\"text-white\",3,\"click\"],[1,\"fas\",\"fa-trash-alt\"],[1,\"btn\",\"btn-primary\",\"text-black\",3,\"click\"],[1,\"fas\",\"fa-download\"]],template:function(rf,ctx){1&rf&&(ɵɵelement(0,\"p\"),ɵɵelementStart(1,\"div\",0),ɵɵelementStart(2,\"div\",1),ɵɵelementStart(3,\"h6\",2),ɵɵtext(4,\" Client List \"),ɵɵelementEnd(),ɵɵelementStart(5,\"table\",3),ɵɵelementStart(6,\"tbody\"),ɵɵelementStart(7,\"tr\"),ɵɵelement(8,\"th\"),ɵɵelementStart(9,\"th\"),ɵɵtext(10,\"Name\"),ɵɵelementEnd(),ɵɵelementStart(11,\"th\"),ɵɵtext(12,\"Dui\"),ɵɵelementEnd(),ɵɵelementStart(13,\"th\"),ɵɵtext(14,\"Vehicle\"),ɵɵelementEnd(),ɵɵelementStart(15,\"th\"),ɵɵtext(16,\"Amount\"),ɵɵelementEnd(),ɵɵelementStart(17,\"th\"),ɵɵtext(18,\"Discount\"),ɵɵelementEnd(),ɵɵelementStart(19,\"th\"),ɵɵtext(20,\"Final Amount\"),ɵɵelementEnd(),ɵɵelementEnd(),ɵɵtemplate(21,ProductListComponent_tr_21_Template,22,7,\"tr\",4),ɵɵelementEnd(),ɵɵelementEnd(),ɵɵelementEnd(),ɵɵelementEnd(),ɵɵelementStart(22,\"div\",5),ɵɵelementStart(23,\"div\",6),ɵɵelementStart(24,\"div\",7),ɵɵelementStart(25,\"div\",8),ɵɵelementStart(26,\"h5\",9),ɵɵtext(27,\"Ticket\"),ɵɵelementEnd(),ɵɵelementStart(28,\"button\",10),ɵɵelementStart(29,\"span\",11),ɵɵtext(30,\"×\"),ɵɵelementEnd(),ɵɵelementEnd(),ɵɵelementEnd(),ɵɵelementStart(31,\"div\",12),ɵɵelementStart(32,\"input\",13,14),ɵɵlistener(\"ngModelChange\",(function($event){return ctx.productService.selectedProduct.$key=$event})),ɵɵelementEnd(),ɵɵelementStart(34,\"div\",15),ɵɵelementStart(35,\"a\"),ɵɵtext(36,\"Name\"),ɵɵelementEnd(),ɵɵelementStart(37,\"input\",16,17),ɵɵlistener(\"ngModelChange\",(function($event){return ctx.productService.selectedProduct.name=$event})),ɵɵelementEnd(),ɵɵelementEnd(),ɵɵelementStart(39,\"div\",15),ɵɵelementStart(40,\"a\"),ɵɵtext(41,\"DUI\"),ɵɵelementEnd(),ɵɵelementStart(42,\"input\",18,19),ɵɵlistener(\"ngModelChange\",(function($event){return ctx.productService.selectedProduct.dui=$event})),ɵɵelementEnd(),ɵɵelementEnd(),ɵɵelementStart(44,\"div\",15),ɵɵelementStart(45,\"a\"),ɵɵtext(46,\"Vehicle\"),ɵɵelementEnd(),ɵɵelementStart(47,\"input\",20,21),ɵɵlistener(\"ngModelChange\",(function($event){return ctx.productService.selectedProduct.vehicle=$event})),ɵɵelementEnd(),ɵɵelementEnd(),ɵɵelementStart(49,\"div\",15),ɵɵelementStart(50,\"a\"),ɵɵtext(51,\"Total Amount\"),ɵɵelementEnd(),ɵɵelementStart(52,\"input\",22,21),ɵɵlistener(\"ngModelChange\",(function($event){return ctx.productService.selectedProduct.tamount=$event})),ɵɵelementEnd(),ɵɵelementEnd(),ɵɵelementEnd(),ɵɵelementEnd(),ɵɵelementEnd(),ɵɵelementEnd()),2&rf&&(ɵɵadvance(21),ɵɵproperty(\"ngForOf\",ctx.productList),ɵɵadvance(11),ɵɵproperty(\"ngModel\",ctx.productService.selectedProduct.$key),ɵɵadvance(5),ɵɵproperty(\"ngModel\",ctx.productService.selectedProduct.name),ɵɵadvance(5),ɵɵproperty(\"ngModel\",ctx.productService.selectedProduct.dui),ɵɵadvance(5),ɵɵproperty(\"ngModel\",ctx.productService.selectedProduct.vehicle),ɵɵadvance(5),ɵɵproperty(\"ngModel\",ctx.productService.selectedProduct.tamount))},directives:[common_NgForOf,forms_DefaultValueAccessor,forms_NgControlStatus,forms_NgModel,forms_NumberValueAccessor],styles:[\"\"]}),ProductListComponent})(),products_component_ProductsComponent=(()=>{class ProductsComponent{constructor(){}ngOnInit(){}}return ProductsComponent.ɵfac=function(t){return new(t||ProductsComponent)},ProductsComponent.ɵcmp=ɵɵdefineComponent({type:ProductsComponent,selectors:[[\"app-products\"]],decls:6,vars:0,consts:[[1,\"container\"],[1,\"row\"],[1,\"col-md-3\"],[1,\"col-md-9\",\"text-center\"]],template:function(rf,ctx){1&rf&&(ɵɵelementStart(0,\"div\",0),ɵɵelementStart(1,\"div\",1),ɵɵelementStart(2,\"div\",2),ɵɵelement(3,\"app-product\"),ɵɵelementEnd(),ɵɵelementStart(4,\"div\",3),ɵɵelement(5,\"app-product-list\"),ɵɵelementEnd(),ɵɵelementEnd(),ɵɵelementEnd())},directives:[product_component_ProductComponent,product_list_component_ProductListComponent],styles:[\"\"]}),ProductsComponent})();function DashboardComponent_div_23_Template(rf,ctx){if(1&rf&&(ɵɵelementStart(0,\"div\",4),ɵɵelementStart(1,\"div\",18),ɵɵelementStart(2,\"div\",19),ɵɵelement(3,\"img\",20),ɵɵelementStart(4,\"div\",21),ɵɵelementStart(5,\"h1\"),ɵɵtext(6,\"Hello: \"),ɵɵelementStart(7,\"strong\"),ɵɵtext(8),ɵɵelementEnd(),ɵɵelementEnd(),ɵɵelementStart(9,\"p\"),ɵɵtext(10,\"User ID: \"),ɵɵelementStart(11,\"strong\"),ɵɵtext(12),ɵɵelementEnd(),ɵɵelementEnd(),ɵɵelementStart(13,\"p\"),ɵɵtext(14,\"Email: \"),ɵɵelementStart(15,\"strong\"),ɵɵtext(16),ɵɵelementEnd(),ɵɵelementEnd(),ɵɵelementStart(17,\"p\"),ɵɵtext(18,\"Email Verified: \"),ɵɵelementStart(19,\"strong\"),ɵɵtext(20),ɵɵelementEnd(),ɵɵelementEnd(),ɵɵelementEnd(),ɵɵelementEnd(),ɵɵelementEnd(),ɵɵelementEnd()),2&rf){const user_r7=ctx.ngIf;ɵɵadvance(3),ɵɵpropertyInterpolate(\"src\",user_r7.photoURL?user_r7.photoURL:\"/assets/dummy-user.png\",ɵɵsanitizeUrl),ɵɵpropertyInterpolate(\"alt\",user_r7.displayName),ɵɵadvance(5),ɵɵtextInterpolate(user_r7.displayName?user_r7.displayName:\"User\"),ɵɵadvance(4),ɵɵtextInterpolate(user_r7.uid),ɵɵadvance(4),ɵɵtextInterpolate(user_r7.email),ɵɵadvance(4),ɵɵtextInterpolate(user_r7.emailVerified)}}let dashboard_component_DashboardComponent=(()=>{class DashboardComponent{constructor(authService){this.authService=authService}ngOnInit(){}}return DashboardComponent.ɵfac=function(t){return new(t||DashboardComponent)(ɵɵdirectiveInject(auth_service_AuthService))},DashboardComponent.ɵcmp=ɵɵdefineComponent({type:DashboardComponent,selectors:[[\"app-dashboard\"]],decls:26,vars:1,consts:[[1,\"navbar\",\"navbar-dark\",\"fixed-top\",\"bg-dark\",\"flex-md-nowrap\",\"p-0\",\"shadow\"],[1,\"navbar-brand\",\"col-sm-3\",\"col-md-2\",\"mr-0\"],[\"src\",\"\",\"alt\",\"Logo\",1,\"brand-logo\"],[1,\"container-fluid\"],[1,\"row\"],[1,\"col-md-2\",\"d-md-block\",\"bg-light\",\"sidebar\"],[1,\"sidebar-sticky\"],[1,\"nav\",\"flex-column\"],[1,\"nav-item\"],[1,\"nav-link\",\"active\"],[1,\"fas\",\"fa-user\"],[1,\"nav-link\",3,\"click\"],[1,\"fas\",\"fa-sign-out-alt\"],[\"role\",\"main\",1,\"col-md-9\",\"ml-sm-auto\",\"col-lg-10\",\"px-4\"],[1,\"inner-adjust\"],[1,\"pt-3\",\"pb-2\",\"mb-3\",\"border-bottom\"],[1,\"h2\"],[\"class\",\"row\",4,\"ngIf\"],[1,\"col-md-12\"],[1,\"media\"],[1,\"align-self-start\",\"mr-1\",\"img-thumbnail\",\"rounded-circle\",3,\"src\",\"alt\"],[1,\"media-body\"]],template:function(rf,ctx){1&rf&&(ɵɵelementStart(0,\"p\"),ɵɵtext(1,\"dashboard works!\"),ɵɵelementEnd(),ɵɵelementStart(2,\"nav\",0),ɵɵelementStart(3,\"a\",1),ɵɵelement(4,\"img\",2),ɵɵelementEnd(),ɵɵelementEnd(),ɵɵelementStart(5,\"div\",3),ɵɵelementStart(6,\"div\",4),ɵɵelementStart(7,\"nav\",5),ɵɵelementStart(8,\"div\",6),ɵɵelementStart(9,\"ul\",7),ɵɵelementStart(10,\"li\",8),ɵɵelementStart(11,\"a\",9),ɵɵelement(12,\"i\",10),ɵɵtext(13,\"User Profile \"),ɵɵelementEnd(),ɵɵelementEnd(),ɵɵelementStart(14,\"li\",8),ɵɵelementStart(15,\"a\",11),ɵɵlistener(\"click\",(function(){return ctx.authService.SignOut()})),ɵɵelement(16,\"i\",12),ɵɵtext(17,\"Log out \"),ɵɵelementEnd(),ɵɵelementEnd(),ɵɵelementEnd(),ɵɵelementEnd(),ɵɵelementEnd(),ɵɵelementStart(18,\"main\",13),ɵɵelementStart(19,\"div\",14),ɵɵelementStart(20,\"div\",15),ɵɵelementStart(21,\"h1\",16),ɵɵtext(22,\"User Profile\"),ɵɵelementEnd(),ɵɵelementEnd(),ɵɵtemplate(23,DashboardComponent_div_23_Template,21,6,\"div\",17),ɵɵelementEnd(),ɵɵelementEnd(),ɵɵelementEnd(),ɵɵelementEnd(),ɵɵelement(24,\"br\"),ɵɵelement(25,\"app-products\")),2&rf&&(ɵɵadvance(23),ɵɵproperty(\"ngIf\",ctx.authService.userData))},directives:[common_NgIf,products_component_ProductsComponent],styles:[\"\"]}),DashboardComponent})(),forgot_password_component_ForgotPasswordComponent=(()=>{class ForgotPasswordComponent{constructor(authService){this.authService=authService}ngOnInit(){}}return ForgotPasswordComponent.ɵfac=function(t){return new(t||ForgotPasswordComponent)(ɵɵdirectiveInject(auth_service_AuthService))},ForgotPasswordComponent.ɵcmp=ɵɵdefineComponent({type:ForgotPasswordComponent,selectors:[[\"app-forgot-password\"]],decls:19,vars:0,consts:[[1,\"displayTable\"],[1,\"displayTableCell\"],[1,\"authBlock\"],[1,\"text-center\"],[1,\"formGroup\"],[\"type\",\"email\",\"placeholder\",\"Email Address\",\"required\",\"\",1,\"formControl\"],[\"passwordResetEmail\",\"\"],[\"type\",\"submit\",\"value\",\"Reset Password\",1,\"btn\",\"btnPrimary\",3,\"click\"],[1,\"redirectToLogin\"],[\"routerLink\",\"/sign-in\",1,\"redirect\"]],template:function(rf,ctx){if(1&rf){const _r9=ɵɵgetCurrentView();ɵɵelementStart(0,\"p\"),ɵɵtext(1,\"forgot-password works!\"),ɵɵelementEnd(),ɵɵelementStart(2,\"div\",0),ɵɵelementStart(3,\"div\",1),ɵɵelementStart(4,\"div\",2),ɵɵelementStart(5,\"h3\"),ɵɵtext(6,\"Reset Password\"),ɵɵelementEnd(),ɵɵelementStart(7,\"p\",3),ɵɵtext(8,\"Please enter your email address to request a password reset.\"),ɵɵelementEnd(),ɵɵelementStart(9,\"div\",4),ɵɵelement(10,\"input\",5,6),ɵɵelementEnd(),ɵɵelementStart(12,\"div\",4),ɵɵelementStart(13,\"input\",7),ɵɵlistener(\"click\",(function(){ɵɵrestoreView(_r9);const _r8=ɵɵreference(11);return ctx.authService.ForgotPassword(_r8.value)})),ɵɵelementEnd(),ɵɵelementEnd(),ɵɵelementEnd(),ɵɵelementStart(14,\"div\",8),ɵɵelementStart(15,\"span\"),ɵɵtext(16,\"Go back to ? \"),ɵɵelementStart(17,\"span\",9),ɵɵtext(18,\"Log In\"),ɵɵelementEnd(),ɵɵelementEnd(),ɵɵelementEnd(),ɵɵelementEnd(),ɵɵelementEnd()}},directives:[router_RouterLink],styles:[\"\"]}),ForgotPasswordComponent})();function VerifyEmailComponent_div_7_Template(rf,ctx){if(1&rf&&(ɵɵelementStart(0,\"div\",4),ɵɵelementStart(1,\"p\",9),ɵɵtext(2,\"We have sent a confirmation email to \"),ɵɵelementStart(3,\"strong\"),ɵɵtext(4),ɵɵelementEnd(),ɵɵtext(5,\".\"),ɵɵelementEnd(),ɵɵelementStart(6,\"p\",9),ɵɵtext(7,\"Please check your email and click on the link to verfiy your email address.\"),ɵɵelementEnd(),ɵɵelementEnd()),2&rf){const user_r11=ctx.ngIf;ɵɵadvance(4),ɵɵtextInterpolate(user_r11.email)}}let verify_email_component_VerifyEmailComponent=(()=>{class VerifyEmailComponent{constructor(authService){this.authService=authService}ngOnInit(){}}return VerifyEmailComponent.ɵfac=function(t){return new(t||VerifyEmailComponent)(ɵɵdirectiveInject(auth_service_AuthService))},VerifyEmailComponent.ɵcmp=ɵɵdefineComponent({type:VerifyEmailComponent,selectors:[[\"app-verify-email\"]],decls:17,vars:1,consts:[[1,\"displayTable\"],[1,\"displayTableCell\"],[1,\"authBlock\"],[\"class\",\"formGroup\",4,\"ngIf\"],[1,\"formGroup\"],[\"type\",\"button\",1,\"btn\",\"btnPrimary\",3,\"click\"],[1,\"fas\",\"fa-redo-alt\"],[1,\"redirectToLogin\"],[\"routerLink\",\"/sign-in\",1,\"redirect\"],[1,\"text-center\"]],template:function(rf,ctx){1&rf&&(ɵɵelementStart(0,\"p\"),ɵɵtext(1,\"verify-email works!\"),ɵɵelementEnd(),ɵɵelementStart(2,\"div\",0),ɵɵelementStart(3,\"div\",1),ɵɵelementStart(4,\"div\",2),ɵɵelementStart(5,\"h3\"),ɵɵtext(6,\"Thank You for Registering\"),ɵɵelementEnd(),ɵɵtemplate(7,VerifyEmailComponent_div_7_Template,8,1,\"div\",3),ɵɵelementStart(8,\"div\",4),ɵɵelementStart(9,\"button\",5),ɵɵlistener(\"click\",(function(){return ctx.authService.SendVerificationMail()})),ɵɵelement(10,\"i\",6),ɵɵtext(11,\" Resend Verification Email \"),ɵɵelementEnd(),ɵɵelementEnd(),ɵɵelementEnd(),ɵɵelementStart(12,\"div\",7),ɵɵelementStart(13,\"span\"),ɵɵtext(14,\"Go back to?\"),ɵɵelementStart(15,\"span\",8),ɵɵtext(16,\" Sign in\"),ɵɵelementEnd(),ɵɵelementEnd(),ɵɵelementEnd(),ɵɵelementEnd(),ɵɵelementEnd()),2&rf&&(ɵɵadvance(7),ɵɵproperty(\"ngIf\",ctx.authService.userData))},directives:[common_NgIf,router_RouterLink],styles:[\"\"]}),VerifyEmailComponent})(),auth_guard_AuthGuard=(()=>{class AuthGuard{constructor(authService,router){this.authService=authService,this.router=router}canActivate(next,state){return!0!==this.authService.isLoggedIn&&this.router.navigate([\"sign-in\"]),!0}}return AuthGuard.ɵfac=function(t){return new(t||AuthGuard)(ɵɵinject(auth_service_AuthService),ɵɵinject(router_Router))},AuthGuard.ɵprov=ɵɵdefineInjectable({token:AuthGuard,factory:AuthGuard.ɵfac,providedIn:\"root\"}),AuthGuard})();const app_routing_module_routes=[{path:\"\",redirectTo:\"/sign-in\",pathMatch:\"full\"},{path:\"sign-in\",component:sign_in_component_SignInComponent},{path:\"register-user\",component:sign_up_component_SignUpComponent},{path:\"dashboard\",component:dashboard_component_DashboardComponent,canActivate:[auth_guard_AuthGuard]},{path:\"forgot-password\",component:forgot_password_component_ForgotPasswordComponent},{path:\"verify-email-address\",component:verify_email_component_VerifyEmailComponent}];let app_routing_module_AppRoutingModule=(()=>{class AppRoutingModule{}return AppRoutingModule.ɵmod=ɵɵdefineNgModule({type:AppRoutingModule}),AppRoutingModule.ɵinj=ɵɵdefineInjector({factory:function(t){return new(t||AppRoutingModule)},imports:[[router_RouterModule.forRoot(app_routing_module_routes)],router_RouterModule]}),AppRoutingModule})(),app_component_AppComponent=(()=>{class AppComponent{constructor(){this.title=\"angularfirebase-authentication\"}}return AppComponent.ɵfac=function(t){return new(t||AppComponent)},AppComponent.ɵcmp=ɵɵdefineComponent({type:AppComponent,selectors:[[\"app-root\"]],decls:1,vars:0,template:function(rf,ctx){1&rf&&ɵɵelement(0,\"router-outlet\")},directives:[router_RouterOutlet],styles:[\"\"]}),AppComponent})();function isNode(){return\"undefined\"!=typeof process&&\"[object process]\"==={}.toString.call(process)}function optimizeGroupPlayer(players){switch(players.length){case 0:return new NoopAnimationPlayer;case 1:return players[0];default:return new AnimationGroupPlayer(players)}}function normalizeKeyframes(driver,normalizer,element,keyframes,preStyles={},postStyles={}){const errors=[],normalizedKeyframes=[];let previousOffset=-1,previousKeyframe=null;if(keyframes.forEach(kf=>{const offset=kf.offset,isSameOffset=offset==previousOffset,normalizedKeyframe=isSameOffset&&previousKeyframe||{};Object.keys(kf).forEach(prop=>{let normalizedProp=prop,normalizedValue=kf[prop];if(\"offset\"!==prop)switch(normalizedProp=normalizer.normalizePropertyName(normalizedProp,errors),normalizedValue){case\"!\":normalizedValue=preStyles[prop];break;case\"*\":normalizedValue=postStyles[prop];break;default:normalizedValue=normalizer.normalizeStyleValue(prop,normalizedProp,normalizedValue,errors)}normalizedKeyframe[normalizedProp]=normalizedValue}),isSameOffset||normalizedKeyframes.push(normalizedKeyframe),previousKeyframe=normalizedKeyframe,previousOffset=offset}),errors.length){const LINE_START=\"\\n - \";throw new Error(`Unable to animate due to the following errors:${LINE_START}${errors.join(LINE_START)}`)}return normalizedKeyframes}function listenOnPlayer(player,eventName,event,callback){switch(eventName){case\"start\":player.onStart(()=>callback(event&&copyAnimationEvent(event,\"start\",player)));break;case\"done\":player.onDone(()=>callback(event&&copyAnimationEvent(event,\"done\",player)));break;case\"destroy\":player.onDestroy(()=>callback(event&&copyAnimationEvent(event,\"destroy\",player)))}}function copyAnimationEvent(e,phaseName,player){const totalTime=player.totalTime,event=makeAnimationEvent(e.element,e.triggerName,e.fromState,e.toState,phaseName||e.phaseName,null==totalTime?e.totalTime:totalTime,!!player.disabled),data=e._data;return null!=data&&(event._data=data),event}function makeAnimationEvent(element,triggerName,fromState,toState,phaseName=\"\",totalTime=0,disabled){return{element:element,triggerName:triggerName,fromState:fromState,toState:toState,phaseName:phaseName,totalTime:totalTime,disabled:!!disabled}}function getOrSetAsInMap(map,key,defaultValue){let value;return map instanceof Map?(value=map.get(key),value||map.set(key,value=defaultValue)):(value=map[key],value||(value=map[key]=defaultValue)),value}function parseTimelineCommand(command){const separatorPos=command.indexOf(\":\");return[command.substring(1,separatorPos),command.substr(separatorPos+1)]}let _contains=(elm1,elm2)=>!1,_matches=(element,selector)=>!1,_query=(element,selector,multi)=>[];const _isNode=isNode();(_isNode||\"undefined\"!=typeof Element)&&(_contains=(elm1,elm2)=>elm1.contains(elm2),_matches=(()=>{if(_isNode||Element.prototype.matches)return(element,selector)=>element.matches(selector);{const proto=Element.prototype,fn=proto.matchesSelector||proto.mozMatchesSelector||proto.msMatchesSelector||proto.oMatchesSelector||proto.webkitMatchesSelector;return fn?(element,selector)=>fn.apply(element,[selector]):_matches}})(),_query=(element,selector,multi)=>{let results=[];if(multi)results.push(...element.querySelectorAll(selector));else{const elm=element.querySelector(selector);elm&&results.push(elm)}return results});let _CACHED_BODY=null,_IS_WEBKIT=!1;function validateStyleProperty(prop){_CACHED_BODY||(_CACHED_BODY=(\"undefined\"!=typeof document?document.body:null)||{},_IS_WEBKIT=!!_CACHED_BODY.style&&\"WebkitAppearance\"in _CACHED_BODY.style);let result=!0;return _CACHED_BODY.style&&!function(prop){return\"ebkit\"==prop.substring(1,6)}(prop)&&(result=prop in _CACHED_BODY.style,!result&&_IS_WEBKIT)&&(result=\"Webkit\"+prop.charAt(0).toUpperCase()+prop.substr(1)in _CACHED_BODY.style),result}const matchesElement=_matches,containsElement=_contains,invokeQuery=_query;function hypenatePropsObject(object){const newObj={};return Object.keys(object).forEach(prop=>{const newProp=prop.replace(/([a-z])([A-Z])/g,\"$1-$2\");newObj[newProp]=object[prop]}),newObj}let browser_NoopAnimationDriver=(()=>{class NoopAnimationDriver{validateStyleProperty(prop){return validateStyleProperty(prop)}matchesElement(element,selector){return matchesElement(element,selector)}containsElement(elm1,elm2){return containsElement(elm1,elm2)}query(element,selector,multi){return invokeQuery(element,selector,multi)}computeStyle(element,prop,defaultValue){return defaultValue||\"\"}animate(element,keyframes,duration,delay,easing,previousPlayers=[],scrubberAccessRequested){return new NoopAnimationPlayer(duration,delay)}}return NoopAnimationDriver.ɵfac=function(t){return new(t||NoopAnimationDriver)},NoopAnimationDriver.ɵprov=ɵɵdefineInjectable({token:NoopAnimationDriver,factory:NoopAnimationDriver.ɵfac}),NoopAnimationDriver})(),AnimationDriver=(()=>{class AnimationDriver{}return AnimationDriver.NOOP=new browser_NoopAnimationDriver,AnimationDriver})();function resolveTimingValue(value){if(\"number\"==typeof value)return value;const matches=value.match(/^(-?[\\.\\d]+)(m?s)/);return!matches||matches.length<2?0:_convertTimeValueToMS(parseFloat(matches[1]),matches[2])}function _convertTimeValueToMS(value,unit){switch(unit){case\"s\":return 1e3*value;default:return value}}function resolveTiming(timings,errors,allowNegativeValues){return timings.hasOwnProperty(\"duration\")?timings:function(exp,errors,allowNegativeValues){let duration,delay=0,easing=\"\";if(\"string\"==typeof exp){const matches=exp.match(/^(-?[\\.\\d]+)(m?s)(?:\\s+(-?[\\.\\d]+)(m?s))?(?:\\s+([-a-z]+(?:\\(.+?\\))?))?$/i);if(null===matches)return errors.push(`The provided timing value \"${exp}\" is invalid.`),{duration:0,delay:0,easing:\"\"};duration=_convertTimeValueToMS(parseFloat(matches[1]),matches[2]);const delayMatch=matches[3];null!=delayMatch&&(delay=_convertTimeValueToMS(parseFloat(delayMatch),matches[4]));const easingVal=matches[5];easingVal&&(easing=easingVal)}else duration=exp;if(!allowNegativeValues){let containsErrors=!1,startIndex=errors.length;duration<0&&(errors.push(\"Duration values below 0 are not allowed for this animation step.\"),containsErrors=!0),delay<0&&(errors.push(\"Delay values below 0 are not allowed for this animation step.\"),containsErrors=!0),containsErrors&&errors.splice(startIndex,0,`The provided timing value \"${exp}\" is invalid.`)}return{duration:duration,delay:delay,easing:easing}}(timings,errors,allowNegativeValues)}function copyObj(obj,destination={}){return Object.keys(obj).forEach(prop=>{destination[prop]=obj[prop]}),destination}function copyStyles(styles,readPrototype,destination={}){if(readPrototype)for(let prop in styles)destination[prop]=styles[prop];else copyObj(styles,destination);return destination}function getStyleAttributeString(element,key,value){return value?key+\":\"+value+\";\":\"\"}function writeStyleAttribute(element){let styleAttrValue=\"\";for(let i=0;i<element.style.length;i++){const key=element.style.item(i);styleAttrValue+=getStyleAttributeString(0,key,element.style.getPropertyValue(key))}for(const key in element.style)element.style.hasOwnProperty(key)&&!key.startsWith(\"_\")&&(styleAttrValue+=getStyleAttributeString(0,key.replace(/([a-z])([A-Z])/g,\"$1-$2\").toLowerCase(),element.style[key]));element.setAttribute(\"style\",styleAttrValue)}function setStyles(element,styles,formerStyles){element.style&&(Object.keys(styles).forEach(prop=>{const camelProp=browser_dashCaseToCamelCase(prop);formerStyles&&!formerStyles.hasOwnProperty(prop)&&(formerStyles[prop]=element.style[camelProp]),element.style[camelProp]=styles[prop]}),isNode()&&writeStyleAttribute(element))}function eraseStyles(element,styles){element.style&&(Object.keys(styles).forEach(prop=>{const camelProp=browser_dashCaseToCamelCase(prop);element.style[camelProp]=\"\"}),isNode()&&writeStyleAttribute(element))}function normalizeAnimationEntry(steps){return Array.isArray(steps)?1==steps.length?steps[0]:sequence(steps):steps}const PARAM_REGEX=new RegExp(\"{{\\\\s*(.+?)\\\\s*}}\",\"g\");function extractStyleParams(value){let params=[];if(\"string\"==typeof value){let match;for(;match=PARAM_REGEX.exec(value);)params.push(match[1]);PARAM_REGEX.lastIndex=0}return params}function interpolateParams(value,params,errors){const original=value.toString(),str=original.replace(PARAM_REGEX,(_,varName)=>{let localVal=params[varName];return params.hasOwnProperty(varName)||(errors.push(\"Please provide a value for the animation param \"+varName),localVal=\"\"),localVal.toString()});return str==original?value:str}function iteratorToArray(iterator){const arr=[];let item=iterator.next();for(;!item.done;)arr.push(item.value),item=iterator.next();return arr}const browser_DASH_CASE_REGEXP=/-+([a-z0-9])/g;function browser_dashCaseToCamelCase(input){return input.replace(browser_DASH_CASE_REGEXP,(...m)=>m[1].toUpperCase())}function allowPreviousPlayerStylesMerge(duration,delay){return 0===duration||0===delay}function balancePreviousStylesIntoKeyframes(element,keyframes,previousStyles){const previousStyleProps=Object.keys(previousStyles);if(previousStyleProps.length&&keyframes.length){let startingKeyframe=keyframes[0],missingStyleProps=[];if(previousStyleProps.forEach(prop=>{startingKeyframe.hasOwnProperty(prop)||missingStyleProps.push(prop),startingKeyframe[prop]=previousStyles[prop]}),missingStyleProps.length)for(var i=1;i<keyframes.length;i++){let kf=keyframes[i];missingStyleProps.forEach((function(prop){kf[prop]=computeStyle(element,prop)}))}}return keyframes}function visitDslNode(visitor,node,context){switch(node.type){case 7:return visitor.visitTrigger(node,context);case 0:return visitor.visitState(node,context);case 1:return visitor.visitTransition(node,context);case 2:return visitor.visitSequence(node,context);case 3:return visitor.visitGroup(node,context);case 4:return visitor.visitAnimate(node,context);case 5:return visitor.visitKeyframes(node,context);case 6:return visitor.visitStyle(node,context);case 8:return visitor.visitReference(node,context);case 9:return visitor.visitAnimateChild(node,context);case 10:return visitor.visitAnimateRef(node,context);case 11:return visitor.visitQuery(node,context);case 12:return visitor.visitStagger(node,context);default:throw new Error(\"Unable to resolve animation metadata node #\"+node.type)}}function computeStyle(element,prop){return window.getComputedStyle(element)[prop]}function parseTransitionExpr(transitionValue,errors){const expressions=[];return\"string\"==typeof transitionValue?transitionValue.split(/\\s*,\\s*/).forEach(str=>function(eventStr,expressions,errors){if(\":\"==eventStr[0]){const result=function(alias,errors){switch(alias){case\":enter\":return\"void => *\";case\":leave\":return\"* => void\";case\":increment\":return(fromState,toState)=>parseFloat(toState)>parseFloat(fromState);case\":decrement\":return(fromState,toState)=>parseFloat(toState)<parseFloat(fromState);default:return errors.push(`The transition alias value \"${alias}\" is not supported`),\"* => *\"}}(eventStr,errors);if(\"function\"==typeof result)return void expressions.push(result);eventStr=result}const match=eventStr.match(/^(\\*|[-\\w]+)\\s*(<?[=-]>)\\s*(\\*|[-\\w]+)$/);if(null==match||match.length<4)return errors.push(`The provided transition expression \"${eventStr}\" is not supported`),expressions;const fromState=match[1],separator=match[2],toState=match[3];expressions.push(makeLambdaFromStates(fromState,toState)),\"<\"!=separator[0]||\"*\"==fromState&&\"*\"==toState||expressions.push(makeLambdaFromStates(toState,fromState))}(str,expressions,errors)):expressions.push(transitionValue),expressions}const TRUE_BOOLEAN_VALUES=new Set([\"true\",\"1\"]),FALSE_BOOLEAN_VALUES=new Set([\"false\",\"0\"]);function makeLambdaFromStates(lhs,rhs){const LHS_MATCH_BOOLEAN=TRUE_BOOLEAN_VALUES.has(lhs)||FALSE_BOOLEAN_VALUES.has(lhs),RHS_MATCH_BOOLEAN=TRUE_BOOLEAN_VALUES.has(rhs)||FALSE_BOOLEAN_VALUES.has(rhs);return(fromState,toState)=>{let lhsMatch=\"*\"==lhs||lhs==fromState,rhsMatch=\"*\"==rhs||rhs==toState;return!lhsMatch&&LHS_MATCH_BOOLEAN&&\"boolean\"==typeof fromState&&(lhsMatch=fromState?TRUE_BOOLEAN_VALUES.has(lhs):FALSE_BOOLEAN_VALUES.has(lhs)),!rhsMatch&&RHS_MATCH_BOOLEAN&&\"boolean\"==typeof toState&&(rhsMatch=toState?TRUE_BOOLEAN_VALUES.has(rhs):FALSE_BOOLEAN_VALUES.has(rhs)),lhsMatch&&rhsMatch}}const SELF_TOKEN_REGEX=new RegExp(\"s*:selfs*,?\",\"g\");function buildAnimationAst(driver,metadata,errors){return new browser_AnimationAstBuilderVisitor(driver).build(metadata,errors)}class browser_AnimationAstBuilderVisitor{constructor(_driver){this._driver=_driver}build(metadata,errors){const context=new AnimationAstBuilderContext(errors);return this._resetContextStyleTimingState(context),visitDslNode(this,normalizeAnimationEntry(metadata),context)}_resetContextStyleTimingState(context){context.currentQuerySelector=\"\",context.collectedStyles={},context.collectedStyles[\"\"]={},context.currentTime=0}visitTrigger(metadata,context){let queryCount=context.queryCount=0,depCount=context.depCount=0;const states=[],transitions=[];return\"@\"==metadata.name.charAt(0)&&context.errors.push(\"animation triggers cannot be prefixed with an `@` sign (e.g. trigger('@foo', [...]))\"),metadata.definitions.forEach(def=>{if(this._resetContextStyleTimingState(context),0==def.type){const stateDef=def,name=stateDef.name;name.toString().split(/\\s*,\\s*/).forEach(n=>{stateDef.name=n,states.push(this.visitState(stateDef,context))}),stateDef.name=name}else if(1==def.type){const transition=this.visitTransition(def,context);queryCount+=transition.queryCount,depCount+=transition.depCount,transitions.push(transition)}else context.errors.push(\"only state() and transition() definitions can sit inside of a trigger()\")}),{type:7,name:metadata.name,states:states,transitions:transitions,queryCount:queryCount,depCount:depCount,options:null}}visitState(metadata,context){const styleAst=this.visitStyle(metadata.styles,context),astParams=metadata.options&&metadata.options.params||null;if(styleAst.containsDynamicStyles){const missingSubs=new Set,params=astParams||{};if(styleAst.styles.forEach(value=>{if(browser_isObject(value)){const stylesObj=value;Object.keys(stylesObj).forEach(prop=>{extractStyleParams(stylesObj[prop]).forEach(sub=>{params.hasOwnProperty(sub)||missingSubs.add(sub)})})}}),missingSubs.size){const missingSubsArr=iteratorToArray(missingSubs.values());context.errors.push(`state(\"${metadata.name}\", ...) must define default values for all the following style substitutions: ${missingSubsArr.join(\", \")}`)}}return{type:0,name:metadata.name,style:styleAst,options:astParams?{params:astParams}:null}}visitTransition(metadata,context){context.queryCount=0,context.depCount=0;const animation=visitDslNode(this,normalizeAnimationEntry(metadata.animation),context);return{type:1,matchers:parseTransitionExpr(metadata.expr,context.errors),animation:animation,queryCount:context.queryCount,depCount:context.depCount,options:normalizeAnimationOptions(metadata.options)}}visitSequence(metadata,context){return{type:2,steps:metadata.steps.map(s=>visitDslNode(this,s,context)),options:normalizeAnimationOptions(metadata.options)}}visitGroup(metadata,context){const currentTime=context.currentTime;let furthestTime=0;const steps=metadata.steps.map(step=>{context.currentTime=currentTime;const innerAst=visitDslNode(this,step,context);return furthestTime=Math.max(furthestTime,context.currentTime),innerAst});return context.currentTime=furthestTime,{type:3,steps:steps,options:normalizeAnimationOptions(metadata.options)}}visitAnimate(metadata,context){const timingAst=function(value,errors){let timings=null;if(value.hasOwnProperty(\"duration\"))timings=value;else if(\"number\"==typeof value)return makeTimingAst(resolveTiming(value,errors).duration,0,\"\");const strValue=value;if(strValue.split(/\\s+/).some(v=>\"{\"==v.charAt(0)&&\"{\"==v.charAt(1))){const ast=makeTimingAst(0,0,\"\");return ast.dynamic=!0,ast.strValue=strValue,ast}return timings=timings||resolveTiming(strValue,errors),makeTimingAst(timings.duration,timings.delay,timings.easing)}(metadata.timings,context.errors);let styleAst;context.currentAnimateTimings=timingAst;let styleMetadata=metadata.styles?metadata.styles:animations_style({});if(5==styleMetadata.type)styleAst=this.visitKeyframes(styleMetadata,context);else{let styleMetadata=metadata.styles,isEmpty=!1;if(!styleMetadata){isEmpty=!0;const newStyleData={};timingAst.easing&&(newStyleData.easing=timingAst.easing),styleMetadata=animations_style(newStyleData)}context.currentTime+=timingAst.duration+timingAst.delay;const _styleAst=this.visitStyle(styleMetadata,context);_styleAst.isEmptyStep=isEmpty,styleAst=_styleAst}return context.currentAnimateTimings=null,{type:4,timings:timingAst,style:styleAst,options:null}}visitStyle(metadata,context){const ast=this._makeStyleAst(metadata,context);return this._validateStyleAst(ast,context),ast}_makeStyleAst(metadata,context){const styles=[];Array.isArray(metadata.styles)?metadata.styles.forEach(styleTuple=>{\"string\"==typeof styleTuple?\"*\"==styleTuple?styles.push(styleTuple):context.errors.push(`The provided style string value ${styleTuple} is not allowed.`):styles.push(styleTuple)}):styles.push(metadata.styles);let containsDynamicStyles=!1,collectedEasing=null;return styles.forEach(styleData=>{if(browser_isObject(styleData)){const styleMap=styleData,easing=styleMap.easing;if(easing&&(collectedEasing=easing,delete styleMap.easing),!containsDynamicStyles)for(let prop in styleMap)if(styleMap[prop].toString().indexOf(\"{{\")>=0){containsDynamicStyles=!0;break}}}),{type:6,styles:styles,easing:collectedEasing,offset:metadata.offset,containsDynamicStyles:containsDynamicStyles,options:null}}_validateStyleAst(ast,context){const timings=context.currentAnimateTimings;let endTime=context.currentTime,startTime=context.currentTime;timings&&startTime>0&&(startTime-=timings.duration+timings.delay),ast.styles.forEach(tuple=>{\"string\"!=typeof tuple&&Object.keys(tuple).forEach(prop=>{if(!this._driver.validateStyleProperty(prop))return void context.errors.push(`The provided animation property \"${prop}\" is not a supported CSS property for animations`);const collectedStyles=context.collectedStyles[context.currentQuerySelector],collectedEntry=collectedStyles[prop];let updateCollectedStyle=!0;collectedEntry&&(startTime!=endTime&&startTime>=collectedEntry.startTime&&endTime<=collectedEntry.endTime&&(context.errors.push(`The CSS property \"${prop}\" that exists between the times of \"${collectedEntry.startTime}ms\" and \"${collectedEntry.endTime}ms\" is also being animated in a parallel animation between the times of \"${startTime}ms\" and \"${endTime}ms\"`),updateCollectedStyle=!1),startTime=collectedEntry.startTime),updateCollectedStyle&&(collectedStyles[prop]={startTime:startTime,endTime:endTime}),context.options&&function(value,options,errors){const params=options.params||{},matches=extractStyleParams(value);matches.length&&matches.forEach(varName=>{params.hasOwnProperty(varName)||errors.push(`Unable to resolve the local animation param ${varName} in the given list of values`)})}(tuple[prop],context.options,context.errors)})})}visitKeyframes(metadata,context){const ast={type:5,styles:[],options:null};if(!context.currentAnimateTimings)return context.errors.push(\"keyframes() must be placed inside of a call to animate()\"),ast;let totalKeyframesWithOffsets=0;const offsets=[];let offsetsOutOfOrder=!1,keyframesOutOfRange=!1,previousOffset=0;const keyframes=metadata.steps.map(styles=>{const style=this._makeStyleAst(styles,context);let offsetVal=null!=style.offset?style.offset:function(styles){if(\"string\"==typeof styles)return null;let offset=null;if(Array.isArray(styles))styles.forEach(styleTuple=>{if(browser_isObject(styleTuple)&&styleTuple.hasOwnProperty(\"offset\")){const obj=styleTuple;offset=parseFloat(obj.offset),delete obj.offset}});else if(browser_isObject(styles)&&styles.hasOwnProperty(\"offset\")){const obj=styles;offset=parseFloat(obj.offset),delete obj.offset}return offset}(style.styles),offset=0;return null!=offsetVal&&(totalKeyframesWithOffsets++,offset=style.offset=offsetVal),keyframesOutOfRange=keyframesOutOfRange||offset<0||offset>1,offsetsOutOfOrder=offsetsOutOfOrder||offset<previousOffset,previousOffset=offset,offsets.push(offset),style});keyframesOutOfRange&&context.errors.push(\"Please ensure that all keyframe offsets are between 0 and 1\"),offsetsOutOfOrder&&context.errors.push(\"Please ensure that all keyframe offsets are in order\");const length=metadata.steps.length;let generatedOffset=0;totalKeyframesWithOffsets>0&&totalKeyframesWithOffsets<length?context.errors.push(\"Not all style() steps within the declared keyframes() contain offsets\"):0==totalKeyframesWithOffsets&&(generatedOffset=1/(length-1));const limit=length-1,currentTime=context.currentTime,currentAnimateTimings=context.currentAnimateTimings,animateDuration=currentAnimateTimings.duration;return keyframes.forEach((kf,i)=>{const offset=generatedOffset>0?i==limit?1:generatedOffset*i:offsets[i],durationUpToThisFrame=offset*animateDuration;context.currentTime=currentTime+currentAnimateTimings.delay+durationUpToThisFrame,currentAnimateTimings.duration=durationUpToThisFrame,this._validateStyleAst(kf,context),kf.offset=offset,ast.styles.push(kf)}),ast}visitReference(metadata,context){return{type:8,animation:visitDslNode(this,normalizeAnimationEntry(metadata.animation),context),options:normalizeAnimationOptions(metadata.options)}}visitAnimateChild(metadata,context){return context.depCount++,{type:9,options:normalizeAnimationOptions(metadata.options)}}visitAnimateRef(metadata,context){return{type:10,animation:this.visitReference(metadata.animation,context),options:normalizeAnimationOptions(metadata.options)}}visitQuery(metadata,context){const parentSelector=context.currentQuerySelector,options=metadata.options||{};context.queryCount++,context.currentQuery=metadata;const[selector,includeSelf]=function(selector){const hasAmpersand=!!selector.split(/\\s*,\\s*/).find(token=>\":self\"==token);return hasAmpersand&&(selector=selector.replace(SELF_TOKEN_REGEX,\"\")),[selector=selector.replace(/@\\*/g,\".ng-trigger\").replace(/@\\w+/g,match=>\".ng-trigger-\"+match.substr(1)).replace(/:animating/g,\".ng-animating\"),hasAmpersand]}(metadata.selector);context.currentQuerySelector=parentSelector.length?parentSelector+\" \"+selector:selector,getOrSetAsInMap(context.collectedStyles,context.currentQuerySelector,{});const animation=visitDslNode(this,normalizeAnimationEntry(metadata.animation),context);return context.currentQuery=null,context.currentQuerySelector=parentSelector,{type:11,selector:selector,limit:options.limit||0,optional:!!options.optional,includeSelf:includeSelf,animation:animation,originalSelector:metadata.selector,options:normalizeAnimationOptions(metadata.options)}}visitStagger(metadata,context){context.currentQuery||context.errors.push(\"stagger() can only be used inside of query()\");const timings=\"full\"===metadata.timings?{duration:0,delay:0,easing:\"full\"}:resolveTiming(metadata.timings,context.errors,!0);return{type:12,animation:visitDslNode(this,normalizeAnimationEntry(metadata.animation),context),timings:timings,options:null}}}class AnimationAstBuilderContext{constructor(errors){this.errors=errors,this.queryCount=0,this.depCount=0,this.currentTransition=null,this.currentQuery=null,this.currentQuerySelector=null,this.currentAnimateTimings=null,this.currentTime=0,this.collectedStyles={},this.options=null}}function browser_isObject(value){return!Array.isArray(value)&&\"object\"==typeof value}function normalizeAnimationOptions(options){var obj;return options?(options=copyObj(options)).params&&(options.params=(obj=options.params)?copyObj(obj):null):options={},options}function makeTimingAst(duration,delay,easing){return{duration:duration,delay:delay,easing:easing}}function createTimelineInstruction(element,keyframes,preStyleProps,postStyleProps,duration,delay,easing=null,subTimeline=!1){return{type:1,element:element,keyframes:keyframes,preStyleProps:preStyleProps,postStyleProps:postStyleProps,duration:duration,delay:delay,totalTime:duration+delay,easing:easing,subTimeline:subTimeline}}class ElementInstructionMap{constructor(){this._map=new Map}consume(element){let instructions=this._map.get(element);return instructions?this._map.delete(element):instructions=[],instructions}append(element,instructions){let existingInstructions=this._map.get(element);existingInstructions||this._map.set(element,existingInstructions=[]),existingInstructions.push(...instructions)}has(element){return this._map.has(element)}clear(){this._map.clear()}}const ENTER_TOKEN_REGEX=new RegExp(\":enter\",\"g\"),LEAVE_TOKEN_REGEX=new RegExp(\":leave\",\"g\");function buildAnimationTimelines(driver,rootElement,ast,enterClassName,leaveClassName,startingStyles={},finalStyles={},options,subInstructions,errors=[]){return(new AnimationTimelineBuilderVisitor).buildKeyframes(driver,rootElement,ast,enterClassName,leaveClassName,startingStyles,finalStyles,options,subInstructions,errors)}class AnimationTimelineBuilderVisitor{buildKeyframes(driver,rootElement,ast,enterClassName,leaveClassName,startingStyles,finalStyles,options,subInstructions,errors=[]){subInstructions=subInstructions||new ElementInstructionMap;const context=new AnimationTimelineContext(driver,rootElement,subInstructions,enterClassName,leaveClassName,errors,[]);context.options=options,context.currentTimeline.setStyles([startingStyles],null,context.errors,options),visitDslNode(this,ast,context);const timelines=context.timelines.filter(timeline=>timeline.containsAnimation());if(timelines.length&&Object.keys(finalStyles).length){const tl=timelines[timelines.length-1];tl.allowOnlyTimelineStyles()||tl.setStyles([finalStyles],null,context.errors,options)}return timelines.length?timelines.map(timeline=>timeline.buildKeyframes()):[createTimelineInstruction(rootElement,[],[],[],0,0,\"\",!1)]}visitTrigger(ast,context){}visitState(ast,context){}visitTransition(ast,context){}visitAnimateChild(ast,context){const elementInstructions=context.subInstructions.consume(context.element);if(elementInstructions){const innerContext=context.createSubContext(ast.options),startTime=context.currentTimeline.currentTime,endTime=this._visitSubInstructions(elementInstructions,innerContext,innerContext.options);startTime!=endTime&&context.transformIntoNewTimeline(endTime)}context.previousNode=ast}visitAnimateRef(ast,context){const innerContext=context.createSubContext(ast.options);innerContext.transformIntoNewTimeline(),this.visitReference(ast.animation,innerContext),context.transformIntoNewTimeline(innerContext.currentTimeline.currentTime),context.previousNode=ast}_visitSubInstructions(instructions,context,options){let furthestTime=context.currentTimeline.currentTime;const duration=null!=options.duration?resolveTimingValue(options.duration):null,delay=null!=options.delay?resolveTimingValue(options.delay):null;return 0!==duration&&instructions.forEach(instruction=>{const instructionTimings=context.appendInstructionToTimeline(instruction,duration,delay);furthestTime=Math.max(furthestTime,instructionTimings.duration+instructionTimings.delay)}),furthestTime}visitReference(ast,context){context.updateOptions(ast.options,!0),visitDslNode(this,ast.animation,context),context.previousNode=ast}visitSequence(ast,context){const subContextCount=context.subContextCount;let ctx=context;const options=ast.options;if(options&&(options.params||options.delay)&&(ctx=context.createSubContext(options),ctx.transformIntoNewTimeline(),null!=options.delay)){6==ctx.previousNode.type&&(ctx.currentTimeline.snapshotCurrentStyles(),ctx.previousNode=DEFAULT_NOOP_PREVIOUS_NODE);const delay=resolveTimingValue(options.delay);ctx.delayNextStep(delay)}ast.steps.length&&(ast.steps.forEach(s=>visitDslNode(this,s,ctx)),ctx.currentTimeline.applyStylesToKeyframe(),ctx.subContextCount>subContextCount&&ctx.transformIntoNewTimeline()),context.previousNode=ast}visitGroup(ast,context){const innerTimelines=[];let furthestTime=context.currentTimeline.currentTime;const delay=ast.options&&ast.options.delay?resolveTimingValue(ast.options.delay):0;ast.steps.forEach(s=>{const innerContext=context.createSubContext(ast.options);delay&&innerContext.delayNextStep(delay),visitDslNode(this,s,innerContext),furthestTime=Math.max(furthestTime,innerContext.currentTimeline.currentTime),innerTimelines.push(innerContext.currentTimeline)}),innerTimelines.forEach(timeline=>context.currentTimeline.mergeTimelineCollectedStyles(timeline)),context.transformIntoNewTimeline(furthestTime),context.previousNode=ast}_visitTiming(ast,context){if(ast.dynamic){const strValue=ast.strValue;return resolveTiming(context.params?interpolateParams(strValue,context.params,context.errors):strValue,context.errors)}return{duration:ast.duration,delay:ast.delay,easing:ast.easing}}visitAnimate(ast,context){const timings=context.currentAnimateTimings=this._visitTiming(ast.timings,context),timeline=context.currentTimeline;timings.delay&&(context.incrementTime(timings.delay),timeline.snapshotCurrentStyles());const style=ast.style;5==style.type?this.visitKeyframes(style,context):(context.incrementTime(timings.duration),this.visitStyle(style,context),timeline.applyStylesToKeyframe()),context.currentAnimateTimings=null,context.previousNode=ast}visitStyle(ast,context){const timeline=context.currentTimeline,timings=context.currentAnimateTimings;!timings&&timeline.getCurrentStyleProperties().length&&timeline.forwardFrame();const easing=timings&&timings.easing||ast.easing;ast.isEmptyStep?timeline.applyEmptyStep(easing):timeline.setStyles(ast.styles,easing,context.errors,context.options),context.previousNode=ast}visitKeyframes(ast,context){const currentAnimateTimings=context.currentAnimateTimings,startTime=context.currentTimeline.duration,duration=currentAnimateTimings.duration,innerTimeline=context.createSubContext().currentTimeline;innerTimeline.easing=currentAnimateTimings.easing,ast.styles.forEach(step=>{innerTimeline.forwardTime((step.offset||0)*duration),innerTimeline.setStyles(step.styles,step.easing,context.errors,context.options),innerTimeline.applyStylesToKeyframe()}),context.currentTimeline.mergeTimelineCollectedStyles(innerTimeline),context.transformIntoNewTimeline(startTime+duration),context.previousNode=ast}visitQuery(ast,context){const startTime=context.currentTimeline.currentTime,options=ast.options||{},delay=options.delay?resolveTimingValue(options.delay):0;delay&&(6===context.previousNode.type||0==startTime&&context.currentTimeline.getCurrentStyleProperties().length)&&(context.currentTimeline.snapshotCurrentStyles(),context.previousNode=DEFAULT_NOOP_PREVIOUS_NODE);let furthestTime=startTime;const elms=context.invokeQuery(ast.selector,ast.originalSelector,ast.limit,ast.includeSelf,!!options.optional,context.errors);context.currentQueryTotal=elms.length;let sameElementTimeline=null;elms.forEach((element,i)=>{context.currentQueryIndex=i;const innerContext=context.createSubContext(ast.options,element);delay&&innerContext.delayNextStep(delay),element===context.element&&(sameElementTimeline=innerContext.currentTimeline),visitDslNode(this,ast.animation,innerContext),innerContext.currentTimeline.applyStylesToKeyframe(),furthestTime=Math.max(furthestTime,innerContext.currentTimeline.currentTime)}),context.currentQueryIndex=0,context.currentQueryTotal=0,context.transformIntoNewTimeline(furthestTime),sameElementTimeline&&(context.currentTimeline.mergeTimelineCollectedStyles(sameElementTimeline),context.currentTimeline.snapshotCurrentStyles()),context.previousNode=ast}visitStagger(ast,context){const parentContext=context.parentContext,tl=context.currentTimeline,timings=ast.timings,duration=Math.abs(timings.duration),maxTime=duration*(context.currentQueryTotal-1);let delay=duration*context.currentQueryIndex;switch(timings.duration<0?\"reverse\":timings.easing){case\"reverse\":delay=maxTime-delay;break;case\"full\":delay=parentContext.currentStaggerTime}const timeline=context.currentTimeline;delay&&timeline.delayNextStep(delay);const startingTime=timeline.currentTime;visitDslNode(this,ast.animation,context),context.previousNode=ast,parentContext.currentStaggerTime=tl.currentTime-startingTime+(tl.startTime-parentContext.currentTimeline.startTime)}}const DEFAULT_NOOP_PREVIOUS_NODE={};class AnimationTimelineContext{constructor(_driver,element,subInstructions,_enterClassName,_leaveClassName,errors,timelines,initialTimeline){this._driver=_driver,this.element=element,this.subInstructions=subInstructions,this._enterClassName=_enterClassName,this._leaveClassName=_leaveClassName,this.errors=errors,this.timelines=timelines,this.parentContext=null,this.currentAnimateTimings=null,this.previousNode=DEFAULT_NOOP_PREVIOUS_NODE,this.subContextCount=0,this.options={},this.currentQueryIndex=0,this.currentQueryTotal=0,this.currentStaggerTime=0,this.currentTimeline=initialTimeline||new browser_TimelineBuilder(this._driver,element,0),timelines.push(this.currentTimeline)}get params(){return this.options.params}updateOptions(options,skipIfExists){if(!options)return;const newOptions=options;let optionsToUpdate=this.options;null!=newOptions.duration&&(optionsToUpdate.duration=resolveTimingValue(newOptions.duration)),null!=newOptions.delay&&(optionsToUpdate.delay=resolveTimingValue(newOptions.delay));const newParams=newOptions.params;if(newParams){let paramsToUpdate=optionsToUpdate.params;paramsToUpdate||(paramsToUpdate=this.options.params={}),Object.keys(newParams).forEach(name=>{skipIfExists&&paramsToUpdate.hasOwnProperty(name)||(paramsToUpdate[name]=interpolateParams(newParams[name],paramsToUpdate,this.errors))})}}_copyOptions(){const options={};if(this.options){const oldParams=this.options.params;if(oldParams){const params=options.params={};Object.keys(oldParams).forEach(name=>{params[name]=oldParams[name]})}}return options}createSubContext(options=null,element,newTime){const target=element||this.element,context=new AnimationTimelineContext(this._driver,target,this.subInstructions,this._enterClassName,this._leaveClassName,this.errors,this.timelines,this.currentTimeline.fork(target,newTime||0));return context.previousNode=this.previousNode,context.currentAnimateTimings=this.currentAnimateTimings,context.options=this._copyOptions(),context.updateOptions(options),context.currentQueryIndex=this.currentQueryIndex,context.currentQueryTotal=this.currentQueryTotal,context.parentContext=this,this.subContextCount++,context}transformIntoNewTimeline(newTime){return this.previousNode=DEFAULT_NOOP_PREVIOUS_NODE,this.currentTimeline=this.currentTimeline.fork(this.element,newTime),this.timelines.push(this.currentTimeline),this.currentTimeline}appendInstructionToTimeline(instruction,duration,delay){const updatedTimings={duration:null!=duration?duration:instruction.duration,delay:this.currentTimeline.currentTime+(null!=delay?delay:0)+instruction.delay,easing:\"\"},builder=new SubTimelineBuilder(this._driver,instruction.element,instruction.keyframes,instruction.preStyleProps,instruction.postStyleProps,updatedTimings,instruction.stretchStartingKeyframe);return this.timelines.push(builder),updatedTimings}incrementTime(time){this.currentTimeline.forwardTime(this.currentTimeline.duration+time)}delayNextStep(delay){delay>0&&this.currentTimeline.delayNextStep(delay)}invokeQuery(selector,originalSelector,limit,includeSelf,optional,errors){let results=[];if(includeSelf&&results.push(this.element),selector.length>0){selector=(selector=selector.replace(ENTER_TOKEN_REGEX,\".\"+this._enterClassName)).replace(LEAVE_TOKEN_REGEX,\".\"+this._leaveClassName);let elements=this._driver.query(this.element,selector,1!=limit);0!==limit&&(elements=limit<0?elements.slice(elements.length+limit,elements.length):elements.slice(0,limit)),results.push(...elements)}return optional||0!=results.length||errors.push(`\\`query(\"${originalSelector}\")\\` returned zero elements. (Use \\`query(\"${originalSelector}\", { optional: true })\\` if you wish to allow this.)`),results}}class browser_TimelineBuilder{constructor(_driver,element,startTime,_elementTimelineStylesLookup){this._driver=_driver,this.element=element,this.startTime=startTime,this._elementTimelineStylesLookup=_elementTimelineStylesLookup,this.duration=0,this._previousKeyframe={},this._currentKeyframe={},this._keyframes=new Map,this._styleSummary={},this._pendingStyles={},this._backFill={},this._currentEmptyStepKeyframe=null,this._elementTimelineStylesLookup||(this._elementTimelineStylesLookup=new Map),this._localTimelineStyles=Object.create(this._backFill,{}),this._globalTimelineStyles=this._elementTimelineStylesLookup.get(element),this._globalTimelineStyles||(this._globalTimelineStyles=this._localTimelineStyles,this._elementTimelineStylesLookup.set(element,this._localTimelineStyles)),this._loadKeyframe()}containsAnimation(){switch(this._keyframes.size){case 0:return!1;case 1:return this.getCurrentStyleProperties().length>0;default:return!0}}getCurrentStyleProperties(){return Object.keys(this._currentKeyframe)}get currentTime(){return this.startTime+this.duration}delayNextStep(delay){const hasPreStyleStep=1==this._keyframes.size&&Object.keys(this._pendingStyles).length;this.duration||hasPreStyleStep?(this.forwardTime(this.currentTime+delay),hasPreStyleStep&&this.snapshotCurrentStyles()):this.startTime+=delay}fork(element,currentTime){return this.applyStylesToKeyframe(),new browser_TimelineBuilder(this._driver,element,currentTime||this.currentTime,this._elementTimelineStylesLookup)}_loadKeyframe(){this._currentKeyframe&&(this._previousKeyframe=this._currentKeyframe),this._currentKeyframe=this._keyframes.get(this.duration),this._currentKeyframe||(this._currentKeyframe=Object.create(this._backFill,{}),this._keyframes.set(this.duration,this._currentKeyframe))}forwardFrame(){this.duration+=1,this._loadKeyframe()}forwardTime(time){this.applyStylesToKeyframe(),this.duration=time,this._loadKeyframe()}_updateStyle(prop,value){this._localTimelineStyles[prop]=value,this._globalTimelineStyles[prop]=value,this._styleSummary[prop]={time:this.currentTime,value:value}}allowOnlyTimelineStyles(){return this._currentEmptyStepKeyframe!==this._currentKeyframe}applyEmptyStep(easing){easing&&(this._previousKeyframe.easing=easing),Object.keys(this._globalTimelineStyles).forEach(prop=>{this._backFill[prop]=this._globalTimelineStyles[prop]||\"*\",this._currentKeyframe[prop]=\"*\"}),this._currentEmptyStepKeyframe=this._currentKeyframe}setStyles(input,easing,errors,options){easing&&(this._previousKeyframe.easing=easing);const params=options&&options.params||{},styles=function(input,allStyles){const styles={};let allProperties;return input.forEach(token=>{\"*\"===token?(allProperties=allProperties||Object.keys(allStyles),allProperties.forEach(prop=>{styles[prop]=\"*\"})):copyStyles(token,!1,styles)}),styles}(input,this._globalTimelineStyles);Object.keys(styles).forEach(prop=>{const val=interpolateParams(styles[prop],params,errors);this._pendingStyles[prop]=val,this._localTimelineStyles.hasOwnProperty(prop)||(this._backFill[prop]=this._globalTimelineStyles.hasOwnProperty(prop)?this._globalTimelineStyles[prop]:\"*\"),this._updateStyle(prop,val)})}applyStylesToKeyframe(){const styles=this._pendingStyles,props=Object.keys(styles);0!=props.length&&(this._pendingStyles={},props.forEach(prop=>{this._currentKeyframe[prop]=styles[prop]}),Object.keys(this._localTimelineStyles).forEach(prop=>{this._currentKeyframe.hasOwnProperty(prop)||(this._currentKeyframe[prop]=this._localTimelineStyles[prop])}))}snapshotCurrentStyles(){Object.keys(this._localTimelineStyles).forEach(prop=>{const val=this._localTimelineStyles[prop];this._pendingStyles[prop]=val,this._updateStyle(prop,val)})}getFinalKeyframe(){return this._keyframes.get(this.duration)}get properties(){const properties=[];for(let prop in this._currentKeyframe)properties.push(prop);return properties}mergeTimelineCollectedStyles(timeline){Object.keys(timeline._styleSummary).forEach(prop=>{const details0=this._styleSummary[prop],details1=timeline._styleSummary[prop];(!details0||details1.time>details0.time)&&this._updateStyle(prop,details1.value)})}buildKeyframes(){this.applyStylesToKeyframe();const preStyleProps=new Set,postStyleProps=new Set,isEmpty=1===this._keyframes.size&&0===this.duration;let finalKeyframes=[];this._keyframes.forEach((keyframe,time)=>{const finalKeyframe=copyStyles(keyframe,!0);Object.keys(finalKeyframe).forEach(prop=>{const value=finalKeyframe[prop];\"!\"==value?preStyleProps.add(prop):\"*\"==value&&postStyleProps.add(prop)}),isEmpty||(finalKeyframe.offset=time/this.duration),finalKeyframes.push(finalKeyframe)});const preProps=preStyleProps.size?iteratorToArray(preStyleProps.values()):[],postProps=postStyleProps.size?iteratorToArray(postStyleProps.values()):[];if(isEmpty){const kf0=finalKeyframes[0],kf1=copyObj(kf0);kf0.offset=0,kf1.offset=1,finalKeyframes=[kf0,kf1]}return createTimelineInstruction(this.element,finalKeyframes,preProps,postProps,this.duration,this.startTime,this.easing,!1)}}class SubTimelineBuilder extends browser_TimelineBuilder{constructor(driver,element,keyframes,preStyleProps,postStyleProps,timings,_stretchStartingKeyframe=!1){super(driver,element,timings.delay),this.element=element,this.keyframes=keyframes,this.preStyleProps=preStyleProps,this.postStyleProps=postStyleProps,this._stretchStartingKeyframe=_stretchStartingKeyframe,this.timings={duration:timings.duration,delay:timings.delay,easing:timings.easing}}containsAnimation(){return this.keyframes.length>1}buildKeyframes(){let keyframes=this.keyframes,{delay:delay,duration:duration,easing:easing}=this.timings;if(this._stretchStartingKeyframe&&delay){const newKeyframes=[],totalTime=duration+delay,startingGap=delay/totalTime,newFirstKeyframe=copyStyles(keyframes[0],!1);newFirstKeyframe.offset=0,newKeyframes.push(newFirstKeyframe);const oldFirstKeyframe=copyStyles(keyframes[0],!1);oldFirstKeyframe.offset=roundOffset(startingGap),newKeyframes.push(oldFirstKeyframe);const limit=keyframes.length-1;for(let i=1;i<=limit;i++){let kf=copyStyles(keyframes[i],!1);kf.offset=roundOffset((delay+kf.offset*duration)/totalTime),newKeyframes.push(kf)}duration=totalTime,delay=0,easing=\"\",keyframes=newKeyframes}return createTimelineInstruction(this.element,keyframes,this.preStyleProps,this.postStyleProps,duration,delay,easing,!0)}}function roundOffset(offset,decimalPoints=3){const mult=Math.pow(10,decimalPoints-1);return Math.round(offset*mult)/mult}class AnimationStyleNormalizer{}class WebAnimationsStyleNormalizer extends AnimationStyleNormalizer{normalizePropertyName(propertyName,errors){return browser_dashCaseToCamelCase(propertyName)}normalizeStyleValue(userProvidedProperty,normalizedProperty,value,errors){let unit=\"\";const strVal=value.toString().trim();if(DIMENSIONAL_PROP_MAP[normalizedProperty]&&0!==value&&\"0\"!==value)if(\"number\"==typeof value)unit=\"px\";else{const valAndSuffixMatch=value.match(/^[+-]?[\\d\\.]+([a-z]*)$/);valAndSuffixMatch&&0==valAndSuffixMatch[1].length&&errors.push(`Please provide a CSS unit value for ${userProvidedProperty}:${value}`)}return strVal+unit}}const DIMENSIONAL_PROP_MAP=(()=>function(keys){const map={};return keys.forEach(key=>map[key]=!0),map}(\"width,height,minWidth,minHeight,maxWidth,maxHeight,left,top,bottom,right,fontSize,outlineWidth,outlineOffset,paddingTop,paddingLeft,paddingBottom,paddingRight,marginTop,marginLeft,marginBottom,marginRight,borderRadius,borderWidth,borderTopWidth,borderLeftWidth,borderRightWidth,borderBottomWidth,textIndent,perspective\".split(\",\")))();function createTransitionInstruction(element,triggerName,fromState,toState,isRemovalTransition,fromStyles,toStyles,timelines,queriedElements,preStyleProps,postStyleProps,totalTime,errors){return{type:0,element:element,triggerName:triggerName,isRemovalTransition:isRemovalTransition,fromState:fromState,fromStyles:fromStyles,toState:toState,toStyles:toStyles,timelines:timelines,queriedElements:queriedElements,preStyleProps:preStyleProps,postStyleProps:postStyleProps,totalTime:totalTime,errors:errors}}const EMPTY_OBJECT={};class AnimationTransitionFactory{constructor(_triggerName,ast,_stateStyles){this._triggerName=_triggerName,this.ast=ast,this._stateStyles=_stateStyles}match(currentState,nextState,element,params){return function(matchFns,currentState,nextState,element,params){return matchFns.some(fn=>fn(currentState,nextState,element,params))}(this.ast.matchers,currentState,nextState,element,params)}buildStyles(stateName,params,errors){const backupStateStyler=this._stateStyles[\"*\"],stateStyler=this._stateStyles[stateName],backupStyles=backupStateStyler?backupStateStyler.buildStyles(params,errors):{};return stateStyler?stateStyler.buildStyles(params,errors):backupStyles}build(driver,element,currentState,nextState,enterClassName,leaveClassName,currentOptions,nextOptions,subInstructions,skipAstBuild){const errors=[],transitionAnimationParams=this.ast.options&&this.ast.options.params||EMPTY_OBJECT,currentStateStyles=this.buildStyles(currentState,currentOptions&&currentOptions.params||EMPTY_OBJECT,errors),nextAnimationParams=nextOptions&&nextOptions.params||EMPTY_OBJECT,nextStateStyles=this.buildStyles(nextState,nextAnimationParams,errors),queriedElements=new Set,preStyleMap=new Map,postStyleMap=new Map,isRemoval=\"void\"===nextState,animationOptions={params:Object.assign(Object.assign({},transitionAnimationParams),nextAnimationParams)},timelines=skipAstBuild?[]:buildAnimationTimelines(driver,element,this.ast.animation,enterClassName,leaveClassName,currentStateStyles,nextStateStyles,animationOptions,subInstructions,errors);let totalTime=0;if(timelines.forEach(tl=>{totalTime=Math.max(tl.duration+tl.delay,totalTime)}),errors.length)return createTransitionInstruction(element,this._triggerName,currentState,nextState,isRemoval,currentStateStyles,nextStateStyles,[],[],preStyleMap,postStyleMap,totalTime,errors);timelines.forEach(tl=>{const elm=tl.element,preProps=getOrSetAsInMap(preStyleMap,elm,{});tl.preStyleProps.forEach(prop=>preProps[prop]=!0);const postProps=getOrSetAsInMap(postStyleMap,elm,{});tl.postStyleProps.forEach(prop=>postProps[prop]=!0),elm!==element&&queriedElements.add(elm)});const queriedElementsList=iteratorToArray(queriedElements.values());return createTransitionInstruction(element,this._triggerName,currentState,nextState,isRemoval,currentStateStyles,nextStateStyles,timelines,queriedElementsList,preStyleMap,postStyleMap,totalTime)}}class AnimationStateStyles{constructor(styles,defaultParams){this.styles=styles,this.defaultParams=defaultParams}buildStyles(params,errors){const finalStyles={},combinedParams=copyObj(this.defaultParams);return Object.keys(params).forEach(key=>{const value=params[key];null!=value&&(combinedParams[key]=value)}),this.styles.styles.forEach(value=>{if(\"string\"!=typeof value){const styleObj=value;Object.keys(styleObj).forEach(prop=>{let val=styleObj[prop];val.length>1&&(val=interpolateParams(val,combinedParams,errors)),finalStyles[prop]=val})}}),finalStyles}}class AnimationTrigger{constructor(name,ast){this.name=name,this.ast=ast,this.transitionFactories=[],this.states={},ast.states.forEach(ast=>{this.states[ast.name]=new AnimationStateStyles(ast.style,ast.options&&ast.options.params||{})}),balanceProperties(this.states,\"true\",\"1\"),balanceProperties(this.states,\"false\",\"0\"),ast.transitions.forEach(ast=>{this.transitionFactories.push(new AnimationTransitionFactory(name,ast,this.states))}),this.fallbackTransition=new AnimationTransitionFactory(name,{type:1,animation:{type:2,steps:[],options:null},matchers:[(fromState,toState)=>!0],options:null,queryCount:0,depCount:0},this.states)}get containsQueries(){return this.ast.queryCount>0}matchTransition(currentState,nextState,element,params){return this.transitionFactories.find(f=>f.match(currentState,nextState,element,params))||null}matchStyles(currentState,params,errors){return this.fallbackTransition.buildStyles(currentState,params,errors)}}function balanceProperties(obj,key1,key2){obj.hasOwnProperty(key1)?obj.hasOwnProperty(key2)||(obj[key2]=obj[key1]):obj.hasOwnProperty(key2)&&(obj[key1]=obj[key2])}const EMPTY_INSTRUCTION_MAP=new ElementInstructionMap;class browser_TimelineAnimationEngine{constructor(bodyNode,_driver,_normalizer){this.bodyNode=bodyNode,this._driver=_driver,this._normalizer=_normalizer,this._animations={},this._playersById={},this.players=[]}register(id,metadata){const errors=[],ast=buildAnimationAst(this._driver,metadata,errors);if(errors.length)throw new Error(\"Unable to build the animation due to the following errors: \"+errors.join(\"\\n\"));this._animations[id]=ast}_buildPlayer(i,preStyles,postStyles){const element=i.element,keyframes=normalizeKeyframes(0,this._normalizer,0,i.keyframes,preStyles,postStyles);return this._driver.animate(element,keyframes,i.duration,i.delay,i.easing,[],!0)}create(id,element,options={}){const errors=[],ast=this._animations[id];let instructions;const autoStylesMap=new Map;if(ast?(instructions=buildAnimationTimelines(this._driver,element,ast,\"ng-enter\",\"ng-leave\",{},{},options,EMPTY_INSTRUCTION_MAP,errors),instructions.forEach(inst=>{const styles=getOrSetAsInMap(autoStylesMap,inst.element,{});inst.postStyleProps.forEach(prop=>styles[prop]=null)})):(errors.push(\"The requested animation doesn't exist or has already been destroyed\"),instructions=[]),errors.length)throw new Error(\"Unable to create the animation due to the following errors: \"+errors.join(\"\\n\"));autoStylesMap.forEach((styles,element)=>{Object.keys(styles).forEach(prop=>{styles[prop]=this._driver.computeStyle(element,prop,\"*\")})});const player=optimizeGroupPlayer(instructions.map(i=>{const styles=autoStylesMap.get(i.element);return this._buildPlayer(i,{},styles)}));return this._playersById[id]=player,player.onDestroy(()=>this.destroy(id)),this.players.push(player),player}destroy(id){const player=this._getPlayer(id);player.destroy(),delete this._playersById[id];const index=this.players.indexOf(player);index>=0&&this.players.splice(index,1)}_getPlayer(id){const player=this._playersById[id];if(!player)throw new Error(\"Unable to find the timeline player referenced by \"+id);return player}listen(id,element,eventName,callback){const baseEvent=makeAnimationEvent(element,\"\",\"\",\"\");return listenOnPlayer(this._getPlayer(id),eventName,baseEvent,callback),()=>{}}command(id,element,command,args){if(\"register\"==command)return void this.register(id,args[0]);if(\"create\"==command)return void this.create(id,element,args[0]||{});const player=this._getPlayer(id);switch(command){case\"play\":player.play();break;case\"pause\":player.pause();break;case\"reset\":player.reset();break;case\"restart\":player.restart();break;case\"finish\":player.finish();break;case\"init\":player.init();break;case\"setPosition\":player.setPosition(parseFloat(args[0]));break;case\"destroy\":this.destroy(id)}}}const EMPTY_PLAYER_ARRAY=[],NULL_REMOVAL_STATE={namespaceId:\"\",setForRemoval:!1,setForMove:!1,hasAnimation:!1,removedBeforeQueried:!1},NULL_REMOVED_QUERIED_STATE={namespaceId:\"\",setForMove:!1,setForRemoval:!1,hasAnimation:!1,removedBeforeQueried:!0};class StateValue{constructor(input,namespaceId=\"\"){this.namespaceId=namespaceId;const isObj=input&&input.hasOwnProperty(\"value\");if(this.value=null!=(value=isObj?input.value:input)?value:null,isObj){const options=copyObj(input);delete options.value,this.options=options}else this.options={};var value;this.options.params||(this.options.params={})}get params(){return this.options.params}absorbOptions(options){const newParams=options.params;if(newParams){const oldParams=this.options.params;Object.keys(newParams).forEach(prop=>{null==oldParams[prop]&&(oldParams[prop]=newParams[prop])})}}}const DEFAULT_STATE_VALUE=new StateValue(\"void\");class AnimationTransitionNamespace{constructor(id,hostElement,_engine){this.id=id,this.hostElement=hostElement,this._engine=_engine,this.players=[],this._triggers={},this._queue=[],this._elementListeners=new Map,this._hostClassName=\"ng-tns-\"+id,addClass(hostElement,this._hostClassName)}listen(element,name,phase,callback){if(!this._triggers.hasOwnProperty(name))throw new Error(`Unable to listen on the animation trigger event \"${phase}\" because the animation trigger \"${name}\" doesn't exist!`);if(null==phase||0==phase.length)throw new Error(`Unable to listen on the animation trigger \"${name}\" because the provided event is undefined!`);if(\"start\"!=(eventName=phase)&&\"done\"!=eventName)throw new Error(`The provided animation trigger event \"${phase}\" for the animation trigger \"${name}\" is not supported!`);var eventName;const listeners=getOrSetAsInMap(this._elementListeners,element,[]),data={name:name,phase:phase,callback:callback};listeners.push(data);const triggersWithStates=getOrSetAsInMap(this._engine.statesByElement,element,{});return triggersWithStates.hasOwnProperty(name)||(addClass(element,\"ng-trigger\"),addClass(element,\"ng-trigger-\"+name),triggersWithStates[name]=DEFAULT_STATE_VALUE),()=>{this._engine.afterFlush(()=>{const index=listeners.indexOf(data);index>=0&&listeners.splice(index,1),this._triggers[name]||delete triggersWithStates[name]})}}register(name,ast){return!this._triggers[name]&&(this._triggers[name]=ast,!0)}_getTrigger(name){const trigger=this._triggers[name];if(!trigger)throw new Error(`The provided animation trigger \"${name}\" has not been registered!`);return trigger}trigger(element,triggerName,value,defaultToFallback=!0){const trigger=this._getTrigger(triggerName),player=new browser_TransitionAnimationPlayer(this.id,triggerName,element);let triggersWithStates=this._engine.statesByElement.get(element);triggersWithStates||(addClass(element,\"ng-trigger\"),addClass(element,\"ng-trigger-\"+triggerName),this._engine.statesByElement.set(element,triggersWithStates={}));let fromState=triggersWithStates[triggerName];const toState=new StateValue(value,this.id);if(!(value&&value.hasOwnProperty(\"value\"))&&fromState&&toState.absorbOptions(fromState.options),triggersWithStates[triggerName]=toState,fromState||(fromState=DEFAULT_STATE_VALUE),\"void\"!==toState.value&&fromState.value===toState.value){if(!function(a,b){const k1=Object.keys(a),k2=Object.keys(b);if(k1.length!=k2.length)return!1;for(let i=0;i<k1.length;i++){const prop=k1[i];if(!b.hasOwnProperty(prop)||a[prop]!==b[prop])return!1}return!0}(fromState.params,toState.params)){const errors=[],fromStyles=trigger.matchStyles(fromState.value,fromState.params,errors),toStyles=trigger.matchStyles(toState.value,toState.params,errors);errors.length?this._engine.reportError(errors):this._engine.afterFlush(()=>{eraseStyles(element,fromStyles),setStyles(element,toStyles)})}return}const playersOnElement=getOrSetAsInMap(this._engine.playersByElement,element,[]);playersOnElement.forEach(player=>{player.namespaceId==this.id&&player.triggerName==triggerName&&player.queued&&player.destroy()});let transition=trigger.matchTransition(fromState.value,toState.value,element,toState.params),isFallbackTransition=!1;if(!transition){if(!defaultToFallback)return;transition=trigger.fallbackTransition,isFallbackTransition=!0}return this._engine.totalQueuedPlayers++,this._queue.push({element:element,triggerName:triggerName,transition:transition,fromState:fromState,toState:toState,player:player,isFallbackTransition:isFallbackTransition}),isFallbackTransition||(addClass(element,\"ng-animate-queued\"),player.onStart(()=>{removeClass(element,\"ng-animate-queued\")})),player.onDone(()=>{let index=this.players.indexOf(player);index>=0&&this.players.splice(index,1);const players=this._engine.playersByElement.get(element);if(players){let index=players.indexOf(player);index>=0&&players.splice(index,1)}}),this.players.push(player),playersOnElement.push(player),player}deregister(name){delete this._triggers[name],this._engine.statesByElement.forEach((stateMap,element)=>{delete stateMap[name]}),this._elementListeners.forEach((listeners,element)=>{this._elementListeners.set(element,listeners.filter(entry=>entry.name!=name))})}clearElementCache(element){this._engine.statesByElement.delete(element),this._elementListeners.delete(element);const elementPlayers=this._engine.playersByElement.get(element);elementPlayers&&(elementPlayers.forEach(player=>player.destroy()),this._engine.playersByElement.delete(element))}_signalRemovalForInnerTriggers(rootElement,context){const elements=this._engine.driver.query(rootElement,\".ng-trigger\",!0);elements.forEach(elm=>{if(elm.__ng_removed)return;const namespaces=this._engine.fetchNamespacesByElement(elm);namespaces.size?namespaces.forEach(ns=>ns.triggerLeaveAnimation(elm,context,!1,!0)):this.clearElementCache(elm)}),this._engine.afterFlushAnimationsDone(()=>elements.forEach(elm=>this.clearElementCache(elm)))}triggerLeaveAnimation(element,context,destroyAfterComplete,defaultToFallback){const triggerStates=this._engine.statesByElement.get(element);if(triggerStates){const players=[];if(Object.keys(triggerStates).forEach(triggerName=>{if(this._triggers[triggerName]){const player=this.trigger(element,triggerName,\"void\",defaultToFallback);player&&players.push(player)}}),players.length)return this._engine.markElementAsRemoved(this.id,element,!0,context),destroyAfterComplete&&optimizeGroupPlayer(players).onDone(()=>this._engine.processLeaveNode(element)),!0}return!1}prepareLeaveAnimationListeners(element){const listeners=this._elementListeners.get(element);if(listeners){const visitedTriggers=new Set;listeners.forEach(listener=>{const triggerName=listener.name;if(visitedTriggers.has(triggerName))return;visitedTriggers.add(triggerName);const transition=this._triggers[triggerName].fallbackTransition,fromState=this._engine.statesByElement.get(element)[triggerName]||DEFAULT_STATE_VALUE,toState=new StateValue(\"void\"),player=new browser_TransitionAnimationPlayer(this.id,triggerName,element);this._engine.totalQueuedPlayers++,this._queue.push({element:element,triggerName:triggerName,transition:transition,fromState:fromState,toState:toState,player:player,isFallbackTransition:!0})})}}removeNode(element,context){const engine=this._engine;if(element.childElementCount&&this._signalRemovalForInnerTriggers(element,context),this.triggerLeaveAnimation(element,context,!0))return;let containsPotentialParentTransition=!1;if(engine.totalAnimations){const currentPlayers=engine.players.length?engine.playersByQueriedElement.get(element):[];if(currentPlayers&&currentPlayers.length)containsPotentialParentTransition=!0;else{let parent=element;for(;parent=parent.parentNode;)if(engine.statesByElement.get(parent)){containsPotentialParentTransition=!0;break}}}if(this.prepareLeaveAnimationListeners(element),containsPotentialParentTransition)engine.markElementAsRemoved(this.id,element,!1,context);else{const removalFlag=element.__ng_removed;removalFlag&&removalFlag!==NULL_REMOVAL_STATE||(engine.afterFlush(()=>this.clearElementCache(element)),engine.destroyInnerAnimations(element),engine._onRemovalComplete(element,context))}}insertNode(element,parent){addClass(element,this._hostClassName)}drainQueuedTransitions(microtaskId){const instructions=[];return this._queue.forEach(entry=>{const player=entry.player;if(player.destroyed)return;const element=entry.element,listeners=this._elementListeners.get(element);listeners&&listeners.forEach(listener=>{if(listener.name==entry.triggerName){const baseEvent=makeAnimationEvent(element,entry.triggerName,entry.fromState.value,entry.toState.value);baseEvent._data=microtaskId,listenOnPlayer(entry.player,listener.phase,baseEvent,listener.callback)}}),player.markedForDestroy?this._engine.afterFlush(()=>{player.destroy()}):instructions.push(entry)}),this._queue=[],instructions.sort((a,b)=>{const d0=a.transition.ast.depCount,d1=b.transition.ast.depCount;return 0==d0||0==d1?d0-d1:this._engine.driver.containsElement(a.element,b.element)?1:-1})}destroy(context){this.players.forEach(p=>p.destroy()),this._signalRemovalForInnerTriggers(this.hostElement,context)}elementContainsData(element){let containsData=!1;return this._elementListeners.has(element)&&(containsData=!0),containsData=!!this._queue.find(entry=>entry.element===element)||containsData,containsData}}class browser_TransitionAnimationEngine{constructor(bodyNode,driver,_normalizer){this.bodyNode=bodyNode,this.driver=driver,this._normalizer=_normalizer,this.players=[],this.newHostElements=new Map,this.playersByElement=new Map,this.playersByQueriedElement=new Map,this.statesByElement=new Map,this.disabledNodes=new Set,this.totalAnimations=0,this.totalQueuedPlayers=0,this._namespaceLookup={},this._namespaceList=[],this._flushFns=[],this._whenQuietFns=[],this.namespacesByHostElement=new Map,this.collectedEnterElements=[],this.collectedLeaveElements=[],this.onRemovalComplete=(element,context)=>{}}_onRemovalComplete(element,context){this.onRemovalComplete(element,context)}get queuedPlayers(){const players=[];return this._namespaceList.forEach(ns=>{ns.players.forEach(player=>{player.queued&&players.push(player)})}),players}createNamespace(namespaceId,hostElement){const ns=new AnimationTransitionNamespace(namespaceId,hostElement,this);return hostElement.parentNode?this._balanceNamespaceList(ns,hostElement):(this.newHostElements.set(hostElement,ns),this.collectEnterElement(hostElement)),this._namespaceLookup[namespaceId]=ns}_balanceNamespaceList(ns,hostElement){const limit=this._namespaceList.length-1;if(limit>=0){let found=!1;for(let i=limit;i>=0;i--)if(this.driver.containsElement(this._namespaceList[i].hostElement,hostElement)){this._namespaceList.splice(i+1,0,ns),found=!0;break}found||this._namespaceList.splice(0,0,ns)}else this._namespaceList.push(ns);return this.namespacesByHostElement.set(hostElement,ns),ns}register(namespaceId,hostElement){let ns=this._namespaceLookup[namespaceId];return ns||(ns=this.createNamespace(namespaceId,hostElement)),ns}registerTrigger(namespaceId,name,trigger){let ns=this._namespaceLookup[namespaceId];ns&&ns.register(name,trigger)&&this.totalAnimations++}destroy(namespaceId,context){if(!namespaceId)return;const ns=this._fetchNamespace(namespaceId);this.afterFlush(()=>{this.namespacesByHostElement.delete(ns.hostElement),delete this._namespaceLookup[namespaceId];const index=this._namespaceList.indexOf(ns);index>=0&&this._namespaceList.splice(index,1)}),this.afterFlushAnimationsDone(()=>ns.destroy(context))}_fetchNamespace(id){return this._namespaceLookup[id]}fetchNamespacesByElement(element){const namespaces=new Set,elementStates=this.statesByElement.get(element);if(elementStates){const keys=Object.keys(elementStates);for(let i=0;i<keys.length;i++){const nsId=elementStates[keys[i]].namespaceId;if(nsId){const ns=this._fetchNamespace(nsId);ns&&namespaces.add(ns)}}}return namespaces}trigger(namespaceId,element,name,value){if(isElementNode(element)){const ns=this._fetchNamespace(namespaceId);if(ns)return ns.trigger(element,name,value),!0}return!1}insertNode(namespaceId,element,parent,insertBefore){if(!isElementNode(element))return;const details=element.__ng_removed;if(details&&details.setForRemoval){details.setForRemoval=!1,details.setForMove=!0;const index=this.collectedLeaveElements.indexOf(element);index>=0&&this.collectedLeaveElements.splice(index,1)}if(namespaceId){const ns=this._fetchNamespace(namespaceId);ns&&ns.insertNode(element,parent)}insertBefore&&this.collectEnterElement(element)}collectEnterElement(element){this.collectedEnterElements.push(element)}markElementAsDisabled(element,value){value?this.disabledNodes.has(element)||(this.disabledNodes.add(element),addClass(element,\"ng-animate-disabled\")):this.disabledNodes.has(element)&&(this.disabledNodes.delete(element),removeClass(element,\"ng-animate-disabled\"))}removeNode(namespaceId,element,isHostElement,context){if(isElementNode(element)){const ns=namespaceId?this._fetchNamespace(namespaceId):null;if(ns?ns.removeNode(element,context):this.markElementAsRemoved(namespaceId,element,!1,context),isHostElement){const hostNS=this.namespacesByHostElement.get(element);hostNS&&hostNS.id!==namespaceId&&hostNS.removeNode(element,context)}}else this._onRemovalComplete(element,context)}markElementAsRemoved(namespaceId,element,hasAnimation,context){this.collectedLeaveElements.push(element),element.__ng_removed={namespaceId:namespaceId,setForRemoval:context,hasAnimation:hasAnimation,removedBeforeQueried:!1}}listen(namespaceId,element,name,phase,callback){return isElementNode(element)?this._fetchNamespace(namespaceId).listen(element,name,phase,callback):()=>{}}_buildInstruction(entry,subTimelines,enterClassName,leaveClassName,skipBuildAst){return entry.transition.build(this.driver,entry.element,entry.fromState.value,entry.toState.value,enterClassName,leaveClassName,entry.fromState.options,entry.toState.options,subTimelines,skipBuildAst)}destroyInnerAnimations(containerElement){let elements=this.driver.query(containerElement,\".ng-trigger\",!0);elements.forEach(element=>this.destroyActiveAnimationsForElement(element)),0!=this.playersByQueriedElement.size&&(elements=this.driver.query(containerElement,\".ng-animating\",!0),elements.forEach(element=>this.finishActiveQueriedAnimationOnElement(element)))}destroyActiveAnimationsForElement(element){const players=this.playersByElement.get(element);players&&players.forEach(player=>{player.queued?player.markedForDestroy=!0:player.destroy()})}finishActiveQueriedAnimationOnElement(element){const players=this.playersByQueriedElement.get(element);players&&players.forEach(player=>player.finish())}whenRenderingDone(){return new Promise(resolve=>{if(this.players.length)return optimizeGroupPlayer(this.players).onDone(()=>resolve());resolve()})}processLeaveNode(element){const details=element.__ng_removed;if(details&&details.setForRemoval){if(element.__ng_removed=NULL_REMOVAL_STATE,details.namespaceId){this.destroyInnerAnimations(element);const ns=this._fetchNamespace(details.namespaceId);ns&&ns.clearElementCache(element)}this._onRemovalComplete(element,details.setForRemoval)}this.driver.matchesElement(element,\".ng-animate-disabled\")&&this.markElementAsDisabled(element,!1),this.driver.query(element,\".ng-animate-disabled\",!0).forEach(node=>{this.markElementAsDisabled(node,!1)})}flush(microtaskId=-1){let players=[];if(this.newHostElements.size&&(this.newHostElements.forEach((ns,element)=>this._balanceNamespaceList(ns,element)),this.newHostElements.clear()),this.totalAnimations&&this.collectedEnterElements.length)for(let i=0;i<this.collectedEnterElements.length;i++)addClass(this.collectedEnterElements[i],\"ng-star-inserted\");if(this._namespaceList.length&&(this.totalQueuedPlayers||this.collectedLeaveElements.length)){const cleanupFns=[];try{players=this._flushAnimations(cleanupFns,microtaskId)}finally{for(let i=0;i<cleanupFns.length;i++)cleanupFns[i]()}}else for(let i=0;i<this.collectedLeaveElements.length;i++)this.processLeaveNode(this.collectedLeaveElements[i]);if(this.totalQueuedPlayers=0,this.collectedEnterElements.length=0,this.collectedLeaveElements.length=0,this._flushFns.forEach(fn=>fn()),this._flushFns=[],this._whenQuietFns.length){const quietFns=this._whenQuietFns;this._whenQuietFns=[],players.length?optimizeGroupPlayer(players).onDone(()=>{quietFns.forEach(fn=>fn())}):quietFns.forEach(fn=>fn())}}reportError(errors){throw new Error(\"Unable to process animations due to the following failed trigger transitions\\n \"+errors.join(\"\\n\"))}_flushAnimations(cleanupFns,microtaskId){const subTimelines=new ElementInstructionMap,skippedPlayers=[],skippedPlayersMap=new Map,queuedInstructions=[],queriedElements=new Map,allPreStyleElements=new Map,allPostStyleElements=new Map,disabledElementsSet=new Set;this.disabledNodes.forEach(node=>{disabledElementsSet.add(node);const nodesThatAreDisabled=this.driver.query(node,\".ng-animate-queued\",!0);for(let i=0;i<nodesThatAreDisabled.length;i++)disabledElementsSet.add(nodesThatAreDisabled[i])});const bodyNode=this.bodyNode,allTriggerElements=Array.from(this.statesByElement.keys()),enterNodeMap=buildRootMap(allTriggerElements,this.collectedEnterElements),enterNodeMapIds=new Map;let i=0;enterNodeMap.forEach((nodes,root)=>{const className=\"ng-enter\"+i++;enterNodeMapIds.set(root,className),nodes.forEach(node=>addClass(node,className))});const allLeaveNodes=[],mergedLeaveNodes=new Set,leaveNodesWithoutAnimations=new Set;for(let i=0;i<this.collectedLeaveElements.length;i++){const element=this.collectedLeaveElements[i],details=element.__ng_removed;details&&details.setForRemoval&&(allLeaveNodes.push(element),mergedLeaveNodes.add(element),details.hasAnimation?this.driver.query(element,\".ng-star-inserted\",!0).forEach(elm=>mergedLeaveNodes.add(elm)):leaveNodesWithoutAnimations.add(element))}const leaveNodeMapIds=new Map,leaveNodeMap=buildRootMap(allTriggerElements,Array.from(mergedLeaveNodes));leaveNodeMap.forEach((nodes,root)=>{const className=\"ng-leave\"+i++;leaveNodeMapIds.set(root,className),nodes.forEach(node=>addClass(node,className))}),cleanupFns.push(()=>{enterNodeMap.forEach((nodes,root)=>{const className=enterNodeMapIds.get(root);nodes.forEach(node=>removeClass(node,className))}),leaveNodeMap.forEach((nodes,root)=>{const className=leaveNodeMapIds.get(root);nodes.forEach(node=>removeClass(node,className))}),allLeaveNodes.forEach(element=>{this.processLeaveNode(element)})});const allPlayers=[],erroneousTransitions=[];for(let i=this._namespaceList.length-1;i>=0;i--)this._namespaceList[i].drainQueuedTransitions(microtaskId).forEach(entry=>{const player=entry.player,element=entry.element;if(allPlayers.push(player),this.collectedEnterElements.length){const details=element.__ng_removed;if(details&&details.setForMove)return void player.destroy()}const nodeIsOrphaned=!bodyNode||!this.driver.containsElement(bodyNode,element),leaveClassName=leaveNodeMapIds.get(element),enterClassName=enterNodeMapIds.get(element),instruction=this._buildInstruction(entry,subTimelines,enterClassName,leaveClassName,nodeIsOrphaned);if(instruction.errors&&instruction.errors.length)erroneousTransitions.push(instruction);else{if(nodeIsOrphaned)return player.onStart(()=>eraseStyles(element,instruction.fromStyles)),player.onDestroy(()=>setStyles(element,instruction.toStyles)),void skippedPlayers.push(player);if(entry.isFallbackTransition)return player.onStart(()=>eraseStyles(element,instruction.fromStyles)),player.onDestroy(()=>setStyles(element,instruction.toStyles)),void skippedPlayers.push(player);instruction.timelines.forEach(tl=>tl.stretchStartingKeyframe=!0),subTimelines.append(element,instruction.timelines),queuedInstructions.push({instruction:instruction,player:player,element:element}),instruction.queriedElements.forEach(element=>getOrSetAsInMap(queriedElements,element,[]).push(player)),instruction.preStyleProps.forEach((stringMap,element)=>{const props=Object.keys(stringMap);if(props.length){let setVal=allPreStyleElements.get(element);setVal||allPreStyleElements.set(element,setVal=new Set),props.forEach(prop=>setVal.add(prop))}}),instruction.postStyleProps.forEach((stringMap,element)=>{const props=Object.keys(stringMap);let setVal=allPostStyleElements.get(element);setVal||allPostStyleElements.set(element,setVal=new Set),props.forEach(prop=>setVal.add(prop))})}});if(erroneousTransitions.length){const errors=[];erroneousTransitions.forEach(instruction=>{errors.push(`@${instruction.triggerName} has failed due to:\\n`),instruction.errors.forEach(error=>errors.push(`- ${error}\\n`))}),allPlayers.forEach(player=>player.destroy()),this.reportError(errors)}const allPreviousPlayersMap=new Map,animationElementMap=new Map;queuedInstructions.forEach(entry=>{const element=entry.element;subTimelines.has(element)&&(animationElementMap.set(element,element),this._beforeAnimationBuild(entry.player.namespaceId,entry.instruction,allPreviousPlayersMap))}),skippedPlayers.forEach(player=>{const element=player.element;this._getPreviousPlayers(element,!1,player.namespaceId,player.triggerName,null).forEach(prevPlayer=>{getOrSetAsInMap(allPreviousPlayersMap,element,[]).push(prevPlayer),prevPlayer.destroy()})});const replaceNodes=allLeaveNodes.filter(node=>replacePostStylesAsPre(node,allPreStyleElements,allPostStyleElements)),postStylesMap=new Map;cloakAndComputeStyles(postStylesMap,this.driver,leaveNodesWithoutAnimations,allPostStyleElements,\"*\").forEach(node=>{replacePostStylesAsPre(node,allPreStyleElements,allPostStyleElements)&&replaceNodes.push(node)});const preStylesMap=new Map;enterNodeMap.forEach((nodes,root)=>{cloakAndComputeStyles(preStylesMap,this.driver,new Set(nodes),allPreStyleElements,\"!\")}),replaceNodes.forEach(node=>{const post=postStylesMap.get(node),pre=preStylesMap.get(node);postStylesMap.set(node,Object.assign(Object.assign({},post),pre))});const rootPlayers=[],subPlayers=[],NO_PARENT_ANIMATION_ELEMENT_DETECTED={};queuedInstructions.forEach(entry=>{const{element:element,player:player,instruction:instruction}=entry;if(subTimelines.has(element)){if(disabledElementsSet.has(element))return player.onDestroy(()=>setStyles(element,instruction.toStyles)),player.disabled=!0,player.overrideTotalTime(instruction.totalTime),void skippedPlayers.push(player);let parentWithAnimation=NO_PARENT_ANIMATION_ELEMENT_DETECTED;if(animationElementMap.size>1){let elm=element;const parentsToAdd=[];for(;elm=elm.parentNode;){const detectedParent=animationElementMap.get(elm);if(detectedParent){parentWithAnimation=detectedParent;break}parentsToAdd.push(elm)}parentsToAdd.forEach(parent=>animationElementMap.set(parent,parentWithAnimation))}const innerPlayer=this._buildAnimation(player.namespaceId,instruction,allPreviousPlayersMap,skippedPlayersMap,preStylesMap,postStylesMap);if(player.setRealPlayer(innerPlayer),parentWithAnimation===NO_PARENT_ANIMATION_ELEMENT_DETECTED)rootPlayers.push(player);else{const parentPlayers=this.playersByElement.get(parentWithAnimation);parentPlayers&&parentPlayers.length&&(player.parentPlayer=optimizeGroupPlayer(parentPlayers)),skippedPlayers.push(player)}}else eraseStyles(element,instruction.fromStyles),player.onDestroy(()=>setStyles(element,instruction.toStyles)),subPlayers.push(player),disabledElementsSet.has(element)&&skippedPlayers.push(player)}),subPlayers.forEach(player=>{const playersForElement=skippedPlayersMap.get(player.element);if(playersForElement&&playersForElement.length){const innerPlayer=optimizeGroupPlayer(playersForElement);player.setRealPlayer(innerPlayer)}}),skippedPlayers.forEach(player=>{player.parentPlayer?player.syncPlayerEvents(player.parentPlayer):player.destroy()});for(let i=0;i<allLeaveNodes.length;i++){const element=allLeaveNodes[i],details=element.__ng_removed;if(removeClass(element,\"ng-leave\"),details&&details.hasAnimation)continue;let players=[];if(queriedElements.size){let queriedPlayerResults=queriedElements.get(element);queriedPlayerResults&&queriedPlayerResults.length&&players.push(...queriedPlayerResults);let queriedInnerElements=this.driver.query(element,\".ng-animating\",!0);for(let j=0;j<queriedInnerElements.length;j++){let queriedPlayers=queriedElements.get(queriedInnerElements[j]);queriedPlayers&&queriedPlayers.length&&players.push(...queriedPlayers)}}const activePlayers=players.filter(p=>!p.destroyed);activePlayers.length?removeNodesAfterAnimationDone(this,element,activePlayers):this.processLeaveNode(element)}return allLeaveNodes.length=0,rootPlayers.forEach(player=>{this.players.push(player),player.onDone(()=>{player.destroy();const index=this.players.indexOf(player);this.players.splice(index,1)}),player.play()}),rootPlayers}elementContainsData(namespaceId,element){let containsData=!1;const details=element.__ng_removed;return details&&details.setForRemoval&&(containsData=!0),this.playersByElement.has(element)&&(containsData=!0),this.playersByQueriedElement.has(element)&&(containsData=!0),this.statesByElement.has(element)&&(containsData=!0),this._fetchNamespace(namespaceId).elementContainsData(element)||containsData}afterFlush(callback){this._flushFns.push(callback)}afterFlushAnimationsDone(callback){this._whenQuietFns.push(callback)}_getPreviousPlayers(element,isQueriedElement,namespaceId,triggerName,toStateValue){let players=[];if(isQueriedElement){const queriedElementPlayers=this.playersByQueriedElement.get(element);queriedElementPlayers&&(players=queriedElementPlayers)}else{const elementPlayers=this.playersByElement.get(element);if(elementPlayers){const isRemovalAnimation=!toStateValue||\"void\"==toStateValue;elementPlayers.forEach(player=>{player.queued||(isRemovalAnimation||player.triggerName==triggerName)&&players.push(player)})}}return(namespaceId||triggerName)&&(players=players.filter(player=>!(namespaceId&&namespaceId!=player.namespaceId||triggerName&&triggerName!=player.triggerName))),players}_beforeAnimationBuild(namespaceId,instruction,allPreviousPlayersMap){const rootElement=instruction.element,targetNameSpaceId=instruction.isRemovalTransition?void 0:namespaceId,targetTriggerName=instruction.isRemovalTransition?void 0:instruction.triggerName;for(const timelineInstruction of instruction.timelines){const element=timelineInstruction.element,isQueriedElement=element!==rootElement,players=getOrSetAsInMap(allPreviousPlayersMap,element,[]);this._getPreviousPlayers(element,isQueriedElement,targetNameSpaceId,targetTriggerName,instruction.toState).forEach(player=>{const realPlayer=player.getRealPlayer();realPlayer.beforeDestroy&&realPlayer.beforeDestroy(),player.destroy(),players.push(player)})}eraseStyles(rootElement,instruction.fromStyles)}_buildAnimation(namespaceId,instruction,allPreviousPlayersMap,skippedPlayersMap,preStylesMap,postStylesMap){const triggerName=instruction.triggerName,rootElement=instruction.element,allQueriedPlayers=[],allConsumedElements=new Set,allSubElements=new Set,allNewPlayers=instruction.timelines.map(timelineInstruction=>{const element=timelineInstruction.element;allConsumedElements.add(element);const details=element.__ng_removed;if(details&&details.removedBeforeQueried)return new NoopAnimationPlayer(timelineInstruction.duration,timelineInstruction.delay);const isQueriedElement=element!==rootElement,previousPlayers=function(players){const finalPlayers=[];return function _flattenGroupPlayersRecur(players,finalPlayers){for(let i=0;i<players.length;i++){const player=players[i];player instanceof AnimationGroupPlayer?_flattenGroupPlayersRecur(player.players,finalPlayers):finalPlayers.push(player)}}(players,finalPlayers),finalPlayers}((allPreviousPlayersMap.get(element)||EMPTY_PLAYER_ARRAY).map(p=>p.getRealPlayer())).filter(p=>!!p.element&&p.element===element),preStyles=preStylesMap.get(element),postStyles=postStylesMap.get(element),keyframes=normalizeKeyframes(0,this._normalizer,0,timelineInstruction.keyframes,preStyles,postStyles),player=this._buildPlayer(timelineInstruction,keyframes,previousPlayers);if(timelineInstruction.subTimeline&&skippedPlayersMap&&allSubElements.add(element),isQueriedElement){const wrappedPlayer=new browser_TransitionAnimationPlayer(namespaceId,triggerName,element);wrappedPlayer.setRealPlayer(player),allQueriedPlayers.push(wrappedPlayer)}return player});allQueriedPlayers.forEach(player=>{getOrSetAsInMap(this.playersByQueriedElement,player.element,[]).push(player),player.onDone(()=>function(map,key,value){let currentValues;if(map instanceof Map){if(currentValues=map.get(key),currentValues){if(currentValues.length){const index=currentValues.indexOf(value);currentValues.splice(index,1)}0==currentValues.length&&map.delete(key)}}else if(currentValues=map[key],currentValues){if(currentValues.length){const index=currentValues.indexOf(value);currentValues.splice(index,1)}0==currentValues.length&&delete map[key]}return currentValues}(this.playersByQueriedElement,player.element,player))}),allConsumedElements.forEach(element=>addClass(element,\"ng-animating\"));const player=optimizeGroupPlayer(allNewPlayers);return player.onDestroy(()=>{allConsumedElements.forEach(element=>removeClass(element,\"ng-animating\")),setStyles(rootElement,instruction.toStyles)}),allSubElements.forEach(element=>{getOrSetAsInMap(skippedPlayersMap,element,[]).push(player)}),player}_buildPlayer(instruction,keyframes,previousPlayers){return keyframes.length>0?this.driver.animate(instruction.element,keyframes,instruction.duration,instruction.delay,instruction.easing,previousPlayers):new NoopAnimationPlayer(instruction.duration,instruction.delay)}}class browser_TransitionAnimationPlayer{constructor(namespaceId,triggerName,element){this.namespaceId=namespaceId,this.triggerName=triggerName,this.element=element,this._player=new NoopAnimationPlayer,this._containsRealPlayer=!1,this._queuedCallbacks={},this.destroyed=!1,this.markedForDestroy=!1,this.disabled=!1,this.queued=!0,this.totalTime=0}setRealPlayer(player){this._containsRealPlayer||(this._player=player,Object.keys(this._queuedCallbacks).forEach(phase=>{this._queuedCallbacks[phase].forEach(callback=>listenOnPlayer(player,phase,void 0,callback))}),this._queuedCallbacks={},this._containsRealPlayer=!0,this.overrideTotalTime(player.totalTime),this.queued=!1)}getRealPlayer(){return this._player}overrideTotalTime(totalTime){this.totalTime=totalTime}syncPlayerEvents(player){const p=this._player;p.triggerCallback&&player.onStart(()=>p.triggerCallback(\"start\")),player.onDone(()=>this.finish()),player.onDestroy(()=>this.destroy())}_queueEvent(name,callback){getOrSetAsInMap(this._queuedCallbacks,name,[]).push(callback)}onDone(fn){this.queued&&this._queueEvent(\"done\",fn),this._player.onDone(fn)}onStart(fn){this.queued&&this._queueEvent(\"start\",fn),this._player.onStart(fn)}onDestroy(fn){this.queued&&this._queueEvent(\"destroy\",fn),this._player.onDestroy(fn)}init(){this._player.init()}hasStarted(){return!this.queued&&this._player.hasStarted()}play(){!this.queued&&this._player.play()}pause(){!this.queued&&this._player.pause()}restart(){!this.queued&&this._player.restart()}finish(){this._player.finish()}destroy(){this.destroyed=!0,this._player.destroy()}reset(){!this.queued&&this._player.reset()}setPosition(p){this.queued||this._player.setPosition(p)}getPosition(){return this.queued?0:this._player.getPosition()}triggerCallback(phaseName){const p=this._player;p.triggerCallback&&p.triggerCallback(phaseName)}}function isElementNode(node){return node&&1===node.nodeType}function cloakElement(element,value){const oldValue=element.style.display;return element.style.display=null!=value?value:\"none\",oldValue}function cloakAndComputeStyles(valuesMap,driver,elements,elementPropsMap,defaultStyle){const cloakVals=[];elements.forEach(element=>cloakVals.push(cloakElement(element)));const failedElements=[];elementPropsMap.forEach((props,element)=>{const styles={};props.forEach(prop=>{const value=styles[prop]=driver.computeStyle(element,prop,defaultStyle);value&&0!=value.length||(element.__ng_removed=NULL_REMOVED_QUERIED_STATE,failedElements.push(element))}),valuesMap.set(element,styles)});let i=0;return elements.forEach(element=>cloakElement(element,cloakVals[i++])),failedElements}function buildRootMap(roots,nodes){const rootMap=new Map;if(roots.forEach(root=>rootMap.set(root,[])),0==nodes.length)return rootMap;const nodeSet=new Set(nodes),localRootMap=new Map;return nodes.forEach(node=>{const root=function getRoot(node){if(!node)return 1;let root=localRootMap.get(node);if(root)return root;const parent=node.parentNode;return root=rootMap.has(parent)?parent:nodeSet.has(parent)?1:getRoot(parent),localRootMap.set(node,root),root}(node);1!==root&&rootMap.get(root).push(node)}),rootMap}function addClass(element,className){if(element.classList)element.classList.add(className);else{let classes=element.$$classes;classes||(classes=element.$$classes={}),classes[className]=!0}}function removeClass(element,className){if(element.classList)element.classList.remove(className);else{let classes=element.$$classes;classes&&delete classes[className]}}function removeNodesAfterAnimationDone(engine,element,players){optimizeGroupPlayer(players).onDone(()=>engine.processLeaveNode(element))}function replacePostStylesAsPre(element,allPreStyleElements,allPostStyleElements){const postEntry=allPostStyleElements.get(element);if(!postEntry)return!1;let preEntry=allPreStyleElements.get(element);return preEntry?postEntry.forEach(data=>preEntry.add(data)):allPreStyleElements.set(element,postEntry),allPostStyleElements.delete(element),!0}class AnimationEngine{constructor(bodyNode,_driver,normalizer){this.bodyNode=bodyNode,this._driver=_driver,this._triggerCache={},this.onRemovalComplete=(element,context)=>{},this._transitionEngine=new browser_TransitionAnimationEngine(bodyNode,_driver,normalizer),this._timelineEngine=new browser_TimelineAnimationEngine(bodyNode,_driver,normalizer),this._transitionEngine.onRemovalComplete=(element,context)=>this.onRemovalComplete(element,context)}registerTrigger(componentId,namespaceId,hostElement,name,metadata){const cacheKey=componentId+\"-\"+name;let trigger=this._triggerCache[cacheKey];if(!trigger){const errors=[],ast=buildAnimationAst(this._driver,metadata,errors);if(errors.length)throw new Error(`The animation trigger \"${name}\" has failed to build due to the following errors:\\n - ${errors.join(\"\\n - \")}`);trigger=function(name,ast){return new AnimationTrigger(name,ast)}(name,ast),this._triggerCache[cacheKey]=trigger}this._transitionEngine.registerTrigger(namespaceId,name,trigger)}register(namespaceId,hostElement){this._transitionEngine.register(namespaceId,hostElement)}destroy(namespaceId,context){this._transitionEngine.destroy(namespaceId,context)}onInsert(namespaceId,element,parent,insertBefore){this._transitionEngine.insertNode(namespaceId,element,parent,insertBefore)}onRemove(namespaceId,element,context,isHostElement){this._transitionEngine.removeNode(namespaceId,element,isHostElement||!1,context)}disableAnimations(element,disable){this._transitionEngine.markElementAsDisabled(element,disable)}process(namespaceId,element,property,value){if(\"@\"==property.charAt(0)){const[id,action]=parseTimelineCommand(property);this._timelineEngine.command(id,element,action,value)}else this._transitionEngine.trigger(namespaceId,element,property,value)}listen(namespaceId,element,eventName,eventPhase,callback){if(\"@\"==eventName.charAt(0)){const[id,action]=parseTimelineCommand(eventName);return this._timelineEngine.listen(id,element,action,callback)}return this._transitionEngine.listen(namespaceId,element,eventName,eventPhase,callback)}flush(microtaskId=-1){this._transitionEngine.flush(microtaskId)}get players(){return this._transitionEngine.players.concat(this._timelineEngine.players)}whenRenderingDone(){return this._transitionEngine.whenRenderingDone()}}function packageNonAnimatableStyles(element,styles){let startStyles=null,endStyles=null;return Array.isArray(styles)&&styles.length?(startStyles=filterNonAnimatableStyles(styles[0]),styles.length>1&&(endStyles=filterNonAnimatableStyles(styles[styles.length-1]))):styles&&(startStyles=filterNonAnimatableStyles(styles)),startStyles||endStyles?new SpecialCasedStyles(element,startStyles,endStyles):null}let SpecialCasedStyles=(()=>{class SpecialCasedStyles{constructor(_element,_startStyles,_endStyles){this._element=_element,this._startStyles=_startStyles,this._endStyles=_endStyles,this._state=0;let initialStyles=SpecialCasedStyles.initialStylesByElement.get(_element);initialStyles||SpecialCasedStyles.initialStylesByElement.set(_element,initialStyles={}),this._initialStyles=initialStyles}start(){this._state<1&&(this._startStyles&&setStyles(this._element,this._startStyles,this._initialStyles),this._state=1)}finish(){this.start(),this._state<2&&(setStyles(this._element,this._initialStyles),this._endStyles&&(setStyles(this._element,this._endStyles),this._endStyles=null),this._state=1)}destroy(){this.finish(),this._state<3&&(SpecialCasedStyles.initialStylesByElement.delete(this._element),this._startStyles&&(eraseStyles(this._element,this._startStyles),this._endStyles=null),this._endStyles&&(eraseStyles(this._element,this._endStyles),this._endStyles=null),setStyles(this._element,this._initialStyles),this._state=3)}}return SpecialCasedStyles.initialStylesByElement=new WeakMap,SpecialCasedStyles})();function filterNonAnimatableStyles(styles){let result=null;const props=Object.keys(styles);for(let i=0;i<props.length;i++){const prop=props[i];isNonAnimatableStyle(prop)&&(result=result||{},result[prop]=styles[prop])}return result}function isNonAnimatableStyle(prop){return\"display\"===prop||\"position\"===prop}class ElementAnimationStyleHandler{constructor(_element,_name,_duration,_delay,_easing,_fillMode,_onDoneFn){this._element=_element,this._name=_name,this._duration=_duration,this._delay=_delay,this._easing=_easing,this._fillMode=_fillMode,this._onDoneFn=_onDoneFn,this._finished=!1,this._destroyed=!1,this._startTime=0,this._position=0,this._eventFn=e=>this._handleCallback(e)}apply(){!function(element,value){const anim=getAnimationStyle(element,\"\").trim();anim.length&&(function(value,char){let count=0;for(let i=0;i<value.length;i++)\",\"===value.charAt(i)&&count++}(anim),value=`${anim}, ${value}`),setAnimationStyle(element,\"\",value)}(this._element,`${this._duration}ms ${this._easing} ${this._delay}ms 1 normal ${this._fillMode} ${this._name}`),addRemoveAnimationEvent(this._element,this._eventFn,!1),this._startTime=Date.now()}pause(){playPauseAnimation(this._element,this._name,\"paused\")}resume(){playPauseAnimation(this._element,this._name,\"running\")}setPosition(position){const index=findIndexForAnimation(this._element,this._name);this._position=position*this._duration,setAnimationStyle(this._element,\"Delay\",`-${this._position}ms`,index)}getPosition(){return this._position}_handleCallback(event){const timestamp=event._ngTestManualTimestamp||Date.now(),elapsedTime=1e3*parseFloat(event.elapsedTime.toFixed(3));event.animationName==this._name&&Math.max(timestamp-this._startTime,0)>=this._delay&&elapsedTime>=this._duration&&this.finish()}finish(){this._finished||(this._finished=!0,this._onDoneFn(),addRemoveAnimationEvent(this._element,this._eventFn,!0))}destroy(){this._destroyed||(this._destroyed=!0,this.finish(),function(element,name){const tokens=getAnimationStyle(element,\"\").split(\",\"),index=findMatchingTokenIndex(tokens,name);index>=0&&(tokens.splice(index,1),setAnimationStyle(element,\"\",tokens.join(\",\")))}(this._element,this._name))}}function playPauseAnimation(element,name,status){setAnimationStyle(element,\"PlayState\",status,findIndexForAnimation(element,name))}function findIndexForAnimation(element,value){const anim=getAnimationStyle(element,\"\");return anim.indexOf(\",\")>0?findMatchingTokenIndex(anim.split(\",\"),value):findMatchingTokenIndex([anim],value)}function findMatchingTokenIndex(tokens,searchToken){for(let i=0;i<tokens.length;i++)if(tokens[i].indexOf(searchToken)>=0)return i;return-1}function addRemoveAnimationEvent(element,fn,doRemove){doRemove?element.removeEventListener(\"animationend\",fn):element.addEventListener(\"animationend\",fn)}function setAnimationStyle(element,name,value,index){const prop=\"animation\"+name;if(null!=index){const oldValue=element.style[prop];if(oldValue.length){const tokens=oldValue.split(\",\");tokens[index]=value,value=tokens.join(\",\")}}element.style[prop]=value}function getAnimationStyle(element,name){return element.style[\"animation\"+name]}class CssKeyframesPlayer{constructor(element,keyframes,animationName,_duration,_delay,easing,_finalStyles,_specialStyles){this.element=element,this.keyframes=keyframes,this.animationName=animationName,this._duration=_duration,this._delay=_delay,this._finalStyles=_finalStyles,this._specialStyles=_specialStyles,this._onDoneFns=[],this._onStartFns=[],this._onDestroyFns=[],this._started=!1,this.currentSnapshot={},this._state=0,this.easing=easing||\"linear\",this.totalTime=_duration+_delay,this._buildStyler()}onStart(fn){this._onStartFns.push(fn)}onDone(fn){this._onDoneFns.push(fn)}onDestroy(fn){this._onDestroyFns.push(fn)}destroy(){this.init(),this._state>=4||(this._state=4,this._styler.destroy(),this._flushStartFns(),this._flushDoneFns(),this._specialStyles&&this._specialStyles.destroy(),this._onDestroyFns.forEach(fn=>fn()),this._onDestroyFns=[])}_flushDoneFns(){this._onDoneFns.forEach(fn=>fn()),this._onDoneFns=[]}_flushStartFns(){this._onStartFns.forEach(fn=>fn()),this._onStartFns=[]}finish(){this.init(),this._state>=3||(this._state=3,this._styler.finish(),this._flushStartFns(),this._specialStyles&&this._specialStyles.finish(),this._flushDoneFns())}setPosition(value){this._styler.setPosition(value)}getPosition(){return this._styler.getPosition()}hasStarted(){return this._state>=2}init(){this._state>=1||(this._state=1,this._styler.apply(),this._delay&&this._styler.pause())}play(){this.init(),this.hasStarted()||(this._flushStartFns(),this._state=2,this._specialStyles&&this._specialStyles.start()),this._styler.resume()}pause(){this.init(),this._styler.pause()}restart(){this.reset(),this.play()}reset(){this._styler.destroy(),this._buildStyler(),this._styler.apply()}_buildStyler(){this._styler=new ElementAnimationStyleHandler(this.element,this.animationName,this._duration,this._delay,this.easing,\"forwards\",()=>this.finish())}triggerCallback(phaseName){const methods=\"start\"==phaseName?this._onStartFns:this._onDoneFns;methods.forEach(fn=>fn()),methods.length=0}beforeDestroy(){this.init();const styles={};if(this.hasStarted()){const finished=this._state>=3;Object.keys(this._finalStyles).forEach(prop=>{\"offset\"!=prop&&(styles[prop]=finished?this._finalStyles[prop]:computeStyle(this.element,prop))})}this.currentSnapshot=styles}}class browser_DirectStylePlayer extends NoopAnimationPlayer{constructor(element,styles){super(),this.element=element,this._startingStyles={},this.__initialized=!1,this._styles=hypenatePropsObject(styles)}init(){!this.__initialized&&this._startingStyles&&(this.__initialized=!0,Object.keys(this._styles).forEach(prop=>{this._startingStyles[prop]=this.element.style[prop]}),super.init())}play(){this._startingStyles&&(this.init(),Object.keys(this._styles).forEach(prop=>this.element.style.setProperty(prop,this._styles[prop])),super.play())}destroy(){this._startingStyles&&(Object.keys(this._startingStyles).forEach(prop=>{const value=this._startingStyles[prop];value?this.element.style.setProperty(prop,value):this.element.style.removeProperty(prop)}),this._startingStyles=null,super.destroy())}}class CssKeyframesDriver{constructor(){this._count=0,this._head=document.querySelector(\"head\"),this._warningIssued=!1}validateStyleProperty(prop){return validateStyleProperty(prop)}matchesElement(element,selector){return matchesElement(element,selector)}containsElement(elm1,elm2){return containsElement(elm1,elm2)}query(element,selector,multi){return invokeQuery(element,selector,multi)}computeStyle(element,prop,defaultValue){return window.getComputedStyle(element)[prop]}buildKeyframeElement(element,name,keyframes){keyframes=keyframes.map(kf=>hypenatePropsObject(kf));let keyframeStr=`@keyframes ${name} {\\n`,tab=\"\";keyframes.forEach(kf=>{tab=\" \";const offset=parseFloat(kf.offset);keyframeStr+=`${tab}${100*offset}% {\\n`,tab+=\" \",Object.keys(kf).forEach(prop=>{const value=kf[prop];switch(prop){case\"offset\":return;case\"easing\":return void(value&&(keyframeStr+=`${tab}animation-timing-function: ${value};\\n`));default:return void(keyframeStr+=`${tab}${prop}: ${value};\\n`)}}),keyframeStr+=tab+\"}\\n\"}),keyframeStr+=\"}\\n\";const kfElm=document.createElement(\"style\");return kfElm.innerHTML=keyframeStr,kfElm}animate(element,keyframes,duration,delay,easing,previousPlayers=[],scrubberAccessRequested){scrubberAccessRequested&&this._notifyFaultyScrubber();const previousCssKeyframePlayers=previousPlayers.filter(player=>player instanceof CssKeyframesPlayer),previousStyles={};allowPreviousPlayerStylesMerge(duration,delay)&&previousCssKeyframePlayers.forEach(player=>{let styles=player.currentSnapshot;Object.keys(styles).forEach(prop=>previousStyles[prop]=styles[prop])});const finalStyles=function(keyframes){let flatKeyframes={};return keyframes&&(Array.isArray(keyframes)?keyframes:[keyframes]).forEach(kf=>{Object.keys(kf).forEach(prop=>{\"offset\"!=prop&&\"easing\"!=prop&&(flatKeyframes[prop]=kf[prop])})}),flatKeyframes}(keyframes=balancePreviousStylesIntoKeyframes(element,keyframes,previousStyles));if(0==duration)return new browser_DirectStylePlayer(element,finalStyles);const animationName=\"gen_css_kf_\"+this._count++,kfElm=this.buildKeyframeElement(element,animationName,keyframes);document.querySelector(\"head\").appendChild(kfElm);const specialStyles=packageNonAnimatableStyles(element,keyframes),player=new CssKeyframesPlayer(element,keyframes,animationName,duration,delay,easing,finalStyles,specialStyles);return player.onDestroy(()=>{var node;(node=kfElm).parentNode.removeChild(node)}),player}_notifyFaultyScrubber(){this._warningIssued||(console.warn(\"@angular/animations: please load the web-animations.js polyfill to allow programmatic access...\\n\",\"  visit http://bit.ly/IWukam to learn more about using the web-animation-js polyfill.\"),this._warningIssued=!0)}}class WebAnimationsPlayer{constructor(element,keyframes,options,_specialStyles){this.element=element,this.keyframes=keyframes,this.options=options,this._specialStyles=_specialStyles,this._onDoneFns=[],this._onStartFns=[],this._onDestroyFns=[],this._initialized=!1,this._finished=!1,this._started=!1,this._destroyed=!1,this.time=0,this.parentPlayer=null,this.currentSnapshot={},this._duration=options.duration,this._delay=options.delay||0,this.time=this._duration+this._delay}_onFinish(){this._finished||(this._finished=!0,this._onDoneFns.forEach(fn=>fn()),this._onDoneFns=[])}init(){this._buildPlayer(),this._preparePlayerBeforeStart()}_buildPlayer(){if(this._initialized)return;this._initialized=!0;const keyframes=this.keyframes;this.domPlayer=this._triggerWebAnimation(this.element,keyframes,this.options),this._finalKeyframe=keyframes.length?keyframes[keyframes.length-1]:{},this.domPlayer.addEventListener(\"finish\",()=>this._onFinish())}_preparePlayerBeforeStart(){this._delay?this._resetDomPlayerState():this.domPlayer.pause()}_triggerWebAnimation(element,keyframes,options){return element.animate(keyframes,options)}onStart(fn){this._onStartFns.push(fn)}onDone(fn){this._onDoneFns.push(fn)}onDestroy(fn){this._onDestroyFns.push(fn)}play(){this._buildPlayer(),this.hasStarted()||(this._onStartFns.forEach(fn=>fn()),this._onStartFns=[],this._started=!0,this._specialStyles&&this._specialStyles.start()),this.domPlayer.play()}pause(){this.init(),this.domPlayer.pause()}finish(){this.init(),this._specialStyles&&this._specialStyles.finish(),this._onFinish(),this.domPlayer.finish()}reset(){this._resetDomPlayerState(),this._destroyed=!1,this._finished=!1,this._started=!1}_resetDomPlayerState(){this.domPlayer&&this.domPlayer.cancel()}restart(){this.reset(),this.play()}hasStarted(){return this._started}destroy(){this._destroyed||(this._destroyed=!0,this._resetDomPlayerState(),this._onFinish(),this._specialStyles&&this._specialStyles.destroy(),this._onDestroyFns.forEach(fn=>fn()),this._onDestroyFns=[])}setPosition(p){this.domPlayer.currentTime=p*this.time}getPosition(){return this.domPlayer.currentTime/this.time}get totalTime(){return this._delay+this._duration}beforeDestroy(){const styles={};this.hasStarted()&&Object.keys(this._finalKeyframe).forEach(prop=>{\"offset\"!=prop&&(styles[prop]=this._finished?this._finalKeyframe[prop]:computeStyle(this.element,prop))}),this.currentSnapshot=styles}triggerCallback(phaseName){const methods=\"start\"==phaseName?this._onStartFns:this._onDoneFns;methods.forEach(fn=>fn()),methods.length=0}}class WebAnimationsDriver{constructor(){this._isNativeImpl=/\\{\\s*\\[native\\s+code\\]\\s*\\}/.test(getElementAnimateFn().toString()),this._cssKeyframesDriver=new CssKeyframesDriver}validateStyleProperty(prop){return validateStyleProperty(prop)}matchesElement(element,selector){return matchesElement(element,selector)}containsElement(elm1,elm2){return containsElement(elm1,elm2)}query(element,selector,multi){return invokeQuery(element,selector,multi)}computeStyle(element,prop,defaultValue){return window.getComputedStyle(element)[prop]}overrideWebAnimationsSupport(supported){this._isNativeImpl=supported}animate(element,keyframes,duration,delay,easing,previousPlayers=[],scrubberAccessRequested){if(!scrubberAccessRequested&&!this._isNativeImpl)return this._cssKeyframesDriver.animate(element,keyframes,duration,delay,easing,previousPlayers);const playerOptions={duration:duration,delay:delay,fill:0==delay?\"both\":\"forwards\"};easing&&(playerOptions.easing=easing);const previousStyles={},previousWebAnimationPlayers=previousPlayers.filter(player=>player instanceof WebAnimationsPlayer);allowPreviousPlayerStylesMerge(duration,delay)&&previousWebAnimationPlayers.forEach(player=>{let styles=player.currentSnapshot;Object.keys(styles).forEach(prop=>previousStyles[prop]=styles[prop])});const specialStyles=packageNonAnimatableStyles(element,keyframes=balancePreviousStylesIntoKeyframes(element,keyframes=keyframes.map(styles=>copyStyles(styles,!1)),previousStyles));return new WebAnimationsPlayer(element,keyframes,playerOptions,specialStyles)}}function getElementAnimateFn(){return\"undefined\"!=typeof window&&void 0!==window.document&&Element.prototype.animate||{}}let animations_BrowserAnimationBuilder=(()=>{class BrowserAnimationBuilder extends AnimationBuilder{constructor(rootRenderer,doc){super(),this._nextAnimationId=0,this._renderer=rootRenderer.createRenderer(doc.body,{id:\"0\",encapsulation:ViewEncapsulation$1.None,styles:[],data:{animation:[]}})}build(animation){const id=this._nextAnimationId.toString();this._nextAnimationId++;const entry=Array.isArray(animation)?sequence(animation):animation;return issueAnimationCommand(this._renderer,null,id,\"register\",[entry]),new animations_BrowserAnimationFactory(id,this._renderer)}}return BrowserAnimationBuilder.ɵfac=function(t){return new(t||BrowserAnimationBuilder)(ɵɵinject(RendererFactory2),ɵɵinject(common_DOCUMENT))},BrowserAnimationBuilder.ɵprov=ɵɵdefineInjectable({token:BrowserAnimationBuilder,factory:BrowserAnimationBuilder.ɵfac}),BrowserAnimationBuilder})();class animations_BrowserAnimationFactory extends class{}{constructor(_id,_renderer){super(),this._id=_id,this._renderer=_renderer}create(element,options){return new RendererAnimationPlayer(this._id,element,options||{},this._renderer)}}class RendererAnimationPlayer{constructor(id,element,options,_renderer){this.id=id,this.element=element,this._renderer=_renderer,this.parentPlayer=null,this._started=!1,this.totalTime=0,this._command(\"create\",options)}_listen(eventName,callback){return this._renderer.listen(this.element,`@@${this.id}:${eventName}`,callback)}_command(command,...args){return issueAnimationCommand(this._renderer,this.element,this.id,command,args)}onDone(fn){this._listen(\"done\",fn)}onStart(fn){this._listen(\"start\",fn)}onDestroy(fn){this._listen(\"destroy\",fn)}init(){this._command(\"init\")}hasStarted(){return this._started}play(){this._command(\"play\"),this._started=!0}pause(){this._command(\"pause\")}restart(){this._command(\"restart\")}finish(){this._command(\"finish\")}destroy(){this._command(\"destroy\")}reset(){this._command(\"reset\")}setPosition(p){this._command(\"setPosition\",p)}getPosition(){return 0}}function issueAnimationCommand(renderer,element,id,command,args){return renderer.setProperty(element,`@@${id}:${command}`,args)}let animations_AnimationRendererFactory=(()=>{class AnimationRendererFactory{constructor(delegate,engine,_zone){this.delegate=delegate,this.engine=engine,this._zone=_zone,this._currentId=0,this._microtaskId=1,this._animationCallbacksBuffer=[],this._rendererCache=new Map,this._cdRecurDepth=0,this.promise=Promise.resolve(0),engine.onRemovalComplete=(element,delegate)=>{delegate&&delegate.parentNode(element)&&delegate.removeChild(element.parentNode,element)}}createRenderer(hostElement,type){const delegate=this.delegate.createRenderer(hostElement,type);if(!(hostElement&&type&&type.data&&type.data.animation)){let renderer=this._rendererCache.get(delegate);return renderer||(renderer=new BaseAnimationRenderer(\"\",delegate,this.engine),this._rendererCache.set(delegate,renderer)),renderer}const componentId=type.id,namespaceId=type.id+\"-\"+this._currentId;this._currentId++,this.engine.register(namespaceId,hostElement);const registerTrigger=trigger=>{Array.isArray(trigger)?trigger.forEach(registerTrigger):this.engine.registerTrigger(componentId,namespaceId,hostElement,trigger.name,trigger)};return type.data.animation.forEach(registerTrigger),new AnimationRenderer(this,namespaceId,delegate,this.engine)}begin(){this._cdRecurDepth++,this.delegate.begin&&this.delegate.begin()}_scheduleCountTask(){this.promise.then(()=>{this._microtaskId++})}scheduleListenerCallback(count,fn,data){count>=0&&count<this._microtaskId?this._zone.run(()=>fn(data)):(0==this._animationCallbacksBuffer.length&&Promise.resolve(null).then(()=>{this._zone.run(()=>{this._animationCallbacksBuffer.forEach(tuple=>{const[fn,data]=tuple;fn(data)}),this._animationCallbacksBuffer=[]})}),this._animationCallbacksBuffer.push([fn,data]))}end(){this._cdRecurDepth--,0==this._cdRecurDepth&&this._zone.runOutsideAngular(()=>{this._scheduleCountTask(),this.engine.flush(this._microtaskId)}),this.delegate.end&&this.delegate.end()}whenRenderingDone(){return this.engine.whenRenderingDone()}}return AnimationRendererFactory.ɵfac=function(t){return new(t||AnimationRendererFactory)(ɵɵinject(RendererFactory2),ɵɵinject(AnimationEngine),ɵɵinject(NgZone))},AnimationRendererFactory.ɵprov=ɵɵdefineInjectable({token:AnimationRendererFactory,factory:AnimationRendererFactory.ɵfac}),AnimationRendererFactory})();class BaseAnimationRenderer{constructor(namespaceId,delegate,engine){this.namespaceId=namespaceId,this.delegate=delegate,this.engine=engine,this.destroyNode=this.delegate.destroyNode?n=>delegate.destroyNode(n):null}get data(){return this.delegate.data}destroy(){this.engine.destroy(this.namespaceId,this.delegate),this.delegate.destroy()}createElement(name,namespace){return this.delegate.createElement(name,namespace)}createComment(value){return this.delegate.createComment(value)}createText(value){return this.delegate.createText(value)}appendChild(parent,newChild){this.delegate.appendChild(parent,newChild),this.engine.onInsert(this.namespaceId,newChild,parent,!1)}insertBefore(parent,newChild,refChild){this.delegate.insertBefore(parent,newChild,refChild),this.engine.onInsert(this.namespaceId,newChild,parent,!0)}removeChild(parent,oldChild,isHostElement){this.engine.onRemove(this.namespaceId,oldChild,this.delegate,isHostElement)}selectRootElement(selectorOrNode,preserveContent){return this.delegate.selectRootElement(selectorOrNode,preserveContent)}parentNode(node){return this.delegate.parentNode(node)}nextSibling(node){return this.delegate.nextSibling(node)}setAttribute(el,name,value,namespace){this.delegate.setAttribute(el,name,value,namespace)}removeAttribute(el,name,namespace){this.delegate.removeAttribute(el,name,namespace)}addClass(el,name){this.delegate.addClass(el,name)}removeClass(el,name){this.delegate.removeClass(el,name)}setStyle(el,style,value,flags){this.delegate.setStyle(el,style,value,flags)}removeStyle(el,style,flags){this.delegate.removeStyle(el,style,flags)}setProperty(el,name,value){\"@\"==name.charAt(0)&&\"@.disabled\"==name?this.disableAnimations(el,!!value):this.delegate.setProperty(el,name,value)}setValue(node,value){this.delegate.setValue(node,value)}listen(target,eventName,callback){return this.delegate.listen(target,eventName,callback)}disableAnimations(element,value){this.engine.disableAnimations(element,value)}}class AnimationRenderer extends BaseAnimationRenderer{constructor(factory,namespaceId,delegate,engine){super(namespaceId,delegate,engine),this.factory=factory,this.namespaceId=namespaceId}setProperty(el,name,value){\"@\"==name.charAt(0)?\".\"==name.charAt(1)&&\"@.disabled\"==name?this.disableAnimations(el,value=void 0===value||!!value):this.engine.process(this.namespaceId,el,name.substr(1),value):this.delegate.setProperty(el,name,value)}listen(target,eventName,callback){if(\"@\"==eventName.charAt(0)){const element=function(target){switch(target){case\"body\":return document.body;case\"document\":return document;case\"window\":return window;default:return target}}(target);let name=eventName.substr(1),phase=\"\";return\"@\"!=name.charAt(0)&&([name,phase]=function(triggerName){const dotIndex=triggerName.indexOf(\".\");return[triggerName.substring(0,dotIndex),triggerName.substr(dotIndex+1)]}(name)),this.engine.listen(this.namespaceId,element,name,phase,event=>{this.factory.scheduleListenerCallback(event._data||-1,callback,event)})}return this.delegate.listen(target,eventName,callback)}}let animations_InjectableAnimationEngine=(()=>{class InjectableAnimationEngine extends AnimationEngine{constructor(doc,driver,normalizer){super(doc.body,driver,normalizer)}}return InjectableAnimationEngine.ɵfac=function(t){return new(t||InjectableAnimationEngine)(ɵɵinject(common_DOCUMENT),ɵɵinject(AnimationDriver),ɵɵinject(AnimationStyleNormalizer))},InjectableAnimationEngine.ɵprov=ɵɵdefineInjectable({token:InjectableAnimationEngine,factory:InjectableAnimationEngine.ɵfac}),InjectableAnimationEngine})();const BROWSER_ANIMATIONS_PROVIDERS=[{provide:AnimationDriver,useFactory:function(){return\"function\"==typeof getElementAnimateFn()?new WebAnimationsDriver:new CssKeyframesDriver}},{provide:new InjectionToken(\"AnimationModuleType\"),useValue:\"BrowserAnimations\"},{provide:AnimationBuilder,useClass:animations_BrowserAnimationBuilder},{provide:AnimationStyleNormalizer,useFactory:function(){return new WebAnimationsStyleNormalizer}},{provide:AnimationEngine,useClass:animations_InjectableAnimationEngine},{provide:RendererFactory2,useFactory:function(renderer,engine,zone){return new animations_AnimationRendererFactory(renderer,engine,zone)},deps:[platform_browser_DomRendererFactory2,AnimationEngine,NgZone]}];let animations_BrowserAnimationsModule=(()=>{class BrowserAnimationsModule{}return BrowserAnimationsModule.ɵmod=ɵɵdefineNgModule({type:BrowserAnimationsModule}),BrowserAnimationsModule.ɵinj=ɵɵdefineInjector({factory:function(t){return new(t||BrowserAnimationsModule)},providers:BROWSER_ANIMATIONS_PROVIDERS,imports:[platform_browser_BrowserModule]}),BrowserAnimationsModule})(),app_module_AppModule=(()=>{class AppModule{}return AppModule.ɵmod=ɵɵdefineNgModule({type:AppModule,bootstrap:[app_component_AppComponent]}),AppModule.ɵinj=ɵɵdefineInjector({factory:function(t){return new(t||AppModule)},providers:[auth_guard_AuthGuard,product_service_ProductService],imports:[[platform_browser_BrowserModule,app_routing_module_AppRoutingModule,angular_fire_AngularFireModule.initializeApp(environment_firebase),angular_fire_auth_AngularFireAuthModule,angular_fire_firestore_AngularFirestoreModule,angular_fire_database_AngularFireDatabaseModule,forms_FormsModule,ngx_toastr_ToastrModule.forRoot(),animations_BrowserAnimationsModule]]}),AppModule})();platformBrowser().bootstrapModule(app_module_AppModule).catch(err=>console.error(err))},zVF4:function(module,exports,__webpack_require__){\"use strict\";Object.defineProperty(exports,\"__esModule\",{value:!0});var tslib=__webpack_require__(\"mrSG\"),CONSTANTS={NODE_CLIENT:!1,NODE_ADMIN:!1,SDK_VERSION:\"${JSCORE_VERSION}\"},assert=function(assertion,message){if(!assertion)throw assertionError(message)},assertionError=function(message){return new Error(\"Firebase Database (\"+CONSTANTS.SDK_VERSION+\") INTERNAL ASSERT FAILED: \"+message)},stringToByteArray=function(str){for(var out=[],p=0,i=0;i<str.length;i++){var c=str.charCodeAt(i);c<128?out[p++]=c:c<2048?(out[p++]=c>>6|192,out[p++]=63&c|128):55296==(64512&c)&&i+1<str.length&&56320==(64512&str.charCodeAt(i+1))?(c=65536+((1023&c)<<10)+(1023&str.charCodeAt(++i)),out[p++]=c>>18|240,out[p++]=c>>12&63|128,out[p++]=c>>6&63|128,out[p++]=63&c|128):(out[p++]=c>>12|224,out[p++]=c>>6&63|128,out[p++]=63&c|128)}return out},base64={byteToCharMap_:null,charToByteMap_:null,byteToCharMapWebSafe_:null,charToByteMapWebSafe_:null,ENCODED_VALS_BASE:\"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789\",get ENCODED_VALS(){return this.ENCODED_VALS_BASE+\"+/=\"},get ENCODED_VALS_WEBSAFE(){return this.ENCODED_VALS_BASE+\"-_.\"},HAS_NATIVE_SUPPORT:\"function\"==typeof atob,encodeByteArray:function(input,webSafe){if(!Array.isArray(input))throw Error(\"encodeByteArray takes an array as a parameter\");this.init_();for(var byteToCharMap=webSafe?this.byteToCharMapWebSafe_:this.byteToCharMap_,output=[],i=0;i<input.length;i+=3){var byte1=input[i],haveByte2=i+1<input.length,byte2=haveByte2?input[i+1]:0,haveByte3=i+2<input.length,byte3=haveByte3?input[i+2]:0,outByte3=(15&byte2)<<2|byte3>>6,outByte4=63&byte3;haveByte3||(outByte4=64,haveByte2||(outByte3=64)),output.push(byteToCharMap[byte1>>2],byteToCharMap[(3&byte1)<<4|byte2>>4],byteToCharMap[outByte3],byteToCharMap[outByte4])}return output.join(\"\")},encodeString:function(input,webSafe){return this.HAS_NATIVE_SUPPORT&&!webSafe?btoa(input):this.encodeByteArray(stringToByteArray(input),webSafe)},decodeString:function(input,webSafe){return this.HAS_NATIVE_SUPPORT&&!webSafe?atob(input):function(bytes){for(var out=[],pos=0,c=0;pos<bytes.length;){var c1=bytes[pos++];if(c1<128)out[c++]=String.fromCharCode(c1);else if(c1>191&&c1<224){var c2=bytes[pos++];out[c++]=String.fromCharCode((31&c1)<<6|63&c2)}else if(c1>239&&c1<365){var u=((7&c1)<<18|(63&(c2=bytes[pos++]))<<12|(63&(c3=bytes[pos++]))<<6|63&bytes[pos++])-65536;out[c++]=String.fromCharCode(55296+(u>>10)),out[c++]=String.fromCharCode(56320+(1023&u))}else{c2=bytes[pos++];var c3=bytes[pos++];out[c++]=String.fromCharCode((15&c1)<<12|(63&c2)<<6|63&c3)}}return out.join(\"\")}(this.decodeStringToByteArray(input,webSafe))},decodeStringToByteArray:function(input,webSafe){this.init_();for(var charToByteMap=webSafe?this.charToByteMapWebSafe_:this.charToByteMap_,output=[],i=0;i<input.length;){var byte1=charToByteMap[input.charAt(i++)],byte2=i<input.length?charToByteMap[input.charAt(i)]:0,byte3=++i<input.length?charToByteMap[input.charAt(i)]:64,byte4=++i<input.length?charToByteMap[input.charAt(i)]:64;if(++i,null==byte1||null==byte2||null==byte3||null==byte4)throw Error();output.push(byte1<<2|byte2>>4),64!==byte3&&(output.push(byte2<<4&240|byte3>>2),64!==byte4&&output.push(byte3<<6&192|byte4))}return output},init_:function(){if(!this.byteToCharMap_){this.byteToCharMap_={},this.charToByteMap_={},this.byteToCharMapWebSafe_={},this.charToByteMapWebSafe_={};for(var i=0;i<this.ENCODED_VALS.length;i++)this.byteToCharMap_[i]=this.ENCODED_VALS.charAt(i),this.charToByteMap_[this.byteToCharMap_[i]]=i,this.byteToCharMapWebSafe_[i]=this.ENCODED_VALS_WEBSAFE.charAt(i),this.charToByteMapWebSafe_[this.byteToCharMapWebSafe_[i]]=i,i>=this.ENCODED_VALS_BASE.length&&(this.charToByteMap_[this.ENCODED_VALS_WEBSAFE.charAt(i)]=i,this.charToByteMapWebSafe_[this.ENCODED_VALS.charAt(i)]=i)}}},base64Decode=function(str){try{return base64.decodeString(str,!0)}catch(e){console.error(\"base64Decode failed: \",e)}return null};function deepExtend(target,source){if(!(source instanceof Object))return source;switch(source.constructor){case Date:return new Date(source.getTime());case Object:void 0===target&&(target={});break;case Array:target=[];break;default:return source}for(var prop in source)source.hasOwnProperty(prop)&&(target[prop]=deepExtend(target[prop],source[prop]));return target}var Deferred=function(){function Deferred(){var _this=this;this.reject=function(){},this.resolve=function(){},this.promise=new Promise((function(resolve,reject){_this.resolve=resolve,_this.reject=reject}))}return Deferred.prototype.wrapCallback=function(callback){var _this=this;return function(error,value){error?_this.reject(error):_this.resolve(value),\"function\"==typeof callback&&(_this.promise.catch((function(){})),1===callback.length?callback(error):callback(error,value))}},Deferred}();function getUA(){return\"undefined\"!=typeof navigator&&\"string\"==typeof navigator.userAgent?navigator.userAgent:\"\"}function isNode(){try{return\"[object process]\"===Object.prototype.toString.call(global.process)}catch(e){return!1}}var FirebaseError=function(_super){function FirebaseError(code,message){var _this=_super.call(this,message)||this;return _this.code=code,_this.name=\"FirebaseError\",Object.setPrototypeOf(_this,FirebaseError.prototype),Error.captureStackTrace&&Error.captureStackTrace(_this,ErrorFactory.prototype.create),_this}return tslib.__extends(FirebaseError,_super),FirebaseError}(Error),ErrorFactory=function(){function ErrorFactory(service,serviceName,errors){this.service=service,this.serviceName=serviceName,this.errors=errors}return ErrorFactory.prototype.create=function(code){for(var data=[],_i=1;_i<arguments.length;_i++)data[_i-1]=arguments[_i];for(var customData=data[0]||{},fullCode=this.service+\"/\"+code,template=this.errors[code],message=template?replaceTemplate(template,customData):\"Error\",fullMessage=this.serviceName+\": \"+message+\" (\"+fullCode+\").\",error=new FirebaseError(fullCode,fullMessage),_a=0,_b=Object.keys(customData);_a<_b.length;_a++){var key=_b[_a];\"_\"!==key.slice(-1)&&(key in error&&console.warn('Overwriting FirebaseError base field \"'+key+'\" can cause unexpected behavior.'),error[key]=customData[key])}return error},ErrorFactory}();function replaceTemplate(template,data){return template.replace(PATTERN,(function(_,key){var value=data[key];return null!=value?String(value):\"<\"+key+\"?>\"}))}var PATTERN=/\\{\\$([^}]+)}/g;function jsonEval(str){return JSON.parse(str)}var decode=function(token){var header={},claims={},data={},signature=\"\";try{var parts=token.split(\".\");header=jsonEval(base64Decode(parts[0])||\"\"),claims=jsonEval(base64Decode(parts[1])||\"\"),signature=parts[2],data=claims.d||{},delete claims.d}catch(e){}return{header:header,claims:claims,data:data,signature:signature}},Sha1=function(){function Sha1(){this.chain_=[],this.buf_=[],this.W_=[],this.pad_=[],this.inbuf_=0,this.total_=0,this.blockSize=64,this.pad_[0]=128;for(var i=1;i<this.blockSize;++i)this.pad_[i]=0;this.reset()}return Sha1.prototype.reset=function(){this.chain_[0]=1732584193,this.chain_[1]=4023233417,this.chain_[2]=2562383102,this.chain_[3]=271733878,this.chain_[4]=3285377520,this.inbuf_=0,this.total_=0},Sha1.prototype.compress_=function(buf,offset){offset||(offset=0);var W=this.W_;if(\"string\"==typeof buf)for(var i=0;i<16;i++)W[i]=buf.charCodeAt(offset)<<24|buf.charCodeAt(offset+1)<<16|buf.charCodeAt(offset+2)<<8|buf.charCodeAt(offset+3),offset+=4;else for(i=0;i<16;i++)W[i]=buf[offset]<<24|buf[offset+1]<<16|buf[offset+2]<<8|buf[offset+3],offset+=4;for(i=16;i<80;i++)W[i]=4294967295&((t=W[i-3]^W[i-8]^W[i-14]^W[i-16])<<1|t>>>31);var f,k,a=this.chain_[0],b=this.chain_[1],c=this.chain_[2],d=this.chain_[3],e=this.chain_[4];for(i=0;i<80;i++){i<40?i<20?(f=d^b&(c^d),k=1518500249):(f=b^c^d,k=1859775393):i<60?(f=b&c|d&(b|c),k=2400959708):(f=b^c^d,k=3395469782);var t=(a<<5|a>>>27)+f+e+k+W[i]&4294967295;e=d,d=c,c=4294967295&(b<<30|b>>>2),b=a,a=t}this.chain_[0]=this.chain_[0]+a&4294967295,this.chain_[1]=this.chain_[1]+b&4294967295,this.chain_[2]=this.chain_[2]+c&4294967295,this.chain_[3]=this.chain_[3]+d&4294967295,this.chain_[4]=this.chain_[4]+e&4294967295},Sha1.prototype.update=function(bytes,length){if(null!=bytes){void 0===length&&(length=bytes.length);for(var lengthMinusBlock=length-this.blockSize,n=0,buf=this.buf_,inbuf=this.inbuf_;n<length;){if(0===inbuf)for(;n<=lengthMinusBlock;)this.compress_(bytes,n),n+=this.blockSize;if(\"string\"==typeof bytes){for(;n<length;)if(buf[inbuf]=bytes.charCodeAt(n),++n,++inbuf===this.blockSize){this.compress_(buf),inbuf=0;break}}else for(;n<length;)if(buf[inbuf]=bytes[n],++n,++inbuf===this.blockSize){this.compress_(buf),inbuf=0;break}}this.inbuf_=inbuf,this.total_+=length}},Sha1.prototype.digest=function(){var digest=[],totalBits=8*this.total_;this.update(this.pad_,this.inbuf_<56?56-this.inbuf_:this.blockSize-(this.inbuf_-56));for(var i=this.blockSize-1;i>=56;i--)this.buf_[i]=255&totalBits,totalBits/=256;this.compress_(this.buf_);var n=0;for(i=0;i<5;i++)for(var j=24;j>=0;j-=8)digest[n]=this.chain_[i]>>j&255,++n;return digest},Sha1}(),ObserverProxy=function(){function ObserverProxy(executor,onNoObservers){var _this=this;this.observers=[],this.unsubscribes=[],this.observerCount=0,this.task=Promise.resolve(),this.finalized=!1,this.onNoObservers=onNoObservers,this.task.then((function(){executor(_this)})).catch((function(e){_this.error(e)}))}return ObserverProxy.prototype.next=function(value){this.forEachObserver((function(observer){observer.next(value)}))},ObserverProxy.prototype.error=function(error){this.forEachObserver((function(observer){observer.error(error)})),this.close(error)},ObserverProxy.prototype.complete=function(){this.forEachObserver((function(observer){observer.complete()})),this.close()},ObserverProxy.prototype.subscribe=function(nextOrObserver,error,complete){var observer,_this=this;if(void 0===nextOrObserver&&void 0===error&&void 0===complete)throw new Error(\"Missing Observer.\");void 0===(observer=function(obj,methods){if(\"object\"!=typeof obj||null===obj)return!1;for(var _i=0,methods_1=[\"next\",\"error\",\"complete\"];_i<methods_1.length;_i++){var method=methods_1[_i];if(method in obj&&\"function\"==typeof obj[method])return!0}return!1}(nextOrObserver)?nextOrObserver:{next:nextOrObserver,error:error,complete:complete}).next&&(observer.next=noop),void 0===observer.error&&(observer.error=noop),void 0===observer.complete&&(observer.complete=noop);var unsub=this.unsubscribeOne.bind(this,this.observers.length);return this.finalized&&this.task.then((function(){try{_this.finalError?observer.error(_this.finalError):observer.complete()}catch(e){}})),this.observers.push(observer),unsub},ObserverProxy.prototype.unsubscribeOne=function(i){void 0!==this.observers&&void 0!==this.observers[i]&&(delete this.observers[i],this.observerCount-=1,0===this.observerCount&&void 0!==this.onNoObservers&&this.onNoObservers(this))},ObserverProxy.prototype.forEachObserver=function(fn){if(!this.finalized)for(var i=0;i<this.observers.length;i++)this.sendOne(i,fn)},ObserverProxy.prototype.sendOne=function(i,fn){var _this=this;this.task.then((function(){if(void 0!==_this.observers&&void 0!==_this.observers[i])try{fn(_this.observers[i])}catch(e){\"undefined\"!=typeof console&&console.error&&console.error(e)}}))},ObserverProxy.prototype.close=function(err){var _this=this;this.finalized||(this.finalized=!0,void 0!==err&&(this.finalError=err),this.task.then((function(){_this.observers=void 0,_this.onNoObservers=void 0})))},ObserverProxy}();function noop(){}function errorPrefix(fnName,argumentNumber,optional){var argName=\"\";switch(argumentNumber){case 1:argName=optional?\"first\":\"First\";break;case 2:argName=optional?\"second\":\"Second\";break;case 3:argName=optional?\"third\":\"Third\";break;case 4:argName=optional?\"fourth\":\"Fourth\";break;default:throw new Error(\"errorPrefix called with argumentNumber > 4.  Need to update it?\")}return fnName+\" failed: \"+argName+\" argument \"}exports.CONSTANTS=CONSTANTS,exports.Deferred=Deferred,exports.ErrorFactory=ErrorFactory,exports.FirebaseError=FirebaseError,exports.MAX_VALUE_MILLIS=144e5,exports.RANDOM_FACTOR=.5,exports.Sha1=Sha1,exports.areCookiesEnabled=function(){return!(!navigator||!navigator.cookieEnabled)},exports.assert=assert,exports.assertionError=assertionError,exports.async=function(fn,onError){return function(){for(var args=[],_i=0;_i<arguments.length;_i++)args[_i]=arguments[_i];Promise.resolve(!0).then((function(){fn.apply(void 0,args)})).catch((function(error){onError&&onError(error)}))}},exports.base64=base64,exports.base64Decode=base64Decode,exports.base64Encode=function(str){var utf8Bytes=stringToByteArray(str);return base64.encodeByteArray(utf8Bytes,!0)},exports.calculateBackoffMillis=function(backoffCount,intervalMillis,backoffFactor){void 0===intervalMillis&&(intervalMillis=1e3),void 0===backoffFactor&&(backoffFactor=2);var currBaseValue=intervalMillis*Math.pow(backoffFactor,backoffCount),randomWait=Math.round(.5*currBaseValue*(Math.random()-.5)*2);return Math.min(144e5,currBaseValue+randomWait)},exports.contains=function(obj,key){return Object.prototype.hasOwnProperty.call(obj,key)},exports.createSubscribe=function(executor,onNoObservers){var proxy=new ObserverProxy(executor,onNoObservers);return proxy.subscribe.bind(proxy)},exports.decode=decode,exports.deepCopy=function(value){return deepExtend(void 0,value)},exports.deepExtend=deepExtend,exports.errorPrefix=errorPrefix,exports.getUA=getUA,exports.isAdmin=function(token){var claims=decode(token).claims;return\"object\"==typeof claims&&!0===claims.admin},exports.isBrowser=function(){return\"object\"==typeof self&&self.self===self},exports.isBrowserExtension=function(){var runtime=\"object\"==typeof chrome?chrome.runtime:\"object\"==typeof browser?browser.runtime:void 0;return\"object\"==typeof runtime&&void 0!==runtime.id},exports.isElectron=function(){return getUA().indexOf(\"Electron/\")>=0},exports.isEmpty=function(obj){for(var key in obj)if(Object.prototype.hasOwnProperty.call(obj,key))return!1;return!0},exports.isIE=function(){var ua=getUA();return ua.indexOf(\"MSIE \")>=0||ua.indexOf(\"Trident/\")>=0},exports.isIndexedDBAvailable=function(){return\"indexedDB\"in self&&null!=indexedDB},exports.isMobileCordova=function(){return\"undefined\"!=typeof window&&!!(window.cordova||window.phonegap||window.PhoneGap)&&/ios|iphone|ipod|ipad|android|blackberry|iemobile/i.test(getUA())},exports.isNode=isNode,exports.isNodeSdk=function(){return!0===CONSTANTS.NODE_CLIENT||!0===CONSTANTS.NODE_ADMIN},exports.isReactNative=function(){return\"object\"==typeof navigator&&\"ReactNative\"===navigator.product},exports.isSafari=function(){return!isNode()&&navigator.userAgent.includes(\"Safari\")&&!navigator.userAgent.includes(\"Chrome\")},exports.isUWP=function(){return getUA().indexOf(\"MSAppHost/\")>=0},exports.isValidFormat=function(token){var claims=decode(token).claims;return!!claims&&\"object\"==typeof claims&&claims.hasOwnProperty(\"iat\")},exports.isValidTimestamp=function(token){var claims=decode(token).claims,now=Math.floor((new Date).getTime()/1e3),validSince=0,validUntil=0;return\"object\"==typeof claims&&(claims.hasOwnProperty(\"nbf\")?validSince=claims.nbf:claims.hasOwnProperty(\"iat\")&&(validSince=claims.iat),validUntil=claims.hasOwnProperty(\"exp\")?claims.exp:validSince+86400),!!now&&!!validSince&&!!validUntil&&now>=validSince&&now<=validUntil},exports.issuedAtTime=function(token){var claims=decode(token).claims;return\"object\"==typeof claims&&claims.hasOwnProperty(\"iat\")?claims.iat:null},exports.jsonEval=jsonEval,exports.map=function(obj,fn,contextObj){var res={};for(var key in obj)Object.prototype.hasOwnProperty.call(obj,key)&&(res[key]=fn.call(contextObj,obj[key],key,obj));return res},exports.querystring=function(querystringParams){for(var params=[],_loop_1=function(key,value){Array.isArray(value)?value.forEach((function(arrayVal){params.push(encodeURIComponent(key)+\"=\"+encodeURIComponent(arrayVal))})):params.push(encodeURIComponent(key)+\"=\"+encodeURIComponent(value))},_i=0,_a=Object.entries(querystringParams);_i<_a.length;_i++){var _b=_a[_i];_loop_1(_b[0],_b[1])}return params.length?\"&\"+params.join(\"&\"):\"\"},exports.querystringDecode=function(querystring){var obj={};return querystring.replace(/^\\?/,\"\").split(\"&\").forEach((function(token){if(token){var key=token.split(\"=\");obj[key[0]]=key[1]}})),obj},exports.safeGet=function(obj,key){return Object.prototype.hasOwnProperty.call(obj,key)?obj[key]:void 0},exports.stringLength=function(str){for(var p=0,i=0;i<str.length;i++){var c=str.charCodeAt(i);c<128?p++:c<2048?p+=2:c>=55296&&c<=56319?(p+=4,i++):p+=3}return p},exports.stringToByteArray=function(str){for(var out=[],p=0,i=0;i<str.length;i++){var c=str.charCodeAt(i);if(c>=55296&&c<=56319){var high=c-55296;i++,assert(i<str.length,\"Surrogate pair missing trail surrogate.\"),c=65536+(high<<10)+(str.charCodeAt(i)-56320)}c<128?out[p++]=c:c<2048?(out[p++]=c>>6|192,out[p++]=63&c|128):c<65536?(out[p++]=c>>12|224,out[p++]=c>>6&63|128,out[p++]=63&c|128):(out[p++]=c>>18|240,out[p++]=c>>12&63|128,out[p++]=c>>6&63|128,out[p++]=63&c|128)}return out},exports.stringify=function(data){return JSON.stringify(data)},exports.validateArgCount=function(fnName,minCount,maxCount,argCount){var argError;if(argCount<minCount?argError=\"at least \"+minCount:argCount>maxCount&&(argError=0===maxCount?\"none\":\"no more than \"+maxCount),argError)throw new Error(fnName+\" failed: Was called with \"+argCount+(1===argCount?\" argument.\":\" arguments.\")+\" Expects \"+argError+\".\")},exports.validateCallback=function(fnName,argumentNumber,callback,optional){if((!optional||callback)&&\"function\"!=typeof callback)throw new Error(errorPrefix(fnName,argumentNumber,optional)+\"must be a valid function.\")},exports.validateContextObject=function(fnName,argumentNumber,context,optional){if((!optional||context)&&(\"object\"!=typeof context||null===context))throw new Error(errorPrefix(fnName,argumentNumber,optional)+\"must be a valid context object.\")},exports.validateIndexedDBOpenable=function(){return new Promise((function(resolve,reject){try{var preExist_1=!0,DB_CHECK_NAME_1=\"validate-browser-context-for-indexeddb-analytics-module\",request_1=window.indexedDB.open(DB_CHECK_NAME_1);request_1.onsuccess=function(){request_1.result.close(),preExist_1||window.indexedDB.deleteDatabase(DB_CHECK_NAME_1),resolve(!0)},request_1.onupgradeneeded=function(){preExist_1=!1},request_1.onerror=function(){var _a;reject((null===(_a=request_1.error)||void 0===_a?void 0:_a.message)||\"\")}}catch(error){reject(error)}}))},exports.validateNamespace=function(fnName,argumentNumber,namespace,optional){if((!optional||namespace)&&\"string\"!=typeof namespace)throw new Error(errorPrefix(fnName,argumentNumber,optional)+\"must be a valid firebase namespace.\")}},zn8P:function(module,exports){function webpackEmptyAsyncContext(req){return Promise.resolve().then((function(){var e=new Error(\"Cannot find module '\"+req+\"'\");throw e.code=\"MODULE_NOT_FOUND\",e}))}webpackEmptyAsyncContext.keys=function(){return[]},webpackEmptyAsyncContext.resolve=webpackEmptyAsyncContext,module.exports=webpackEmptyAsyncContext,webpackEmptyAsyncContext.id=\"zn8P\"}},[[0,0]]]);","extractedComments":[]}